<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>constructive_ereal.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><script>
    // Resolve backreferences
    document.addEventListener("DOMContentLoaded", function() {
        var references = document.querySelectorAll([
           ".alectryon-io .alectryon-extra-goals",
           ".alectryon-io .alectryon-goal",
           ".alectryon-io .alectryon-goals",
           ".alectryon-io .alectryon-output",
           ".alectryon-io .goal-conclusion",
           ".alectryon-io .goal-hyps",
           ".alectryon-io .goal-hyps > span"].join(", "));
        document.querySelectorAll('.alectryon-io q').forEach(function (q) {
            q.replaceWith(references[parseInt(q.innerText, 16)].cloneNode(true)) });
    });

    // Add checkboxes
    document.addEventListener("DOMContentLoaded", function() {
        var input = document.createElement("input");
        input.type = "checkbox";
        input.style = "display: none";

        input.className = "alectryon-extra-goal-toggle";
        document.querySelectorAll('.alectryon-io label.goal-separator').forEach(function(lbl, idx) {
            var goal = lbl.parentNode, box = input.cloneNode(true);
            lbl.htmlFor = box.id = "alectryon-hyps-chk" + idx;
            goal.parentNode.insertBefore(box, goal);
        });

        input.className = "alectryon-toggle";
        document.querySelectorAll('.alectryon-io .alectryon-output').forEach(function(div, idx) {
            var box = input.cloneNode(true), lbl = div.previousSibling;
            box.checked = div.classList.contains("a:show");
            if (lbl && lbl.tagName == "LABEL") {
                lbl.htmlFor = box.id = "alectryon-output-chk" + idx;
            }
            div.parentNode.insertBefore(box, lbl || div);
        });
    });
</script><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-centered alectryon-coqdoc alectryon-minified"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.15.0+0.15.0. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="c">(* mathcomp analysis (c) 2017 Inria and AIST. License: CeCILL-C.              *)</span>
<span class="c">(* -------------------------------------------------------------------- *)</span>
<span class="c">(* Copyright (c) - 2015--2016 - IMDEA Software Institute                *)</span>
<span class="c">(* Copyright (c) - 2015--2018 - Inria                                   *)</span>
<span class="c">(* Copyright (c) - 2016--2018 - Polytechnique                           *)</span>
<span class="c">(* -------------------------------------------------------------------- *)</span>

<span class="c">(* TODO: merge this with table.v in real-closed</span>
<span class="c">   (c.f. https://github.com/math-comp/real-closed/pull/29 ) and</span>
<span class="c">   incorporate it into mathcomp proper where it could then be used for</span>
<span class="c">   bounds of intervals*)</span>
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">From</span> mathcomp <span class="kn">Require Import</span> all_ssreflect all_algebra finmap.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ predI _ &amp; _ ]&quot;</span> was already used <span class="kr">in</span> scope
fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ predU _ &amp; _ ]&quot;</span> was already used <span class="kr">in</span> scope
fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ predD _ &amp; _ ]&quot;</span> was already used <span class="kr">in</span> scope
fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ predC _ ]&quot;</span> was already used <span class="kr">in</span> scope
fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ preim _ of _ ]&quot;</span> was already used <span class="kr">in</span> scope
fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ + _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ - _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt;= _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt; _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &gt;= _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &gt; _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt;= _ &lt;= _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt; _ &lt;= _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt;= _ &lt; _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt; _ &lt; _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ * _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message">New coercion path [GRing.subring_closedM;
                   GRing.smulr_closedN] : GRing.subring_closed &gt;-&gt; GRing.oppr_closed <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.subring_closedB; GRing.zmod_closedN] : GRing.subring_closed &gt;-&gt; GRing.oppr_closed.
[ambiguous-paths,typechecker]</blockquote><blockquote class="alectryon-message">New coercion path [GRing.subring_closed_semi;
                   GRing.semiring_closedM] : GRing.subring_closed &gt;-&gt; GRing.mulr_closed <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.subring_closedM; GRing.smulr_closedM] : GRing.subring_closed &gt;-&gt; GRing.mulr_closed.
New coercion path [GRing.subring_closed_semi;
                   GRing.semiring_closedD] : GRing.subring_closed &gt;-&gt; GRing.addr_closed <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.subring_closedB; GRing.zmod_closedD] : GRing.subring_closed &gt;-&gt; GRing.addr_closed.
[ambiguous-paths,typechecker]</blockquote><blockquote class="alectryon-message">New coercion path [GRing.sdivr_closed_div;
                   GRing.divr_closedM] : GRing.sdivr_closed &gt;-&gt; GRing.mulr_closed <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.sdivr_closedM; GRing.smulr_closedM] : GRing.sdivr_closed &gt;-&gt; GRing.mulr_closed.
[ambiguous-paths,typechecker]</blockquote><blockquote class="alectryon-message">New coercion path [GRing.subalg_closedBM;
                   GRing.subring_closedB] : GRing.subalg_closed &gt;-&gt; GRing.zmod_closed <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.subalg_closedZ; GRing.submod_closedB] : GRing.subalg_closed &gt;-&gt; GRing.zmod_closed.
[ambiguous-paths,typechecker]</blockquote><blockquote class="alectryon-message">New coercion path [GRing.divring_closed_div;
                   GRing.sdivr_closedM] : GRing.divring_closed &gt;-&gt; GRing.smulr_closed <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.divring_closedBM; GRing.subring_closedM] : GRing.divring_closed &gt;-&gt; GRing.smulr_closed.
[ambiguous-paths,typechecker]</blockquote><blockquote class="alectryon-message">New coercion path [GRing.divalg_closedBdiv;
                   GRing.divring_closedBM] : GRing.divalg_closed &gt;-&gt; GRing.subring_closed <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.divalg_closedZ; GRing.subalg_closedBM] : GRing.divalg_closed &gt;-&gt; GRing.subring_closed.
[ambiguous-paths,typechecker]</blockquote><blockquote class="alectryon-message">New coercion path [GRing.Pred.subring_smul;
                   GRing.Pred.smul_mul] : GRing.Pred.subring &gt;-&gt; GRing.Pred.mul <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.Pred.subring_semi; GRing.Pred.semiring_mul] : GRing.Pred.subring &gt;-&gt; GRing.Pred.mul.
[ambiguous-paths,typechecker]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">From</span> mathcomp.classical <span class="kn">Require Import</span> mathcomp_extra.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ \* _&quot;</span> was already used <span class="kr">in</span> scope
ring_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;\- _&quot;</span> was already used <span class="kr">in</span> scope ring_scope.
[notation-overridden,parsing]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> signed.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(******************************************************************************)</span>
<span class="c">(*                         Extended real numbers                              *)</span>
<span class="c">(*                                                                            *)</span>
<span class="c">(* Given a type R for numbers, \bar R is the type R extended with symbols -oo *)</span>
<span class="c">(* and +oo (notation scope: %E), suitable to represent extended real numbers. *)</span>
<span class="c">(* When R is a numDomainType, \bar R is equipped with a canonical porderType  *)</span>
<span class="c">(* and operations for addition/opposite. When R is a realDomainType, \bar R   *)</span>
<span class="c">(* is equipped with a Canonical orderType.                                    *)</span>
<span class="c">(*                                                                            *)</span>
<span class="c">(* Naming convention: in definition/lemma identifiers, &quot;e&quot; stands for an      *)</span>
<span class="c">(* extended number and &quot;y&quot; and &quot;Ny&quot; for +oo ad -oo respectively.              *)</span>
<span class="c">(*                                                                            *)</span>
<span class="c">(*                  \bar R == coproduct of R and {+oo, -oo};                  *)</span>
<span class="c">(*                            notation for extended (R:Type)                  *)</span>
<span class="c">(*                    r%:E == injects real numbers into \bar R                *)</span>
<span class="c">(*           +%E, -%E, *%E == addition/opposite/multiplication for extended   *)</span>
<span class="c">(*                            reals                                           *)</span>
<span class="c">(*                `| x |%E == the absolute value of x                         *)</span>
<span class="c">(*                  x ^+ n == iterated multiplication                         *)</span>
<span class="c">(*                  x *+ n == iterated addition                               *)</span>
<span class="c">(*       +%dE, (x *+ n)%dE == dual addition/dual iterated addition for        *)</span>
<span class="c">(*                            extended reals (-oo + +oo = +oo instead of -oo) *)</span>
<span class="c">(*                            Import DualAddTheory for related lemmas         *)</span>
<span class="c">(*                  x +? y == the addition of the extended real numbers x and *)</span>
<span class="c">(*                            and y is defined, i.e., it is neither +oo - oo  *)</span>
<span class="c">(*                            nor -oo + oo                                    *)</span>
<span class="c">(*                  x *? y == the multiplication of the extended real numbers *)</span>
<span class="c">(*                            x and y is not of the form 0 * +oo or 0 * -oo   *)</span>
<span class="c">(*  (_ &lt;= _)%E, (_ &lt; _)%E, == comparison relations for extended reals         *)</span>
<span class="c">(*  (_ &gt;= _)%E, (_ &gt; _)%E                                                     *)</span>
<span class="c">(*   (\sum_(i in A) f i)%E == bigop-like notation in scope %E                 *)</span>
<span class="c">(*      maxe x y, mine x y == notation for the maximum/minimum of two         *)</span>
<span class="c">(*                            extended real numbers                           *)</span>
<span class="c">(*                                                                            *)</span>
<span class="c">(* Signed extended real numbers:                                              *)</span>
<span class="c">(*    {posnum \bar R} == interface type for elements in \bar R that are       *)</span>
<span class="c">(*                       positive, c.f., signed.v, notation in scope %E       *)</span>
<span class="c">(*    {nonneg \bar R} == interface types for elements in \bar R that are      *)</span>
<span class="c">(*                       non-negative, c.f. signed.v, notation in scope %E    *)</span>
<span class="c">(*             x%:pos == explicitly casts x to {posnum \bar R}, in scope %E   *)</span>
<span class="c">(*             x%:nng == explicitly casts x to {nonneg \bar R}, in scope %E   *)</span>
<span class="c">(*                                                                            *)</span>
<span class="c">(* Topology of extended real numbers:                                         *)</span>
<span class="c">(*                       contract == order-preserving bijective function      *)</span>
<span class="c">(*                                   from extended real numbers to [-1; 1]    *)</span>
<span class="c">(*                         expand == function from real numbers to extended   *)</span>
<span class="c">(*                                   real numbers that cancels contract in    *)</span>
<span class="c">(*                                   [-1; 1]                                  *)</span>
<span class="c">(*                                                                            *)</span>
<span class="sd">(******************************************************************************)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Set Implicit Arguments</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Unset Strict Implicit</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Unset Printing Implicit Defensive</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Reserved Notation</span> <span class="s2">&quot;x %:E&quot;</span> (<span class="kn">at level</span> <span class="mi">2</span>, <span class="kn">format</span> <span class="s2">&quot;x %:E&quot;</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Reserved Notation</span> <span class="s2">&quot;x +? y&quot;</span> (<span class="kn">at level</span> <span class="mi">50</span>, <span class="kn">format</span> <span class="s2">&quot;x  +?  y&quot;</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Reserved Notation</span> <span class="s2">&quot;x *? y&quot;</span> (<span class="kn">at level</span> <span class="mi">50</span>, <span class="kn">format</span> <span class="s2">&quot;x  *?  y&quot;</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Reserved Notation</span> <span class="s2">&quot;&#39;\bar&#39; x&quot;</span> (<span class="kn">at level</span> <span class="mi">2</span>, <span class="kn">format</span> <span class="s2">&quot;&#39;\bar&#39;  x&quot;</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Reserved Notation</span> <span class="s2">&quot;{ &#39;posnum&#39; &#39;\bar&#39; R }&quot;</span> (<span class="kn">at level</span> <span class="mi">0</span>,
  <span class="kn">format</span> <span class="s2">&quot;{ &#39;posnum&#39;  &#39;\bar&#39;  R }&quot;</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Reserved Notation</span> <span class="s2">&quot;{ &#39;nonneg&#39; &#39;\bar&#39; R }&quot;</span> (<span class="kn">at level</span> <span class="mi">0</span>,
  <span class="kn">format</span> <span class="s2">&quot;{ &#39;nonneg&#39;  &#39;\bar&#39;  R }&quot;</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Declare Scope</span> ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Declare Scope</span> ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Order.TTheory GRing.Theory Num.Theory.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> ring_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variant</span> <span class="nf">extended</span> (<span class="nv">R</span> : <span class="kt">Type</span>) := EFin of R | EPInf | ENInf.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> EFin {R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">EFin_inj</span> <span class="nv">T</span> : injective (@EFin T).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">injective EFin</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; a b; <span class="nb">case</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">dual_extended</span> := extended.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* Notations in ereal_dual_scope should be kept *before* the</span>
<span class="c">   corresponding notation in ereal_scope, otherwise when none of the</span>
<span class="c">   scope is open (lte x y) would be displayed as (x &lt; y)%dE, instead</span>
<span class="c">   of (x &lt; y)%E, for instance. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;+oo&quot;</span> := (@EPInf _ : dual_extended _) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;+oo&quot;</span> := (@EPInf _) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;-oo&quot;</span> := (@ENInf _ : dual_extended _) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;-oo&quot;</span> := (@ENInf _) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;r %:E&quot;</span> := (@EFin _ r%R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;&#39;\bar&#39; R&quot;</span> := (extended R) : type_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;0&quot;</span> := (<span class="mi">0</span>%R%:E : dual_extended _) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;0&quot;</span> := (<span class="mi">0</span>%R%:E) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;1&quot;</span> := (<span class="mi">1</span>%R%:E : dual_extended _) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;1&quot;</span> := (<span class="mi">1</span>%R%:E) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">Bind    Scope ereal_dual_scope <span class="kr">with</span> dual_extended.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">Bind    Scope ereal_scope <span class="kr">with</span> extended.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Delimit Scope</span> ereal_dual_scope <span class="kr">with</span> dE.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Delimit Scope</span> ereal_scope <span class="kr">with</span> E.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">er_map</span> <span class="nv">T</span> <span class="nv">T&#39;</span> (<span class="nv">f</span> : T -&gt; T&#39;) (<span class="nv">x</span> : \bar T) : \bar T&#39; :=
  <span class="kr">match</span> x <span class="kr">with</span>
  | r%:E =&gt; (f r)%:E
  | +oo =&gt; +oo
  | -oo =&gt; -oo
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fine</span> {<span class="nv">R</span> : zmodType} <span class="nv">x</span> : R := <span class="kr">if</span> x <span class="kr">is</span> EFin v <span class="kr">then</span> v <span class="kr">else</span> <span class="mi">0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">EqEReal</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> (<span class="nv">R</span> : eqType).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">eq_ereal</span> (<span class="nv">x</span> <span class="nv">y</span> : \bar R) :=
  <span class="kr">match</span> x, y <span class="kr">with</span>
    | x%:E, y%:E =&gt; x == y
    | +oo, +oo =&gt; true
    | -oo, -oo =&gt; true
    | _, _ =&gt; false
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ereal_eqP</span> : Equality.axiom eq_ereal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>eqType</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Equality.axiom eq_ereal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>=&gt; [?||][?||]; <span class="nb">apply</span>: (iffP idP) =&gt; //= [/eqP|[]] -&gt;.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ereal_eqMixin</span> := Equality.Mixin ereal_eqP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">ereal_eqType</span> := Equality.Pack ereal_eqMixin.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eqe</span> (<span class="nv">r1</span> <span class="nv">r2</span> : R) : (r1%:E == r2%:E) = (r1 == r2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>d</q><br><span><var>r1, r2</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(r1%:E == r2%:E) = (r1 == r2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>11</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">EqEReal</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">ERealChoice</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> (<span class="nv">R</span> : choiceType).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">code</span> (<span class="nv">x</span> : \bar R) :=
  <span class="kr">match</span> x <span class="kr">with</span>
  | r%:E =&gt; GenTree.Node <span class="mi">0</span> [:: GenTree.Leaf r]
  | +oo =&gt; GenTree.Node <span class="mi">1</span> [::]
  | -oo =&gt; GenTree.Node <span class="mi">2</span> [::]
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">decode</span> (<span class="nv">x</span> : GenTree.tree R) : option (\bar R) :=
  <span class="kr">match</span> x <span class="kr">with</span>
  | GenTree.Node <span class="mi">0</span> [:: GenTree.Leaf r] =&gt; Some r%:E
  | GenTree.Node <span class="mi">1</span> [::] =&gt; Some +oo
  | GenTree.Node <span class="mi">2</span> [::] =&gt; Some -oo
  | _ =&gt; None
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">codeK</span> : pcancel code decode.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>choiceType</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pcancel code decode</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>18</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ereal_choiceMixin</span> := PcanChoiceMixin codeK.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">ereal_choiceType</span>  := ChoiceType (extended R) ereal_choiceMixin.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">ERealChoice</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">ERealCount</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> (<span class="nv">R</span> : countType).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ereal_countMixin</span> := PcanCountMixin (@codeK R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">ereal_countType</span> := CountType (extended R) ereal_countMixin.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">ERealCount</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">ERealOrder</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">R</span> : numDomainType}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> <span class="nv">x</span> <span class="nv">y</span> : \bar R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">le_ereal</span> <span class="nv">x1</span> <span class="nv">x2</span> :=
  <span class="kr">match</span> x1, x2 <span class="kr">with</span>
  | -oo, r%:E | r%:E, +oo =&gt; r \<span class="kr">is</span> Num.real
  | r1%:E, r2%:E =&gt; r1 &lt;= r2
  | -oo, _    | _, +oo =&gt; true
  | +oo, _    | _, -oo =&gt; false
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lt_ereal</span> <span class="nv">x1</span> <span class="nv">x2</span> :=
  <span class="kr">match</span> x1, x2 <span class="kr">with</span>
  | -oo, r%:E | r%:E, +oo =&gt; r \<span class="kr">is</span> Num.real
  | r1%:E, r2%:E =&gt; r1 &lt; r2
  | -oo, -oo  | +oo, +oo =&gt; false
  | +oo, _    | _  , -oo =&gt; false
  | -oo, _  =&gt; true
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lt_def_ereal</span> <span class="nv">x</span> <span class="nv">y</span> : lt_ereal x y = (y != x) &amp;&amp; le_ereal x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>numDomainType</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">lt_ereal x y = (y != x) &amp;&amp; le_ereal x y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x y =&gt; [?||][?||] //=; <span class="nb">rewrite</span> lt_def eqe.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_refl_ereal</span> : reflexive le_ereal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">reflexive le_ereal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>27</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span> =&gt; /=.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_anti_ereal</span> : ssrbool.antisymmetric le_ereal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">antisymmetric le_ereal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>=&gt; [?||][?||]/=; <span class="nb">rewrite</span> <span class="nl">?andbF</span> =&gt; // /le_anti -&gt;.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_trans_ereal</span> : ssrbool.transitive le_ereal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">transitive le_ereal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>32</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>=&gt; [?||][?||][?||] //=; <span class="nb">rewrite</span> -<span class="nl">?comparabler0</span>; <span class="kp">first</span> <span class="bp">exact</span>: le_trans.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>_r_, _r1_</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">_r1_ &lt;= _r_ -&gt; _r_ &gt;=&lt; <span class="mi">0</span>%R -&gt; _r1_ &gt;=&lt; <span class="mi">0</span>%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>39</q><label class="goal-separator"><hr></label><div class="goal-conclusion">_r_ &gt;=&lt; <span class="mi">0</span>%R -&gt; _r_ &lt;= _r1_ -&gt; _r1_ &gt;=&lt; <span class="mi">0</span>%R</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /le_comparable cmp /(comparabler_trans cmp).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>39</q><span class="goal-separator"><hr></span><q>3e</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; cmp /ge_comparable /comparabler_trans; <span class="nb">apply</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Fact</span> <span class="nf">ereal_display</span> : unit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">unit</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>43</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ereal_porderMixin</span> :=
  LePOrderMixin lt_def_ereal le_refl_ereal le_anti_ereal le_trans_ereal.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">ereal_porderType</span> :=
  POrderType ereal_display (extended R) ereal_porderMixin.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">leEereal</span> <span class="nv">x</span> <span class="nv">y</span> : (x &lt;= y)%O = le_ereal x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt;= y)%O = le_ereal x y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>48</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ltEereal</span> <span class="nv">x</span> <span class="nv">y</span> : (x &lt; y)%O = lt_ereal x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt; y)%O = lt_ereal x y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">ERealOrder</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="nf">lee</span> := (@Order.le ereal_display _) (<span class="kn">only parsing</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;@ &#39;lee&#39; R&quot;</span> :=
  (@Order.le ereal_display R) (<span class="kn">at level</span> <span class="mi">10</span>, R <span class="kn">at level</span> <span class="mi">8</span>, <span class="kn">only parsing</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="nf">lte</span> := (@Order.lt ereal_display _) (<span class="kn">only parsing</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;@ &#39;lte&#39; R&quot;</span> :=
  (@Order.lt ereal_display R) (<span class="kn">at level</span> <span class="mi">10</span>, R <span class="kn">at level</span> <span class="mi">8</span>, <span class="kn">only parsing</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="nf">gee</span> := (@Order.ge ereal_display _) (<span class="kn">only parsing</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;@ &#39;gee&#39; R&quot;</span> :=
  (@Order.ge ereal_display R) (<span class="kn">at level</span> <span class="mi">10</span>, R <span class="kn">at level</span> <span class="mi">8</span>, <span class="kn">only parsing</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="nf">gte</span> := (@Order.gt ereal_display _) (<span class="kn">only parsing</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;@ &#39;gte&#39; R&quot;</span> :=
  (@Order.gt ereal_display R) (<span class="kn">at level</span> <span class="mi">10</span>, R <span class="kn">at level</span> <span class="mi">8</span>, <span class="kn">only parsing</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y&quot;</span> := (lee x y) (<span class="kn">only printing</span>) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y&quot;</span> := (lee x y) (<span class="kn">only printing</span>) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y&quot;</span>  := (lte x y) (<span class="kn">only printing</span>) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y&quot;</span>  := (lte x y) (<span class="kn">only printing</span>) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y &lt;= z&quot;</span> := ((lee x y) &amp;&amp; (lee y z)) (<span class="kn">only printing</span>) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y &lt;= z&quot;</span> := ((lee x y) &amp;&amp; (lee y z)) (<span class="kn">only printing</span>) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y &lt;= z&quot;</span>  := ((lte x y) &amp;&amp; (lee y z)) (<span class="kn">only printing</span>) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y &lt;= z&quot;</span>  := ((lte x y) &amp;&amp; (lee y z)) (<span class="kn">only printing</span>) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y &lt; z&quot;</span>  := ((lee x y) &amp;&amp; (lte y z)) (<span class="kn">only printing</span>) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y &lt; z&quot;</span>  := ((lee x y) &amp;&amp; (lte y z)) (<span class="kn">only printing</span>) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y &lt; z&quot;</span>   := ((lte x y) &amp;&amp; (lte y z)) (<span class="kn">only printing</span>) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y &lt; z&quot;</span>   := ((lte x y) &amp;&amp; (lte y z)) (<span class="kn">only printing</span>) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y&quot;</span> := (lee (x%dE : dual_extended _) (y%dE : dual_extended _)) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y&quot;</span> := (lee (x : extended _) (y : extended _)) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y&quot;</span>  := (lte (x%dE : dual_extended _) (y%dE : dual_extended _)) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y&quot;</span>  := (lte (x : extended _) (y : extended _)) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &gt;= y&quot;</span> := (y &lt;= x) (<span class="kn">only parsing</span>) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &gt;= y&quot;</span> := (y &lt;= x) (<span class="kn">only parsing</span>) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &gt; y&quot;</span>  := (y &lt; x) (<span class="kn">only parsing</span>) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &gt; y&quot;</span>  := (y &lt; x) (<span class="kn">only parsing</span>) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y &lt;= z&quot;</span> := ((x &lt;= y) &amp;&amp; (y &lt;= z)) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y &lt;= z&quot;</span> := ((x &lt;= y) &amp;&amp; (y &lt;= z)) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y &lt;= z&quot;</span>  := ((x &lt; y) &amp;&amp; (y &lt;= z)) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y &lt;= z&quot;</span>  := ((x &lt; y) &amp;&amp; (y &lt;= z)) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y &lt; z&quot;</span>  := ((x &lt;= y) &amp;&amp; (y &lt; z)) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y &lt; z&quot;</span>  := ((x &lt;= y) &amp;&amp; (y &lt; z)) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y &lt; z&quot;</span>   := ((x &lt; y) &amp;&amp; (y &lt; z)) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y &lt; z&quot;</span>   := ((x &lt; y) &amp;&amp; (y &lt; z)) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y :&gt; T&quot;</span> := ((x : T) &lt;= (y : T)) (<span class="kn">only parsing</span>) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y :&gt; T&quot;</span> := ((x : T) &lt; (y : T)) (<span class="kn">only parsing</span>) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">ERealOrder_numDomainType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">R</span> : numDomainType}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> (<span class="nv">x</span> <span class="nv">y</span> : \bar R) (<span class="nv">r</span> : R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_fin</span> (<span class="nv">r</span> <span class="nv">s</span> : R) : (r%:E &lt;= s%:E) = (r &lt;= s)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>r, s</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(r%:E &lt;= s%:E) = (r &lt;= s)%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>52</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_fin</span> (<span class="nv">r</span> <span class="nv">s</span> : R) : (r%:E &lt; s%:E) = (r &lt; s)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>54</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r%:E &lt; s%:E) = (r &lt; s)%R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>59</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee01</span> : <span class="mi">0</span> &lt;= <span class="mi">1</span> :&gt; \bar R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> : \bar R) &lt;= (<span class="mi">1</span> : \bar R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lee_fin.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte01</span> : <span class="mi">0</span> &lt; <span class="mi">1</span> :&gt; \bar R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> : \bar R) &lt; (<span class="mi">1</span> : \bar R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>63</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lte_fin.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">leeNy_eq</span> <span class="nv">x</span> : (x &lt;= -oo) = (x == -oo).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>x</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt;= -oo) = (x == -oo)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>68</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">leye_eq</span> <span class="nv">x</span> : (+oo &lt;= x) = (x == +oo).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(+oo &lt;= x) = (x == +oo)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>6f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lt0y</span> : (<span class="mi">0</span> : \bar R) &lt; +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> : \bar R) &lt; +oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>74</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: real0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ltNy0</span> : -oo &lt; (<span class="mi">0</span> : \bar R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">-oo &lt; (<span class="mi">0</span> : \bar R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>79</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: real0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le0y</span> : (<span class="mi">0</span> : \bar R) &lt;= +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> : \bar R) &lt;= +oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>7e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: real0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">leNy0</span> : -oo &lt;= (<span class="mi">0</span> : \bar R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">-oo &lt;= (<span class="mi">0</span> : \bar R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>83</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: real0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lt0e</span> <span class="nv">x</span> : (<span class="mi">0</span> &lt; x) = (x != <span class="mi">0</span>) &amp;&amp; (<span class="mi">0</span> &lt;= x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; x) = (x != <span class="mi">0</span>) &amp;&amp; (<span class="mi">0</span> &lt;= x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>88</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; [r| |]//; <span class="nb">rewrite</span> lte_fin lee_fin lt0r.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ereal_comparable</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="mi">0</span>%E &gt;=&lt; x)%O -&gt; (<span class="mi">0</span>%E &gt;=&lt; y)%O -&gt; (x &gt;=&lt; y)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span>%E &gt;=&lt; x)%O -&gt; (<span class="mi">0</span>%E &gt;=&lt; y)%O -&gt; (x &gt;=&lt; y)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x||] [y||] //; <span class="nb">rewrite</span> /Order.comparable !lee_fin -!realE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> Num.real -&gt;
y \<span class="kr">is</span> Num.real -&gt; (x &lt;= y)%R || (y &lt;= x)%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>x</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">x \<span class="kr">is</span> Num.real -&gt;
(<span class="mi">0</span> &lt;= +oo) || (+oo &lt;= <span class="mi">0</span>) -&gt;
(x%:E &lt;= +oo) || (+oo &lt;= x%:E)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>y</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt;= -oo) || (-oo &lt;= <span class="mi">0</span>) -&gt;
y \<span class="kr">is</span> Num.real -&gt; (-oo &lt;= y%:E) || (y%:E &lt;= -oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>92</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">exact</span>: real_comparable.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>99</q><span class="goal-separator"><hr></span><q>9b</q></blockquote><div class="alectryon-extra-goals"><q>9c</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>a2</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /lee/= =&gt; -&gt;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9d</q><span class="goal-separator"><hr></span><q>9f</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>a7</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /lee/= =&gt; _ -&gt;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">real_ltry</span> <span class="nv">r</span> : r%:E &lt; +oo = (r \<span class="kr">is</span> Num.real).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(r%:E &lt; +oo) = (r \<span class="kr">is</span> Num.real)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ab</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">real_ltNyr</span> <span class="nv">r</span> : -oo &lt; r%:E = (r \<span class="kr">is</span> Num.real).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ad</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(-oo &lt; r%:E) = (r \<span class="kr">is</span> Num.real)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b2</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">real_leey</span> <span class="nv">x</span> : (x &lt;= +oo) = (fine x \<span class="kr">is</span> Num.real).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt;= +oo) = (fine x \<span class="kr">is</span> Num.real)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b7</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; //=; <span class="nb">rewrite</span> real0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">real_leNye</span> <span class="nv">x</span> : (-oo &lt;= x) = (fine x \<span class="kr">is</span> Num.real).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(-oo &lt;= x) = (fine x \<span class="kr">is</span> Num.real)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>bc</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; //=; <span class="nb">rewrite</span> real0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gee0P</span> <span class="nv">x</span> : <span class="mi">0</span> &lt;= x &lt;-&gt; x = +oo \/ <span class="kr">exists2</span> r, (r &gt;= <span class="mi">0</span>)%R &amp; x = r%:E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x &lt;-&gt;
x = +oo \/ (<span class="kr">exists2</span> r : R, (<span class="mi">0</span> &lt;= r)%R &amp; x = r%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>c1</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">split</span>=&gt; [|[-&gt;|[r r0 -&gt;//]]]; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> real_leey/=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt;
x = +oo \/ (<span class="kr">exists2</span> r : R, (<span class="mi">0</span> &lt;= r)%R &amp; x = r%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; [r r0 | _ |//]; [<span class="nb">right</span>; <span class="kr">exists</span> <span class="nv">r</span>|<span class="nb">left</span>].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">ERealOrder_numDomainType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Hint Resolve</span> lee01 lte01 : core.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">ERealOrder_realDomainType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">R</span> : realDomainType}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> (<span class="nv">x</span> <span class="nv">y</span> : \bar R) (<span class="nv">r</span> : R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ltry</span> <span class="nv">r</span> : r%:E &lt; +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>realDomainType</span></span></span><br><q>ae</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r%:E &lt; +oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ca</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: num_real.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ltey</span> <span class="nv">x</span> : (x &lt; +oo) = (x != +oo).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6b</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt; +oo) = (x != +oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>d1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; // r; <span class="nb">rewrite</span> ltry.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ltNyr</span> <span class="nv">r</span> : -oo &lt; r%:E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>cc</q><span class="goal-separator"><hr></span><div class="goal-conclusion">-oo &lt; r%:E</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>d7</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: num_real.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ltNye</span> <span class="nv">x</span> : (-oo &lt; x) = (x != -oo).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(-oo &lt; x) = (x != -oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>dc</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; // r; <span class="nb">rewrite</span> ltNyr.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">leey</span> <span class="nv">x</span> : x &lt;= +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= +oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; //= r; <span class="bp">exact</span>: num_real.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">leNye</span> <span class="nv">x</span> : -oo &lt;= x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">-oo &lt;= x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e6</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; //= r; <span class="bp">exact</span>: num_real.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lteey</span> := (ltey, leey).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lteNye</span> := (ltNye, leNye).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_total_ereal</span> : totalPOrderMixin [porderType of \bar R].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">totalPOrderMixin [porderType of \bar R]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>eb</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; [?||][?||]//=; <span class="nb">rewrite</span> (ltEereal, leEereal)/= <span class="nl">?num_real</span> <span class="nl">?le_total</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">ereal_latticeType</span> := LatticeType (extended R) le_total_ereal.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">ereal_distrLatticeType</span> :=  DistrLatticeType (extended R) le_total_ereal.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">ereal_orderType</span> := OrderType (extended R) le_total_ereal.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">ERealOrder_realDomainType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">ERealArith</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">R</span> : numDomainType}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : \bar R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">adde_subdef</span> <span class="nv">x</span> <span class="nv">y</span> :=
  <span class="kr">match</span> x, y <span class="kr">with</span>
  | x%:E , y%:E  =&gt; (x + y)%:E
  | -oo, _     =&gt; -oo
  | _    , -oo =&gt; -oo
  | +oo, _     =&gt; +oo
  | _    , +oo =&gt; +oo
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">adde</span> := nosimpl adde_subdef.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">dual_adde_subdef</span> <span class="nv">x</span> <span class="nv">y</span> :=
  <span class="kr">match</span> x, y <span class="kr">with</span>
  | x%:E , y%:E  =&gt; (x + y)%R%:E
  | +oo, _     =&gt; +oo
  | _    , +oo =&gt; +oo
  | -oo, _     =&gt; -oo
  | _    , -oo =&gt; -oo
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">dual_adde</span> := nosimpl dual_adde_subdef.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">oppe</span> <span class="nv">x</span> :=
  <span class="kr">match</span> x <span class="kr">with</span>
  | r%:E  =&gt; (- r)%:E
  | -oo =&gt; +oo
  | +oo =&gt; -oo
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">mule_subdef</span> <span class="nv">x</span> <span class="nv">y</span> :=
  <span class="kr">match</span> x, y <span class="kr">with</span>
  | x%:E , y%:E =&gt; (x * y)%:E
  | -oo, y | y, -oo =&gt; <span class="kr">if</span> y == <span class="mi">0</span> <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; y <span class="kr">then</span> -oo <span class="kr">else</span> +oo
  | +oo, y | y, +oo =&gt; <span class="kr">if</span> y == <span class="mi">0</span> <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; y <span class="kr">then</span> +oo <span class="kr">else</span> -oo
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">mule</span> := nosimpl mule_subdef.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">abse</span> <span class="nv">x</span> := <span class="kr">if</span> x <span class="kr">is</span> r%:E <span class="kr">then</span> `|r|%:E <span class="kr">else</span> +oo.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">expe</span> <span class="nv">x</span> <span class="nv">n</span> := iterop n mule x <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">enatmul</span> <span class="nv">x</span> <span class="nv">n</span> := iterop n adde x <span class="mi">0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ednatmul</span> <span class="nv">x</span> <span class="nv">n</span> := iterop n dual_adde x <span class="mi">0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">ERealArith</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;+%dE&quot;</span>   := dual_adde.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;+%E&quot;</span>   := adde.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;-%E&quot;</span>   := oppe.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x + y&quot;</span> := (dual_adde x%dE y%dE) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x + y&quot;</span> := (adde x y) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x - y&quot;</span> := (dual_adde x%dE (oppe y%dE)) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x - y&quot;</span> := (adde x (oppe y)) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;- x&quot;</span>   := (oppe (x%dE : dual_extended _)) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;- x&quot;</span>   := (oppe x) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;*%E&quot;</span>   := mule.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x * y&quot;</span> := (mule (x%dE : dual_extended _) (y%dE : dual_extended _)) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x * y&quot;</span> := (mule x y) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;`| x |&quot;</span> := (abse (x%dE : dual_extended _)) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;`| x |&quot;</span> := (abse x) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> abse {R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x ^+ n&quot;</span> := (expe x%dE n) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x ^+ n&quot;</span> := (expe x n) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x *+ n&quot;</span> := (ednatmul x%dE n) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x *+ n&quot;</span> := (enatmul x n) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\- f&quot;</span> := (<span class="kr">fun</span> <span class="nv">x</span> =&gt; - f x)%dE : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\- f&quot;</span> := (<span class="kr">fun</span> <span class="nv">x</span> =&gt; - f x)%E : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;f \+ g&quot;</span> := (<span class="kr">fun</span> <span class="nv">x</span> =&gt; f x + g x)%dE : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;f \+ g&quot;</span> := (<span class="kr">fun</span> <span class="nv">x</span> =&gt; f x + g x)%E : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;f \* g&quot;</span> := (<span class="kr">fun</span> <span class="nv">x</span> =&gt; f x * g x)%dE : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;f \* g&quot;</span> := (<span class="kr">fun</span> <span class="nv">x</span> =&gt; f x * g x)%E : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;f \- g&quot;</span> := (<span class="kr">fun</span> <span class="nv">x</span> =&gt; f x - g x)%dE : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;f \- g&quot;</span> := (<span class="kr">fun</span> <span class="nv">x</span> =&gt; f x - g x)%E : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i &lt;- r | P ) F&quot;</span> :=
  (\big[+%dE/<span class="mi">0</span>%:E]_(i &lt;- r | P%B) F%dE) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i &lt;- r | P ) F&quot;</span> :=
  (\big[+%E/<span class="mi">0</span>%:E]_(i &lt;- r | P%B) F%E) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i &lt;- r ) F&quot;</span> :=
  (\big[+%dE/<span class="mi">0</span>%:E]_(i &lt;- r) F%dE) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i &lt;- r ) F&quot;</span> :=
  (\big[+%E/<span class="mi">0</span>%:E]_(i &lt;- r) F%E) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( m &lt;= i &lt; n | P ) F&quot;</span> :=
  (\big[+%dE/<span class="mi">0</span>%:E]_(m &lt;= i &lt; n | P%B) F%dE) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( m &lt;= i &lt; n | P ) F&quot;</span> :=
  (\big[+%E/<span class="mi">0</span>%:E]_(m &lt;= i &lt; n | P%B) F%E) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( m &lt;= i &lt; n ) F&quot;</span> :=
  (\big[+%dE/<span class="mi">0</span>%:E]_(m &lt;= i &lt; n) F%dE) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( m &lt;= i &lt; n ) F&quot;</span> :=
  (\big[+%E/<span class="mi">0</span>%:E]_(m &lt;= i &lt; n) F%E) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i | P ) F&quot;</span> :=
  (\big[+%dE/<span class="mi">0</span>%:E]_(i | P%B) F%dE) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i | P ) F&quot;</span> :=
  (\big[+%E/<span class="mi">0</span>%:E]_(i | P%B) F%E) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ i F&quot;</span> :=
  (\big[+%dE/<span class="mi">0</span>%:E]_i F%dE) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ i F&quot;</span> :=
  (\big[+%E/<span class="mi">0</span>%:E]_i F%E) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i : t | P ) F&quot;</span> :=
  (\big[+%dE/<span class="mi">0</span>%:E]_(i : t | P%B) F%dE) (<span class="kn">only parsing</span>) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i : t | P ) F&quot;</span> :=
  (\big[+%E/<span class="mi">0</span>%:E]_(i : t | P%B) F%E) (<span class="kn">only parsing</span>) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i : t ) F&quot;</span> :=
  (\big[+%dE/<span class="mi">0</span>%:E]_(i : t) F%dE) (<span class="kn">only parsing</span>) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i : t ) F&quot;</span> :=
  (\big[+%E/<span class="mi">0</span>%:E]_(i : t) F%E) (<span class="kn">only parsing</span>) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i &lt; n | P ) F&quot;</span> :=
  (\big[+%dE/<span class="mi">0</span>%:E]_(i &lt; n | P%B) F%dE) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i &lt; n | P ) F&quot;</span> :=
  (\big[+%E/<span class="mi">0</span>%:E]_(i &lt; n | P%B) F%E) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i &lt; n ) F&quot;</span> :=
  (\big[+%dE/<span class="mi">0</span>%:E]_(i &lt; n) F%dE) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i &lt; n ) F&quot;</span> :=
  (\big[+%E/<span class="mi">0</span>%:E]_(i &lt; n) F%E) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i &#39;in&#39; A | P ) F&quot;</span> :=
  (\big[+%dE/<span class="mi">0</span>%:E]_(i <span class="kr">in</span> A | P%B) F%dE) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i &#39;in&#39; A | P ) F&quot;</span> :=
  (\big[+%E/<span class="mi">0</span>%:E]_(i <span class="kr">in</span> A | P%B) F%E) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i &#39;in&#39; A ) F&quot;</span> :=
  (\big[+%dE/<span class="mi">0</span>%:E]_(i <span class="kr">in</span> A) F%dE) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\sum_ ( i &#39;in&#39; A ) F&quot;</span> :=
  (\big[+%E/<span class="mi">0</span>%:E]_(i <span class="kr">in</span> A) F%E) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">ERealOrderTheory</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">R</span> : numDomainType}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : \bar R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Tactic Notation</span> <span class="s2">&quot;elift&quot;</span> <span class="kp">constr</span>(lm) <span class="s2">&quot;:&quot;</span> <span class="kn">ident</span>(x) :=
  <span class="bp">by</span> <span class="nb">case</span>: x =&gt; [||?]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> <span class="nl">?eqe</span>; <span class="nb">apply</span>: lm.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Tactic Notation</span> <span class="s2">&quot;elift&quot;</span> <span class="kp">constr</span>(lm) <span class="s2">&quot;:&quot;</span> <span class="kn">ident</span>(x) <span class="kn">ident</span>(y) :=
  <span class="bp">by</span> <span class="nb">case</span>: x y =&gt; [?||] [?||]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> <span class="nl">?eqe</span>; <span class="nb">apply</span>: lm.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Tactic Notation</span> <span class="s2">&quot;elift&quot;</span> <span class="kp">constr</span>(lm) <span class="s2">&quot;:&quot;</span> <span class="kn">ident</span>(x) <span class="kn">ident</span>(y) <span class="kn">ident</span>(z) :=
  <span class="bp">by</span> <span class="nb">case</span>: x y z =&gt; [?||] [?||] [?||]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> <span class="nl">?eqe</span>; <span class="nb">apply</span>: lm.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee0N1</span> : <span class="mi">0</span> &lt;= (-<span class="mi">1</span>)%:E :&gt; \bar R = false.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="mi">0</span> : \bar R) &lt;= ((-<span class="mi">1</span>)%:E : \bar R)) = false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>f1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lee_fin ler0N1.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte0N1</span> : <span class="mi">0</span> &lt; (-<span class="mi">1</span>)%:E :&gt; \bar R = false.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="mi">0</span> : \bar R) &lt; ((-<span class="mi">1</span>)%:E : \bar R)) = false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>f6</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lte_fin ltr0N1.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lteN10</span> : - <span class="mi">1</span>%E &lt; <span class="mi">0</span> :&gt; \bar R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- (<span class="mi">1</span>) : \bar R) &lt; (<span class="mi">0</span> : \bar R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>fb</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lte_fin ltrN10.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">leeN10</span> : - <span class="mi">1</span>%E &lt;= <span class="mi">0</span> :&gt; \bar R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- (<span class="mi">1</span>) : \bar R) &lt;= (<span class="mi">0</span> : \bar R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>100</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lee_fin lerN10.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fine_ge0</span> <span class="nv">x</span> : <span class="mi">0</span> &lt;= x -&gt; (<span class="mi">0</span> &lt;= fine x)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; (<span class="mi">0</span> &lt;= fine x)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>105</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fine_gt0</span> <span class="nv">x</span> : <span class="mi">0</span> &lt; x &lt; +oo -&gt; (<span class="mi">0</span> &lt; fine x)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x &lt; +oo -&gt; (<span class="mi">0</span> &lt; fine x)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>10a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [x| |] //=; <span class="nb">rewrite</span> <span class="nl">?ltxx</span> <span class="nl">?andbF</span>// lte_fin =&gt; /andP[].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fine_lt0</span> <span class="nv">x</span> : -oo &lt; x &lt; <span class="mi">0</span> -&gt; (fine x &lt; <span class="mi">0</span>)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">-oo &lt; x &lt; <span class="mi">0</span> -&gt; (fine x &lt; <span class="mi">0</span>)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>10f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [x| |] //= /andP[_]; <span class="nb">rewrite</span> lte_fin.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fine_le0</span> <span class="nv">x</span> : x &lt;= <span class="mi">0</span> -&gt; (fine x &lt;= <span class="mi">0</span>)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= <span class="mi">0</span> -&gt; (fine x &lt;= <span class="mi">0</span>)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>114</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_tofin</span> (<span class="nv">r0</span> <span class="nv">r1</span> : R) : (r0 &lt;= r1)%R -&gt; r0%:E &lt;= r1%:E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>r0, r1</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(r0 &lt;= r1)%R -&gt; r0%:E &lt;= r1%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>119</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_tofin</span> (<span class="nv">r0</span> <span class="nv">r1</span> : R) : (r0 &lt; r1)%R -&gt; r0%:E &lt; r1%:E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>11b</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r0 &lt; r1)%R -&gt; r0%:E &lt; r1%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>120</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">enatmul_pinfty</span> <span class="nv">n</span> : +oo *+ n.+<span class="mi">1</span> = +oo :&gt; \bar R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">+oo *+ n.+<span class="mi">1</span> = +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>125</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">elim</span>: n =&gt; //= n -&gt;.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">enatmul_ninfty</span> <span class="nv">n</span> : -oo *+ n.+<span class="mi">1</span> = -oo :&gt; \bar R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>127</q><span class="goal-separator"><hr></span><div class="goal-conclusion">-oo *+ n.+<span class="mi">1</span> = -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>12c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">elim</span>: n =&gt; //= n -&gt;.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">EFin_natmul</span> (<span class="nv">r</span> : R) <span class="nv">n</span> : (r *+ n.+<span class="mi">1</span>)%:E = r%:E *+ n.+<span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>ae</q><br><q>128</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(r *+ n.+<span class="mi">1</span>)%:E = r%:E *+ n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>131</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">elim</span>: n =&gt; //= n &lt;-.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule2n</span> <span class="nv">x</span> : x *+ <span class="mi">2</span> = x + x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x *+ <span class="mi">2</span> = x + x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>137</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">expe2</span> <span class="nv">x</span> : x ^+ <span class="mi">2</span> = x * x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x ^+ <span class="mi">2</span> = x * x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>13c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">ERealOrderTheory</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Hint Resolve</span> leeN10 lteN10 : core.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">finNumPred</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">R</span> : numDomainType}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Type</span> (x : \bar R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fin_num</span> := [qualify a x : \bar R | (x != -oo) &amp;&amp; (x != +oo)].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Fact</span> <span class="nf">fin_num_key</span> : pred_key fin_num.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">pred_key fin_num</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">fin_num_keyd</span> := KeyedQualifier fin_num_key.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_numE</span> <span class="nv">x</span> : (x \<span class="kr">is</span> a fin_num) = (x != -oo) &amp;&amp; (x != +oo).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x \<span class="kr">is</span> a fin_num) = (x != -oo) &amp;&amp; (x != +oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>145</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_numP</span> <span class="nv">x</span> : reflect ((x != -oo) /\ (x != +oo)) (x \<span class="kr">is</span> a fin_num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect (x != -oo /\ x != +oo) (x \<span class="kr">is</span> a fin_num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>14a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/(iffP idP) =&gt; [/andP//|/andP].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_numEn</span> <span class="nv">x</span> : (x \<span class="kr">isn&#39;t</span> a fin_num) = (x == -oo) || (x == +oo).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x \<span class="kr">isn&#39;t</span> a fin_num) = (x == -oo) || (x == +oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>14f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> fin_numE negb_and <span class="nl">?negbK</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_numPn</span> <span class="nv">x</span> : reflect (x = -oo \/ x = +oo) (x \<span class="kr">isn&#39;t</span> a fin_num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect (x = -oo \/ x = +oo) (x \<span class="kr">isn&#39;t</span> a fin_num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>154</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> fin_numEn; <span class="nb">apply</span>: (iffP orP) =&gt; -[]/eqP; <span class="bp">by</span> [<span class="nb">left</span>|<span class="nb">right</span>].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_real</span> <span class="nv">x</span> : -oo &lt; x &lt; +oo -&gt; x \<span class="kr">is</span> a fin_num.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">-oo &lt; x &lt; +oo -&gt; x \<span class="kr">is</span> a fin_num</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>159</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /andP[oox xoo]; <span class="nb">rewrite</span> fin_numE gt_eqF <span class="nl">?lt_eqF</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_num_abs</span> <span class="nv">x</span> : (x \<span class="kr">is</span> a fin_num) = (`| x | &lt; +oo)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x \<span class="kr">is</span> a fin_num) = (`|x| &lt; +oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>15e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> fin_numE; <span class="nb">case</span>: x =&gt; // r; <span class="nb">rewrite</span> real_ltry normr_real.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">finNumPred</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">ERealArithTh_numDomainType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">R</span> : numDomainType}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : \bar R) (<span class="nv">r</span> : R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fine_le</span> : {<span class="kr">in</span> fin_num &amp;, {homo @fine R : x y / x &lt;= y &gt;-&gt; (x &lt;= y)%R}}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> fin_num &amp;,
  {homo fine : x y / x &lt;= y &gt;-&gt; (x &lt;= y)%R}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>163</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; [? [?| |]| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fine_lt</span> : {<span class="kr">in</span> fin_num &amp;, {homo @fine R : x y / x &lt; y &gt;-&gt; (x &lt; y)%R}}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> fin_num &amp;,
  {homo fine : x y / x &lt; y &gt;-&gt; (x &lt; y)%R}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>168</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; [? [?| |]| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fine_abse</span> : {<span class="kr">in</span> fin_num, {morph @fine R : x / `|x| &gt;-&gt; `|x|%R}}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> fin_num, {morph fine : x / `|x| &gt;-&gt; `|x|%R}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>16d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">abse_fin_num</span> <span class="nv">x</span> : (`|x| \<span class="kr">is</span> a fin_num) = (x \<span class="kr">is</span> a fin_num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(`|x| \<span class="kr">is</span> a fin_num) = (x \<span class="kr">is</span> a fin_num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>172</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fine_eq0</span> <span class="nv">x</span> : x \<span class="kr">is</span> a fin_num -&gt; (fine x == <span class="mi">0</span>%R) = (x == <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (fine x == <span class="mi">0</span>%R) = (x == <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>177</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [//| |] /=; <span class="nb">rewrite</span> fin_numE.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">EFinN</span> <span class="nv">r</span> : (- r)%:E = (- r%:E).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ad</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- r)%:E = - r%:E</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>17c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fineN</span> <span class="nv">x</span> : fine (- x) = (- fine x)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">fine (- x) = (- fine x)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>181</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; //=; <span class="nb">rewrite</span> oppr0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">EFinD</span> <span class="nv">r</span> <span class="nv">r&#39;</span> : (r + r&#39;)%:E = r%:E + r&#39;%:E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>r, r'</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(r + r&#39;)%:E = r%:E + r&#39;%:E</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>186</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">EFinB</span> <span class="nv">r</span> <span class="nv">r&#39;</span> : (r - r&#39;)%:E = r%:E - r&#39;%:E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>188</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r - r&#39;)%:E = r%:E - r&#39;%:E</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>18d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">EFinM</span> <span class="nv">r</span> <span class="nv">r&#39;</span> : (r * r&#39;)%:E = r%:E * r&#39;%:E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>188</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r * r&#39;)%:E = r%:E * r&#39;%:E</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>192</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sumEFin</span> <span class="nv">I</span> <span class="nv">s</span> <span class="nv">P</span> (<span class="nv">F</span> : I -&gt; R) :
  \sum_(i &lt;- s | P i) (F i)%:E = (\sum_(i &lt;- s | P i) F i)%:E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>seq I</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>I -&gt; bool</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>I -&gt; R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt;- s | P i) (F i)%:E =
(\sum_(i &lt;- s | P i) F i)%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>197</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (big_morph _ EFinD erefl).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">adde_def</span> <span class="nv">x</span> <span class="nv">y</span> :=
  ~~ ((x == +oo) &amp;&amp; (y == -oo)) &amp;&amp; ~~ ((x == -oo) &amp;&amp; (y == +oo)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Notation</span> <span class="s2">&quot;x +? y&quot;</span> := (adde_def x y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_defC</span> <span class="nv">x</span> <span class="nv">y</span> : x +? y = y +? x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x +? y = y +? x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1a1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /adde_def andbC (andbC (x == -oo)) (andbC (x == +oo)).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_num_adde_defr</span> <span class="nv">x</span> <span class="nv">y</span> : x \<span class="kr">is</span> a fin_num -&gt; x +? y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; x +? y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1a6</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y | |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_num_adde_defl</span> <span class="nv">x</span> <span class="nv">y</span> : y \<span class="kr">is</span> a fin_num -&gt; x +? y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; x +? y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1ab</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> adde_defC; <span class="bp">exact</span>: fin_num_adde_defr.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_defN</span> <span class="nv">x</span> <span class="nv">y</span> : x +? - y = - x +? y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x +? - y = - x +? y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1b0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_defDr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x +? y -&gt; x +? z -&gt; x +? (y + z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x +? y -&gt; x +? z -&gt; x +? (y + z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1b5</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y z =&gt; [x||] [y||] [z||].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_defEninfty</span> <span class="nv">x</span> : (x +? -oo) = (x != +oo).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x +? -oo = (x != +oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1bc</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ge0_adde_def</span> : {<span class="kr">in</span> [pred x | x &gt;= <span class="mi">0</span>] &amp;, <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, x +? y}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> [pred x | <span class="mi">0</span> &lt;= x] &amp;, <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, x +? y}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1c1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; [x| |] [y| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">addeC</span> : commutative (S := \bar R) +%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">commutative +%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1c6</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>=&gt; [x||] [y||] //; <span class="nb">rewrite</span> /adde /= addrC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde0</span> : right_id (<span class="mi">0</span> : \bar R) +%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">right_id (<span class="mi">0</span> : \bar R) +%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1cb</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>=&gt; // r; <span class="nb">rewrite</span> /adde /= addr0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">add0e</span> : left_id (<span class="mi">0</span> : \bar R) +%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">left_id (<span class="mi">0</span> : \bar R) +%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1d0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x; <span class="nb">rewrite</span> addeC adde0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">addeA</span> : associative (S := \bar R) +%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">associative +%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1d5</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>=&gt; [x||] [y||] [z||] //; <span class="nb">rewrite</span> /adde /= addrA.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">adde_monoid</span> := Monoid.Law addeA add0e adde0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">adde_comoid</span> := Monoid.ComLaw addeC.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_def_sum</span> <span class="nv">I</span> <span class="nv">h</span> <span class="nv">t</span> (<span class="nv">P</span> : pred I) (<span class="nv">f</span> : I -&gt; \bar R) :
    {<span class="kr">in</span> P, <span class="kr">forall</span> <span class="nv">i</span> : I, f h +? f i} -&gt;
  f h +? \sum_(j &lt;- t | P j) f j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>19a</q><br><span><var>h</var><span class="hyp-type"><b>: </b><span>I</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>seq I</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>pred I</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>I -&gt; \bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> P, <span class="kr">forall</span> <span class="nv">i</span> : I, f h +? f i} -&gt;
f h +? \sum_(j &lt;- t | P j) f j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1da</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; fhi; <span class="nb">elim</span>/big_rec : _; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> fin_num_adde_defl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>19a</q><br><q>1dd</q><br><q>1de</q><br><q>1df</q><br><q>1e0</q><br><span><var>fhi</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> P, <span class="kr">forall</span> <span class="nv">i</span> : I, f h +? f i}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> : I) (<span class="nv">x</span> : \bar R),
P i -&gt; f h +? x -&gt; f h +? (f i + x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; i x Pi fhx; <span class="nb">rewrite</span> adde_defDr// fhi.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">addeAC</span> : @right_commutative (\bar R) _ +%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">right_commutative +%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1ea</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: Monoid.mulmAC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">addeCA</span> : @left_commutative (\bar R) _ +%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">left_commutative +%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1ef</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: Monoid.mulmCA.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">addeACA</span> : @interchange (\bar R) +%E +%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">interchange +%E +%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1f4</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: Monoid.mulmACA.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_gt0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt; <span class="mi">0</span> &lt; x + y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt; <span class="mi">0</span> &lt; x + y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1f9</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //; <span class="nb">rewrite</span> !lte_fin; <span class="bp">exact</span>: addr_gt0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">padde_eq0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= x -&gt; <span class="mi">0</span> &lt;= y -&gt; (x + y == <span class="mi">0</span>) = (x == <span class="mi">0</span>) &amp;&amp; (y == <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt;
<span class="mi">0</span> &lt;= y -&gt; (x + y == <span class="mi">0</span>) = (x == <span class="mi">0</span>) &amp;&amp; (y == <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1fe</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x| |] [y| |]//; <span class="nb">rewrite</span> !lee_fin; <span class="kp">first</span> <span class="bp">exact</span>: paddr_eq0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>99</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x)%R -&gt;
<span class="mi">0</span> &lt;= +oo -&gt;
(x%:E + +oo == <span class="mi">0</span>) = (x%:E == <span class="mi">0</span>) &amp;&amp; (+oo == <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x0 _ /=; <span class="nb">rewrite</span> andbF.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">nadde_eq0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt;= <span class="mi">0</span> -&gt; y &lt;= <span class="mi">0</span> -&gt; (x + y == <span class="mi">0</span>) = (x == <span class="mi">0</span>) &amp;&amp; (y == <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= <span class="mi">0</span> -&gt;
y &lt;= <span class="mi">0</span> -&gt; (x + y == <span class="mi">0</span>) = (x == <span class="mi">0</span>) &amp;&amp; (y == <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>207</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x| |] [y| |]//; <span class="nb">rewrite</span> !lee_fin; <span class="kp">first</span> <span class="bp">exact</span>: naddr_eq0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>99</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt;= <span class="mi">0</span>)%R -&gt;
-oo &lt;= <span class="mi">0</span> -&gt;
(x%:E + -oo == <span class="mi">0</span>) = (x%:E == <span class="mi">0</span>) &amp;&amp; (-oo == <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x0 _ /=; <span class="nb">rewrite</span> andbF.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">realDe</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="mi">0</span>%E &gt;=&lt; x)%O -&gt; (<span class="mi">0</span>%E &gt;=&lt; y)%O -&gt; (<span class="mi">0</span>%E &gt;=&lt; x + y)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span>%E &gt;=&lt; x)%O -&gt; (<span class="mi">0</span>%E &gt;=&lt; y)%O -&gt; (<span class="mi">0</span>%E &gt;=&lt; x + y)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>210</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">case</span>: x y =&gt; [x||] [y||] //; <span class="bp">exact</span>: realD.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oppe0</span> : - <span class="mi">0</span> = <span class="mi">0</span> :&gt; \bar R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">- <span class="mi">0</span> = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>215</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /= oppr0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oppeK</span> : involutive (A := \bar R) -%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">involutive -%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>21a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>=&gt; [x||] //=; <span class="nb">rewrite</span> opprK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oppe_inj</span> : @injective (\bar R) _ -%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">injective -%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>21f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: inv_inj oppeK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_defNN</span> <span class="nv">x</span> <span class="nv">y</span> : - x +? - y = x +? y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">- x +? - y = x +? y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>224</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> adde_defN oppeK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oppe_eq0</span> <span class="nv">x</span> : (- x == <span class="mi">0</span>)%E = (x == <span class="mi">0</span>)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- x == <span class="mi">0</span>) = (x == <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>229</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -(can_eq oppeK) oppe0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oppeD</span> <span class="nv">x</span> <span class="nv">y</span> : x +? y -&gt; - (x + y) = - x - y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x +? y -&gt; - (x + y) = - x - y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>22e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //= _; <span class="nb">rewrite</span> opprD.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_num_oppeD</span> <span class="nv">x</span> <span class="nv">y</span> : y \<span class="kr">is</span> a fin_num -&gt; - (x + y) = - x - y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; - (x + y) = - x - y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>233</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; finy; <span class="nb">rewrite</span> oppeD// fin_num_adde_defl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sube0</span> <span class="nv">x</span> : x - <span class="mi">0</span> = x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x - <span class="mi">0</span> = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>238</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [x| |] //; <span class="nb">rewrite</span> -EFinB subr0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub0e</span> <span class="nv">x</span> : <span class="mi">0</span> - x = - x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> - x = - x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>23d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [x| |] //; <span class="nb">rewrite</span> -EFinB sub0r.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">muleC</span> <span class="nv">x</span> <span class="nv">y</span> : x * y = y * x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x * y = y * x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>242</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [r||] [s||]//=; <span class="nb">rewrite</span> -EFinM mulrC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">onee_neq0</span> : <span class="mi">1</span> != <span class="mi">0</span> :&gt; \bar R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> != <span class="mi">0</span> :&gt; \bar R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>247</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: oner_neq0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">onee_eq0</span> : <span class="mi">1</span> == <span class="mi">0</span> :&gt; \bar R = false.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">1</span> == <span class="mi">0</span> :&gt; \bar R) = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>24c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: oner_eq0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule1</span> <span class="nv">x</span> : x * <span class="mi">1</span> = x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x * <span class="mi">1</span> = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>251</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x=&gt; [r||]/=; <span class="nb">rewrite</span> /mule/= <span class="nl">?mulr1</span> ?(negbTE onee_neq0) <span class="nl">?lte_tofin</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mul1e</span> <span class="nv">x</span> : <span class="mi">1</span> * x = x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> * x = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>256</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC mule1.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule0</span> <span class="nv">x</span> : x * <span class="mi">0</span> = <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x * <span class="mi">0</span> = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>25b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [r| |] //=; <span class="nb">rewrite</span> /mule/= <span class="nl">?mulr0</span>// eqxx.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mul0e</span> <span class="nv">x</span> : <span class="mi">0</span> * x = <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> * x = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>260</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [r| |]/=; <span class="nb">rewrite</span> /mule/= <span class="nl">?mul0r</span>// eqxx.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">mule_mulmonoid</span> := @Monoid.MulLaw _ _ mule mul0e mule0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">expeS</span> <span class="nv">x</span> <span class="nv">n</span> : x ^+ n.+<span class="mi">1</span> = x * x ^+ n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>6b</q><br><q>128</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ^+ n.+<span class="mi">1</span> = x * x ^+ n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>265</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: n =&gt; //=; <span class="nb">rewrite</span> mule1.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">mule_def</span> <span class="nv">x</span> <span class="nv">y</span> :=
  ~~ (((x == <span class="mi">0</span>) &amp;&amp; (`| y | == +oo)) || ((y == <span class="mi">0</span>) &amp;&amp; (`| x | == +oo))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Notation</span> <span class="s2">&quot;x *? y&quot;</span> := (mule_def x y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_defC</span> <span class="nv">x</span> <span class="nv">y</span> : x *? y = y *? x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x *? y = y *? x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>26b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> [<span class="kr">in</span> LHS]/mule_def orbC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_def_fin</span> <span class="nv">x</span> <span class="nv">y</span> : x \<span class="kr">is</span> a fin_num -&gt; y \<span class="kr">is</span> a fin_num -&gt; x *? y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; y \<span class="kr">is</span> a fin_num -&gt; x *? y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>270</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x| |] [y| |] finx finy//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>95</q><br><span><var>finx</var><span class="hyp-type"><b>: </b><span>x%:E \<span class="kr">is</span> a fin_num</span></span></span><br><span><var>finy</var><span class="hyp-type"><b>: </b><span>y%:E \<span class="kr">is</span> a fin_num</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x%:E *? y%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /mule_def negb_or <span class="mi">2</span>!negb_and/= <span class="mi">2</span>!orbT.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_def_neq0_infty</span> <span class="nv">x</span> <span class="nv">y</span> : x != <span class="mi">0</span> -&gt; y \<span class="kr">isn&#39;t</span> a fin_num -&gt; x *? y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x != <span class="mi">0</span> -&gt; y \<span class="kr">isn&#39;t</span> a fin_num -&gt; x *? y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>27c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |]// x0 _; <span class="nb">rewrite</span> /mule_def (negbTE x0).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_def_infty_neq0</span> <span class="nv">x</span> <span class="nv">y</span> : x \<span class="kr">isn&#39;t</span> a fin_num -&gt; y!= <span class="mi">0</span> -&gt; x *? y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">isn&#39;t</span> a fin_num -&gt; y != <span class="mi">0</span> -&gt; x *? y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>281</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |]// _ y0; <span class="nb">rewrite</span> /mule_def (negbTE y0).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">neq0_mule_def</span> <span class="nv">x</span> <span class="nv">y</span> :  x * y != <span class="mi">0</span> -&gt; x *? y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x * y != <span class="mi">0</span> -&gt; x *? y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>286</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x| |] [y| |] //; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> mule_def_fin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>99</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x%:E * +oo != <span class="mi">0</span> -&gt; x%:E *? +oo</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>99</q><label class="goal-separator"><hr></label><div class="goal-conclusion">x%:E * -oo != <span class="mi">0</span> -&gt; x%:E *? -oo</div></blockquote><blockquote class="alectryon-goal"><q>9d</q><label class="goal-separator"><hr></label><div class="goal-conclusion">+oo * y%:E != <span class="mi">0</span> -&gt; +oo *? y%:E</div></blockquote><blockquote class="alectryon-goal"><q>9d</q><label class="goal-separator"><hr></label><div class="goal-conclusion">-oo * y%:E != <span class="mi">0</span> -&gt; -oo *? y%:E</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>28b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">have</span> [-&gt;|?] := eqVneq x <span class="mi">0</span>%R; <span class="nb">rewrite</span> <span class="nl">?mul0e</span> <span class="nl">?eqxx</span>// mule_def_neq0_infty.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>99</q><span class="goal-separator"><hr></span><q>290</q></blockquote><div class="alectryon-extra-goals"><q>291</q><q>293</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>297</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">have</span> [-&gt;|?] := eqVneq x <span class="mi">0</span>%R; <span class="nb">rewrite</span> <span class="nl">?mul0e</span> <span class="nl">?eqxx</span>// mule_def_neq0_infty.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9d</q><span class="goal-separator"><hr></span><q>292</q></blockquote><div class="alectryon-extra-goals"><q>293</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>29c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">have</span> [-&gt;|?] := eqVneq y <span class="mi">0</span>%R; <span class="nb">rewrite</span> <span class="nl">?mule0</span> <span class="nl">?eqxx</span>// mule_def_infty_neq0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9d</q><span class="goal-separator"><hr></span><q>294</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>2a1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">have</span> [-&gt;|?] := eqVneq y <span class="mi">0</span>%R; <span class="nb">rewrite</span> <span class="nl">?mule0</span> <span class="nl">?eqxx</span>// mule_def_infty_neq0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ltpinfty_adde_def</span> : {<span class="kr">in</span> [pred x | x &lt; +oo] &amp;, <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, x +? y}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> [pred x | x &lt; +oo] &amp;, <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, x +? y}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2a5</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; [x| |] [y| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ltninfty_adde_def</span> : {<span class="kr">in</span> [pred x | -oo &lt; x] &amp;, <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, x +? y}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> [pred x | -oo &lt; x] &amp;, <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, x +? y}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2aa</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; [x| |] [y| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">abse_eq0</span> <span class="nv">x</span> : (`|x| == <span class="mi">0</span>) = (x == <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(`|x| == <span class="mi">0</span>) = (x == <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2af</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [| |] //= r; <span class="nb">rewrite</span> !eqe normr_eq0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">abse0</span> : `|<span class="mi">0</span>| = <span class="mi">0</span> :&gt; \bar R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">`|<span class="mi">0</span>| = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2b4</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /abse normr0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">abse1</span> : `|<span class="mi">1</span>| = <span class="mi">1</span> :&gt; \bar R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">`|<span class="mi">1</span>| = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2b9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /abse normr1.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">abseN</span> <span class="nv">x</span> : `|- x| = `|x|.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">`|- x| = `|x|</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2be</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; [r||]; <span class="nb">rewrite</span> //= normrN.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eqe_opp</span> <span class="nv">x</span> <span class="nv">y</span> : (- x == - y) = (x == y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- x == - y) = (x == y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2c3</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [r| |] [r&#39;| |] //=; <span class="nb">apply</span>/idP/idP =&gt; [|/eqP[-&gt;]//].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>188</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- r)%:E == (- r&#39;)%:E -&gt; r%:E == r&#39;%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>/eqP =&gt; -[] /eqP; <span class="nb">rewrite</span> eqr_opp =&gt; /eqP -&gt;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eqe_oppP</span> <span class="nv">x</span> <span class="nv">y</span> : (- x = - y) &lt;-&gt; (x = y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">- x = - y &lt;-&gt; x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2cc</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>=&gt; [/eqP | -&gt; //]; <span class="nb">rewrite</span> eqe_opp =&gt; /eqP.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eqe_oppLR</span> <span class="nv">x</span> <span class="nv">y</span> : (- x == y) = (x == - y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- x == y) = (x == - y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2d1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [r0| |] [r1| |] //=; <span class="nb">rewrite</span> !eqe eqr_oppLR.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eqe_oppLRP</span> <span class="nv">x</span> <span class="nv">y</span> : (- x = y) &lt;-&gt; (x = - y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">- x = y &lt;-&gt; x = - y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2d6</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">split</span>=&gt; /eqP; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> eqe_oppLR =&gt; /eqP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x == - y -&gt; - x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -eqe_oppLR =&gt; /eqP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_numN</span> <span class="nv">x</span> : (- x \<span class="kr">is</span> a fin_num) = (x \<span class="kr">is</span> a fin_num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- x \<span class="kr">is</span> a fin_num) = (x \<span class="kr">is</span> a fin_num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2df</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !fin_num_abs abseN.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oppeB</span> <span class="nv">x</span> <span class="nv">y</span> : x +? - y -&gt; - (x - y) = - x + y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x +? - y -&gt; - (x - y) = - x + y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2e4</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; xy; <span class="nb">rewrite</span> oppeD// oppeK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_num_oppeB</span> <span class="nv">x</span> <span class="nv">y</span> : y \<span class="kr">is</span> a fin_num -&gt; - (x - y) = - x + y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; - (x - y) = - x + y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2e9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> oppeB// adde_defN fin_num_adde_defl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_numD</span> <span class="nv">x</span> <span class="nv">y</span> :
  (x + y \<span class="kr">is</span> a fin_num) = (x \<span class="kr">is</span> a fin_num) &amp;&amp; (y \<span class="kr">is</span> a fin_num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x + y \<span class="kr">is</span> a fin_num) =
(x \<span class="kr">is</span> a fin_num) &amp;&amp; (y \<span class="kr">is</span> a fin_num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2ee</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sum_fin_num</span> (<span class="nv">T</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : seq T) (<span class="nv">P</span> : pred T) (<span class="nv">f</span> : T -&gt; \bar R) :
  \sum_(i &lt;- s | P i) f i \<span class="kr">is</span> a fin_num =
  <span class="kp">all</span> [pred x | x \<span class="kr">is</span> a fin_num] [seq f i | i &lt;- s &amp; P i].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>6</q><br><span><var>s</var><span class="hyp-type"><b>: </b><span>seq T</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>pred T</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>T -&gt; \bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(i &lt;- s | P i) f i \<span class="kr">is</span> a fin_num) =
<span class="kp">all</span> [pred x <span class="kr">in</span> fin_num] [seq f i | i &lt;- s &amp; P i]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2f3</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -big_all big_map big_filter; <span class="bp">exact</span>: (big_morph _ fin_numD).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sum_fin_numP</span> (<span class="nv">T</span> : eqType) (<span class="nv">s</span> : seq T) (<span class="nv">P</span> : pred T) (<span class="nv">f</span> : T -&gt; \bar R) :
  reflect (<span class="kr">forall</span> <span class="nv">i</span>, i \<span class="kr">in</span> s -&gt; P i -&gt; f i \<span class="kr">is</span> a fin_num)
          (\sum_(i &lt;- s | P i) f i \<span class="kr">is</span> a fin_num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>T</var><span class="hyp-type"><b>: </b><span>eqType</span></span></span><br><q>2f6</q><br><q>2f7</q><br><q>2f8</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect
  (<span class="kr">forall</span> <span class="nv">i</span> : T, i \<span class="kr">in</span> s -&gt; P i -&gt; f i \<span class="kr">is</span> a fin_num)
  (\sum_(i &lt;- s | P i) f i \<span class="kr">is</span> a fin_num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2fc</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> sum_fin_num; <span class="nb">apply</span>: (iffP allP) =&gt; /=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2fe</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> [seq f i | i &lt;- s &amp; P i],
  <span class="kr">forall</span> <span class="nv">x</span>, x \<span class="kr">is</span> a fin_num} -&gt;
<span class="kr">forall</span> <span class="nv">i</span> : T, i \<span class="kr">in</span> s -&gt; P i -&gt; f i \<span class="kr">is</span> a fin_num</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>2fe</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : T, i \<span class="kr">in</span> s -&gt; P i -&gt; f i \<span class="kr">is</span> a fin_num) -&gt;
{<span class="kr">in</span> [seq f i | i &lt;- s &amp; P i],
  <span class="kr">forall</span> <span class="nv">x</span>, x \<span class="kr">is</span> a fin_num}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; + x xs Px; <span class="nb">apply</span>; <span class="nb">rewrite</span> map_f// mem_filter Px.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2fe</q><span class="goal-separator"><hr></span><q>308</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; + _ /mapP[x /[!mem_filter]/andP[Px xs] -&gt;]; <span class="nb">apply</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_numB</span> <span class="nv">x</span> <span class="nv">y</span> :
  (x - y \<span class="kr">is</span> a fin_num) = (x \<span class="kr">is</span> a fin_num) &amp;&amp; (y \<span class="kr">is</span> a fin_num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x - y \<span class="kr">is</span> a fin_num) =
(x \<span class="kr">is</span> a fin_num) &amp;&amp; (y \<span class="kr">is</span> a fin_num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>30d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_numM</span> <span class="nv">x</span> <span class="nv">y</span> : x \<span class="kr">is</span> a fin_num -&gt; y \<span class="kr">is</span> a fin_num -&gt;
  x * y \<span class="kr">is</span> a fin_num.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt;
y \<span class="kr">is</span> a fin_num -&gt; x * y \<span class="kr">is</span> a fin_num</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>312</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_numX</span> <span class="nv">x</span> <span class="nv">n</span> : x \<span class="kr">is</span> a fin_num -&gt; x ^+ n \<span class="kr">is</span> a fin_num.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>267</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; x ^+ n \<span class="kr">is</span> a fin_num</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>317</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">elim</span>: n x =&gt; // n ih x finx; <span class="nb">rewrite</span> expeS fin_numM// ih.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fineD</span> : {<span class="kr">in</span> @fin_num R &amp;, {morph fine : x y / x + y &gt;-&gt; (x + y)%R}}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> fin_num &amp;,
  {morph fine : x y / x + y &gt;-&gt; (x + y)%R}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>31c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; [r| |] [s| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fineB</span> : {<span class="kr">in</span> @fin_num R &amp;, {morph fine : x y / x - y &gt;-&gt; (x - y)%R}}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> fin_num &amp;,
  {morph fine : x y / x - y &gt;-&gt; (x - y)%R}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>321</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; [r| |] [s| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fineM</span> : {<span class="kr">in</span> @fin_num R &amp;, {morph fine : x y / x * y &gt;-&gt; (x * y)%R}}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> fin_num &amp;,
  {morph fine : x y / x * y &gt;-&gt; (x * y)%R}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>326</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; [x| |] [y| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fineK</span> <span class="nv">x</span> : x \<span class="kr">is</span> a fin_num -&gt; (fine x)%:E = x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (fine x)%:E = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>32b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">EFin_sum_fine</span> (<span class="nv">I</span> : <span class="kt">Type</span>) <span class="nv">s</span> (<span class="nv">P</span> : pred I) (<span class="nv">f</span> : I -&gt; \bar R) :
    (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; f i \<span class="kr">is</span> a fin_num) -&gt;
  (\sum_(i &lt;- s | P i) fine (f i))%:E = \sum_(i &lt;- s | P i) f i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>19a</q><br><q>19b</q><br><q>1df</q><br><q>1e0</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; f i \<span class="kr">is</span> a fin_num) -&gt;
(\sum_(i &lt;- s | P i) fine (f i))%:E =
\sum_(i &lt;- s | P i) f i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>330</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; h; <span class="nb">rewrite</span> -sumEFin; <span class="nb">apply</span>: eq_bigr =&gt; i Pi; <span class="nb">rewrite</span> fineK// h.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sum_fine</span> (<span class="nv">I</span> : <span class="kt">Type</span>) <span class="nv">s</span> (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; \bar R) :
    (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; F i \<span class="kr">is</span> a fin_num) -&gt;
  (\sum_(i &lt;- s | P i) fine (F i) = fine (\sum_(i &lt;- s | P i) F i))%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>19a</q><br><q>19b</q><br><q>1df</q><br><span><var>F</var><span class="hyp-type"><b>: </b><span>I -&gt; \bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F i \<span class="kr">is</span> a fin_num) -&gt;
(\sum_(i &lt;- s | P i) fine (F i))%R =
fine (\sum_(i &lt;- s | P i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>336</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; h; <span class="nb">rewrite</span> -EFin_sum_fine.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sumeN</span> <span class="nv">I</span> <span class="nv">s</span> (<span class="nv">P</span> : pred I) (<span class="nv">f</span> : I -&gt; \bar R) :
    {<span class="kr">in</span> P &amp;, <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span>, f i +? f j} -&gt;
  \sum_(i &lt;- s | P i) - f i = - \sum_(i &lt;- s | P i) f i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>332</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> P &amp;, <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : I, f i +? f j} -&gt;
\sum_(i &lt;- s | P i) - f i =
- (\sum_(i &lt;- s | P i) f i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>33d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">elim</span>: s =&gt; [|a b ih h]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> !big_nil oppe0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>19a</q><br><q>1df</q><br><q>1e0</q><br><span><var>a</var><span class="hyp-type"><b>: </b><span>I</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>seq I</span></span></span><br><span><var>ih</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> P &amp;, <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : I, f i +? f j} -&gt;
\sum_(i &lt;- b | P i) - f i =
- (\sum_(i &lt;- b | P i) f i)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> P &amp;, <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : I, f i +? f j}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt;- (a :: b) | P i) - f i =
- (\sum_(i &lt;- (a :: b) | P i) f i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> !big_cons; <span class="nb">case</span>: ifPn =&gt; Pa; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> ih.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>19a</q><br><q>1df</q><br><q>1e0</q><br><q>345</q><br><q>346</q><br><q>347</q><br><q>348</q><br><span><var>Pa</var><span class="hyp-type"><b>: </b><span>P a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">- f a + \sum_(j &lt;- b | P j) - f j =
- (f a + \sum_(j &lt;- b | P j) f j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> oppeD <span class="nl">?ih</span>// adde_def_sum// =&gt; i Pi; <span class="nb">rewrite</span> h.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_num_sumeN</span> <span class="nv">I</span> <span class="nv">s</span> (<span class="nv">P</span> : pred I) (<span class="nv">f</span> : I -&gt; \bar R) :
    (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; f i \<span class="kr">is</span> a fin_num) -&gt;
  \sum_(i &lt;- s | P i) - f i = - \sum_(i &lt;- s | P i) f i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>332</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; f i \<span class="kr">is</span> a fin_num) -&gt;
\sum_(i &lt;- s | P i) - f i =
- (\sum_(i &lt;- s | P i) f i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>351</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; h; <span class="nb">rewrite</span> sumeN// =&gt; i j Pi Pj; <span class="nb">rewrite</span> fin_num_adde_defl// h.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">telescope_sume</span> <span class="nv">n</span> <span class="nv">m</span> (<span class="nv">f</span> : nat -&gt; \bar R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, (n &lt;= i &lt;= m)%N -&gt; f i \<span class="kr">is</span> a fin_num) -&gt; (n &lt;= m)%N -&gt;
  \sum_(n &lt;= k &lt; m) (f k.+<span class="mi">1</span> - f k) = f m - f n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>nat -&gt; \bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : nat, (n &lt;= i &lt;= m)%N -&gt; f i \<span class="kr">is</span> a fin_num) -&gt;
(n &lt;= m)%N -&gt;
\sum_(n &lt;= k &lt; m) (f k.+<span class="mi">1</span> - f k) = f m - f n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>356</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; nmf nm; <span class="nb">under</span> eq_big_nat =&gt; i /andP[ni im] <span class="kp">do</span>
  <span class="nb">rewrite</span> -[f i.+<span class="mi">1</span>]fineK -<span class="mi">1</span>?[f i]fineK ?(nmf, ni, im) <span class="mi">1</span><span class="nl">?ltnW</span>//= -EFinD.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>359</q><br><q>35a</q><br><span><var>nmf</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : nat, (n &lt;= i &lt;= m)%N -&gt; f i \<span class="kr">is</span> a fin_num</span></span></span><br><span><var>nm</var><span class="hyp-type"><b>: </b><span>(n &lt;= m)%N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(n &lt;= i &lt; m) (fine (f i.+<span class="mi">1</span>) - fine (f i))%:E =
f m - f n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> sumEFin telescope_sumr// EFinB !fineK <span class="nl">?nmf</span> <span class="nl">?nm</span> <span class="nl">?leqnn</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">addeK</span> <span class="nv">x</span> <span class="nv">y</span> : x \<span class="kr">is</span> a fin_num -&gt; y + x - x = y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; y + x - x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>365</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //; <span class="nb">rewrite</span> -EFinD -EFinB addrK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">subeK</span> <span class="nv">x</span> <span class="nv">y</span> : y \<span class="kr">is</span> a fin_num -&gt; x - y + y = x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; x - y + y = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>36a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //; <span class="nb">rewrite</span> -EFinD subrK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">subee</span> <span class="nv">x</span> : x \<span class="kr">is</span> a fin_num -&gt; x - x = <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; x - x = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>36f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [r _| |] //; <span class="nb">rewrite</span> -EFinB subrr.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sube_eq</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; (y +? z) -&gt;
  (x - z == y) = (x == y + z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1b7</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt;
y +? z -&gt; (x - z == y) = (x == y + z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>374</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y z =&gt; [x| |] [y| |] [z| |] // _ _; <span class="nb">rewrite</span> !eqe subr_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_eq_ninfty</span> <span class="nv">x</span> <span class="nv">y</span> : (x + y == -oo) = ((x == -oo) || (y == -oo)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x + y == -oo) = (x == -oo) || (y == -oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>379</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [?| |] [?| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">addye</span> <span class="nv">x</span> : x != -oo -&gt; +oo + x = +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x != -oo -&gt; +oo + x = +oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>37e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">addey</span> <span class="nv">x</span> : x != -oo -&gt; x + +oo = +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x != -oo -&gt; x + +oo = +oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>383</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">addNye</span> <span class="nv">x</span> : -oo + x = -oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">-oo + x = -oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>388</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">addeNy</span> <span class="nv">x</span> : x + -oo = -oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x + -oo = -oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>38d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_Neq_pinfty</span> <span class="nv">x</span> <span class="nv">y</span> : x != -oo -&gt; y != -oo -&gt;
  (x + y != +oo) = (x != +oo) &amp;&amp; (y != +oo).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x != -oo -&gt;
y != -oo -&gt; (x + y != +oo) = (x != +oo) &amp;&amp; (y != +oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>392</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_Neq_ninfty</span> <span class="nv">x</span> <span class="nv">y</span> : x != +oo -&gt; y != +oo -&gt;
  (x + y != -oo) = (x != -oo) &amp;&amp; (y != -oo).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x != +oo -&gt;
y != +oo -&gt; (x + y != -oo) = (x != -oo) &amp;&amp; (y != -oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>397</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_ss_eq0</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="mi">0</span> &lt;= x) &amp;&amp; (<span class="mi">0</span> &lt;= y) || (x &lt;= <span class="mi">0</span>) &amp;&amp; (y &lt;= <span class="mi">0</span>) -&gt;
  x + y == <span class="mi">0</span> = (x == <span class="mi">0</span>) &amp;&amp; (y == <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x) &amp;&amp; (<span class="mi">0</span> &lt;= y) || (x &lt;= <span class="mi">0</span>) &amp;&amp; (y &lt;= <span class="mi">0</span>) -&gt;
(x + y == <span class="mi">0</span>) = (x == <span class="mi">0</span>) &amp;&amp; (y == <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>39c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /orP[|] /andP[]; [<span class="bp">exact</span>: padde_eq0|<span class="bp">exact</span>: nadde_eq0].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">esum_eqNyP</span> (<span class="nv">T</span> : eqType) (<span class="nv">s</span> : seq T) (<span class="nv">P</span> : pred T) (<span class="nv">f</span> : T -&gt; \bar R) :
  \sum_(i &lt;- s | P i) f i = -oo &lt;-&gt; <span class="kr">exists</span> <span class="nv">i</span>, [/\ i \<span class="kr">in</span> s, P i &amp; f i = -oo].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2fe</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt;- s | P i) f i = -oo &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">i</span> : T, [/\ i \<span class="kr">in</span> s, P i &amp; f i = -oo])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>3a1</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">split</span>=&gt; [|[i [si Pi fi]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2fe</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt;- s | P i) f i = -oo -&gt;
<span class="kr">exists</span> <span class="nv">i</span> : T, [/\ i \<span class="kr">in</span> s, P i &amp; f i = -oo]</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>2ff</q><br><q>2f6</q><br><q>2f7</q><br><q>2f8</q><br><span><var>i</var><span class="hyp-type"><b>: </b><span>T</span></span></span><br><span><var>si</var><span class="hyp-type"><b>: </b><span>i \<span class="kr">in</span> s</span></span></span><br><span><var>Pi</var><span class="hyp-type"><b>: </b><span>P i</span></span></span><br><span><var>fi</var><span class="hyp-type"><b>: </b><span>f i = -oo</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">\sum_(i &lt;- s | P i) f i = -oo</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> big_seq_cond; <span class="nb">elim</span>/big_ind: _ =&gt; // [[?| |] [?| |]//|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2fe</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i</span> : T,
(i \<span class="kr">in</span> s) &amp;&amp; P i -&gt;
f i = -oo -&gt;
<span class="kr">exists</span> <span class="nv">i0</span> : T, [/\ i0 \<span class="kr">in</span> s, P i0 &amp; f i0 = -oo]</div></blockquote><q>3a9</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; i /andP[si Pi] fioo; <span class="kr">exists</span> <span class="nv">i</span>; <span class="nb">rewrite</span> si Pi fioo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3ab</q><span class="goal-separator"><hr></span><q>3b0</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> big_mkcond (bigID (xpred1 i))/= (eq_bigr (<span class="kr">fun</span> <span class="nv">_</span> =&gt; -oo)); <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3ab</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i0</span> : T,
i0 == i -&gt; (<span class="kr">if</span> P i0 <span class="kr">then</span> f i0 <span class="kr">else</span> <span class="mi">0</span>) = -oo</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>3ab</q><label class="goal-separator"><hr></label><div class="goal-conclusion">\sum_(i0 &lt;- s | i0 == i) -oo +
\sum_(i0 &lt;- s | i0 != i) (<span class="kr">if</span> P i0 <span class="kr">then</span> f i0 <span class="kr">else</span> <span class="mi">0</span>) =
-oo</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; j /eqP -&gt;; <span class="nb">rewrite</span> Pi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3ab</q><span class="goal-separator"><hr></span><q>3be</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> big_const_seq/= [X <span class="kr">in</span> X + _](_ : _ = -oo)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3ab</q><span class="goal-separator"><hr></span><div class="goal-conclusion">iter (count (eq_op^~ i) s) (+%E -oo) <span class="mi">0</span> = -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">elim</span>: s i Pi fi si =&gt; // h t ih i Pi fi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>2ff</q><br><q>2f7</q><br><q>2f8</q><br><span><var>h</var><span class="hyp-type"><b>: </b><span>T</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>seq T</span></span></span><br><span><var>ih</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : T,
P i -&gt;
f i = -oo -&gt;
i \<span class="kr">in</span> t -&gt;
iter (count (eq_op^~ i) t) (+%E -oo) <span class="mi">0</span> = -oo</span></span></span><br><q>3ac</q><br><q>3ae</q><br><q>3af</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i \<span class="kr">in</span> h :: t -&gt;
iter (count (eq_op^~ i) (h :: t)) (+%E -oo) <span class="mi">0</span> = -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> inE =&gt; /predU1P[&lt;-/=|it]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> eqxx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>2ff</q><br><q>2f7</q><br><q>2f8</q><br><q>3ca</q><br><q>3cb</q><br><q>3cc</q><br><q>3ac</q><br><q>3ae</q><br><q>3af</q><br><span><var>it</var><span class="hyp-type"><b>: </b><span>i \<span class="kr">in</span> t</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">iter (count (eq_op^~ i) (h :: t)) (+%E -oo) <span class="mi">0</span> = -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /= iterD ih//=; <span class="nb">case</span>: (_ == _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">esum_eqNy</span> (<span class="nv">I</span> : finType) (<span class="nv">f</span> : I -&gt; \bar R) (<span class="nv">P</span> : {pred I}) :
  (\sum_(i | P i) f i == -oo) = [<span class="kr">exists</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">P</span>, f i == -oo].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>I</var><span class="hyp-type"><b>: </b><span>finType</span></span></span><br><q>1e0</q><br><span><var>P</var><span class="hyp-type"><b>: </b><span>{pred I}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(i | P i) f i == -oo) =
[<span class="kr">exists</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">P</span>, f i == -oo]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>3d5</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/idP/idP =&gt; [/eqP/esum_eqNyP|/existsP[i /andP[Pi /eqP fi]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3d7</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">i</span> : I,
   [/\ i \<span class="kr">in</span> index_enum I, P i &amp; f i = -oo]) -&gt;
[<span class="kr">exists</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">P</span>, f i == -oo]</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>3d8</q><br><q>1e0</q><br><q>3d9</q><br><span><var>i</var><span class="hyp-type"><b>: </b><span>I</span></span></span><br><span><var>Pi</var><span class="hyp-type"><b>: </b><span>i \<span class="kr">in</span> P</span></span></span><br><q>3af</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">\sum_(i | P i) f i == -oo</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; -[i [_ Pi fi]]; <span class="nb">apply</span>/existsP; <span class="kr">exists</span> <span class="nv">i</span>; <span class="nb">rewrite</span> fi eqxx andbT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3e2</q><span class="goal-separator"><hr></span><q>3e5</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/eqP/esum_eqNyP; <span class="kr">exists</span> <span class="nv">i</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">esum_eqyP</span> (<span class="nv">T</span> : eqType) (<span class="nv">s</span> : seq T) (<span class="nv">P</span> : pred T) (<span class="nv">f</span> : T -&gt; \bar R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; f i != -oo) -&gt;
  \sum_(i &lt;- s | P i) f i = +oo &lt;-&gt; <span class="kr">exists</span> <span class="nv">i</span>, [/\ i \<span class="kr">in</span> s, P i &amp; f i = +oo].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2fe</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : T, P i -&gt; f i != -oo) -&gt;
\sum_(i &lt;- s | P i) f i = +oo &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">i</span> : T, [/\ i \<span class="kr">in</span> s, P i &amp; f i = +oo])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>3ea</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; finoo; <span class="nb">split</span>=&gt; [|[i [si Pi fi]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>2ff</q><br><q>2f6</q><br><q>2f7</q><br><q>2f8</q><br><span><var>finoo</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : T, P i -&gt; f i != -oo</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt;- s | P i) f i = +oo -&gt;
<span class="kr">exists</span> <span class="nv">i</span> : T, [/\ i \<span class="kr">in</span> s, P i &amp; f i = +oo]</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>2ff</q><br><q>2f6</q><br><q>2f7</q><br><q>2f8</q><br><q>3f2</q><br><q>3ac</q><br><q>3ad</q><br><q>3ae</q><br><span><var>fi</var><span class="hyp-type"><b>: </b><span>f i = +oo</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">\sum_(i &lt;- s | P i) f i = +oo</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> big_seq_cond; <span class="nb">elim</span>/big_ind: _ =&gt; // [[?| |] [?| |]//|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3f1</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i</span> : T,
(i \<span class="kr">in</span> s) &amp;&amp; P i -&gt;
f i = +oo -&gt;
<span class="kr">exists</span> <span class="nv">i0</span> : T, [/\ i0 \<span class="kr">in</span> s, P i0 &amp; f i0 = +oo]</div></blockquote><q>3f4</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; i /andP[si Pi] fioo; <span class="kr">exists</span> <span class="nv">i</span>; <span class="nb">rewrite</span> si Pi fioo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3f6</q><span class="goal-separator"><hr></span><q>3f8</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">elim</span>: s i Pi fi si =&gt; // h t ih i Pi fi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>2ff</q><br><q>2f7</q><br><q>2f8</q><br><q>3f2</q><br><q>3ca</q><br><q>3cb</q><br><span><var>ih</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : T,
P i -&gt;
f i = +oo -&gt;
i \<span class="kr">in</span> t -&gt; \sum_(i0 &lt;- t | P i0) f i0 = +oo</span></span></span><br><q>3ac</q><br><q>3ae</q><br><q>3f7</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i \<span class="kr">in</span> h :: t -&gt; \sum_(i &lt;- (h :: t) | P i) f i = +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> inE =&gt; /predU1P[&lt;-/=|it].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>403</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt;- (i :: t) | P i) f i = +oo</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>2ff</q><br><q>2f7</q><br><q>2f8</q><br><q>3f2</q><br><q>3ca</q><br><q>3cb</q><br><q>404</q><br><q>3ac</q><br><q>3ae</q><br><q>3f7</q><br><q>3d2</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">\sum_(i &lt;- (h :: t) | P i) f i = +oo</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> big_cons Pi fi addye//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>403</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(j &lt;- t | P j) f j != -oo</div></blockquote><q>40a</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/eqP =&gt; /esum_eqNyP[j [jt /finoo/negbTE/eqP]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>40c</q><span class="goal-separator"><hr></span><q>40d</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> big_cons; <span class="nb">case</span>: ifPn =&gt; Ph; <span class="nb">rewrite</span> (ih i)// addey// finoo.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">esum_eqy</span> (<span class="nv">I</span> : finType) (<span class="nv">P</span> : {pred I}) (<span class="nv">f</span> : I -&gt; \bar R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; f i != -oo) -&gt;
  (\sum_(i | P i) f i == +oo) = [<span class="kr">exists</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">P</span>, f i == +oo].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>3d8</q><br><q>3d9</q><br><q>1e0</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; f i != -oo) -&gt;
(\sum_(i | P i) f i == +oo) =
[<span class="kr">exists</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">P</span>, f i == +oo]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>416</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; fio; <span class="nb">apply</span>/idP/existsP =&gt; [/eqP /=|[/= i /andP[Pi /eqP fi]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>3d8</q><br><q>3d9</q><br><q>1e0</q><br><span><var>fio</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; f i != -oo</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i | P i) f i = +oo -&gt;
<span class="kr">exists</span> <span class="nv">x</span> : I, (x \<span class="kr">in</span> P) &amp;&amp; (f x == +oo)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>3d8</q><br><q>3d9</q><br><q>1e0</q><br><q>41f</q><br><q>3e3</q><br><q>3e4</q><br><q>3f7</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">\sum_(i | P i) f i == +oo</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> {}fio : (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; f i != -oo) <span class="bp">by</span> <span class="nb">move</span>=&gt; i Pi; <span class="bp">exact</span>: fio.</label><small class="alectryon-output"><div><q>41c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /(esum_eqyP _ fio)[i [_ Pi fi]]; <span class="kr">exists</span> <span class="nv">i</span>; <span class="nb">rewrite</span> fi eqxx andbT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>423</q><span class="goal-separator"><hr></span><q>424</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/eqP/esum_eqyP =&gt; //; <span class="kr">exists</span> <span class="nv">i</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[deprecated(since=<span class="s2">&quot;mathcomp-analysis 0.6.0&quot;</span>, note=<span class="s2">&quot;renamed `esum_eqNyP`&quot;</span>)]
<span class="kn">Notation</span> <span class="nf">esum_ninftyP</span> := esum_eqNyP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[deprecated(since=<span class="s2">&quot;mathcomp-analysis 0.6.0&quot;</span>, note=<span class="s2">&quot;renamed `esum_eqNy`&quot;</span>)]
<span class="kn">Notation</span> <span class="nf">esum_ninfty</span> := esum_eqNy.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[deprecated(since=<span class="s2">&quot;mathcomp-analysis 0.6.0&quot;</span>, note=<span class="s2">&quot;renamed `esum_eqyP`&quot;</span>)]
<span class="kn">Notation</span> <span class="nf">esum_pinftyP</span> := esum_eqyP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[deprecated(since=<span class="s2">&quot;mathcomp-analysis 0.6.0&quot;</span>, note=<span class="s2">&quot;renamed `esum_eqy`&quot;</span>)]
<span class="kn">Notation</span> <span class="nf">esum_pinfty</span> := esum_eqy.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_ge0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= x -&gt; <span class="mi">0</span> &lt;= y -&gt; <span class="mi">0</span> &lt;= x + y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; <span class="mi">0</span> &lt;= y -&gt; <span class="mi">0</span> &lt;= x + y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>42a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [r0| |] [r1| |] // ? ?; <span class="nb">rewrite</span> !lee_fin addr_ge0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_le0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt;= <span class="mi">0</span> -&gt; y &lt;= <span class="mi">0</span> -&gt; x + y &lt;= <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= <span class="mi">0</span> -&gt; y &lt;= <span class="mi">0</span> -&gt; x + y &lt;= <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>42f</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">move</span>: x y =&gt; [r0||] [r1||]// ? ?; <span class="nb">rewrite</span> !lee_fin -(addr0 <span class="mi">0</span>%R); <span class="bp">exact</span>: ler_add.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oppe_gt0</span> <span class="nv">x</span> : (<span class="mi">0</span> &lt; - x) = (x &lt; <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; - x) = (x &lt; <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>434</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">move</span>: x =&gt; [x||] //; <span class="bp">exact</span>: oppr_gt0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oppe_lt0</span> <span class="nv">x</span> : (- x &lt; <span class="mi">0</span>) = (<span class="mi">0</span> &lt; x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- x &lt; <span class="mi">0</span>) = (<span class="mi">0</span> &lt; x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>439</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">move</span>: x =&gt; [x||] //; <span class="bp">exact</span>: oppr_lt0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oppe_ge0</span> <span class="nv">x</span> : (<span class="mi">0</span> &lt;= - x) = (x &lt;= <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= - x) = (x &lt;= <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>43e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">move</span>: x =&gt; [x||] //; <span class="bp">exact</span>: oppr_ge0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oppe_le0</span> <span class="nv">x</span> : (- x &lt;= <span class="mi">0</span>) = (<span class="mi">0</span> &lt;= x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- x &lt;= <span class="mi">0</span>) = (<span class="mi">0</span> &lt;= x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>443</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">move</span>: x =&gt; [x||] //; <span class="bp">exact</span>: oppr_le0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sume_ge0</span> <span class="nv">T</span> (<span class="nv">f</span> : T -&gt; \bar R) (<span class="nv">P</span> : pred T) :
  (<span class="kr">forall</span> <span class="nv">t</span>, P t -&gt; <span class="mi">0</span> &lt;= f t) -&gt; <span class="kr">forall</span> <span class="nv">l</span>, <span class="mi">0</span> &lt;= \sum_(i &lt;- l | P i) f i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>6</q><br><q>2f8</q><br><q>2f7</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">t</span> : T, P t -&gt; <span class="mi">0</span> &lt;= f t) -&gt;
<span class="kr">forall</span> <span class="nv">l</span> : seq T, <span class="mi">0</span> &lt;= \sum_(i &lt;- l | P i) f i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>448</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; f0 l; <span class="nb">elim</span>/big_rec : _ =&gt; // t x Pt; <span class="nb">apply</span>/adde_ge0/f0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sume_le0</span> <span class="nv">T</span> (<span class="nv">f</span> : T -&gt; \bar R) (<span class="nv">P</span> : pred T) :
  (<span class="kr">forall</span> <span class="nv">t</span>, P t -&gt; f t &lt;= <span class="mi">0</span>) -&gt; <span class="kr">forall</span> <span class="nv">l</span>, \sum_(i &lt;- l | P i) f i &lt;= <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>44a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">t</span> : T, P t -&gt; f t &lt;= <span class="mi">0</span>) -&gt;
<span class="kr">forall</span> <span class="nv">l</span> : seq T, \sum_(i &lt;- l | P i) f i &lt;= <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>44e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; f0 l; <span class="nb">elim</span>/big_rec : _ =&gt; // t x Pt; <span class="nb">apply</span>/adde_le0/f0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mulNyy</span> : -oo * +oo = -oo :&gt; \bar R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">-oo * +oo = -oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>453</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /mule /= lt0y.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mulyNy</span> : +oo * -oo = -oo :&gt; \bar R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">+oo * -oo = -oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>458</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC mulNyy.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mulyy</span> : +oo * +oo = +oo :&gt; \bar R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">+oo * +oo = +oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>45d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /mule /= lt0y.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mulNyNy</span> : -oo * -oo = +oo :&gt; \bar R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">-oo * -oo = +oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>462</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">real_mulry</span> <span class="nv">r</span> : r \<span class="kr">is</span> Num.real -&gt; r%:E * +oo = (Num.sg r)%:E * +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ad</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r \<span class="kr">is</span> Num.real -&gt; r%:E * +oo = (Num.sg r)%:E * +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>467</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; rreal; <span class="nb">rewrite</span> /mule/= !eqe sgr_eq0; <span class="nb">case</span>: ifP =&gt; [//|rn0].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>ae</q><br><span><var>rreal</var><span class="hyp-type"><b>: </b><span>r \<span class="kr">is</span> Num.real</span></span></span><br><span><var>rn0</var><span class="hyp-type"><b>: </b><span>(r == <span class="mi">0</span>%R) = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
(<span class="kr">if</span> <span class="mi">0</span> &lt; (Num.sg r)%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: rreal =&gt; /orP[|]; <span class="nb">rewrite</span> le_eqVlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>ae</q><br><q>470</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span>%R == r) || (<span class="mi">0</span> &lt; r)%R -&gt;
(<span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
(<span class="kr">if</span> <span class="mi">0</span> &lt; (Num.sg r)%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>475</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(r == <span class="mi">0</span>%R) || (r &lt; <span class="mi">0</span>)%R -&gt;
(<span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
(<span class="kr">if</span> <span class="mi">0</span> &lt; (Num.sg r)%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> eq_sym rn0/= =&gt; rgt0; <span class="nb">rewrite</span> lte_fin rgt0 gtr0_sg// lte01.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>475</q><span class="goal-separator"><hr></span><q>479</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> rn0/= =&gt; rlt0; <span class="nb">rewrite</span> lt_def lt_geF// andbF ltr0_sg// lte0N1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">real_mulyr</span> <span class="nv">r</span> : r \<span class="kr">is</span> Num.real -&gt; +oo * r%:E = (Num.sg r)%:E * +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ad</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r \<span class="kr">is</span> Num.real -&gt; +oo * r%:E = (Num.sg r)%:E * +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>47e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; rreal; <span class="nb">rewrite</span> muleC real_mulry.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">real_mulrNy</span> <span class="nv">r</span> : r \<span class="kr">is</span> Num.real -&gt; r%:E * -oo = (Num.sg r)%:E * -oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ad</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r \<span class="kr">is</span> Num.real -&gt; r%:E * -oo = (Num.sg r)%:E * -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>483</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; rreal; <span class="nb">rewrite</span> /mule/= !eqe sgr_eq0; <span class="nb">case</span>: ifP =&gt; [//|rn0].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>46e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> <span class="mi">0</span> &lt; (Num.sg r)%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: rreal =&gt; /orP[|]; <span class="nb">rewrite</span> le_eqVlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>475</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span>%R == r) || (<span class="mi">0</span> &lt; r)%R -&gt;
(<span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> <span class="mi">0</span> &lt; (Num.sg r)%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>475</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(r == <span class="mi">0</span>%R) || (r &lt; <span class="mi">0</span>)%R -&gt;
(<span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> <span class="mi">0</span> &lt; (Num.sg r)%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> eq_sym rn0/= =&gt; rgt0; <span class="nb">rewrite</span> lte_fin rgt0 gtr0_sg// lte01.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>475</q><span class="goal-separator"><hr></span><q>491</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> rn0/= =&gt; rlt0; <span class="nb">rewrite</span> lt_def lt_geF// andbF ltr0_sg// lte0N1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">real_mulNyr</span> <span class="nv">r</span> : r \<span class="kr">is</span> Num.real -&gt; -oo * r%:E = (Num.sg r)%:E * -oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ad</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r \<span class="kr">is</span> Num.real -&gt; -oo * r%:E = (Num.sg r)%:E * -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>496</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; rreal; <span class="nb">rewrite</span> muleC real_mulrNy.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">real_mulr_infty</span> := (real_mulry, real_mulyr, real_mulrNy, real_mulNyr).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mulN1e</span> <span class="nv">x</span> : - <span class="mi">1</span>%E * x = - x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">- (<span class="mi">1</span>) * x = - x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>49b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> -EFinN /mule/=; <span class="nb">case</span>: x =&gt; [x||];
  <span class="kp">do</span> ?[<span class="bp">by</span> <span class="nb">rewrite</span> mulN1r|<span class="bp">by</span> <span class="nb">rewrite</span> eqe oppr_eq0 oner_eq0 lte_fin ltr0N1].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">muleN1</span> <span class="nv">x</span> : x * - <span class="mi">1</span>%E = - x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x * - (<span class="mi">1</span>) = - x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4a0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC mulN1e.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_neq0</span> <span class="nv">x</span> <span class="nv">y</span> : x != <span class="mi">0</span> -&gt; y != <span class="mi">0</span> -&gt; x * y != <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x != <span class="mi">0</span> -&gt; y != <span class="mi">0</span> -&gt; x * y != <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4a5</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x||] [y||] x0 y0 //; <span class="nb">rewrite</span> /mule/= ?(lt0y,mulf_neq0)//;
  <span class="kp">try</span> <span class="bp">by</span> (<span class="nb">rewrite</span> (negbTE x0); <span class="nb">case</span>: ifPn) ||
      <span class="bp">by</span> (<span class="nb">rewrite</span> (negbTE y0); <span class="nb">case</span>: ifPn).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_eq0</span> <span class="nv">x</span> <span class="nv">y</span> : (x * y == <span class="mi">0</span>) = (x == <span class="mi">0</span>) || (y == <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x * y == <span class="mi">0</span>) = (x == <span class="mi">0</span>) || (y == <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4aa</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/idP/idP =&gt; [|/orP[] /eqP-&gt;]; <span class="nb">rewrite</span> ?(mule0, mul0e)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x * y == <span class="mi">0</span> -&gt; (x == <span class="mi">0</span>) || (y == <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: contraTT =&gt; /norP[]; <span class="nb">apply</span>: mule_neq0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_ge0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= x -&gt; <span class="mi">0</span> &lt;= y -&gt; <span class="mi">0</span> &lt;= x * y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; <span class="mi">0</span> &lt;= y -&gt; <span class="mi">0</span> &lt;= x * y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4b3</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x||] [y||]//=; <span class="nb">rewrite</span> /mule/= ?(lee_fin, eqe, lte_fin, lt0y)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>94</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x)%R -&gt; (<span class="mi">0</span> &lt;= y)%R -&gt; (<span class="mi">0</span> &lt;= x * y)%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>99</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x)%R -&gt;
<span class="mi">0</span> &lt;= +oo -&gt;
<span class="mi">0</span> &lt;=
(<span class="kr">if</span> x == <span class="mi">0</span>%R
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> (<span class="mi">0</span> &lt; x)%R <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><blockquote class="alectryon-goal"><q>9d</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="mi">0</span> &lt;= +oo -&gt;
(<span class="mi">0</span> &lt;= y)%R -&gt;
<span class="mi">0</span> &lt;=
(<span class="kr">if</span> y == <span class="mi">0</span>%R
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> (<span class="mi">0</span> &lt; y)%R <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>4b8</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">exact</span>: mulr_ge0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>99</q><span class="goal-separator"><hr></span><q>4bd</q></blockquote><div class="alectryon-extra-goals"><q>4be</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>4c2</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;- _|x0 _]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> eqxx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>9a</q><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; x)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;=
(<span class="kr">if</span> x == <span class="mi">0</span>%R
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> (<span class="mi">0</span> &lt; x)%R <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><q>4c4</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> gt_eqF // x0 le0y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9d</q><span class="goal-separator"><hr></span><q>4bf</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>4cd</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;-|y0]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> eqxx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>9e</q><br><span><var>y0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; y)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;=
(<span class="kr">if</span> y == <span class="mi">0</span>%R
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> (<span class="mi">0</span> &lt; y)%R <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> gt_eqF // y0 le0y.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_gt0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt; <span class="mi">0</span> &lt; x * y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt; <span class="mi">0</span> &lt; x * y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4d7</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lt_def =&gt; /andP[? ?] /andP[? ?]; <span class="nb">rewrite</span> mule_neq0 <span class="nl">?mule_ge0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_le0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt;= <span class="mi">0</span> -&gt; y &lt;= <span class="mi">0</span> -&gt; <span class="mi">0</span> &lt;= x * y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= <span class="mi">0</span> -&gt; y &lt;= <span class="mi">0</span> -&gt; <span class="mi">0</span> &lt;= x * y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4dc</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x||] [y||]//=; <span class="nb">rewrite</span> /mule/= ?(lee_fin, eqe, lte_fin)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>94</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt;= <span class="mi">0</span>)%R -&gt; (y &lt;= <span class="mi">0</span>)%R -&gt; (<span class="mi">0</span> &lt;= x * y)%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>99</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x &lt;= <span class="mi">0</span>)%R -&gt;
-oo &lt;= <span class="mi">0</span> -&gt;
<span class="mi">0</span> &lt;=
(<span class="kr">if</span> x == <span class="mi">0</span>%R
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> (<span class="mi">0</span> &lt; x)%R <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><blockquote class="alectryon-goal"><q>9d</q><label class="goal-separator"><hr></label><div class="goal-conclusion">-oo &lt;= <span class="mi">0</span> -&gt;
(y &lt;= <span class="mi">0</span>)%R -&gt;
<span class="mi">0</span> &lt;=
(<span class="kr">if</span> y == <span class="mi">0</span>%R
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> (<span class="mi">0</span> &lt; y)%R <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>4e1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">exact</span>: mulr_le0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>99</q><span class="goal-separator"><hr></span><q>4e6</q></blockquote><div class="alectryon-extra-goals"><q>4e7</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>4eb</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lt_leAnge =&gt; -&gt; _; <span class="nb">case</span>: ifP =&gt; _ //; <span class="nb">rewrite</span> andbF le0y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9d</q><span class="goal-separator"><hr></span><q>4e8</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>4f0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lt_leAnge =&gt; _ -&gt;; <span class="nb">case</span>: ifP =&gt; _ //; <span class="nb">rewrite</span> andbF le0y.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_le0_ge0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt;= <span class="mi">0</span> -&gt; <span class="mi">0</span> &lt;= y -&gt; x * y &lt;= <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= <span class="mi">0</span> -&gt; <span class="mi">0</span> &lt;= y -&gt; x * y &lt;= <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4f4</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x| |] [y| |] //; <span class="nb">rewrite</span> /mule/= ?(lee_fin, lte_fin).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>94</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt;= <span class="mi">0</span>)%R -&gt; (<span class="mi">0</span> &lt;= y)%R -&gt; (x * y &lt;= <span class="mi">0</span>)%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>99</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x &lt;= <span class="mi">0</span>)%R -&gt;
<span class="mi">0</span> &lt;= +oo -&gt;
(<span class="kr">if</span> x%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> (<span class="mi">0</span> &lt; x)%R <span class="kr">then</span> +oo <span class="kr">else</span> -oo) &lt;= <span class="mi">0</span></div></blockquote><blockquote class="alectryon-goal"><q>9d</q><label class="goal-separator"><hr></label><div class="goal-conclusion">-oo &lt;= <span class="mi">0</span> -&gt;
(<span class="mi">0</span> &lt;= y)%R -&gt;
(<span class="kr">if</span> y%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> (<span class="mi">0</span> &lt; y)%R <span class="kr">then</span> -oo <span class="kr">else</span> +oo) &lt;= <span class="mi">0</span></div></blockquote><blockquote class="alectryon-goal"><q>29</q><label class="goal-separator"><hr></label><div class="goal-conclusion">-oo &lt;= <span class="mi">0</span> -&gt;
<span class="mi">0</span> &lt;= +oo -&gt; (<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> -oo <span class="kr">else</span> +oo) &lt;= <span class="mi">0</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>4f9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">exact</span>: mulr_le0_ge0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>99</q><span class="goal-separator"><hr></span><q>4fe</q></blockquote><div class="alectryon-extra-goals"><q>4ff</q><q>501</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>505</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x0 _; <span class="nb">case</span>: ifP =&gt; _ //; <span class="nb">rewrite</span> lt_leAnge /= x0 andbF leNy0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9d</q><span class="goal-separator"><hr></span><q>500</q></blockquote><div class="alectryon-extra-goals"><q>501</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>50a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;-|-&gt;]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> eqxx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> y%:E == <span class="mi">0</span> <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> -oo) &lt;= <span class="mi">0</span></div></blockquote><q>50c</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: ifP =&gt; _ //; <span class="nb">rewrite</span> leNy0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><q>502</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>513</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lt0y leNy0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_ge0_le0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= x -&gt; y &lt;= <span class="mi">0</span> -&gt; x * y &lt;= <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; y &lt;= <span class="mi">0</span> -&gt; x * y &lt;= <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>517</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x0 y0; <span class="nb">rewrite</span> muleC mule_le0_ge0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_lt0_lt0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt; <span class="mi">0</span> -&gt; y &lt; <span class="mi">0</span> -&gt; <span class="mi">0</span> &lt; x * y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; y &lt; <span class="mi">0</span> -&gt; <span class="mi">0</span> &lt; x * y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>51c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lt_neqAle =&gt; /andP[? ?]/andP[*]; <span class="nb">rewrite</span> eq_sym mule_neq0 <span class="nl">?mule_le0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_gt0_lt0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; y &lt; <span class="mi">0</span> -&gt; x * y &lt; <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; y &lt; <span class="mi">0</span> -&gt; x * y &lt; <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>521</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> lt_def !lt_neqAle =&gt; /andP[? ?]/andP[? ?].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>23</q><br><span><var>_a_</var><span class="hyp-type"><b>: </b><span>x != <span class="mi">0</span></span></span></span><br><span><var>_b_</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= x</span></span></span><br><span><var>_a1_</var><span class="hyp-type"><b>: </b><span>y != <span class="mi">0</span></span></span></span><br><span><var>_b1_</var><span class="hyp-type"><b>: </b><span>y &lt;= <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x * y != <span class="mi">0</span>) &amp;&amp; (x * y &lt;= <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mule_neq0 <span class="nl">?mule_ge0_le0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_lt0_gt0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt; <span class="mi">0</span> -&gt; <span class="mi">0</span> &lt; y -&gt; x * y &lt; <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; <span class="mi">0</span> &lt; y -&gt; x * y &lt; <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>52f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x0 y0; <span class="nb">rewrite</span> muleC mule_gt0_lt0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gte_opp</span> <span class="nv">x</span> : <span class="mi">0</span> &lt; x -&gt; - x &lt; x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; - x &lt; x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>534</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; //= r; <span class="nb">rewrite</span> !lte_fin; <span class="nb">apply</span>: gtr_opp.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">realMe</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="mi">0</span>%E &gt;=&lt; x)%O -&gt; (<span class="mi">0</span>%E &gt;=&lt; y)%O -&gt; (<span class="mi">0</span>%E &gt;=&lt; x * y)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span>%E &gt;=&lt; x)%O -&gt; (<span class="mi">0</span>%E &gt;=&lt; y)%O -&gt; (<span class="mi">0</span>%E &gt;=&lt; x * y)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>539</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">case</span>: x y =&gt; [x||] [y||]// rx ry;
  <span class="kp">do</span> ?[<span class="bp">exact</span>: realM
      |<span class="bp">by</span> <span class="nb">rewrite</span> /mule/= lt0y
      |<span class="bp">by</span> <span class="nb">rewrite</span> real_mulr_infty <span class="nl">?realE</span> -<span class="nl">?lee_fin</span>// /Num.sg;
          <span class="nb">case</span>: ifP; [|<span class="nb">case</span>: ifP]; <span class="nb">rewrite</span> <span class="nl">?mul0e</span> /Order.comparable <span class="nl">?lexx</span>;
          <span class="nb">rewrite</span> <span class="nl">?mulN1e</span> <span class="nl">?leNy0</span> <span class="nl">?mul1e</span> <span class="nl">?le0y</span>
      |<span class="bp">by</span> <span class="nb">rewrite</span> mulNyNy /Order.comparable le0y].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">abse_ge0</span> <span class="nv">x</span> : <span class="mi">0</span> &lt;= `|x|.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= `|x|</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>53e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [x| |] /=; <span class="nb">rewrite</span> <span class="nl">?le0y</span> <span class="nl">?lee_fin</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gee0_abs</span> <span class="nv">x</span> : <span class="mi">0</span> &lt;= x -&gt; `|x| = x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; `|x| = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>543</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [x| |]//; <span class="nb">rewrite</span> lee_fin =&gt; x0; <span class="nb">apply</span>/eqP; <span class="nb">rewrite</span> eqe ger0_norm.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gte0_abs</span> <span class="nv">x</span> : <span class="mi">0</span> &lt; x -&gt; `|x| = x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; `|x| = x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>548</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /ltW/gee0_abs.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee0_abs</span> <span class="nv">x</span> : x &lt;= <span class="mi">0</span> -&gt; `|x| = - x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= <span class="mi">0</span> -&gt; `|x| = - x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>54d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [x| |]//; <span class="nb">rewrite</span> lee_fin =&gt; x0; <span class="nb">apply</span>/eqP; <span class="nb">rewrite</span> eqe ler0_norm.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte0_abs</span> <span class="nv">x</span> : x &lt; <span class="mi">0</span> -&gt; `|x| = - x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; `|x| = - x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>552</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /ltW/lee0_abs.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">ERealArithTh_numDomainType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x +? y&quot;</span> := (adde_def x%dE y%dE) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x +? y&quot;</span> := (adde_def x y) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x *? y&quot;</span> := (mule_def x%dE y%dE) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x *? y&quot;</span> := (mule_def x y) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="nf">maxe</span> := (@Order.max ereal_display _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;@ &#39;maxe&#39; R&quot;</span> := (@Order.max ereal_display R)
  (<span class="kn">at level</span> <span class="mi">10</span>, R <span class="kn">at level</span> <span class="mi">8</span>, <span class="kn">only parsing</span>) : fun_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="nf">mine</span> := (@Order.min ereal_display _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;@ &#39;mine&#39; R&quot;</span> := (@Order.min ereal_display R)
  (<span class="kn">at level</span> <span class="mi">10</span>, R <span class="kn">at level</span> <span class="mi">8</span>, <span class="kn">only parsing</span>) : fun_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">DualAddTheoryNumDomain</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">DualERealArithTh_numDomainType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">R</span> : numDomainType}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : \bar R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dual_addeE</span> <span class="nv">x</span> <span class="nv">y</span> : (x + y)%dE = - ((- x) + (- y))%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x + y = - (- x - y)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>557</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; [x| |]; <span class="nb">case</span>: y =&gt; [y| |] //=; <span class="nb">rewrite</span> opprD !opprK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dual_sumeE</span> <span class="nv">I</span> (<span class="nv">r</span> : seq I) (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; \bar R) :
  (\sum_(i &lt;- r | P i) F i)%dE = - (\sum_(i &lt;- r | P i) (- F i)%E)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>19a</q><br><span><var>r</var><span class="hyp-type"><b>: </b><span>seq I</span></span></span><br><q>1df</q><br><q>339</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt;- r | P i) F i =
- (\sum_(i &lt;- r | P i) - F i)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>55c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: (big_ind2 (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> =&gt; x = - y)%E) =&gt; [|_ x _ y -&gt; -&gt;|i _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>55e</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span>%E = (- <span class="mi">0</span>)%E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>19a</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><q>23</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(- x)%E - y = (- (x + y))%E</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>19a</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><q>3e3</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">F i = (- - F i)%E</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>563</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> oppe0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>568</q><span class="goal-separator"><hr></span><q>569</q></blockquote><div class="alectryon-extra-goals"><q>56a</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>56f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> dual_addeE !oppeK.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>56b</q><span class="goal-separator"><hr></span><q>56c</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>574</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> oppeK.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dual_addeE_def</span> <span class="nv">x</span> <span class="nv">y</span> : x +? y -&gt; (x + y)%dE = (x + y)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x +? y)%E -&gt; x + y = (x + y)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>578</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; [x| |]; <span class="nb">case</span>: y.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dEFinD</span> (<span class="nv">r</span> <span class="nv">r&#39;</span> : R) : (r + r&#39;)%R%:E = r%:E + r&#39;%:E.</label><small class="alectryon-output"><div><q>186</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>18b</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dEFinB</span> (<span class="nv">r</span> <span class="nv">r&#39;</span> : R) : (r - r&#39;)%R%:E = r%:E - r&#39;%:E.</label><small class="alectryon-output"><div><q>18d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>190</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsumEFin</span> <span class="nv">I</span> <span class="nv">r</span> <span class="nv">P</span> (<span class="nv">F</span> : I -&gt; R) :
  \sum_(i &lt;- r | P i) (F i)%:E = (\sum_(i &lt;- r | P i) F i)%R%:E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>19a</q><br><q>55f</q><br><q>19c</q><br><q>19d</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt;- r | P i) (F i)%:E =
(\sum_(i &lt;- r | P i) F i)%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>57f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> dual_sumeE fin_num_sumeN// oppeK sumEFin.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">daddeC</span> : commutative (S := \bar R) +%dE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">commutative +%dE</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>585</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x y; <span class="nb">rewrite</span> !dual_addeE addeC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dadde0</span> : right_id (<span class="mi">0</span> : \bar R) +%dE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">right_id (<span class="mi">0</span> : \bar R) +%dE</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>58a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x; <span class="nb">rewrite</span> dual_addeE eqe_oppLRP oppe0 adde0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dadd0e</span> : left_id (<span class="mi">0</span> : \bar R) +%dE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">left_id (<span class="mi">0</span> : \bar R) +%dE</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>58f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x;<span class="nb">rewrite</span> dual_addeE eqe_oppLRP oppe0 add0e.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">daddeA</span> : associative (S := \bar R) +%dE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">associative +%dE</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>594</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x y z; <span class="nb">rewrite</span> !dual_addeE !oppeK addeA.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">dadde_monoid</span> := Monoid.Law daddeA dadd0e dadde0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">dadde_comoid</span> := Monoid.ComLaw daddeC.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">daddeAC</span> : right_commutative (S := \bar R) +%dE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">right_commutative +%dE</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>599</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: Monoid.mulmAC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">daddeCA</span> : left_commutative (S := \bar R) +%dE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">left_commutative +%dE</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>59e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: Monoid.mulmCA.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">daddeACA</span> : @interchange (\bar R) +%dE +%dE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">interchange +%dE +%dE</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5a3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: Monoid.mulmACA.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">realDed</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="mi">0</span>%E &gt;=&lt; x)%O -&gt; (<span class="mi">0</span>%E &gt;=&lt; y)%O -&gt; (<span class="mi">0</span>%E &gt;=&lt; x + y)%O.</label><small class="alectryon-output"><div><q>210</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>213</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">case</span>: x y =&gt; [x||] [y||] //; <span class="bp">exact</span>: realD.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">doppeD</span> <span class="nv">x</span> <span class="nv">y</span> : x +? y -&gt; - (x + y) = - x - y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x +? y)%E -&gt; - (x + y) = - x - y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5a9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //= _; <span class="nb">rewrite</span> opprD.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_num_doppeD</span> <span class="nv">x</span> <span class="nv">y</span> : y \<span class="kr">is</span> a fin_num -&gt; - (x + y) = - x - y.</label><small class="alectryon-output"><div><q>233</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>236</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; finy; <span class="nb">rewrite</span> doppeD// fin_num_adde_defl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsube0</span> <span class="nv">x</span> : x - <span class="mi">0</span> = x.</label><small class="alectryon-output"><div><q>238</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>23b</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [x| |] //; <span class="nb">rewrite</span> -dEFinB subr0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsub0e</span> <span class="nv">x</span> : <span class="mi">0</span> - x = - x.</label><small class="alectryon-output"><div><q>23d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>240</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [x| |] //; <span class="nb">rewrite</span> -dEFinB sub0r.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">doppeB</span> <span class="nv">x</span> <span class="nv">y</span> : x +? - y -&gt; - (x - y) = - x + y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x +? (- y)%dE)%E -&gt; - (x - y) = - x + y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5b1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; xy; <span class="nb">rewrite</span> doppeD// oppeK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_num_doppeB</span> <span class="nv">x</span> <span class="nv">y</span> : y \<span class="kr">is</span> a fin_num -&gt; - (x - y) = - x + y.</label><small class="alectryon-output"><div><q>2e9</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>2ec</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> doppeB// fin_num_adde_defl// fin_numN.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dfin_numD</span> <span class="nv">x</span> <span class="nv">y</span> :
  (x + y \<span class="kr">is</span> a fin_num) = (x \<span class="kr">is</span> a fin_num) &amp;&amp; (y \<span class="kr">is</span> a fin_num).</label><small class="alectryon-output"><div><q>2ee</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>2f1</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dfineD</span> :
  {<span class="kr">in</span> (@fin_num R) &amp;, {morph fine : x y / x + y &gt;-&gt; (x + y)%R}}.</label><small class="alectryon-output"><div><q>31c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>31f</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; [r| |] [s| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dfineB</span> : {<span class="kr">in</span> @fin_num R &amp;, {morph fine : x y / x - y &gt;-&gt; (x - y)%R}}.</label><small class="alectryon-output"><div><q>321</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>324</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; [r| |] [s| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">daddeK</span> <span class="nv">x</span> <span class="nv">y</span> : x \<span class="kr">is</span> a fin_num -&gt; y + x - x = y.</label><small class="alectryon-output"><div><q>365</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>368</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; fx; <span class="nb">rewrite</span> !dual_addeE oppeK addeK <span class="nl">?oppeK</span>; <span class="nb">case</span>: x fx.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsubeK</span> <span class="nv">x</span> <span class="nv">y</span> : y \<span class="kr">is</span> a fin_num -&gt; x - y + y = x.</label><small class="alectryon-output"><div><q>36a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>36d</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; fy; <span class="nb">rewrite</span> !dual_addeE oppeK subeK <span class="nl">?oppeK</span>; <span class="nb">case</span>: y fy.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsubee</span> <span class="nv">x</span> : x \<span class="kr">is</span> a fin_num -&gt; x - x = <span class="mi">0</span>.</label><small class="alectryon-output"><div><q>36f</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>372</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; fx; <span class="nb">rewrite</span> dual_addeE subee <span class="nl">?oppe0</span>; <span class="nb">case</span>: x fx.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsube_eq</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; (y +? z) -&gt;
  (x - z == y) = (x == y + z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1b7</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt;
(y +? z)%E -&gt; (x - z == y) = (x == y + z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5bd</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y z =&gt; [x| |] [y| |] [z| |] // _ _; <span class="nb">rewrite</span> !eqe subr_eq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dadde_eq_pinfty</span> <span class="nv">x</span> <span class="nv">y</span> : (x + y == +oo) = ((x == +oo) || (y == +oo)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x + y == +oo) = (x == +oo) || (y == +oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5c2</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [?| |] [?| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">daddye</span> <span class="nv">x</span> : +oo + x = +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">+oo + x = +oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5c7</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">daddey</span> <span class="nv">x</span> : x + +oo = +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x + +oo = +oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5cc</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">daddNye</span> <span class="nv">x</span> : x != +oo -&gt; -oo + x = -oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x != +oo -&gt; -oo + x = -oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5d1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">daddeNy</span> <span class="nv">x</span> : x != +oo -&gt; x + -oo = -oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x != +oo -&gt; x + -oo = -oo</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5d6</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input">#[deprecated(since=<span class="s2">&quot;mathcomp-analysis 0.6.0&quot;</span>,
  note=<span class="s2">&quot;renamed `daddye` and generalized&quot;</span>)]
<span class="kn">Lemma</span> <span class="nf">daddooe</span> <span class="nv">x</span> : x != -oo -&gt; +oo + x = +oo.</label><small class="alectryon-output"><div><q>37e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>381</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> daddye.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input">#[deprecated(since=<span class="s2">&quot;mathcomp-analysis 0.6.0&quot;</span>,
  note=<span class="s2">&quot;renamed `daddey` and generalized&quot;</span>)]
<span class="kn">Lemma</span> <span class="nf">daddeoo</span> <span class="nv">x</span> : x != -oo -&gt; x + +oo = +oo.</label><small class="alectryon-output"><div><q>383</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>386</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> daddey.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dadde_Neq_pinfty</span> <span class="nv">x</span> <span class="nv">y</span> : x != -oo -&gt; y != -oo -&gt;
  (x + y != +oo) = (x != +oo) &amp;&amp; (y != +oo).</label><small class="alectryon-output"><div><q>392</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>395</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dadde_Neq_ninfty</span> <span class="nv">x</span> <span class="nv">y</span> : x != +oo -&gt; y != +oo -&gt;
  (x + y != -oo) = (x != -oo) &amp;&amp; (y != -oo).</label><small class="alectryon-output"><div><q>397</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>39a</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ndadde_eq0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt;= <span class="mi">0</span> -&gt; y &lt;= <span class="mi">0</span> -&gt; x + y == <span class="mi">0</span> = (x == <span class="mi">0</span>) &amp;&amp; (y == <span class="mi">0</span>).</label><small class="alectryon-output"><div><q>207</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>20a</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x||] [y||] //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>94</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x%:E &lt;= <span class="mi">0</span>)%E -&gt;
(y%:E &lt;= <span class="mi">0</span>)%E -&gt;
(x%:E + y%:E == <span class="mi">0</span>%E) = (x%:E == <span class="mi">0</span>%E) &amp;&amp; (y%:E == <span class="mi">0</span>%E)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>99</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x%:E &lt;= <span class="mi">0</span>)%E -&gt;
(-oo &lt;= <span class="mi">0</span>)%E -&gt;
(x%:E + -oo%E == <span class="mi">0</span>%E) =
(x%:E == <span class="mi">0</span>%E) &amp;&amp; (-oo%E == <span class="mi">0</span>%E)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>5e0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lee_fin -dEFinD !eqe; <span class="bp">exact</span>: naddr_eq0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>99</q><span class="goal-separator"><hr></span><q>5e5</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>5e8</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /adde/= (_ : -oo == <span class="mi">0</span> = false)// andbF.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">pdadde_eq0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= x -&gt; <span class="mi">0</span> &lt;= y -&gt; x + y == <span class="mi">0</span> = (x == <span class="mi">0</span>) &amp;&amp; (y == <span class="mi">0</span>).</label><small class="alectryon-output"><div><q>1fe</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>201</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x||] [y||] //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>94</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x%:E)%E -&gt;
(<span class="mi">0</span> &lt;= y%:E)%E -&gt;
(x%:E + y%:E == <span class="mi">0</span>%E) = (x%:E == <span class="mi">0</span>%E) &amp;&amp; (y%:E == <span class="mi">0</span>%E)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>99</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x%:E)%E -&gt;
(<span class="mi">0</span> &lt;= +oo)%E -&gt;
(x%:E + +oo%E == <span class="mi">0</span>%E) =
(x%:E == <span class="mi">0</span>%E) &amp;&amp; (+oo%E == <span class="mi">0</span>%E)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>5ed</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lee_fin -dEFinD !eqe; <span class="bp">exact</span>: paddr_eq0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>99</q><span class="goal-separator"><hr></span><q>5f2</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>5f5</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /adde/= (_ : +oo == <span class="mi">0</span> = false)// andbF.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dadde_ss_eq0</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="mi">0</span> &lt;= x) &amp;&amp; (<span class="mi">0</span> &lt;= y) || (x &lt;= <span class="mi">0</span>) &amp;&amp; (y &lt;= <span class="mi">0</span>) -&gt;
  x + y == <span class="mi">0</span> = (x == <span class="mi">0</span>) &amp;&amp; (y == <span class="mi">0</span>).</label><small class="alectryon-output"><div><q>39c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>39f</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">move</span>=&gt; /orP[|] /andP[]; [<span class="bp">exact</span>: pdadde_eq0|<span class="bp">exact</span>: ndadde_eq0].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">desum_eqyP</span> (<span class="nv">T</span> : eqType) (<span class="nv">s</span> : seq T) (<span class="nv">P</span> : pred T) (<span class="nv">f</span> : T -&gt; \bar R) :
  \sum_(i &lt;- s | P i) f i = +oo &lt;-&gt; <span class="kr">exists</span> <span class="nv">i</span>, [/\ i \<span class="kr">in</span> s, P i &amp; f i = +oo].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2fe</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt;- s | P i) f i = +oo &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">i</span> : T, [/\ i \<span class="kr">in</span> s, P i &amp; f i = +oo])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5fa</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> dual_sumeE eqe_oppLRP /= esum_eqNyP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2fe</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">i</span> : T, [/\ i \<span class="kr">in</span> s, P i &amp; (- f i)%E = -oo%E]) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">i</span> : T, [/\ i \<span class="kr">in</span> s, P i &amp; f i = +oo%E])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>=&gt; -[i + /<span class="kp">ltac</span>:(<span class="kr">exists</span> <span class="nv">i</span>)] =&gt; [|] []; [|<span class="nb">split</span>]; <span class="nb">rewrite</span> // eqe_oppLRP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">desum_eqy</span> (<span class="nv">I</span> : finType) (<span class="nv">f</span> : I -&gt; \bar R) (<span class="nv">P</span> : {pred I}) :
  (\sum_(i | P i) f i == +oo) = [<span class="kr">exists</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">P</span>, f i == +oo].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3d7</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(i | P i) f i == +oo) =
[<span class="kr">exists</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">P</span>, f i == +oo]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>603</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> dual_sumeE eqe_oppLR esum_eqNy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3d7</q><span class="goal-separator"><hr></span><div class="goal-conclusion">[<span class="kr">exists</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">P</span>, (- f i)%E == -oo%E] =
[<span class="kr">exists</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">P</span>, f i == +oo%E]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">under</span> eq_existsb =&gt; i <span class="kp">do</span> <span class="nb">rewrite</span> eqe_oppLR.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">desum_eqNyP</span>
    (<span class="nv">T</span> : eqType) (<span class="nv">s</span> : seq T) (<span class="nv">P</span> : pred T) (<span class="nv">f</span> : T -&gt; \bar R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; f i != +oo) -&gt;
  \sum_(i &lt;- s | P i) f i = -oo &lt;-&gt; <span class="kr">exists</span> <span class="nv">i</span>, [/\ i \<span class="kr">in</span> s, P i &amp; f i = -oo].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2fe</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : T, P i -&gt; f i != +oo) -&gt;
\sum_(i &lt;- s | P i) f i = -oo &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">i</span> : T, [/\ i \<span class="kr">in</span> s, P i &amp; f i = -oo])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>60c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; fioo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>2ff</q><br><q>2f6</q><br><q>2f7</q><br><q>2f8</q><br><span><var>fioo</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : T, P i -&gt; f i != +oo</span></span></span><br></div><span class="goal-separator"><hr></span><q>3a3</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> dual_sumeE eqe_oppLRP /= esum_eqyP =&gt; [|i Pi]; <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>2ff</q><br><q>2f6</q><br><q>2f7</q><br><q>2f8</q><br><q>614</q><br><q>3ac</q><br><q>3ae</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(- f i)%E != -oo%E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>613</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">i</span> : T, [/\ i \<span class="kr">in</span> s, P i &amp; (- f i)%E = +oo%E]) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">i</span> : T, [/\ i \<span class="kr">in</span> s, P i &amp; f i = -oo%E])</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> eqe_oppLR fioo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>613</q><span class="goal-separator"><hr></span><q>61c</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>=&gt; -[i + /<span class="kp">ltac</span>:(<span class="kr">exists</span> <span class="nv">i</span>)] =&gt; [|] []; [|<span class="nb">split</span>]; <span class="nb">rewrite</span> // eqe_oppLRP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">desum_eqNy</span> (<span class="nv">I</span> : finType) (<span class="nv">f</span> : I -&gt; \bar R) (<span class="nv">P</span> : {pred I}) :
  (<span class="kr">forall</span> <span class="nv">i</span>, f i != +oo) -&gt;
  (\sum_(i | P i) f i == -oo) = [<span class="kr">exists</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">P</span>, f i == -oo].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3d7</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, f i != +oo) -&gt;
(\sum_(i | P i) f i == -oo) =
[<span class="kr">exists</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">P</span>, f i == -oo]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>621</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; finoo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>3d8</q><br><q>1e0</q><br><q>3d9</q><br><span><var>finoo</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : I, f i != +oo</span></span></span><br></div><span class="goal-separator"><hr></span><q>3da</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> dual_sumeE eqe_oppLR /= esum_eqy =&gt; [|i]; <span class="nb">rewrite</span> <span class="nl">?eqe_oppLR</span> //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>628</q><span class="goal-separator"><hr></span><div class="goal-conclusion">[<span class="kr">exists</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">P</span>, (- f i)%E == +oo%E] =
[<span class="kr">exists</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">P</span>, f i == -oo%E]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">under</span> eq_existsb =&gt; i <span class="kp">do</span> <span class="nb">rewrite</span> eqe_oppLR.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[deprecated(since=<span class="s2">&quot;mathcomp-analysis 0.6.0&quot;</span>, note=<span class="s2">&quot;renamed `desum_eqNyP`&quot;</span>)]
<span class="kn">Notation</span> <span class="nf">desum_ninftyP</span> := desum_eqNyP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[deprecated(since=<span class="s2">&quot;mathcomp-analysis 0.6.0&quot;</span>, note=<span class="s2">&quot;renamed `desum_eqNy`&quot;</span>)]
<span class="kn">Notation</span> <span class="nf">desum_ninfty</span> := desum_eqNy.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[deprecated(since=<span class="s2">&quot;mathcomp-analysis 0.6.0&quot;</span>, note=<span class="s2">&quot;renamed `desum_eqyP`&quot;</span>)]
<span class="kn">Notation</span> <span class="nf">desum_pinftyP</span> := desum_eqyP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[deprecated(since=<span class="s2">&quot;mathcomp-analysis 0.6.0&quot;</span>, note=<span class="s2">&quot;renamed `desum_eqy`&quot;</span>)]
<span class="kn">Notation</span> <span class="nf">desum_pinfty</span> := desum_eqy.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dadde_ge0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= x -&gt; <span class="mi">0</span> &lt;= y -&gt; <span class="mi">0</span> &lt;= x + y.</label><small class="alectryon-output"><div><q>42a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>42d</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> dual_addeE oppe_ge0 -!oppe_le0; <span class="bp">exact</span>: adde_le0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dadde_le0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt;= <span class="mi">0</span> -&gt; y &lt;= <span class="mi">0</span> -&gt; x + y &lt;= <span class="mi">0</span>.</label><small class="alectryon-output"><div><q>42f</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>42f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> dual_addeE oppe_le0 -!oppe_ge0; <span class="bp">exact</span>: adde_ge0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsume_ge0</span> <span class="nv">T</span> (<span class="nv">f</span> : T -&gt; \bar R) (<span class="nv">P</span> : pred T) :
  (<span class="kr">forall</span> <span class="nv">n</span>, P n -&gt; <span class="mi">0</span> &lt;= f n) -&gt; <span class="kr">forall</span> <span class="nv">l</span>, <span class="mi">0</span> &lt;= \sum_(i &lt;- l | P i) f i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>44a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">n</span> : T, P n -&gt; <span class="mi">0</span> &lt;= f n) -&gt;
<span class="kr">forall</span> <span class="nv">l</span> : seq T, <span class="mi">0</span> &lt;= \sum_(i &lt;- l | P i) f i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>632</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; u0 l; <span class="nb">rewrite</span> dual_sumeE oppe_ge0 sume_le0 // =&gt; t Pt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>6</q><br><q>2f8</q><br><q>2f7</q><br><span><var>u0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : T, P n -&gt; <span class="mi">0</span> &lt;= f n</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>seq T</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T</span></span></span><br><span><var>Pt</var><span class="hyp-type"><b>: </b><span>P t</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(- f t &lt;= <span class="mi">0</span>)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> oppe_le0; <span class="bp">exact</span>: u0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsume_le0</span> <span class="nv">T</span> (<span class="nv">f</span> : T -&gt; \bar R) (<span class="nv">P</span> : pred T) :
  (<span class="kr">forall</span> <span class="nv">n</span>, P n -&gt; f n &lt;= <span class="mi">0</span>) -&gt; <span class="kr">forall</span> <span class="nv">l</span>, \sum_(i &lt;- l | P i) f i &lt;= <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>44a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">n</span> : T, P n -&gt; f n &lt;= <span class="mi">0</span>) -&gt;
<span class="kr">forall</span> <span class="nv">l</span> : seq T, \sum_(i &lt;- l | P i) f i &lt;= <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>640</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; u0 l; <span class="nb">rewrite</span> dual_sumeE oppe_le0 sume_ge0 // =&gt; t Pt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>6</q><br><q>2f8</q><br><q>2f7</q><br><span><var>u0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : T, P n -&gt; f n &lt;= <span class="mi">0</span></span></span></span><br><q>63b</q><br><q>63c</q><br><q>63d</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= - f t)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> oppe_ge0; <span class="bp">exact</span>: u0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gte_dopp</span> (<span class="nv">r</span> : \bar R) : (<span class="mi">0</span> &lt; r)%E -&gt; (- r &lt; r)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>r</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; r)%E -&gt; (- r &lt; r)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>64b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: r =&gt; //= r; <span class="nb">rewrite</span> !lte_fin; <span class="nb">apply</span>: gtr_opp.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ednatmul_pinfty</span> <span class="nv">n</span> : +oo *+ n.+<span class="mi">1</span> = +oo :&gt; \bar R.</label><small class="alectryon-output"><div><q>125</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>12a</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">elim</span>: n =&gt; //= n -&gt;.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ednatmul_ninfty</span> <span class="nv">n</span> : -oo *+ n.+<span class="mi">1</span> = -oo :&gt; \bar R.</label><small class="alectryon-output"><div><q>12c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>12f</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">elim</span>: n =&gt; //= n -&gt;.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">EFin_dnatmul</span> (<span class="nv">r</span> : R) <span class="nv">n</span> : (r *+ n.+<span class="mi">1</span>)%:E = r%:E *+ n.+<span class="mi">1</span>.</label><small class="alectryon-output"><div><q>131</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>135</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">elim</span>: n =&gt; //= n &lt;-.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ednatmulE</span> <span class="nv">x</span> <span class="nv">n</span> : x *+ n = (x *+ n)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>267</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x *+ n = (x *+ n)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>655</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: x =&gt; [x| |]; <span class="nb">case</span>: n =&gt; [//|n].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>9a</q><br><q>128</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x%:E *+ n.+<span class="mi">1</span> = (x%:E *+ n.+<span class="mi">1</span>)%E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>127</q><label class="goal-separator"><hr></label><div class="goal-conclusion">+oo%E *+ n.+<span class="mi">1</span> = (+oo *+ n.+<span class="mi">1</span>)%E</div></blockquote><blockquote class="alectryon-goal"><q>127</q><label class="goal-separator"><hr></label><div class="goal-conclusion">-oo%E *+ n.+<span class="mi">1</span> = (-oo *+ n.+<span class="mi">1</span>)%E</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>65a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -EFin_natmul -EFin_dnatmul.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>127</q><span class="goal-separator"><hr></span><q>660</q></blockquote><div class="alectryon-extra-goals"><q>661</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>665</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> enatmul_pinfty ednatmul_pinfty.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>127</q><span class="goal-separator"><hr></span><q>662</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>66a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> enatmul_ninfty ednatmul_ninfty.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dmule2n</span> <span class="nv">x</span> : x *+ <span class="mi">2</span> = x + x.</label><small class="alectryon-output"><div><q>137</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>13a</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">DualERealArithTh_numDomainType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">DualAddTheoryNumDomain</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">ERealArithTh_realDomainType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">R</span> : realDomainType}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">u</span> <span class="nv">a</span> <span class="nv">b</span> : \bar R) (<span class="nv">r</span> : R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_numElt</span> <span class="nv">x</span> : (x \<span class="kr">is</span> a fin_num) = (-oo &lt; x &lt; +oo).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x \<span class="kr">is</span> a fin_num) = (-oo &lt; x &lt; +oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>66f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> fin_numE -leye_eq -leeNy_eq -<span class="mi">2</span>!ltNge.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_numPlt</span> <span class="nv">x</span> : reflect (-oo &lt; x &lt; +oo) (x \<span class="kr">is</span> a fin_num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect (-oo &lt; x &lt; +oo) (x \<span class="kr">is</span> a fin_num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>674</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> fin_numElt; <span class="bp">exact</span>: idP.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ltey_eq</span> <span class="nv">x</span> : (x &lt; +oo) = (x \<span class="kr">is</span> a fin_num) || (x == -oo).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt; +oo) = (x \<span class="kr">is</span> a fin_num) || (x == -oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>679</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; // x //=; <span class="bp">exact</span>: ltry.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ltNye_eq</span> <span class="nv">x</span> : (-oo &lt; x) = (x \<span class="kr">is</span> a fin_num) || (x == +oo).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(-oo &lt; x) = (x \<span class="kr">is</span> a fin_num) || (x == +oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>67e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; // x //=; <span class="bp">exact</span>: ltNyr.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ge0_fin_numE</span> <span class="nv">x</span> : <span class="mi">0</span> &lt;= x -&gt; (x \<span class="kr">is</span> a fin_num) = (x &lt; +oo).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; (x \<span class="kr">is</span> a fin_num) = (x &lt; +oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>683</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [x| |] =&gt; // x0; <span class="nb">rewrite</span> fin_numElt ltNyr.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le0_fin_numE</span> <span class="nv">x</span> : x &lt;= <span class="mi">0</span> -&gt; (x \<span class="kr">is</span> a fin_num) = (-oo &lt; x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= <span class="mi">0</span> -&gt; (x \<span class="kr">is</span> a fin_num) = (-oo &lt; x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>688</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [x| |]//=; <span class="nb">rewrite</span> lee_fin =&gt; x0; <span class="nb">rewrite</span> ltNyr.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eqyP</span> <span class="nv">x</span> : x = +oo &lt;-&gt; (<span class="kr">forall</span> <span class="nv">A</span>, (<span class="mi">0</span> &lt; A)%R -&gt; A%:E &lt;= x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x = +oo &lt;-&gt; (<span class="kr">forall</span> <span class="nv">A</span> : R, (<span class="mi">0</span> &lt; A)%R -&gt; A%:E &lt;= x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>68d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">split</span>=&gt; [-&gt; // A A0|Ax]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6b</q><br><span><var>Ax</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : R, (<span class="mi">0</span> &lt; A)%R -&gt; A%:E &lt;= x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/eqP; <span class="nb">rewrite</span> eq_le leey /= leNgt; <span class="nb">apply</span>/negP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>694</q><span class="goal-separator"><hr></span><div class="goal-conclusion">~ x &lt; +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: x Ax =&gt; [x Ax _|//|/(_ _ ltr01)//].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9a</q><br><span><var>Ax</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : R, (<span class="mi">0</span> &lt; A)%R -&gt; A%:E &lt;= x%:E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">suff</span>: ~ x%:E &lt; (Order.max <span class="mi">0</span> x + <span class="mi">1</span>)%:E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>69e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">~ x%:E &lt; (Num.max <span class="mi">0</span> x + <span class="mi">1</span>)%:E -&gt; <span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>69e</q><label class="goal-separator"><hr></label><div class="goal-conclusion">~ x%:E &lt; (Num.max <span class="mi">0</span> x + <span class="mi">1</span>)%:E</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>; <span class="nb">rewrite</span> lte_fin ltr_spaddr// le_maxr lexx orbT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>69e</q><span class="goal-separator"><hr></span><q>6a7</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/negP; <span class="nb">rewrite</span> -leNgt; <span class="nb">apply</span>/Ax/ltr_spaddr; <span class="nb">rewrite</span> // le_maxr lexx.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[deprecated(since=<span class="s2">&quot;mathcomp-analysis 0.6.0&quot;</span>, note=<span class="s2">&quot;renamed `eqyP`&quot;</span>)]
<span class="kn">Notation</span> <span class="nf">eq_pinftyP</span> := eqyP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">seq_psume_eq0</span> (<span class="nv">I</span> : choiceType) (<span class="nv">r</span> : seq I)
    (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; \bar R) : (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; <span class="mi">0</span> &lt;= F i)%E -&gt;
  (\sum_(i &lt;- r | P i) F i == <span class="mi">0</span>)%E = <span class="kp">all</span> (<span class="kr">fun</span> <span class="nv">i</span> =&gt; P i ==&gt; (F i == <span class="mi">0</span>%E)) r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>I</var><span class="hyp-type"><b>: </b><span>choiceType</span></span></span><br><q>55f</q><br><q>1df</q><br><q>339</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; <span class="mi">0</span> &lt;= F i) -&gt;
(\sum_(i &lt;- r | P i) F i == <span class="mi">0</span>) =
<span class="kp">all</span> (<span class="kr">fun</span> <span class="nv">i</span> : I =&gt; P i ==&gt; (F i == <span class="mi">0</span>)) r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>6ac</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; F0; <span class="nb">apply</span>/eqP/allP =&gt; PF0; <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6af</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><span><var>F0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; <span class="mi">0</span> &lt;= F i</span></span></span><br><span><var>PF0</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> r, <span class="kr">forall</span> <span class="nv">x</span> : I, P x ==&gt; (F x == <span class="mi">0</span>)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt;- r | P i) F i = <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6af</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br><span><var>PF0</var><span class="hyp-type"><b>: </b><span>\sum_(i &lt;- r | P i) F i = <span class="mi">0</span></span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">{<span class="kr">in</span> r, <span class="kr">forall</span> <span class="nv">x</span> : I, P x ==&gt; (F x == <span class="mi">0</span>)}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> big_seq_cond big1// =&gt; i /andP[ir Pi].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6af</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br><q>6b7</q><br><q>3e3</q><br><span><var>ir</var><span class="hyp-type"><b>: </b><span>i \<span class="kr">in</span> r</span></span></span><br><q>3ae</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F i = <span class="mi">0</span></div></blockquote><q>6b9</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">have</span> := PF0 _ ir; <span class="nb">rewrite</span> Pi implyTb =&gt; /eqP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6bb</q><span class="goal-separator"><hr></span><q>6bd</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; i ir; <span class="nb">apply</span>/implyP =&gt; Pi; <span class="nb">apply</span>/eqP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6af</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br><q>6bc</q><br><q>3e3</q><br><q>6c2</q><br><q>3ae</q><br></div><span class="goal-separator"><hr></span><q>6c3</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> rPF : {<span class="kr">in</span> r, <span class="kr">forall</span> <span class="nv">i</span>, P i ==&gt; (F i \<span class="kr">is</span> a fin_num)}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6ca</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> r, <span class="kr">forall</span> <span class="nv">i</span> : I, P i ==&gt; (F i \<span class="kr">is</span> a fin_num)}</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6af</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br><q>6bc</q><br><q>3e3</q><br><q>6c2</q><br><q>3ae</q><br><span><var>rPF</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> r, <span class="kr">forall</span> <span class="nv">i</span> : I, P i ==&gt; (F i \<span class="kr">is</span> a fin_num)}</span></span></span><br></div><label class="goal-separator"><hr></label><q>6c3</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; j jr; <span class="nb">apply</span>/implyP =&gt; Pj; <span class="nb">rewrite</span> fin_numElt; <span class="nb">apply</span>/andP; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6af</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br><q>6bc</q><br><q>3e3</q><br><q>6c2</q><br><q>3ae</q><br><span><var>j</var><span class="hyp-type"><b>: </b><span>I</span></span></span><br><span><var>jr</var><span class="hyp-type"><b>: </b><span>j \<span class="kr">in</span> r</span></span></span><br><span><var>Pj</var><span class="hyp-type"><b>: </b><span>P j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">-oo &lt; F j</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>6d6</q><label class="goal-separator"><hr></label><div class="goal-conclusion">F j &lt; +oo</div></blockquote><q>6d0</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (lt_le_trans _ (F0 _ Pj))// ltNyr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6d6</q><span class="goal-separator"><hr></span><q>6dd</q></blockquote><q>6cf</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> ltNge; <span class="nb">apply</span>/eqP; <span class="nb">rewrite</span> leye_eq; <span class="nb">apply</span>/eqP/negP =&gt; /eqP Fjoo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6af</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br><q>6bc</q><br><q>3e3</q><br><q>6c2</q><br><q>3ae</q><br><q>6d7</q><br><q>6d8</q><br><q>6d9</q><br><span><var>Fjoo</var><span class="hyp-type"><b>: </b><span>F j = +oo</span></span></span><br></div><span class="goal-separator"><hr></span><q>6a0</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6af</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br><q>6bc</q><br><q>3e3</q><br><q>6c2</q><br><q>3ae</q><br><span><var>rPF</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> r,
  <span class="kr">forall</span> <span class="nv">i</span> : I, P i ==&gt; (F i \<span class="kr">is</span> a fin_num)}</span></span></span><br></div><label class="goal-separator"><hr></label><q>6c3</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> PFninfty k : P k -&gt; F k != -oo%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6af</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br><q>6bc</q><br><q>3e3</q><br><q>6c2</q><br><q>3ae</q><br><q>6d7</q><br><q>6d8</q><br><q>6d9</q><br><q>6e5</q><br><span><var>k</var><span class="hyp-type"><b>: </b><span>I</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P k -&gt; F k != -oo</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6af</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br><q>6bc</q><br><q>3e3</q><br><q>6c2</q><br><q>3ae</q><br><q>6d7</q><br><q>6d8</q><br><q>6d9</q><br><q>6e5</q><br><span><var>PFninfty</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : I, P k -&gt; F k != -oo</span></span></span><br></div><label class="goal-separator"><hr></label><q>6a0</q></blockquote><q>6e7</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; Pk; <span class="nb">rewrite</span> gt_eqF// (lt_le_trans _ (F0 _ Pk))// ltNyr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6f2</q><span class="goal-separator"><hr></span><q>6a0</q></blockquote><q>6e6</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> /esum_eqyP : <span class="kr">exists</span> <span class="nv">i</span>, [/\ i \<span class="kr">in</span> r, P i &amp; F i = +oo%E] <span class="bp">by</span> <span class="kr">exists</span> <span class="nv">j</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6f2</q><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F i != -oo) -&gt;
 \sum_(i0 &lt;- r | P i0) F i0 = +oo) -&gt; <span class="kt">False</span></div></blockquote><q>6e6</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /(_ PFninfty); <span class="nb">rewrite</span> PF0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6d1</q><span class="goal-separator"><hr></span><q>6c3</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> ? : (\sum_(i &lt;- r | P i) (fine \o F) i == <span class="mi">0</span>)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6d1</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(i &lt;- r | P i) (fine \o F) i)%R == <span class="mi">0</span>%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6af</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br><q>6bc</q><br><q>3e3</q><br><q>6c2</q><br><q>3ae</q><br><q>6d2</q><br><span><var>_x_</var><span class="hyp-type"><b>: </b><span>(\sum_(i &lt;- r | P i) (fine \o F) i)%R == <span class="mi">0</span>%R</span></span></span><br></div><label class="goal-separator"><hr></label><q>6c3</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/eqP/EFin_inj; <span class="nb">rewrite</span> big_seq_cond -sumEFin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6d1</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt;- r | (i \<span class="kr">in</span> r) &amp;&amp; P i) ((fine \o F) i)%:E =
<span class="mi">0</span></div></blockquote><q>702</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> (eq_bigr (<span class="kr">fun</span> <span class="nv">i0</span> =&gt; F i0)); <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6d1</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i</span> : I,
(i \<span class="kr">in</span> r) &amp;&amp; P i -&gt; ((fine \o F) i)%:E = F i</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>6d1</q><label class="goal-separator"><hr></label><div class="goal-conclusion">\sum_(i &lt;- r | (i \<span class="kr">in</span> r) &amp;&amp; P i) F i = <span class="mi">0</span></div></blockquote><q>703</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; j /andP[jr Pj] /=; <span class="nb">rewrite</span> fineK//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6af</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br><q>6bc</q><br><q>3e3</q><br><q>6c2</q><br><q>3ae</q><br><q>6d2</q><br><q>6d7</q><br><q>6d8</q><br><q>6d9</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F j \<span class="kr">is</span> a fin_num</div></blockquote><q>70e</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">have</span> := rPF _ jr; <span class="nb">rewrite</span> Pj implyTb.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6d1</q><span class="goal-separator"><hr></span><q>710</q></blockquote><q>702</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -big_seq_cond PF0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>704</q><span class="goal-separator"><hr></span><q>6c3</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> /allP/(_ _ ir) : <span class="kp">all</span> (<span class="kr">fun</span> <span class="nv">i</span> =&gt; P i ==&gt; ((fine \o F) i == <span class="mi">0</span>))%R r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>704</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kp">all</span> (<span class="kr">fun</span> <span class="nv">i</span> : I =&gt; P i ==&gt; ((fine \o F) i == <span class="mi">0</span>%R)) r</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>704</q><label class="goal-separator"><hr></label><div class="goal-conclusion">P i ==&gt; ((fine \o F) i == <span class="mi">0</span>%R) -&gt; F i = <span class="mi">0</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -psumr_eq0// =&gt; j Pj/=; <span class="nb">apply</span>/fine_ge0/F0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>704</q><span class="goal-separator"><hr></span><q>722</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> Pi implyTb =&gt; /= =&gt; /eqP Fi0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6af</q><br><q>55f</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br><q>6bc</q><br><q>3e3</q><br><q>6c2</q><br><q>3ae</q><br><q>6d2</q><br><q>705</q><br><span><var>Fi0</var><span class="hyp-type"><b>: </b><span>fine (F i) = <span class="mi">0</span>%R</span></span></span><br></div><span class="goal-separator"><hr></span><q>6c3</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -(@fineK _ (F i))//; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">have</span> := rPF _ ir; <span class="nb">rewrite</span> Pi implyTb.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>729</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(fine (F i))%:E = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> Fi0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_add_pinfty</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt; +oo -&gt; y &lt; +oo -&gt; x + y &lt; +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>23</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; +oo -&gt; y &lt; +oo -&gt; x + y &lt; +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>730</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; -[r [r&#39;| |]| |] // ? ?; <span class="nb">rewrite</span> -EFinD ltry.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_sum_pinfty</span> <span class="nv">I</span> (<span class="nv">s</span> : seq I) (<span class="nv">P</span> : pred I) (<span class="nv">f</span> : I -&gt; \bar R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; f i &lt; +oo) -&gt; \sum_(i &lt;- s | P i) f i &lt; +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>19b</q><br><q>1df</q><br><q>1e0</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; f i &lt; +oo) -&gt;
\sum_(i &lt;- s | P i) f i &lt; +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>736</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">elim</span>/big_ind : _ =&gt; [_|x y xoo yoo foo|i ?]; [<span class="bp">exact</span>: ltry| |<span class="bp">exact</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>19b</q><br><q>1df</q><br><q>1e0</q><br><q>23</q><br><span><var>xoo</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; f i &lt; +oo) -&gt; x &lt; +oo</span></span></span><br><span><var>yoo</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; f i &lt; +oo) -&gt; y &lt; +oo</span></span></span><br><span><var>foo</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; f i &lt; +oo</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x + y &lt; +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: lte_add_pinfty; [<span class="bp">exact</span>: xoo| <span class="bp">exact</span>: yoo].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sube_gt0</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="mi">0</span> &lt; y - x) = (x &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; y - x) = (x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>744</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [r | |] [r&#39;| |] //=; <span class="nb">rewrite</span> ?(ltry, ltNyr)// !lte_fin subr_gt0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sube_le0</span> <span class="nv">x</span> <span class="nv">y</span> : (y - x &lt;= <span class="mi">0</span>) = (y &lt;= x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(y - x &lt;= <span class="mi">0</span>) = (y &lt;= x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>749</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !leNgt sube_gt0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">suber_ge0</span> <span class="nv">y</span> <span class="nv">x</span> : y \<span class="kr">is</span> a fin_num -&gt; (<span class="mi">0</span> &lt;= x - y) = (y &lt;= x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>y, x</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (<span class="mi">0</span> &lt;= x - y) = (y &lt;= x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>74e</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //= _; <span class="nb">rewrite</span> ?(leey, lee_fin, subr_ge0).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">subre_ge0</span> <span class="nv">x</span> <span class="nv">y</span> : y \<span class="kr">is</span> a fin_num -&gt; (<span class="mi">0</span> &lt;= y - x) = (x &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (<span class="mi">0</span> &lt;= y - x) = (x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>755</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //=; <span class="nb">rewrite</span> ?(leey, leNye, lee_fin) //= subr_ge0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sube_ge0</span> <span class="nv">x</span> <span class="nv">y</span> : (x \<span class="kr">is</span> a fin_num) || (y \<span class="kr">is</span> a fin_num) -&gt;
  (<span class="mi">0</span> &lt;= y - x) = (x &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x \<span class="kr">is</span> a fin_num) || (y \<span class="kr">is</span> a fin_num) -&gt;
(<span class="mi">0</span> &lt;= y - x) = (x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>75a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /orP[?|?]; [<span class="nb">rewrite</span> suber_ge0|<span class="nb">rewrite</span> subre_ge0].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_oppl</span> <span class="nv">x</span> <span class="nv">y</span> : (- x &lt; y) = (- y &lt; x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- x &lt; y) = (- y &lt; x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>75f</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [r| |] [r&#39;| |] //=; <span class="nb">rewrite</span> ?(ltry, ltNyr)// !lte_fin ltr_oppl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_oppr</span> <span class="nv">x</span> <span class="nv">y</span> : (x &lt; - y) = (y &lt; - x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt; - y) = (y &lt; - x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>764</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [r| |] [r&#39;| |] //=; <span class="nb">rewrite</span> ?(ltry, ltNyr)// !lte_fin ltr_oppr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_oppr</span> <span class="nv">x</span> <span class="nv">y</span> : (x &lt;= - y) = (y &lt;= - x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt;= - y) = (y &lt;= - x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>769</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [r0| |] [r1| |] //=; <span class="nb">rewrite</span> ?(leey, leNye)// !lee_fin ler_oppr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_oppl</span> <span class="nv">x</span> <span class="nv">y</span> : (- x &lt;= y) = (- y &lt;= x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- x &lt;= y) = (- y &lt;= x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>76e</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [r0| |] [r1| |] //=; <span class="nb">rewrite</span> ?(leey, leNye)// !lee_fin ler_oppl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">muleN</span> <span class="nv">x</span> <span class="nv">y</span> : x * - y = - (x * y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x * - y = - (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>773</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x| |] [y| |] //=; <span class="nb">rewrite</span> /mule/=; <span class="kp">try</span> <span class="bp">by</span> <span class="nb">rewrite</span> ltry.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>95</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x * - y)%:E = (- (x * y))%:E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9a</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> x%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; x%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
-
(<span class="kr">if</span> x%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; x%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><blockquote class="alectryon-goal"><q>77e</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> x%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; x%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
-
(<span class="kr">if</span> x%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; x%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9e</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> (- y)%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; (- y)%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
-
(<span class="kr">if</span> y%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; y%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><blockquote class="alectryon-goal"><q>783</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> (- y)%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; (- y)%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
-
(<span class="kr">if</span> y%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; y%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>778</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulrN.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><q>77f</q></blockquote><div class="alectryon-extra-goals"><q>780</q><q>782</q><q>785</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>789</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !eqe !lte_fin; <span class="nb">case</span>: ltrgtP =&gt; //; <span class="nb">rewrite</span> oppe0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><q>781</q></blockquote><div class="alectryon-extra-goals"><q>782</q><q>785</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>78e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !eqe !lte_fin; <span class="nb">case</span>: ltrgtP =&gt; //; <span class="nb">rewrite</span> oppe0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>783</q><span class="goal-separator"><hr></span><q>784</q></blockquote><div class="alectryon-extra-goals"><q>785</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>793</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> !eqe oppr_eq0 eq_sym; <span class="nb">case</span>: ifP; <span class="nb">rewrite</span> <span class="nl">?oppe0</span>// =&gt; y0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9e</q><br><span><var>y0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span>%R == y) = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; (- y)%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
- (<span class="kr">if</span> <span class="mi">0</span> &lt; y%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><q>795</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> [RHS]fun_if ltNge if_neg EFinN lee_oppl oppe0 le_eqVlt eqe y0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>783</q><span class="goal-separator"><hr></span><q>786</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>79e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> !eqe oppr_eq0 eq_sym; <span class="nb">case</span>: ifP; <span class="nb">rewrite</span> <span class="nl">?oppe0</span>// =&gt; y0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>79a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; (- y)%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
- (<span class="kr">if</span> <span class="mi">0</span> &lt; y%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> [RHS]fun_if ltNge if_neg EFinN lee_oppl oppe0 le_eqVlt eqe y0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mulNe</span> <span class="nv">x</span> <span class="nv">y</span> : - x * y = - (x * y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">- x * y = - (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>7a6</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC muleN muleC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">muleNN</span> <span class="nv">x</span> <span class="nv">y</span> : - x * - y = x * y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">- x * - y = x * y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>7ab</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulNe muleN oppeK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mulry</span> <span class="nv">r</span> : r%:E * +oo%E = (Num.sg r)%:E * +oo%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>cc</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r%:E * +oo = (Num.sg r)%:E * +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>7b0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> [LHS]real_mulry// num_real.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mulyr</span> <span class="nv">r</span> : +oo%E * r%:E = (Num.sg r)%:E * +oo%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>cc</q><span class="goal-separator"><hr></span><div class="goal-conclusion">+oo * r%:E = (Num.sg r)%:E * +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>7b5</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC mulry.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mulrNy</span> <span class="nv">r</span> : r%:E * -oo%E = (Num.sg r)%:E * -oo%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>cc</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r%:E * -oo = (Num.sg r)%:E * -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>7ba</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> [LHS]real_mulrNy// num_real.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mulNyr</span> <span class="nv">r</span> : -oo%E * r%:E = (Num.sg r)%:E * -oo%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>cc</q><span class="goal-separator"><hr></span><div class="goal-conclusion">-oo * r%:E = (Num.sg r)%:E * -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>7bf</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC mulrNy.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">mulr_infty</span> := (mulry, mulyr, mulrNy, mulNyr).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_mul_pinfty</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= x -&gt; x \<span class="kr">is</span> a fin_num -&gt; y &lt; +oo -&gt; x * y &lt; +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; x \<span class="kr">is</span> a fin_num -&gt; y &lt; +oo -&gt; x * y &lt; +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>7c4</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x| |] [y| |] // x0 xfin _; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> -EFinM ltry.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9a</q><br><span><var>x0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= x%:E</span></span></span><br><span><var>xfin</var><span class="hyp-type"><b>: </b><span>x%:E \<span class="kr">is</span> a fin_num</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x%:E * -oo &lt; +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> mulr_infty; <span class="nb">move</span>: x0; <span class="nb">rewrite</span> lee_fin le_eqVlt =&gt; /predU1P[&lt;-|x0].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9a</q><br><q>7cd</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Num.sg <span class="mi">0</span>)%:E * -oo &lt; +oo</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9a</q><br><q>7cd</q><br><q>4ca</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(Num.sg x)%:E * -oo &lt; +oo</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>7d0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> sgr0 mul0e ltry.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>7d6</q><span class="goal-separator"><hr></span><q>7d7</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>7da</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> gtr0_sg // mul1e.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_ge0_gt0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= x -&gt; <span class="mi">0</span> &lt;= y -&gt; (<span class="mi">0</span> &lt; x * y) = (<span class="mi">0</span> &lt; x) &amp;&amp; (<span class="mi">0</span> &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; <span class="mi">0</span> &lt;= y -&gt; (<span class="mi">0</span> &lt; x * y) = (<span class="mi">0</span> &lt; x) &amp;&amp; (<span class="mi">0</span> &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>7de</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x| |] [y| |] //; <span class="nb">rewrite</span> <span class="nl">?lee_fin</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x)%R -&gt;
(<span class="mi">0</span> &lt;= y)%R -&gt;
(<span class="mi">0</span> &lt; x%:E * y%:E) = (<span class="mi">0</span> &lt; x%:E) &amp;&amp; (<span class="mi">0</span> &lt; y%:E)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>77e</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x)%R -&gt;
<span class="mi">0</span> &lt;= +oo -&gt; (<span class="mi">0</span> &lt; x%:E * +oo) = (<span class="mi">0</span> &lt; x%:E) &amp;&amp; (<span class="mi">0</span> &lt; +oo)</div></blockquote><blockquote class="alectryon-goal"><q>783</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="mi">0</span> &lt;= +oo -&gt;
(<span class="mi">0</span> &lt;= y)%R -&gt;
(<span class="mi">0</span> &lt; +oo * y%:E) = (<span class="mi">0</span> &lt; +oo) &amp;&amp; (<span class="mi">0</span> &lt; y%:E)</div></blockquote><blockquote class="alectryon-goal"><q>ed</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="mi">0</span> &lt;= +oo -&gt;
<span class="mi">0</span> &lt;= +oo -&gt; (<span class="mi">0</span> &lt; +oo * +oo) = (<span class="mi">0</span> &lt; +oo) &amp;&amp; (<span class="mi">0</span> &lt; +oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>7e3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x0 y0; <span class="nb">rewrite</span> !lte_fin; <span class="bp">exact</span>: mulr_ge0_gt0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><q>7e8</q></blockquote><div class="alectryon-extra-goals"><q>7e9</q><q>7eb</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>7ef</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;-|x0] _; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> mul0e ltxx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9a</q><br><q>4ca</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; x%:E * +oo) = (<span class="mi">0</span> &lt; x%:E) &amp;&amp; (<span class="mi">0</span> &lt; +oo)</div></blockquote><q>7f1</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltry andbT mulr_infty gtr0_sg// mul1e lte_fin x0 ltry.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>783</q><span class="goal-separator"><hr></span><q>7ea</q></blockquote><div class="alectryon-extra-goals"><q>7eb</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>7f9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;-|x0].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>783</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; +oo * <span class="mi">0</span>) = (<span class="mi">0</span> &lt; +oo) &amp;&amp; (<span class="mi">0</span> &lt; <span class="mi">0</span>)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9e</q><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; y)%R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt; +oo * y%:E) = (<span class="mi">0</span> &lt; +oo) &amp;&amp; (<span class="mi">0</span> &lt; y%:E)</div></blockquote><q>7eb</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mule0 ltxx andbC.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>803</q><span class="goal-separator"><hr></span><q>805</q></blockquote><q>7fb</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltry/= mulr_infty gtr0_sg// mul1e lte_fin x0 ltry.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><q>7ec</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>80a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; _ _; <span class="nb">rewrite</span> mulyy ltry.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gt0_mulye</span> <span class="nv">x</span> : (<span class="mi">0</span> &lt; x -&gt; +oo * x = +oo)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; +oo * x = +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>80e</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x =&gt; [x|_|//]; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> mulyy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x%:E -&gt; +oo * x%:E = +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lte_fin =&gt; x0; <span class="nb">rewrite</span> muleC mulr_infty gtr0_sg// mul1e.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lt0_mulye</span> <span class="nv">x</span> : (x &lt; <span class="mi">0</span> -&gt; +oo * x = -oo)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; +oo * x = -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>817</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x =&gt; [x|//|_]; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> mulyNy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x%:E &lt; <span class="mi">0</span> -&gt; +oo * x%:E = -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lte_fin =&gt; x0; <span class="nb">rewrite</span> muleC mulr_infty ltr0_sg// mulN1e.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gt0_mulNye</span> <span class="nv">x</span> : (<span class="mi">0</span> &lt; x -&gt; -oo * x = -oo)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; -oo * x = -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>820</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x =&gt; [x|_|//]; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> mulNyy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x%:E -&gt; -oo * x%:E = -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lte_fin =&gt; x0; <span class="nb">rewrite</span> muleC mulr_infty gtr0_sg// mul1e.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lt0_mulNye</span> <span class="nv">x</span> : (x &lt; <span class="mi">0</span> -&gt; -oo * x = +oo)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; -oo * x = +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>829</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x =&gt; [x|//|_]; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> mulNyNy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x%:E &lt; <span class="mi">0</span> -&gt; -oo * x%:E = +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lte_fin =&gt; x0; <span class="nb">rewrite</span> muleC mulr_infty ltr0_sg// mulN1e.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gt0_muley</span> <span class="nv">x</span> : (<span class="mi">0</span> &lt; x -&gt; x * +oo = +oo)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; x * +oo = +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>832</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /gt0_mulye; <span class="nb">rewrite</span> muleC; <span class="nb">apply</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lt0_muley</span> <span class="nv">x</span> : (x &lt; <span class="mi">0</span> -&gt; x * +oo = -oo)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; x * +oo = -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>837</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /lt0_mulye; <span class="nb">rewrite</span> muleC; <span class="nb">apply</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gt0_muleNy</span> <span class="nv">x</span> : (<span class="mi">0</span> &lt; x -&gt; x * -oo = -oo)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; x * -oo = -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>83c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /gt0_mulNye; <span class="nb">rewrite</span> muleC; <span class="nb">apply</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lt0_muleNy</span> <span class="nv">x</span> : (x &lt; <span class="mi">0</span> -&gt; x * -oo = +oo)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; x * -oo = +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>841</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /lt0_mulNye; <span class="nb">rewrite</span> muleC; <span class="nb">apply</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_eq_pinfty</span> <span class="nv">x</span> <span class="nv">y</span> : (x * y == +oo) =
  [|| (x &gt; <span class="mi">0</span>) &amp;&amp; (y == +oo), (x &lt; <span class="mi">0</span>) &amp;&amp; (y == -oo),
     (x == +oo) &amp;&amp; (y &gt; <span class="mi">0</span>) | (x == -oo) &amp;&amp; (y &lt; <span class="mi">0</span>)].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x * y == +oo) =
[|| (<span class="mi">0</span> &lt; x) &amp;&amp; (y == +oo), (x &lt; <span class="mi">0</span>) &amp;&amp; (y == -oo),
    (x == +oo) &amp;&amp; (<span class="mi">0</span> &lt; y)
  | (x == -oo) &amp;&amp; (y &lt; <span class="mi">0</span>)]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>846</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x| |] [y| |]; <span class="nb">rewrite</span> ?(lte_fin,andbF,andbT,orbF,eqxx,andbT)//=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x%:E * +oo == +oo) = (<span class="mi">0</span> &lt; x)%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>77e</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x%:E * -oo == +oo) = (x &lt; <span class="mi">0</span>)%R</div></blockquote><blockquote class="alectryon-goal"><q>783</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(+oo * y%:E == +oo) = (<span class="mi">0</span> &lt; y)%R</div></blockquote><blockquote class="alectryon-goal"><q>ed</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(+oo * +oo == +oo) = (<span class="mi">0</span> &lt; +oo) || (<span class="mi">0</span> &lt; +oo)</div></blockquote><blockquote class="alectryon-goal"><q>ed</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(+oo * -oo == +oo) = false</div></blockquote><blockquote class="alectryon-goal"><q>783</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(-oo * y%:E == +oo) = (y &lt; <span class="mi">0</span>)%R</div></blockquote><blockquote class="alectryon-goal"><q>ed</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(-oo * +oo == +oo) = (<span class="mi">0</span> &lt; -oo)</div></blockquote><blockquote class="alectryon-goal"><q>ed</q><label class="goal-separator"><hr></label><div class="goal-conclusion">true = (-oo &lt; <span class="mi">0</span>) || (-oo &lt; <span class="mi">0</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>84b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty; <span class="nb">have</span> [/ltr0_sg|/gtr0_sg|] := ltgtP x <span class="mi">0</span>%R;
    <span class="nb">move</span>=&gt; -&gt;; <span class="nb">rewrite</span> ?(mulN1e,mul1e,sgr0,mul0e).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><q>850</q></blockquote><div class="alectryon-extra-goals"><q>851</q><q>853</q><q>855</q><q>857</q><q>859</q><q>85b</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>85f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty; <span class="nb">have</span> [/ltr0_sg|/gtr0_sg|] := ltgtP x <span class="mi">0</span>%R;
    <span class="nb">move</span>=&gt; -&gt;; <span class="nb">rewrite</span> ?(mulN1e,mul1e,sgr0,mul0e).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>783</q><span class="goal-separator"><hr></span><q>852</q></blockquote><div class="alectryon-extra-goals"><q>853</q><q>855</q><q>857</q><q>859</q><q>85b</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>864</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty; <span class="nb">have</span> [/ltr0_sg|/gtr0_sg|] := ltgtP y <span class="mi">0</span>%R;
    <span class="nb">move</span>=&gt; -&gt;; <span class="nb">rewrite</span> ?(mulN1e,mul1e,sgr0,mul0e).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><q>854</q></blockquote><div class="alectryon-extra-goals"><q>855</q><q>857</q><q>859</q><q>85b</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>869</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulyy ltry.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><q>856</q></blockquote><div class="alectryon-extra-goals"><q>857</q><q>859</q><q>85b</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>86e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulyNy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>783</q><span class="goal-separator"><hr></span><q>858</q></blockquote><div class="alectryon-extra-goals"><q>859</q><q>85b</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>873</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty; <span class="nb">have</span> [/ltr0_sg|/gtr0_sg|] := ltgtP y <span class="mi">0</span>%R;
    <span class="nb">move</span>=&gt; -&gt;; <span class="nb">rewrite</span> ?(mulN1e,mul1e,sgr0,mul0e).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><q>85a</q></blockquote><div class="alectryon-extra-goals"><q>85b</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>878</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulNyy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><q>85c</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>87d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltNyr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_eq_ninfty</span> <span class="nv">x</span> <span class="nv">y</span> : (x * y == -oo) =
  [|| (x &gt; <span class="mi">0</span>) &amp;&amp; (y == -oo), (x &lt; <span class="mi">0</span>) &amp;&amp; (y == +oo),
     (x == -oo) &amp;&amp; (y &gt; <span class="mi">0</span>) | (x == +oo) &amp;&amp; (y &lt; <span class="mi">0</span>)].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x * y == -oo) =
[|| (<span class="mi">0</span> &lt; x) &amp;&amp; (y == -oo), (x &lt; <span class="mi">0</span>) &amp;&amp; (y == +oo),
    (x == -oo) &amp;&amp; (<span class="mi">0</span> &lt; y)
  | (x == +oo) &amp;&amp; (y &lt; <span class="mi">0</span>)]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>881</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> := mule_eq_pinfty x (- y); <span class="nb">rewrite</span> muleN eqe_oppLR =&gt; -&gt;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">[|| (<span class="mi">0</span> &lt; x) &amp;&amp; (- y == +oo), (x &lt; <span class="mi">0</span>) &amp;&amp; (- y == -oo),
    (x == +oo) &amp;&amp; (<span class="mi">0</span> &lt; - y)
  | (x == -oo) &amp;&amp; (- y &lt; <span class="mi">0</span>)] =
[|| (<span class="mi">0</span> &lt; x) &amp;&amp; (y == -oo), (x &lt; <span class="mi">0</span>) &amp;&amp; (y == +oo),
    (x == -oo) &amp;&amp; (<span class="mi">0</span> &lt; y)
  | (x == +oo) &amp;&amp; (y &lt; <span class="mi">0</span>)]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !eqe_oppLR lte_oppr lte_oppl oppe0 (orbC _ ((x == -oo) &amp;&amp; _)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_opp</span> <span class="nv">x</span> <span class="nv">y</span> : (- x &lt; - y) = (y &lt; x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- x &lt; - y) = (y &lt; x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>88a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lte_oppl oppeK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_add</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">y</span> : a &lt; b -&gt; x &lt; y -&gt; a + x &lt; b + y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>a, b, x, y</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt; b -&gt; x &lt; y -&gt; a + x &lt; b + y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>88f</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: a b x y=&gt; [a| |] [b| |] [x| |] [y| |]; <span class="nb">rewrite</span> ?(ltry,ltNyr)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>a, b, x, y</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a%:E &lt; b%:E -&gt;
x%:E &lt; y%:E -&gt; a%:E + x%:E &lt; b%:E + y%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lte_fin; <span class="bp">exact</span>: ltr_add.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_addl</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= y -&gt; x &lt;= x + y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= y -&gt; x &lt;= x + y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>89c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">move</span>: x y =&gt; -[ x [y| |]//= | [| |]// | [| | ]//];
  <span class="bp">by</span> [<span class="nb">rewrite</span> !lee_fin ler_addl | <span class="nb">move</span>=&gt; _; <span class="bp">exact</span>: leey].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_addr</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= y -&gt; x &lt;= y + x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= y -&gt; x &lt;= y + x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8a1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> addeC; <span class="bp">exact</span>: lee_addl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gee_addl</span> <span class="nv">x</span> <span class="nv">y</span> : y &lt;= <span class="mi">0</span> -&gt; x + y &lt;= x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y &lt;= <span class="mi">0</span> -&gt; x + y &lt;= x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8a6</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">move</span>: x y =&gt; -[ x [y| |]//= | [| |]// | [| | ]//];
  <span class="bp">by</span> [<span class="nb">rewrite</span> !lee_fin ger_addl | <span class="nb">move</span>=&gt; _; <span class="bp">exact</span>: leNye].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gee_addr</span> <span class="nv">x</span> <span class="nv">y</span> : y &lt;= <span class="mi">0</span> -&gt; y + x &lt;= x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y &lt;= <span class="mi">0</span> -&gt; y + x &lt;= x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8ab</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> addeC; <span class="bp">exact</span>: gee_addl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_addl</span> <span class="nv">y</span> <span class="nv">x</span> : y \<span class="kr">is</span> a fin_num -&gt; (y &lt; y + x) = (<span class="mi">0</span> &lt; x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>750</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (y &lt; y + x) = (<span class="mi">0</span> &lt; x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8b0</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |] _ //; <span class="nb">rewrite</span> <span class="nl">?ltry</span> <span class="nl">?ltNyr</span> // !lte_fin ltr_addl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_addr</span> <span class="nv">y</span> <span class="nv">x</span> : y \<span class="kr">is</span> a fin_num -&gt; (y &lt; x + y) = (<span class="mi">0</span> &lt; x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>750</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (y &lt; x + y) = (<span class="mi">0</span> &lt; x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8b5</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> addeC; <span class="bp">exact</span>: lte_addl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gte_subl</span> <span class="nv">y</span> <span class="nv">x</span> : y \<span class="kr">is</span> a fin_num -&gt; (y - x &lt; y) = (<span class="mi">0</span> &lt; x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>750</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (y - x &lt; y) = (<span class="mi">0</span> &lt; x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8ba</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: y x =&gt; [x| |] [y| |] _ //; <span class="nb">rewrite</span> addeC /= <span class="nl">?ltNyr</span> <span class="nl">?ltry</span>//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">((- y)%:E + x%:E &lt; x%:E) = (<span class="mi">0</span> &lt; y%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lte_fin gtr_addr ltr_oppl oppr0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gte_subr</span> <span class="nv">y</span> <span class="nv">x</span> : y \<span class="kr">is</span> a fin_num -&gt; (- x + y &lt; y) = (<span class="mi">0</span> &lt; x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>750</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (- x + y &lt; y) = (<span class="mi">0</span> &lt; x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8c3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> addeC; <span class="bp">exact</span>: gte_subl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gte_addl</span> <span class="nv">x</span> <span class="nv">y</span> : x \<span class="kr">is</span> a fin_num -&gt; (x + y &lt; x) = (y &lt; <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (x + y &lt; x) = (y &lt; <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8c8</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [r| |] [s| |]// _; [<span class="nb">rewrite</span> !lte_fin gtr_addl|<span class="nb">rewrite</span> !ltNyr].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gte_addr</span> <span class="nv">x</span> <span class="nv">y</span> : x \<span class="kr">is</span> a fin_num -&gt; (y + x &lt; x) = (y &lt; <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (y + x &lt; x) = (y &lt; <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8cd</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> addeC; <span class="bp">exact</span>: gte_addl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_add2lE</span> <span class="nv">x</span> <span class="nv">a</span> <span class="nv">b</span> : x \<span class="kr">is</span> a fin_num -&gt; (x + a &lt; x + b) = (a &lt; b).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>x, a, b</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (x + a &lt; x + b) = (a &lt; b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8d2</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: a b x =&gt; [a| |] [b| |] [x| |] _ //; <span class="nb">rewrite</span> ?(ltry, ltNyr)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>a, b, x</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x%:E + a%:E &lt; x%:E + b%:E) = (a%:E &lt; b%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lte_fin ltr_add2l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_add2l</span> <span class="nv">x</span> <span class="nv">a</span> <span class="nv">b</span> : a &lt;= b -&gt; x + a &lt;= x + b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>8d4</q><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt;= b -&gt; x + a &lt;= x + b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8df</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: a b x =&gt; -[a [b [x /=|//|//] | []// |//] | []// | ].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>8db</q><span class="goal-separator"><hr></span><div class="goal-conclusion">a%:E &lt;= b%:E -&gt; x%:E + a%:E &lt;= x%:E + b%:E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>a</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">r</span>, a%:E &lt;= +oo -&gt; r%:E + a%:E &lt;= r%:E + +oo</div></blockquote><blockquote class="alectryon-goal"><q>ed</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> <span class="nv">x</span>, -oo &lt;= b -&gt; x + -oo &lt;= x + b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>8e4</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lee_fin ler_add2l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>8e9</q><span class="goal-separator"><hr></span><q>8eb</q></blockquote><div class="alectryon-extra-goals"><q>8ec</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>8f0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; r _; <span class="bp">exact</span>: leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><q>8ed</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>8f5</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; -[b [|  |]// | []// | //] r oob; <span class="bp">exact</span>: leNye.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_add2lE</span> <span class="nv">x</span> <span class="nv">a</span> <span class="nv">b</span> : x \<span class="kr">is</span> a fin_num -&gt; (x + a &lt;= x + b) = (a &lt;= b).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>8d4</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (x + a &lt;= x + b) = (a &lt;= b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8f9</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: a b x =&gt; [a| |] [b| |] [x| |] _ //; <span class="nb">rewrite</span> ?(leey, leNye)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>8db</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x%:E + a%:E &lt;= x%:E + b%:E) = (a%:E &lt;= b%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lee_fin ler_add2l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_add2r</span> <span class="nv">x</span> <span class="nv">a</span> <span class="nv">b</span> : a &lt;= b -&gt; a + x &lt;= b + x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>8d4</q><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt;= b -&gt; a + x &lt;= b + x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>902</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> addeC (addeC b); <span class="bp">exact</span>: lee_add2l.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_add</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">y</span> : a &lt;= b -&gt; x &lt;= y -&gt; a + x &lt;= b + y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>891</q><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt;= b -&gt; x &lt;= y -&gt; a + x &lt;= b + y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>907</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: a b x y =&gt; [a| |] [b| |] [x| |] [y| |]; <span class="nb">rewrite</span> ?(leey, leNye)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>898</q><span class="goal-separator"><hr></span><div class="goal-conclusion">a%:E &lt;= b%:E -&gt;
x%:E &lt;= y%:E -&gt; a%:E + x%:E &lt;= b%:E + y%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lee_fin; <span class="bp">exact</span>: ler_add.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_le_add</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">y</span> : b \<span class="kr">is</span> a fin_num -&gt; a &lt; x -&gt; b &lt;= y -&gt; a + b &lt; x + y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>891</q><span class="goal-separator"><hr></span><div class="goal-conclusion">b \<span class="kr">is</span> a fin_num -&gt; a &lt; x -&gt; b &lt;= y -&gt; a + b &lt; x + y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>910</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y a b =&gt; [x| |] [y| |] [a| |] [b| |] _ //=; <span class="nb">rewrite</span> ?(ltry, ltNyr)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>x, y, a, b</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a%:E &lt; x%:E -&gt;
b%:E &lt;= y%:E -&gt; a%:E + b%:E &lt; x%:E + y%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lte_fin; <span class="bp">exact</span>: ltr_le_add.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_lt_add</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">y</span> : a \<span class="kr">is</span> a fin_num -&gt; a &lt;= x -&gt; b &lt; y -&gt; a + b &lt; x + y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>891</q><span class="goal-separator"><hr></span><div class="goal-conclusion">a \<span class="kr">is</span> a fin_num -&gt; a &lt;= x -&gt; b &lt; y -&gt; a + b &lt; x + y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>91b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; afin xa yb; <span class="nb">rewrite</span> (addeC a) (addeC x) lte_le_add.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_sub</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">u</span> : x &lt;= y -&gt; u &lt;= z -&gt; x - z &lt;= y - u.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>x, y, z, u</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= y -&gt; u &lt;= z -&gt; x - z &lt;= y - u</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>920</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y z u =&gt; -[x| |] -[y| |] -[z| |] -[u| |] //=; <span class="nb">rewrite</span> ?(leey,leNye)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>x, y, z, u</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x%:E &lt;= y%:E -&gt;
u%:E &lt;= z%:E -&gt; x%:E + (- z)%:E &lt;= y%:E + (- u)%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lee_fin; <span class="bp">exact</span>: ler_sub.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_le_sub</span> <span class="nv">z</span> <span class="nv">u</span> <span class="nv">x</span> <span class="nv">y</span> : u \<span class="kr">is</span> a fin_num -&gt;
  x &lt; z -&gt; u &lt;= y -&gt; x - y &lt; z - u.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>z, u, x, y</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">u \<span class="kr">is</span> a fin_num -&gt; x &lt; z -&gt; u &lt;= y -&gt; x - y &lt; z - u</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>92d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: z u x y =&gt; [z| |] [u| |] [x| |] [y| |] _ //=; <span class="nb">rewrite</span> ?(ltry, ltNyr)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>z, u, x, y</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x%:E &lt; z%:E -&gt;
u%:E &lt;= y%:E -&gt; x%:E + (- y)%:E &lt; z%:E + (- u)%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lte_fin =&gt; xltr tley; <span class="nb">apply</span>: ltr_le_add; <span class="nb">rewrite</span> // ler_oppl opprK.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_pmul2r</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; z -&gt; {mono *%E^~ z : x y / x &lt; y}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>z</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt;
<span class="mi">0</span> &lt; z -&gt; {mono *%E^~ z : x y / x &lt; y &gt;-&gt; x &lt; y}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>93a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: z =&gt; [z| |] _ // z0 [x| |] [y| |] //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>z</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>z0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; z%:E</span></span></span><br><q>95</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x%:E * z%:E &lt; y%:E * z%:E) = (x%:E &lt; y%:E)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>944</q><br><q>945</q><br><q>9a</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(x%:E * z%:E &lt; +oo * z%:E) = (x%:E &lt; +oo)</div></blockquote><blockquote class="alectryon-goal"><q>949</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x%:E * z%:E &lt; -oo * z%:E) = (x%:E &lt; -oo)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>944</q><br><q>945</q><br><q>9e</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(+oo * z%:E &lt; y%:E * z%:E) = (+oo &lt; y%:E)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>944</q><br><q>945</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(+oo * z%:E &lt; -oo * z%:E) = (+oo &lt; -oo)</div></blockquote><blockquote class="alectryon-goal"><q>94e</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(-oo * z%:E &lt; y%:E * z%:E) = (-oo &lt; y%:E)</div></blockquote><blockquote class="alectryon-goal"><q>951</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(-oo * z%:E &lt; +oo * z%:E) = (-oo &lt; +oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>941</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lte_fin ltr_pmul2r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>949</q><span class="goal-separator"><hr></span><q>94a</q></blockquote><div class="alectryon-extra-goals"><q>94b</q><q>94d</q><q>950</q><q>953</q><q>955</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>959</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e <span class="mi">2</span>!ltry.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>949</q><span class="goal-separator"><hr></span><q>94c</q></blockquote><div class="alectryon-extra-goals"><q>94d</q><q>950</q><q>953</q><q>955</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>95e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e ltNge leNye ltNge leNye.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>94e</q><span class="goal-separator"><hr></span><q>94f</q></blockquote><div class="alectryon-extra-goals"><q>950</q><q>953</q><q>955</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>963</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e ltNge leey ltNge leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>951</q><span class="goal-separator"><hr></span><q>952</q></blockquote><div class="alectryon-extra-goals"><q>953</q><q>955</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>968</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e mulr_infty gtr0_sg// mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>94e</q><span class="goal-separator"><hr></span><q>954</q></blockquote><div class="alectryon-extra-goals"><q>955</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>96d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e <span class="mi">2</span>!ltNyr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>951</q><span class="goal-separator"><hr></span><q>956</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>972</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e mulr_infty gtr0_sg// mul1e.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_pmul2l</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; z -&gt; {mono *%E z : x y / x &lt; y}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>93c</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt;
<span class="mi">0</span> &lt; z -&gt; {mono *%E z : x y / x &lt; y &gt;-&gt; x &lt; y}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>976</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; zfin z0 x y; <span class="nb">rewrite</span> <span class="mi">2</span>!(muleC z) lte_pmul2r.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_nmul2l</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; z &lt; <span class="mi">0</span> -&gt; {mono *%E z : x y /~ x &lt; y}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>93c</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt;
z &lt; <span class="mi">0</span> -&gt; {mono *%E z : y x / x &lt; y &gt;-&gt; y &lt; x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>97b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -oppe0 lte_oppr =&gt; zfin z0 x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>93d</q><br><span><var>zfin</var><span class="hyp-type"><b>: </b><span>z \<span class="kr">is</span> a fin_num</span></span></span><br><span><var>z0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; - z</span></span></span><br><q>23</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(z * x &lt; z * y) = (y &lt; x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -(oppeK z) !mulNe lte_oppl oppeK -<span class="mi">2</span>!mulNe lte_pmul2l <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_nmul2r</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; z &lt; <span class="mi">0</span> -&gt; {mono *%E^~ z : x y /~ x &lt; y}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>93c</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt;
z &lt; <span class="mi">0</span> -&gt; {mono *%E^~ z : y x / x &lt; y &gt;-&gt; y &lt; x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>987</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; zfin z0 x y; <span class="nb">rewrite</span> -!(muleC z) lte_nmul2l.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_sum</span> <span class="nv">I</span> (<span class="nv">f</span> <span class="nv">g</span> : I -&gt; \bar R) <span class="nv">s</span> (<span class="nv">P</span> : pred I) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; f i &lt;= g i) -&gt;
  \sum_(i &lt;- s | P i) f i &lt;= \sum_(i &lt;- s | P i) g i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>I -&gt; \bar R</span></span></span><br><q>19b</q><br><q>1df</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; f i &lt;= g i) -&gt;
\sum_(i &lt;- s | P i) f i &lt;= \sum_(i &lt;- s | P i) g i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>98c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; Pfg; <span class="nb">elim</span>/big_ind2 : _ =&gt; // *; <span class="nb">apply</span> lee_add.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_sum_nneg_subset</span> <span class="nv">I</span> (<span class="nv">s</span> : seq I) (<span class="nv">P</span> <span class="nv">Q</span> : {pred I}) (<span class="nv">f</span> : I -&gt; \bar R) :
  {subset Q &lt;= P} -&gt; {<span class="kr">in</span> [predD P &amp; Q], <span class="kr">forall</span> <span class="nv">i</span>, <span class="mi">0</span> &lt;= f i} -&gt;
  \sum_(i &lt;- s | Q i) f i &lt;= \sum_(i &lt;- s | P i) f i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>19b</q><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>{pred I}</span></span></span><br><q>1e0</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{subset Q &lt;= P} -&gt;
{<span class="kr">in</span> [predD P &amp; Q], <span class="kr">forall</span> <span class="nv">i</span> : I, <span class="mi">0</span> &lt;= f i} -&gt;
\sum_(i &lt;- s | Q i) f i &lt;= \sum_(i &lt;- s | P i) f i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>993</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; QP PQf; <span class="nb">rewrite</span> big_mkcond [leRHS]big_mkcond lee_sum// =&gt; i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>19b</q><br><q>996</q><br><q>1e0</q><br><span><var>QP</var><span class="hyp-type"><b>: </b><span>{subset Q &lt;= P}</span></span></span><br><span><var>PQf</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> [predD P &amp; Q], <span class="kr">forall</span> <span class="nv">i</span> : I, <span class="mi">0</span> &lt;= f i}</span></span></span><br><q>3e3</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">true -&gt;
(<span class="kr">if</span> Q i <span class="kr">then</span> f i <span class="kr">else</span> <span class="mi">0</span>) &lt;= (<span class="kr">if</span> P i <span class="kr">then</span> f i <span class="kr">else</span> <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>/implyP: (QP i); <span class="nb">move</span>: (PQf i); <span class="nb">rewrite</span> !inE -!topredE/=; <span class="kp">do</span> !<span class="nb">case</span>: ifP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_sum_npos_subset</span> <span class="nv">I</span> (<span class="nv">s</span> : seq I) (<span class="nv">P</span> <span class="nv">Q</span> : {pred I}) (<span class="nv">f</span> : I -&gt; \bar R) :
  {subset Q &lt;= P} -&gt; {<span class="kr">in</span> [predD P &amp; Q], <span class="kr">forall</span> <span class="nv">i</span>, f i &lt;= <span class="mi">0</span>} -&gt;
  \sum_(i &lt;- s | P i) f i &lt;= \sum_(i &lt;- s | Q i) f i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>995</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{subset Q &lt;= P} -&gt;
{<span class="kr">in</span> [predD P &amp; Q], <span class="kr">forall</span> <span class="nv">i</span> : I, f i &lt;= <span class="mi">0</span>} -&gt;
\sum_(i &lt;- s | P i) f i &lt;= \sum_(i &lt;- s | Q i) f i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>9a1</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; QP PQf; <span class="nb">rewrite</span> big_mkcond [leRHS]big_mkcond lee_sum// =&gt; i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>19b</q><br><q>996</q><br><q>1e0</q><br><q>99d</q><br><span><var>PQf</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> [predD P &amp; Q], <span class="kr">forall</span> <span class="nv">i</span> : I, f i &lt;= <span class="mi">0</span>}</span></span></span><br><q>3e3</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">true -&gt;
(<span class="kr">if</span> P i <span class="kr">then</span> f i <span class="kr">else</span> <span class="mi">0</span>) &lt;= (<span class="kr">if</span> Q i <span class="kr">then</span> f i <span class="kr">else</span> <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>/implyP: (QP i); <span class="nb">move</span>: (PQf i); <span class="nb">rewrite</span> !inE -!topredE/=; <span class="kp">do</span> !<span class="nb">case</span>: ifP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_sum_nneg</span> (<span class="nv">I</span> : eqType) (<span class="nv">s</span> : seq I) (<span class="nv">P</span> <span class="nv">Q</span> : pred I)
  (<span class="nv">f</span> : I -&gt; \bar R) : (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; ~~ Q i -&gt; <span class="mi">0</span> &lt;= f i) -&gt;
  \sum_(i &lt;- s | P i &amp;&amp; Q i) f i &lt;= \sum_(i &lt;- s | P i) f i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>I</var><span class="hyp-type"><b>: </b><span>eqType</span></span></span><br><q>19b</q><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>pred I</span></span></span><br><q>1e0</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; ~~ Q i -&gt; <span class="mi">0</span> &lt;= f i) -&gt;
\sum_(i &lt;- s | P i &amp;&amp; Q i) f i &lt;=
\sum_(i &lt;- s | P i) f i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>9ac</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; PQf; <span class="nb">rewrite</span> [leRHS](bigID Q) /= -[leLHS]adde0 lee_add //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9af</q><br><q>19b</q><br><q>9b0</q><br><q>1e0</q><br><span><var>PQf</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; ~~ Q i -&gt; <span class="mi">0</span> &lt;= f i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= \sum_(i &lt;- s | P i &amp;&amp; ~~ Q i) f i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> sume_ge0// =&gt; i /andP[]; <span class="bp">exact</span>: PQf.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_sum_npos</span> (<span class="nv">I</span> : eqType) (<span class="nv">s</span> : seq I) (<span class="nv">P</span> <span class="nv">Q</span> : pred I)
  (<span class="nv">f</span> : I -&gt; \bar R) : (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; ~~ Q i -&gt; f i &lt;= <span class="mi">0</span>) -&gt;
  \sum_(i &lt;- s | P i) f i &lt;= \sum_(i &lt;- s | P i &amp;&amp; Q i) f i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9ae</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; ~~ Q i -&gt; f i &lt;= <span class="mi">0</span>) -&gt;
\sum_(i &lt;- s | P i) f i &lt;=
\sum_(i &lt;- s | P i &amp;&amp; Q i) f i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>9ba</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; PQf; <span class="nb">rewrite</span> [leLHS](bigID Q) /= -[leRHS]adde0 lee_add //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9af</q><br><q>19b</q><br><q>9b0</q><br><q>1e0</q><br><span><var>PQf</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; ~~ Q i -&gt; f i &lt;= <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt;- s | P i &amp;&amp; ~~ Q i) f i &lt;= <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> sume_le0// =&gt; i /andP[]; <span class="bp">exact</span>: PQf.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_sum_nneg_ord</span> (<span class="nv">f</span> : nat -&gt; \bar R) (<span class="nv">P</span> : pred nat) :
  (<span class="kr">forall</span> <span class="nv">n</span>, P n -&gt; <span class="mi">0</span> &lt;= f n) -&gt;
  {homo (<span class="kr">fun</span> <span class="nv">n</span> =&gt; \sum_(i &lt; n | P i) (f i)) : i j / (i &lt;= j)%N &gt;-&gt; i &lt;= j}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><span><var>P</var><span class="hyp-type"><b>: </b><span>pred nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; <span class="mi">0</span> &lt;= f n) -&gt;
{homo (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n | P i) f i) : i j / 
(i &lt;= j)%N &gt;-&gt; i &lt;= j}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>9c5</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; f0 i j le_ij; <span class="nb">rewrite</span> (big_ord_widen_cond j) // big_mkcondr /=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><q>9c8</q><br><span><var>f0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; <span class="mi">0</span> &lt;= f n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>le_ij</var><span class="hyp-type"><b>: </b><span>(i &lt;= j)%N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i0 &lt; j | P i0) (<span class="kr">if</span> (i0 &lt; i)%N <span class="kr">then</span> f i0 <span class="kr">else</span> <span class="mi">0</span>) &lt;=
\sum_(i &lt; j | P i) f i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lee_sum // =&gt; k ?; <span class="nb">case</span>: ifP =&gt; // _; <span class="bp">exact</span>: f0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_sum_npos_ord</span> (<span class="nv">f</span> : nat -&gt; \bar R) (<span class="nv">P</span> : pred nat) :
  (<span class="kr">forall</span> <span class="nv">n</span>, P n -&gt; f n &lt;= <span class="mi">0</span>) -&gt;
  {homo (<span class="kr">fun</span> <span class="nv">n</span> =&gt; \sum_(i &lt; n | P i) (f i)) : i j / (i &lt;= j)%N &gt;-&gt; j &lt;= i}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9c7</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; f n &lt;= <span class="mi">0</span>) -&gt;
{homo (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n | P i) f i) : i j / 
(i &lt;= j)%N &gt;-&gt; j &lt;= i}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>9d4</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; f0 m n ?; <span class="nb">rewrite</span> [leRHS](big_ord_widen_cond n) // big_mkcondr /=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><q>9c8</q><br><span><var>f0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; f n &lt;= <span class="mi">0</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>_Hyp_</var><span class="hyp-type"><b>: </b><span>(m &lt;= n)%N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt; n | P i) f i &lt;=
\sum_(i &lt; n | P i) (<span class="kr">if</span> (i &lt; m)%N <span class="kr">then</span> f i <span class="kr">else</span> <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lee_sum // =&gt; i ?; <span class="nb">case</span>: ifP =&gt; // _; <span class="bp">exact</span>: f0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_sum_nneg_natr</span> (<span class="nv">f</span> : nat -&gt; \bar R) (<span class="nv">P</span> : pred nat) <span class="nv">m</span> :
  (<span class="kr">forall</span> <span class="nv">n</span>, (m &lt;= n)%N -&gt; P n -&gt; <span class="mi">0</span> &lt;= f n) -&gt;
  {homo (<span class="kr">fun</span> <span class="nv">n</span> =&gt; \sum_(m &lt;= i &lt; n | P i) (f i)) : i j / (i &lt;= j)%N &gt;-&gt; i &lt;= j}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><q>9c8</q><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">n</span> : nat, (m &lt;= n)%N -&gt; P n -&gt; <span class="mi">0</span> &lt;= f n) -&gt;
{homo (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(m &lt;= i &lt; n | P i) f i) : i j / 
(i &lt;= j)%N &gt;-&gt; i &lt;= j}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>9e1</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; f0 i j le_ij; <span class="nb">rewrite</span> -[m]add0n !big_addn !big_mkord.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><q>9c8</q><br><q>9e4</q><br><span><var>f0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, (m &lt;= n)%N -&gt; P n -&gt; <span class="mi">0</span> &lt;= f n</span></span></span><br><q>9d0</q><br><q>9d1</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i0 &lt; i - m | P (i0 + m)%N) f (i0 + m)%N &lt;=
\sum_(i &lt; j - m | P (i + m)%N) f (i + m)%N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>: (@lee_sum_nneg_ord (<span class="kr">fun</span> <span class="nv">k</span> =&gt; f (k + m)%N) (<span class="kr">fun</span> <span class="nv">k</span> =&gt; P (k + m)%N));
  <span class="bp">by</span> [<span class="nb">move</span>=&gt; n /f0; <span class="nb">apply</span>; <span class="nb">rewrite</span> leq_addl | <span class="nb">rewrite</span> leq_sub2r].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_sum_npos_natr</span> (<span class="nv">f</span> : nat -&gt; \bar R) (<span class="nv">P</span> : pred nat) <span class="nv">m</span> :
  (<span class="kr">forall</span> <span class="nv">n</span>, (m &lt;= n)%N -&gt; P n -&gt; f n &lt;= <span class="mi">0</span>) -&gt;
  {homo (<span class="kr">fun</span> <span class="nv">n</span> =&gt; \sum_(m &lt;= i &lt; n | P i) (f i)) : i j / (i &lt;= j)%N &gt;-&gt; j &lt;= i}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9e3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">n</span> : nat, (m &lt;= n)%N -&gt; P n -&gt; f n &lt;= <span class="mi">0</span>) -&gt;
{homo (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(m &lt;= i &lt; n | P i) f i) : i j / 
(i &lt;= j)%N &gt;-&gt; j &lt;= i}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>9ee</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; f0 i j le_ij; <span class="nb">rewrite</span> -[m]add0n !big_addn !big_mkord.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><q>9c8</q><br><q>9e4</q><br><span><var>f0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, (m &lt;= n)%N -&gt; P n -&gt; f n &lt;= <span class="mi">0</span></span></span></span><br><q>9d0</q><br><q>9d1</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt; j - m | P (i + m)%N) f (i + m)%N &lt;=
\sum_(i0 &lt; i - m | P (i0 + m)%N) f (i0 + m)%N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>: (@lee_sum_npos_ord (<span class="kr">fun</span> <span class="nv">k</span> =&gt; f (k + m)%N) (<span class="kr">fun</span> <span class="nv">k</span> =&gt; P (k + m)%N));
  <span class="bp">by</span> [<span class="nb">move</span>=&gt; n /f0; <span class="nb">apply</span>; <span class="nb">rewrite</span> leq_addl | <span class="nb">rewrite</span> leq_sub2r].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_sum_nneg_natl</span> (<span class="nv">f</span> : nat -&gt; \bar R) (<span class="nv">P</span> : pred nat) <span class="nv">n</span> :
  (<span class="kr">forall</span> <span class="nv">m</span>, (m &lt; n)%N -&gt; P m -&gt; <span class="mi">0</span> &lt;= f m) -&gt;
  {homo (<span class="kr">fun</span> <span class="nv">m</span> =&gt; \sum_(m &lt;= i &lt; n | P i) (f i)) : i j / (i &lt;= j)%N &gt;-&gt; j &lt;= i}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><q>9c8</q><br><q>128</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">m</span> : nat, (m &lt; n)%N -&gt; P m -&gt; <span class="mi">0</span> &lt;= f m) -&gt;
{homo (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; \sum_(m &lt;= i &lt; n | P i) f i) : i j / 
(i &lt;= j)%N &gt;-&gt; j &lt;= i}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>9f9</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; f0 i j le_ij; <span class="nb">rewrite</span> !big_geq_mkord/=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><q>9c8</q><br><q>128</q><br><span><var>f0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">m</span> : nat, (m &lt; n)%N -&gt; P m -&gt; <span class="mi">0</span> &lt;= f m</span></span></span><br><q>9d0</q><br><q>9d1</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt; n | P i &amp;&amp; (j &lt;= i)%N) f i &lt;=
\sum_(i0 &lt; n | P i0 &amp;&amp; (i &lt;= i0)%N) f i0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> lee_sum_nneg_subset// =&gt; [k | k /and3P[_ /f0-&gt;//]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><q>9c8</q><br><q>128</q><br><q>a02</q><br><q>9d0</q><br><q>9d1</q><br><span><var>k</var><span class="hyp-type"><b>: </b><span>&#39;I_n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">k \<span class="kr">in</span> (<span class="kr">fun</span> <span class="nv">i</span> : &#39;I_n =&gt; P i &amp;&amp; (j &lt;= i)%N) -&gt;
k \<span class="kr">in</span> (<span class="kr">fun</span> <span class="nv">i0</span> : &#39;I_n =&gt; P i0 &amp;&amp; (i &lt;= i0)%N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> <span class="nl">?inE</span> -!topredE/= =&gt; /andP[-&gt; /(leq_trans le_ij)-&gt;].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_sum_npos_natl</span> (<span class="nv">f</span> : nat -&gt; \bar R) (<span class="nv">P</span> : pred nat) <span class="nv">n</span> :
  (<span class="kr">forall</span> <span class="nv">m</span>, (m &lt; n)%N -&gt; P m -&gt; f m &lt;= <span class="mi">0</span>) -&gt;
  {homo (<span class="kr">fun</span> <span class="nv">m</span> =&gt; \sum_(m &lt;= i &lt; n | P i) (f i)) : i j / (i &lt;= j)%N &gt;-&gt; i &lt;= j}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9fb</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">m</span> : nat, (m &lt; n)%N -&gt; P m -&gt; f m &lt;= <span class="mi">0</span>) -&gt;
{homo (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; \sum_(m &lt;= i &lt; n | P i) f i) : i j / 
(i &lt;= j)%N &gt;-&gt; i &lt;= j}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a0b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; f0 i j le_ij; <span class="nb">rewrite</span> !big_geq_mkord/=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><q>9c8</q><br><q>128</q><br><span><var>f0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">m</span> : nat, (m &lt; n)%N -&gt; P m -&gt; f m &lt;= <span class="mi">0</span></span></span></span><br><q>9d0</q><br><q>9d1</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i0 &lt; n | P i0 &amp;&amp; (i &lt;= i0)%N) f i0 &lt;=
\sum_(i &lt; n | P i &amp;&amp; (j &lt;= i)%N) f i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> lee_sum_npos_subset// =&gt; [k | k /and3P[_ /f0-&gt;//]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><q>9c8</q><br><q>128</q><br><q>a13</q><br><q>9d0</q><br><q>9d1</q><br><q>a08</q><br></div><span class="goal-separator"><hr></span><q>a09</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> <span class="nl">?inE</span> -!topredE/= =&gt; /andP[-&gt; /(leq_trans le_ij)-&gt;].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_sum_nneg_subfset</span> (<span class="nv">T</span> : choiceType) (<span class="nv">A</span> <span class="nv">B</span> : {fset T}%fset) (<span class="nv">P</span> : pred T)
  (<span class="nv">f</span> : T -&gt; \bar R) : {subset A &lt;= B} -&gt;
  {<span class="kr">in</span> [predD B &amp; A], <span class="kr">forall</span> <span class="nv">t</span>, P t -&gt; <span class="mi">0</span> &lt;= f t} -&gt;
  \sum_(t &lt;- A | P t) f t &lt;= \sum_(t &lt;- B | P t) f t.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>T</var><span class="hyp-type"><b>: </b><span>choiceType</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span>{fset T}</span></span></span><br><q>2f7</q><br><q>2f8</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{subset A &lt;= B} -&gt;
{<span class="kr">in</span> [predD B &amp; A], <span class="kr">forall</span> <span class="nv">t</span> : T, P t -&gt; <span class="mi">0</span> &lt;= f t} -&gt;
\sum_(t &lt;- A | P t) f t &lt;= \sum_(t &lt;- B | P t) f t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a1a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; AB f0; <span class="nb">rewrite</span> [leRHS]big_mkcond (big_fsetID _ (mem A) B) /=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>a1d</q><br><q>a1e</q><br><q>2f7</q><br><q>2f8</q><br><span><var>AB</var><span class="hyp-type"><b>: </b><span>{subset A &lt;= B}</span></span></span><br><span><var>f0</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> [predD B &amp; A], <span class="kr">forall</span> <span class="nv">t</span> : T, P t -&gt; <span class="mi">0</span> &lt;= f t}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(t &lt;- A | P t) f t &lt;=
\sum_(i &lt;- [fset x | x <span class="kr">in</span> B &amp; x \<span class="kr">in</span> A]%fset)
   (<span class="kr">if</span> P i <span class="kr">then</span> f i <span class="kr">else</span> <span class="mi">0</span>) +
\sum_(i &lt;- [fset x | x <span class="kr">in</span> B &amp; x \notin A]%fset)
   (<span class="kr">if</span> P i <span class="kr">then</span> f i <span class="kr">else</span> <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -[leLHS]adde0 lee_add //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a24</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(t &lt;- A | P t) f t &lt;=
\sum_(i &lt;- [fset x | x <span class="kr">in</span> B &amp; x \<span class="kr">in</span> A]%fset)
   (<span class="kr">if</span> P i <span class="kr">then</span> f i <span class="kr">else</span> <span class="mi">0</span>)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>a24</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="mi">0</span> &lt;=
\sum_(i &lt;- [fset x | x <span class="kr">in</span> B &amp; x \notin A]%fset)
   (<span class="kr">if</span> P i <span class="kr">then</span> f i <span class="kr">else</span> <span class="mi">0</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -big_mkcond /= {<span class="mi">1</span>}(_ : A = [fset x <span class="kr">in</span> B | x \<span class="kr">in</span> A]%fset) //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a24</q><span class="goal-separator"><hr></span><div class="goal-conclusion">A = [fset x | x <span class="kr">in</span> B &amp; x \<span class="kr">in</span> A]%fset</div></blockquote><q>a2c</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/fsetP=&gt; t; <span class="nb">rewrite</span> !inE /= andbC; <span class="nb">case</span>: (boolP (_ \<span class="kr">in</span> _)) =&gt; // /AB.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a24</q><span class="goal-separator"><hr></span><q>a2e</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> big_fset /= big_seq_cond sume_ge0 // =&gt; t /andP[tB tA].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>a1d</q><br><q>a1e</q><br><q>2f7</q><br><q>2f8</q><br><q>a25</q><br><q>a26</q><br><q>63c</q><br><span><var>tB</var><span class="hyp-type"><b>: </b><span>t \<span class="kr">in</span> B</span></span></span><br><span><var>tA</var><span class="hyp-type"><b>: </b><span>t \notin A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= (<span class="kr">if</span> P t <span class="kr">then</span> f t <span class="kr">else</span> <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: ifPn =&gt; // Pt; <span class="nb">rewrite</span> f0 // !inE tA.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_sum_npos_subfset</span> (<span class="nv">T</span> : choiceType) (<span class="nv">A</span> <span class="nv">B</span> : {fset T}%fset) (<span class="nv">P</span> : pred T)
  (<span class="nv">f</span> : T -&gt; \bar R) : {subset A &lt;= B} -&gt;
  {<span class="kr">in</span> [predD B &amp; A], <span class="kr">forall</span> <span class="nv">t</span>, P t -&gt; f t &lt;= <span class="mi">0</span>} -&gt;
  \sum_(t &lt;- B | P t) f t &lt;= \sum_(t &lt;- A | P t) f t.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a1c</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{subset A &lt;= B} -&gt;
{<span class="kr">in</span> [predD B &amp; A], <span class="kr">forall</span> <span class="nv">t</span> : T, P t -&gt; f t &lt;= <span class="mi">0</span>} -&gt;
\sum_(t &lt;- B | P t) f t &lt;= \sum_(t &lt;- A | P t) f t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a3e</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; AB f0; <span class="nb">rewrite</span> big_mkcond (big_fsetID _ (mem A) B) /=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>a1d</q><br><q>a1e</q><br><q>2f7</q><br><q>2f8</q><br><q>a25</q><br><span><var>f0</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> [predD B &amp; A], <span class="kr">forall</span> <span class="nv">t</span> : T, P t -&gt; f t &lt;= <span class="mi">0</span>}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt;- [fset x | x <span class="kr">in</span> B &amp; x \<span class="kr">in</span> A]%fset)
   (<span class="kr">if</span> P i <span class="kr">then</span> f i <span class="kr">else</span> <span class="mi">0</span>) +
\sum_(i &lt;- [fset x | x <span class="kr">in</span> B &amp; x \notin A]%fset)
   (<span class="kr">if</span> P i <span class="kr">then</span> f i <span class="kr">else</span> <span class="mi">0</span>) &lt;= \sum_(t &lt;- A | P t) f t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -[leRHS]adde0 lee_add //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a45</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\sum_(i &lt;- [fset x | x <span class="kr">in</span> B &amp; x \<span class="kr">in</span> A]%fset)
   (<span class="kr">if</span> P i <span class="kr">then</span> f i <span class="kr">else</span> <span class="mi">0</span>) &lt;= \sum_(t &lt;- A | P t) f t</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>a45</q><label class="goal-separator"><hr></label><div class="goal-conclusion">\sum_(i &lt;- [fset x | x <span class="kr">in</span> B &amp; x \notin A]%fset)
   (<span class="kr">if</span> P i <span class="kr">then</span> f i <span class="kr">else</span> <span class="mi">0</span>) &lt;= <span class="mi">0</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -big_mkcond /= {<span class="mi">3</span>}(_ : A = [fset x <span class="kr">in</span> B | x \<span class="kr">in</span> A]%fset) //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a45</q><span class="goal-separator"><hr></span><q>a32</q></blockquote><q>a4c</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/fsetP=&gt; t; <span class="nb">rewrite</span> !inE /= andbC; <span class="nb">case</span>: (boolP (_ \<span class="kr">in</span> _)) =&gt; // /AB.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a45</q><span class="goal-separator"><hr></span><q>a4e</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> big_fset /= big_seq_cond sume_le0 // =&gt; t /andP[tB tA].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>a1d</q><br><q>a1e</q><br><q>2f7</q><br><q>2f8</q><br><q>a25</q><br><q>a46</q><br><q>63c</q><br><q>a3a</q><br><q>a3b</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> P t <span class="kr">then</span> f t <span class="kr">else</span> <span class="mi">0</span>) &lt;= <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: ifPn =&gt; // Pt; <span class="nb">rewrite</span> f0 // !inE tA.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_subl_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; z) = (x &lt; z + y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; z) = (x &lt; z + y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a5b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y z =&gt; [x| |] [y| |] [z| |] _ //=; <span class="nb">rewrite</span> <span class="nl">?ltry</span> <span class="nl">?ltNyr</span> //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x%:E + (- y)%:E &lt; z%:E) = (x%:E &lt; z%:E + y%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lte_fin ltr_subl_addr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_subl_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; z) = (x &lt; y + z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; z) = (x &lt; y + z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a67</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> lte_subl_addr// addeC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_subr_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; (x &lt; y - z) = (x + z &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt; (x &lt; y - z) = (x + z &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a6c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y z =&gt; [x| |] [y| |] [z| |] _ //=; <span class="nb">rewrite</span> <span class="nl">?ltNyr</span> <span class="nl">?ltry</span> //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a63</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x%:E &lt; y%:E + (- z)%:E) = (x%:E + z%:E &lt; y%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lte_fin ltr_subr_addr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_subr_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; (x &lt; y - z) = (z + x &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt; (x &lt; y - z) = (z + x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a75</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> lte_subr_addr// addeC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_subel_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; z) = (x &lt; z + y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; z) = (x &lt; z + y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a7a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y z =&gt; [x| |] [y| |] [z| |] _ //=; <span class="nb">rewrite</span> <span class="nl">?ltNyr</span> <span class="nl">?ltry</span> //.</label><small class="alectryon-output"><div><q>a61</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lte_fin ltr_subl_addr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_subel_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; z) = (x &lt; y + z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; z) = (x &lt; y + z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a80</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> lte_subel_addr// addeC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_suber_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; (x &lt; y - z) = (x + z &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (x &lt; y - z) = (x + z &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a85</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y z =&gt; [x| |] [y| |] [z| |] _ //=; <span class="nb">rewrite</span> <span class="nl">?ltNyr</span> <span class="nl">?ltry</span> //.</label><q>a70</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lte_fin ltr_subr_addr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_suber_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; (x &lt; y - z) = (z + x &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (x &lt; y - z) = (z + x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a8a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> lte_suber_addr// addeC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_subl_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= z) = (x &lt;= z + y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= z) = (x &lt;= z + y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a8f</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y z =&gt; [x| |] [y| |] [z| |] _ //=; <span class="nb">rewrite</span> <span class="nl">?leey</span> <span class="nl">?leNye</span> //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a63</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x%:E + (- y)%:E &lt;= z%:E) = (x%:E &lt;= z%:E + y%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lee_fin ler_subl_addr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_subl_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= z) = (x &lt;= y + z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= z) = (x &lt;= y + z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a98</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> lee_subl_addr// addeC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_subr_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; (x &lt;= y - z) = (x + z &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt; (x &lt;= y - z) = (x + z &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a9d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: y x z =&gt; [y| |] [x| |] [z| |] _ //=; <span class="nb">rewrite</span> <span class="nl">?leNye</span> <span class="nl">?leey</span> //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>y, x, z</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x%:E &lt;= y%:E + (- z)%:E) = (x%:E + z%:E &lt;= y%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lee_fin ler_subr_addr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_subr_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; (x &lt;= y - z) = (z + x &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt; (x &lt;= y - z) = (z + x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>aa8</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> lee_subr_addr// addeC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_subel_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= z) = (x &lt;= z + y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= z) = (x &lt;= z + y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>aad</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y z =&gt; [x| |] [y| |] [z| |] _ //=; <span class="nb">rewrite</span> <span class="nl">?leey</span> <span class="nl">?leNye</span> //.</label><q>a93</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lee_fin ler_subl_addr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_subel_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= z) = (x &lt;= y + z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= z) = (x &lt;= y + z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ab2</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> lee_subel_addr// addeC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_suber_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y \<span class="kr">is</span> a fin_num -&gt; (x &lt;= y - z) = (x + z &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (x &lt;= y - z) = (x + z &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ab7</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: y x z =&gt; [y| |] [x| |] [z| |] _ //=; <span class="nb">rewrite</span> <span class="nl">?leNye</span> <span class="nl">?leey</span> //.</label><q>aa1</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !lee_fin ler_subr_addr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_suber_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y \<span class="kr">is</span> a fin_num -&gt; (x &lt;= y - z) = (z + x &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (x &lt;= y - z) = (z + x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>abc</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> lee_suber_addr// addeC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">subre_lt0</span> <span class="nv">x</span> <span class="nv">y</span> : x \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; <span class="mi">0</span>) = (x &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; <span class="mi">0</span>) = (x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ac1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> lte_subel_addr// add0e.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">suber_lt0</span> <span class="nv">x</span> <span class="nv">y</span> : y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; <span class="mi">0</span>) = (x &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; <span class="mi">0</span>) = (x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ac6</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> lte_subl_addl// adde0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sube_lt0</span> <span class="nv">x</span> <span class="nv">y</span> : (x \<span class="kr">is</span> a fin_num) || (y \<span class="kr">is</span> a fin_num) -&gt;
  (x - y &lt; <span class="mi">0</span>) = (x &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x \<span class="kr">is</span> a fin_num) || (y \<span class="kr">is</span> a fin_num) -&gt;
(x - y &lt; <span class="mi">0</span>) = (x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>acb</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /orP[?|?]; [<span class="nb">rewrite</span> subre_lt0|<span class="nb">rewrite</span> suber_lt0].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">pmule_rge0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; (x * y &gt;= <span class="mi">0</span>) = (y &gt;= <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; (<span class="mi">0</span> &lt;= x * y) = (<span class="mi">0</span> &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ad0</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; x_gt0; <span class="nb">apply</span>/idP/idP; <span class="nb">last</span> <span class="bp">exact</span>/mule_ge0/ltW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>23</q><br><span><var>x_gt0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x * y -&gt; <span class="mi">0</span> &lt;= y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: contra_le; <span class="nb">apply</span>: mule_gt0_lt0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">pmule_lge0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; (y * x &gt;= <span class="mi">0</span>) = (y &gt;= <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; (<span class="mi">0</span> &lt;= y * x) = (<span class="mi">0</span> &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>adb</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC; <span class="nb">apply</span>: pmule_rge0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">pmule_rlt0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; (x * y &lt; <span class="mi">0</span>) = (y &lt; <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; (x * y &lt; <span class="mi">0</span>) = (y &lt; <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ae0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /pmule_rge0; <span class="nb">rewrite</span> !ltNge =&gt; -&gt;.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">pmule_llt0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; (y * x &lt; <span class="mi">0</span>) = (y &lt; <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; (y * x &lt; <span class="mi">0</span>) = (y &lt; <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ae5</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC; <span class="nb">apply</span>: pmule_rlt0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">pmule_rle0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; (x * y &lt;= <span class="mi">0</span>) = (y &lt;= <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; (x * y &lt;= <span class="mi">0</span>) = (y &lt;= <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>aea</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; xgt0; <span class="nb">rewrite</span> -oppe_ge0 -muleN pmule_rge0 <span class="nl">?oppe_ge0</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">pmule_lle0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; (y * x &lt;= <span class="mi">0</span>) = (y &lt;= <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; (y * x &lt;= <span class="mi">0</span>) = (y &lt;= <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>aef</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC; <span class="nb">apply</span>: pmule_rle0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">pmule_rgt0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; (x * y &gt; <span class="mi">0</span>) = (y &gt; <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; (<span class="mi">0</span> &lt; x * y) = (<span class="mi">0</span> &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>af4</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; xgt0; <span class="nb">rewrite</span> -oppe_lt0 -muleN pmule_rlt0 <span class="nl">?oppe_lt0</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">pmule_lgt0</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; (y * x &gt; <span class="mi">0</span>) = (y &gt; <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; (<span class="mi">0</span> &lt; y * x) = (<span class="mi">0</span> &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>af9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC; <span class="nb">apply</span>: pmule_rgt0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">nmule_rge0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt; <span class="mi">0</span> -&gt; (x * y &gt;= <span class="mi">0</span>) = (y &lt;= <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; (<span class="mi">0</span> &lt;= x * y) = (y &lt;= <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>afe</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -oppe_gt0 =&gt; /pmule_rle0&lt;-; <span class="nb">rewrite</span> mulNe oppe_le0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">nmule_lge0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt; <span class="mi">0</span> -&gt; (y * x &gt;= <span class="mi">0</span>) = (y &lt;= <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; (<span class="mi">0</span> &lt;= y * x) = (y &lt;= <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b03</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC; <span class="nb">apply</span>: nmule_rge0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">nmule_rle0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt; <span class="mi">0</span> -&gt; (x * y &lt;= <span class="mi">0</span>) = (y &gt;= <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; (x * y &lt;= <span class="mi">0</span>) = (<span class="mi">0</span> &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b08</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -oppe_gt0 =&gt; /pmule_rge0&lt;-; <span class="nb">rewrite</span> mulNe oppe_ge0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">nmule_lle0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt; <span class="mi">0</span> -&gt; (y * x &lt;= <span class="mi">0</span>) = (y &gt;= <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; (y * x &lt;= <span class="mi">0</span>) = (<span class="mi">0</span> &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b0d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC; <span class="nb">apply</span>: nmule_rle0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">nmule_rgt0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt; <span class="mi">0</span> -&gt; (x * y &gt; <span class="mi">0</span>) = (y &lt; <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; (<span class="mi">0</span> &lt; x * y) = (y &lt; <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b12</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -oppe_gt0 =&gt; /pmule_rlt0&lt;-; <span class="nb">rewrite</span> mulNe oppe_lt0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">nmule_lgt0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt; <span class="mi">0</span> -&gt; (y * x &gt; <span class="mi">0</span>) = (y &lt; <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; (<span class="mi">0</span> &lt; y * x) = (y &lt; <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b17</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC; <span class="nb">apply</span>: nmule_rgt0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">nmule_rlt0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt; <span class="mi">0</span> -&gt; (x * y &lt; <span class="mi">0</span>) = (y &gt; <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; (x * y &lt; <span class="mi">0</span>) = (<span class="mi">0</span> &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b1c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -oppe_gt0 =&gt; /pmule_rgt0&lt;-; <span class="nb">rewrite</span> mulNe oppe_gt0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">nmule_llt0</span> <span class="nv">x</span> <span class="nv">y</span> : x &lt; <span class="mi">0</span> -&gt; (y * x &lt; <span class="mi">0</span>) = (y &gt; <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; <span class="mi">0</span> -&gt; (y * x &lt; <span class="mi">0</span>) = (<span class="mi">0</span> &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b21</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC; <span class="nb">apply</span>: nmule_rlt0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_lt0</span> <span class="nv">x</span> <span class="nv">y</span> : (x * y &lt; <span class="mi">0</span>) = [&amp;&amp; x != <span class="mi">0</span>, y != <span class="mi">0</span> &amp; (x &lt; <span class="mi">0</span>) (+) (y &lt; <span class="mi">0</span>)].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x * y &lt; <span class="mi">0</span>) =
[&amp;&amp; x != <span class="mi">0</span>, y != <span class="mi">0</span> &amp; (x &lt; <span class="mi">0</span>) (+) (y &lt; <span class="mi">0</span>)]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b26</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [xlt0|xgt0|-&gt;] := ltgtP x <span class="mi">0</span>; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> mul0e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>23</q><br><span><var>xlt0</var><span class="hyp-type"><b>: </b><span>x &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x * y &lt; <span class="mi">0</span>) = [&amp;&amp; ~~ false, y != <span class="mi">0</span> &amp; true (+) (y &lt; <span class="mi">0</span>)]</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>23</q><br><span><var>xgt0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; x</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(x * y &lt; <span class="mi">0</span>) =
[&amp;&amp; ~~ false, y != <span class="mi">0</span> &amp; false (+) (y &lt; <span class="mi">0</span>)]</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> nmule_rlt0//= -leNgt lt_def.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>b32</q><span class="goal-separator"><hr></span><q>b34</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> pmule_rlt0//= !lt_neqAle andbA andbb.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">muleA</span> : associative ( *%E : \bar R -&gt; \bar R -&gt; \bar R ).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">associative <span class="c">(*%E : \bar R -&gt; \bar R -&gt; \bar R)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b39</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; x y z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x * (y * z) = x * y * z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">wlog</span> x0 : x y z / <span class="mi">0</span> &lt; x =&gt; [hwlog|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br><span><var>hwlog</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>, <span class="mi">0</span> &lt; x -&gt; x * (y * z) = x * y * z</span></span></span><br></div><span class="goal-separator"><hr></span><q>b40</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br><span><var>x0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; x</span></span></span><br></div><label class="goal-separator"><hr></label><q>b40</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [x0| |-&gt;] := ltgtP x <span class="mi">0</span>; [ |<span class="bp">exact</span>: hwlog|<span class="bp">by</span> <span class="nb">rewrite</span> !mul0e].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br><q>b45</q><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>x &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><q>b40</q></blockquote><q>b46</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: oppe_inj; <span class="nb">rewrite</span> -!mulNe hwlog <span class="nl">?oppe_gt0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>b48</q><span class="goal-separator"><hr></span><q>b40</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">wlog</span> y0 : x y z x0 / <span class="mi">0</span> &lt; y =&gt; [hwlog|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br><q>b49</q><br><span><var>hwlog</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>,
<span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt; x * (y * z) = x * y * z</span></span></span><br></div><span class="goal-separator"><hr></span><q>b40</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br><q>b49</q><br><span><var>y0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; y</span></span></span><br></div><label class="goal-separator"><hr></label><q>b40</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [y0| |-&gt;] := ltgtP y <span class="mi">0</span>; [ |<span class="bp">exact</span>: hwlog|<span class="bp">by</span> <span class="nb">rewrite</span> !(mul0e, mule0)].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br><q>b49</q><br><q>b56</q><br><span><var>y0</var><span class="hyp-type"><b>: </b><span>y &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><q>b40</q></blockquote><q>b57</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: oppe_inj; <span class="nb">rewrite</span> -muleN -<span class="mi">2</span>!mulNe -muleN hwlog <span class="nl">?oppe_gt0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>b59</q><span class="goal-separator"><hr></span><q>b40</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">wlog</span> z0 : x y z x0 y0 / <span class="mi">0</span> &lt; z =&gt; [hwlog|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br><q>b49</q><br><q>b5a</q><br><span><var>hwlog</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>,
<span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt; <span class="mi">0</span> &lt; z -&gt; x * (y * z) = x * y * z</span></span></span><br></div><span class="goal-separator"><hr></span><q>b40</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br><q>b49</q><br><q>b5a</q><br><span><var>z0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; z</span></span></span><br></div><label class="goal-separator"><hr></label><q>b40</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [z0| |-&gt;] := ltgtP z <span class="mi">0</span>; [ |<span class="bp">exact</span>: hwlog|<span class="bp">by</span> <span class="nb">rewrite</span> !mule0].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br><q>b49</q><br><q>b5a</q><br><q>b67</q><br><span><var>z0</var><span class="hyp-type"><b>: </b><span>z &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><q>b40</q></blockquote><q>b68</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: oppe_inj; <span class="nb">rewrite</span> -!muleN hwlog <span class="nl">?oppe_gt0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>b6a</q><span class="goal-separator"><hr></span><q>b40</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: x x0 =&gt; [x x0| |//]; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> !gt0_mulye <span class="nl">?mule_gt0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>y, z</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br><q>b5a</q><br><q>b6b</q><br><q>9a</q><br><span><var>x0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; x%:E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x%:E * (y * z) = x%:E * y * z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: y y0 =&gt; [y y0| |//]; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> gt0_mulye // muleC !gt0_mulye.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>93d</q><br><q>b6b</q><br><q>9a</q><br><q>b79</q><br><q>9e</q><br><span><var>y0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; y%:E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x%:E * (y%:E * z) = x%:E * y%:E * z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: z z0 =&gt; [z z0| |//]; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> !gt0_muley <span class="nl">?mule_gt0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9a</q><br><q>b79</q><br><q>9e</q><br><q>b7f</q><br><q>944</q><br><q>945</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x%:E * (y%:E * z%:E) = x%:E * y%:E * z%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /mule/= mulrA.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">mule_monoid</span> := Monoid.Law muleA mul1e mule1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">mule_comoid</span> := Monoid.ComLaw muleC.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">muleCA</span> : left_commutative ( *%E : \bar R -&gt; \bar R -&gt; \bar R ).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">left_commutative <span class="c">(*%E : \bar R -&gt; \bar R -&gt; \bar R)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b87</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: Monoid.mulmCA.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">muleAC</span> : right_commutative ( *%E : \bar R -&gt; \bar R -&gt; \bar R ).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">right_commutative <span class="c">(*%E : \bar R -&gt; \bar R -&gt; \bar R)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b8c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: Monoid.mulmAC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">muleACA</span> : interchange (@mule R) (@mule R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">interchange *%E *%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b91</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: Monoid.mulmACA.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">muleDr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; y +? z -&gt; x * (y + z) = x * y + x * z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt;
y +? z -&gt; x * (y + z) = x * y + x * z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b96</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> /mule/=; <span class="nb">move</span>: x y z =&gt; [x| |] [y| |] [z| |] //= _; <span class="kp">try</span>
  (<span class="bp">by</span> <span class="nb">case</span>: ltgtP =&gt; // -[] &lt;-; <span class="nb">rewrite</span> ?(mul0r,add0r,adde0))
  || (<span class="bp">by</span> <span class="nb">case</span>: ltgtP =&gt; //; <span class="nb">rewrite</span> adde0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a63</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y%:E +? z%:E -&gt;
(x * (y + z))%:E = (x * y)%:E + (x * z)%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulrDr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">muleDl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; y +? z -&gt; (y + z) * x = y * x + z * x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt;
y +? z -&gt; (y + z) * x = y * x + z * x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b9f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ? ?; <span class="nb">rewrite</span> -!(muleC x) muleDr.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">muleBr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; y +? - z -&gt; x * (y - z) = x * y - x * z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt;
y +? - z -&gt; x * (y - z) = x * y - x * z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ba4</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ? yz; <span class="nb">rewrite</span> muleDr <span class="nl">?muleN</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">muleBl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; y +? - z -&gt; (y - z) * x = y * x - z * x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt;
y +? - z -&gt; (y - z) * x = y * x - z * x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ba9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ? yz; <span class="nb">rewrite</span> muleDl// mulNe.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ge0_muleDl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : <span class="mi">0</span> &lt;= y -&gt; <span class="mi">0</span> &lt;= z -&gt; (y + z) * x = y * x + z * x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= y -&gt; <span class="mi">0</span> &lt;= z -&gt; (y + z) * x = y * x + z * x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>bae</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> /mule/=; <span class="nb">move</span>: x y z =&gt; [r| |] [s| |] [t| |] //= s0 t0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>r, s, t</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= s%:E</span></span></span><br><span><var>t0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= t%:E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((s + t) * r)%:E = (s * r)%:E + (t * r)%:E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>55</q><br><q>bb7</q><br><span><var>t0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= +oo</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> r%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
(s * r)%:E +
(<span class="kr">if</span> r%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>r, t</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>s0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= +oo</span></span></span><br><q>bb8</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> r%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
(<span class="kr">if</span> r%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) + (t * r)%:E</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>ae</q><br><span><var>s0, t0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= +oo</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> r%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
(<span class="kr">if</span> r%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) +
(<span class="kr">if</span> r%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>s, t</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><q>bb7</q><br><q>bb8</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> s%:E + t%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E + t%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
(<span class="kr">if</span> s%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) +
(<span class="kr">if</span> t%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>s</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><q>bb7</q><br><q>bbd</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
(<span class="kr">if</span> s%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) +
(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>t</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><q>bc2</q><br><q>bb8</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> +oo <span class="kr">else</span> -oo) +
(<span class="kr">if</span> t%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>bc6</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> +oo <span class="kr">else</span> -oo) +
(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><blockquote class="alectryon-goal"><q>bc9</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> s%:E + t%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E + t%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> s%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) +
(<span class="kr">if</span> t%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><blockquote class="alectryon-goal"><q>bcd</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; s%:E + +oo <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> s%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) +
(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><blockquote class="alectryon-goal"><q>bd1</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo + t%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> -oo <span class="kr">else</span> +oo) +
(<span class="kr">if</span> t%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><blockquote class="alectryon-goal"><q>bd5</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo + +oo <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> -oo <span class="kr">else</span> +oo) +
(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>bb3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulrDl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bbc</q><span class="goal-separator"><hr></span><q>bbe</q></blockquote><div class="alectryon-extra-goals"><q>bbf</q><q>bc4</q><q>bc8</q><q>bcc</q><q>bd0</q><q>bd4</q><q>bd7</q><q>bd9</q><q>bdb</q><q>bdd</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>be1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: ltgtP =&gt; // -[] &lt;-; <span class="nb">rewrite</span> mulr0 adde0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bc0</q><span class="goal-separator"><hr></span><q>bc3</q></blockquote><div class="alectryon-extra-goals"><q>bc4</q><q>bc8</q><q>bcc</q><q>bd0</q><q>bd4</q><q>bd7</q><q>bd9</q><q>bdb</q><q>bdd</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>be6</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: ltgtP =&gt; // -[] &lt;-; <span class="nb">rewrite</span> mulr0 adde0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bc5</q><span class="goal-separator"><hr></span><q>bc7</q></blockquote><div class="alectryon-extra-goals"><q>bc8</q><q>bcc</q><q>bd0</q><q>bd4</q><q>bd7</q><q>bd9</q><q>bdb</q><q>bdd</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>beb</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: ltgtP =&gt; //; <span class="nb">rewrite</span> adde0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bc9</q><span class="goal-separator"><hr></span><q>bcb</q></blockquote><div class="alectryon-extra-goals"><q>bcc</q><q>bd0</q><q>bd4</q><q>bd7</q><q>bd9</q><q>bdb</q><q>bdd</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>bf0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> !eqe paddr_eq0 //; <span class="nb">move</span>: s0; <span class="nb">rewrite</span> lee_fin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>bca</q><br><q>bb8</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= s)%R -&gt;
(<span class="kr">if</span> (s == <span class="mi">0</span>%R) &amp;&amp; (t == <span class="mi">0</span>%R)
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E + t%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
(<span class="kr">if</span> s == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) +
(<span class="kr">if</span> t == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><q>bf2</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: (ltgtP s) =&gt; //= [s0|-&gt;{s}] _; <span class="nb">rewrite</span> <span class="nl">?add0e</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>bca</q><br><q>bb8</q><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; s)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; s%:E + t%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
(<span class="kr">if</span> <span class="mi">0</span> &lt; s%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) +
(<span class="kr">if</span> t == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>bd2</q><br><q>bb8</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> t == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
(<span class="kr">if</span> t == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><q>bcc</q><q>bd0</q><q>bd4</q><q>bd7</q><q>bd9</q><q>bdb</q><q>bdd</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">+</label><small class="alectryon-output"><div><q>bfa</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> lte_fin -[<span class="kr">in</span> LHS](addr0 <span class="mi">0</span>%R) ltr_le_add // lte_fin s0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bfc</q><span class="goal-separator"><hr></span><div class="goal-conclusion">+oo =
+oo +
(<span class="kr">if</span> t == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><q>bff</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: ltgtP t0 =&gt; // [t0|[&lt;-{t}]] _; [<span class="nb">rewrite</span> gt_eqF|<span class="nb">rewrite</span> eqxx].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c01</q><span class="goal-separator"><hr></span><q>c02</q></blockquote><q>bf2</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">+</label><small class="alectryon-output"><div><q>c09</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: t0; <span class="nb">rewrite</span> lee_fin; <span class="nb">case</span>: (ltgtP t).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bcd</q><span class="goal-separator"><hr></span><q>bcf</q></blockquote><div class="alectryon-extra-goals"><q>bd0</q><q>bd4</q><q>bd7</q><q>bd9</q><q>bdb</q><q>bdd</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>c0d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltry; <span class="nb">case</span>: ltgtP s0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bd1</q><span class="goal-separator"><hr></span><q>bd3</q></blockquote><div class="alectryon-extra-goals"><q>bd4</q><q>bd7</q><q>bd9</q><q>bdb</q><q>bdd</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>c12</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltry; <span class="nb">case</span>: ltgtP t0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bd5</q><span class="goal-separator"><hr></span><q>bd6</q></blockquote><div class="alectryon-extra-goals"><q>bd7</q><q>bd9</q><q>bdb</q><q>bdd</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>c17</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltry.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bc9</q><span class="goal-separator"><hr></span><q>bd8</q></blockquote><div class="alectryon-extra-goals"><q>bd9</q><q>bdb</q><q>bdd</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>c1c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> !eqe paddr_eq0 //; <span class="nb">move</span>: s0; <span class="nb">rewrite</span> lee_fin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bf7</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= s)%R -&gt;
(<span class="kr">if</span> (s == <span class="mi">0</span>%R) &amp;&amp; (t == <span class="mi">0</span>%R)
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E + t%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> s == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) +
(<span class="kr">if</span> t == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><q>c1e</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: (ltgtP s) =&gt; //= [s0|-&gt;{s}] _; <span class="nb">rewrite</span> <span class="nl">?add0e</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bfc</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; s%:E + t%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> <span class="mi">0</span> &lt; s%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) +
(<span class="kr">if</span> t == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>c01</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> t == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> t == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><q>bd9</q><q>bdb</q><q>bdd</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">+</label><small class="alectryon-output"><div><q>c25</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> lte_fin -[<span class="kr">in</span> LHS](addr0 <span class="mi">0</span>%R) ltr_le_add // lte_fin s0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bfc</q><span class="goal-separator"><hr></span><div class="goal-conclusion">-oo =
-oo +
(<span class="kr">if</span> t == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><q>c28</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: ltgtP t0 =&gt; // [t0|[&lt;-{t}]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c01</q><span class="goal-separator"><hr></span><q>c2a</q></blockquote><q>c1e</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">+</label><small class="alectryon-output"><div><q>c31</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: t0; <span class="nb">rewrite</span> lee_fin; <span class="nb">case</span>: (ltgtP t).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bcd</q><span class="goal-separator"><hr></span><q>bda</q></blockquote><div class="alectryon-extra-goals"><q>bdb</q><q>bdd</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>c35</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltry; <span class="nb">case</span>: ltgtP s0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bd1</q><span class="goal-separator"><hr></span><q>bdc</q></blockquote><div class="alectryon-extra-goals"><q>bdd</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>c3a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltry; <span class="nb">case</span>: ltgtP s0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>bd5</q><span class="goal-separator"><hr></span><q>bde</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>c3f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltry; <span class="nb">case</span>: ltgtP s0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ge0_muleDr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : <span class="mi">0</span> &lt;= y -&gt; <span class="mi">0</span> &lt;= z -&gt; x * (y + z) = x * y + x * z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= y -&gt; <span class="mi">0</span> &lt;= z -&gt; x * (y + z) = x * y + x * z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>c43</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; y0 z0; <span class="nb">rewrite</span> !(muleC x) ge0_muleDl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le0_muleDl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y &lt;= <span class="mi">0</span> -&gt; z &lt;= <span class="mi">0</span> -&gt; (y + z) * x = y * x + z * x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y &lt;= <span class="mi">0</span> -&gt; z &lt;= <span class="mi">0</span> -&gt; (y + z) * x = y * x + z * x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>c48</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> /mule/=; <span class="nb">move</span>: x y z =&gt; [r| |] [s| |] [t| |] //= s0 t0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>bb6</q><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>s%:E &lt;= <span class="mi">0</span></span></span></span><br><span><var>t0</var><span class="hyp-type"><b>: </b><span>t%:E &lt;= <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><q>bb9</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>55</q><br><q>c50</q><br><span><var>t0</var><span class="hyp-type"><b>: </b><span>-oo &lt;= <span class="mi">0</span></span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> r%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(s * r)%:E +
(<span class="kr">if</span> r%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>bc1</q><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>-oo &lt;= <span class="mi">0</span></span></span></span><br><q>c51</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> r%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> r%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) + (t * r)%:E</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>ae</q><br><span><var>s0, t0</var><span class="hyp-type"><b>: </b><span>-oo &lt;= <span class="mi">0</span></span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> r%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> r%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) +
(<span class="kr">if</span> r%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; r%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>bca</q><br><q>c50</q><br><q>c51</q><br></div><label class="goal-separator"><hr></label><q>bcb</q></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>bce</q><br><q>c50</q><br><q>c55</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> s%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) +
(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>bd2</q><br><q>c59</q><br><q>c51</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> -oo <span class="kr">else</span> +oo) +
(<span class="kr">if</span> t%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>c5d</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> -oo <span class="kr">else</span> +oo) +
(<span class="kr">if</span> <span class="mi">0</span> &lt; +oo <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><blockquote class="alectryon-goal"><q>c60</q><label class="goal-separator"><hr></label><q>bd8</q></blockquote><blockquote class="alectryon-goal"><q>c62</q><label class="goal-separator"><hr></label><div class="goal-conclusion">+oo =
(<span class="kr">if</span> s%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) + +oo</div></blockquote><blockquote class="alectryon-goal"><q>c65</q><label class="goal-separator"><hr></label><div class="goal-conclusion">+oo =
+oo +
(<span class="kr">if</span> t%:E == <span class="mi">0</span>
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>c4d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulrDl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c54</q><span class="goal-separator"><hr></span><q>c56</q></blockquote><div class="alectryon-extra-goals"><q>c57</q><q>c5b</q><q>c5f</q><q>c61</q><q>c64</q><q>c67</q><q>c6a</q><q>c6b</q><q>c6d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>c71</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: ltgtP =&gt; // -[] &lt;-; <span class="nb">rewrite</span> mulr0 adde0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c58</q><span class="goal-separator"><hr></span><q>c5a</q></blockquote><div class="alectryon-extra-goals"><q>c5b</q><q>c5f</q><q>c61</q><q>c64</q><q>c67</q><q>c6a</q><q>c6b</q><q>c6d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>c76</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: ltgtP =&gt; // -[] &lt;-; <span class="nb">rewrite</span> mulr0 adde0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c5c</q><span class="goal-separator"><hr></span><q>c5e</q></blockquote><div class="alectryon-extra-goals"><q>c5f</q><q>c61</q><q>c64</q><q>c67</q><q>c6a</q><q>c6b</q><q>c6d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>c7b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: ltgtP =&gt; //; <span class="nb">rewrite</span> adde0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c60</q><span class="goal-separator"><hr></span><q>bcb</q></blockquote><div class="alectryon-extra-goals"><q>c61</q><q>c64</q><q>c67</q><q>c6a</q><q>c6b</q><q>c6d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>c80</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> !eqe naddr_eq0 //; <span class="nb">move</span>: s0; <span class="nb">rewrite</span> lee_fin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>bca</q><br><q>c51</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(s &lt;= <span class="mi">0</span>)%R -&gt;
(<span class="kr">if</span> (s == <span class="mi">0</span>%R) &amp;&amp; (t == <span class="mi">0</span>%R)
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E + t%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) =
(<span class="kr">if</span> s == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo) +
(<span class="kr">if</span> t == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><q>c82</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: (ltgtP s) =&gt; //= [s0|-&gt;{s}] _; <span class="nb">rewrite</span> <span class="nl">?add0e</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>bca</q><br><q>c51</q><br><span><var>s0</var><span class="hyp-type"><b>: </b><span>(s &lt; <span class="mi">0</span>)%R</span></span></span><br></div><span class="goal-separator"><hr></span><q>bfe</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>bd2</q><br><q>c51</q><br></div><label class="goal-separator"><hr></label><q>c02</q></blockquote><q>c61</q><q>c64</q><q>c67</q><q>c6a</q><q>c6b</q><q>c6d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">+</label><small class="alectryon-output"><div><q>c8a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> !lte_fin -[<span class="kr">in</span> LHS](addr0 <span class="mi">0</span>%R) ltNge ler_add // <span class="nl">?ltW</span> //=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c8c</q><span class="goal-separator"><hr></span><div class="goal-conclusion">-oo =
(<span class="kr">if</span> (<span class="mi">0</span> &lt; s)%R <span class="kr">then</span> +oo <span class="kr">else</span> -oo) +
(<span class="kr">if</span> t == <span class="mi">0</span>%R
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> (<span class="mi">0</span> &lt; t)%R <span class="kr">then</span> +oo <span class="kr">else</span> -oo)</div></blockquote><q>c8e</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !ltNge ltW //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c90</q><span class="goal-separator"><hr></span><q>c02</q></blockquote><q>c82</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">+</label><small class="alectryon-output"><div><q>c97</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: (ltgtP t).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c62</q><span class="goal-separator"><hr></span><q>c63</q></blockquote><div class="alectryon-extra-goals"><q>c64</q><q>c67</q><q>c6a</q><q>c6b</q><q>c6d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>c9b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltry; <span class="nb">case</span>: ltgtP s0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c65</q><span class="goal-separator"><hr></span><q>c66</q></blockquote><div class="alectryon-extra-goals"><q>c67</q><q>c6a</q><q>c6b</q><q>c6d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>ca0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltry; <span class="nb">case</span>: ltgtP t0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c68</q><span class="goal-separator"><hr></span><q>c69</q></blockquote><div class="alectryon-extra-goals"><q>c6a</q><q>c6b</q><q>c6d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>ca5</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltry.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c60</q><span class="goal-separator"><hr></span><q>bd8</q></blockquote><div class="alectryon-extra-goals"><q>c6b</q><q>c6d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>caa</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> !eqe naddr_eq0 //; <span class="nb">move</span>: s0; <span class="nb">rewrite</span> lee_fin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c87</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(s &lt;= <span class="mi">0</span>)%R -&gt;
(<span class="kr">if</span> (s == <span class="mi">0</span>%R) &amp;&amp; (t == <span class="mi">0</span>%R)
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E + t%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) =
(<span class="kr">if</span> s == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; s%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo) +
(<span class="kr">if</span> t == <span class="mi">0</span>%R <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="kr">if</span> <span class="mi">0</span> &lt; t%:E <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><q>cac</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: (ltgtP s) =&gt; //= [s0|-&gt;{s}] _; <span class="nb">rewrite</span> <span class="nl">?add0e</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c8c</q><span class="goal-separator"><hr></span><q>c27</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>c90</q><label class="goal-separator"><hr></label><q>c2a</q></blockquote><q>c6b</q><q>c6d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">+</label><small class="alectryon-output"><div><q>cb3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> !lte_fin -[<span class="kr">in</span> LHS](addr0 <span class="mi">0</span>%R) ltNge ler_add // <span class="nl">?ltW</span> //=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c8c</q><span class="goal-separator"><hr></span><div class="goal-conclusion">+oo =
(<span class="kr">if</span> (<span class="mi">0</span> &lt; s)%R <span class="kr">then</span> -oo <span class="kr">else</span> +oo) +
(<span class="kr">if</span> t == <span class="mi">0</span>%R
 <span class="kr">then</span> <span class="mi">0</span>
 <span class="kr">else</span> <span class="kr">if</span> (<span class="mi">0</span> &lt; t)%R <span class="kr">then</span> -oo <span class="kr">else</span> +oo)</div></blockquote><q>cb5</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !ltNge ltW // -lee_fin t0; <span class="nb">case</span>: eqP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c90</q><span class="goal-separator"><hr></span><q>c2a</q></blockquote><q>cac</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">+</label><small class="alectryon-output"><div><q>cbd</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: (ltgtP t).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c62</q><span class="goal-separator"><hr></span><q>c6c</q></blockquote><div class="alectryon-extra-goals"><q>c6d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>cc1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltNge s0 /=; <span class="nb">case</span>: eqP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>c65</q><span class="goal-separator"><hr></span><q>c6e</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>cc6</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltNge t0 /=; <span class="nb">case</span>: eqP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le0_muleDr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y &lt;= <span class="mi">0</span> -&gt; z &lt;= <span class="mi">0</span> -&gt; x * (y + z) = x * y + x * z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y &lt;= <span class="mi">0</span> -&gt; z &lt;= <span class="mi">0</span> -&gt; x * (y + z) = x * y + x * z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>cca</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; y0 z0; <span class="nb">rewrite</span> !(muleC x) le0_muleDl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gee_pmull</span> <span class="nv">y</span> <span class="nv">x</span> : y \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; x -&gt; y &lt;= <span class="mi">1</span> -&gt; y * x &lt;= x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>750</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; x -&gt; y &lt;= <span class="mi">1</span> -&gt; y * x &lt;= x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ccf</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x| |] [y| |] _ //=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x%:E -&gt; y%:E &lt;= <span class="mi">1</span> -&gt; y%:E * x%:E &lt;= x%:E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>783</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="mi">0</span> &lt; +oo -&gt; y%:E &lt;= <span class="mi">1</span> -&gt; y%:E * +oo &lt;= +oo</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>cd4</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lte_fin =&gt; x0 r0; <span class="nb">rewrite</span> /mule/= lee_fin ger_pmull.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>783</q><span class="goal-separator"><hr></span><q>cd9</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>cdc</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> /mule/= eqe =&gt; r1; <span class="nb">rewrite</span> leey.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_wpmul2r</span> <span class="nv">x</span> : <span class="mi">0</span> &lt;= x -&gt; {homo *%E^~ x : y z / y &lt;= z}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; {homo *%E^~ x : y z / y &lt;= z &gt;-&gt; y &lt;= z}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ce0</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x =&gt; [x|_|//].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x%:E -&gt; {homo *%E^~ x%:E : y z / y &lt;= z}</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>ed</q><label class="goal-separator"><hr></label><div class="goal-conclusion">{homo *%E^~ +oo : y z / y &lt;= z}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> lee_fin le_eqVlt =&gt; /predU1P[&lt;- y z|x0]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">2</span>!mule0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>7f6</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{homo *%E^~ x%:E : y z / y &lt;= z}</div></blockquote><q>ce8</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; [y| |] [z| |]//; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> !lee_fin// ler_pmul2r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9a</q><br><q>4ca</q><br><q>9e</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y%:E &lt;= +oo -&gt; y%:E * x%:E &lt;= +oo * x%:E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9a</q><br><q>4ca</q><br><q>944</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">-oo &lt;= z%:E -&gt; -oo * x%:E &lt;= z%:E * x%:E</div></blockquote><blockquote class="alectryon-goal"><q>7f6</q><label class="goal-separator"><hr></label><div class="goal-conclusion">-oo &lt;= +oo -&gt; -oo * x%:E &lt;= +oo * x%:E</div></blockquote><q>ce9</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>cf0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>cf6</q><span class="goal-separator"><hr></span><q>cf7</q></blockquote><div class="alectryon-extra-goals"><q>cf8</q><q>ce9</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>cfc</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e leNye.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>7f6</q><span class="goal-separator"><hr></span><q>cf9</q></blockquote><q>ce8</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>d01</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> <span class="mi">2</span>!mulr_infty gtr0_sg// <span class="mi">2</span>!mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><q>cea</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; [y| |] [z| |]//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>y, z</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y%:E &lt;= z%:E -&gt; y%:E * +oo &lt;= z%:E * +oo</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>783</q><label class="goal-separator"><hr></label><div class="goal-conclusion">y%:E &lt;= +oo -&gt; y%:E * +oo &lt;= +oo * +oo</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>944</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">-oo &lt;= z%:E -&gt; -oo * +oo &lt;= z%:E * +oo</div></blockquote><blockquote class="alectryon-goal"><q>ed</q><label class="goal-separator"><hr></label><div class="goal-conclusion">-oo &lt;= +oo -&gt; -oo * +oo &lt;= +oo * +oo</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>d08</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> lee_fin =&gt; yz.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>d0b</q><br><span><var>yz</var><span class="hyp-type"><b>: </b><span>(y &lt;= z)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y%:E * +oo &lt;= z%:E * +oo</div></blockquote><q>d0d</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [z0|z0|] := ltgtP <span class="mi">0</span>%R z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>d0b</q><br><q>d1a</q><br><span><var>z0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; z)%R</span></span></span><br></div><span class="goal-separator"><hr></span><q>d1b</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>d0b</q><br><q>d1a</q><br><span><var>z0</var><span class="hyp-type"><b>: </b><span>(z &lt; <span class="mi">0</span>)%R</span></span></span><br></div><label class="goal-separator"><hr></label><q>d1b</q></blockquote><blockquote class="alectryon-goal"><q>d19</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="mi">0</span>%R = z -&gt; y%:E * +oo &lt;= z%:E * +oo</div></blockquote><q>d0e</q><q>d10</q><q>d13</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">+</label><small class="alectryon-output"><div><q>d1d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> [leRHS]mulr_infty gtr0_sg// mul1e leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d23</q><span class="goal-separator"><hr></span><q>d1b</q></blockquote><div class="alectryon-extra-goals"><q>d25</q><q>d0e</q><q>d10</q><q>d13</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">+</label><small class="alectryon-output"><div><q>d29</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty ltr0_sg// ?(le_lt_trans yz)// [leRHS]mulr_infty ltr0_sg.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d19</q><span class="goal-separator"><hr></span><q>d26</q></blockquote><q>d0d</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">+</label><small class="alectryon-output"><div><q>d2e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; z0; <span class="nb">move</span>: yz; <span class="nb">rewrite</span> -z0 mul0e le_eqVlt =&gt; /predU1P[-&gt;|y0].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>d0b</q><br><span><var>z0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span>%R = z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> * +oo &lt;= <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>d0b</q><br><q>d35</q><br><span><var>y0</var><span class="hyp-type"><b>: </b><span>(y &lt; <span class="mi">0</span>)%R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">y%:E * +oo &lt;= <span class="mi">0</span></div></blockquote><q>d0e</q><q>d10</q><q>d13</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mul0e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d39</q><span class="goal-separator"><hr></span><q>d3b</q></blockquote><q>d0d</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty ltr0_sg// mulN1e leNye.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>783</q><span class="goal-separator"><hr></span><q>d0f</q></blockquote><div class="alectryon-extra-goals"><q>d10</q><q>d13</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">+</label><small class="alectryon-output"><div><q>d40</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> mulyy leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d11</q><span class="goal-separator"><hr></span><q>d12</q></blockquote><div class="alectryon-extra-goals"><q>d13</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">+</label><small class="alectryon-output"><div><q>d45</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> mulNyy leNye.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><q>d14</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">+</label><small class="alectryon-output"><div><q>d4a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> mulNyy leNye.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_wpmul2l</span> <span class="nv">x</span> : <span class="mi">0</span> &lt;= x -&gt; {homo *%E x : y z / y &lt;= z}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; {homo *%E x : y z / y &lt;= z &gt;-&gt; y &lt;= z}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>d4e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x0 y z yz; <span class="nb">rewrite</span> !(muleC x) lee_wpmul2r.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ge0_sume_distrl</span> (<span class="nv">I</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : seq I) <span class="nv">x</span> (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; \bar R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; <span class="mi">0</span> &lt;= F i) -&gt;
  (\sum_(i &lt;- s | P i) F i) * x = \sum_(i &lt;- s | P i) (F i * x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>19b</q><br><q>6b</q><br><q>1df</q><br><q>339</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; <span class="mi">0</span> &lt;= F i) -&gt;
(\sum_(i &lt;- s | P i) F i) * x =
\sum_(i &lt;- s | P i) F i * x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>d53</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">elim</span>: s x P F =&gt; [x P F F0|h t ih x P F F0]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">2</span>!big_nil mul0e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>1dd</q><br><q>1de</q><br><span><var>ih</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; \bar R),
(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; <span class="mi">0</span> &lt;= F i) -&gt;
(\sum_(i &lt;- t | P i) F i) * x =
\sum_(i &lt;- t | P i) F i * x</span></span></span><br><q>6b</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(i &lt;- (h :: t) | P i) F i) * x =
\sum_(i &lt;- (h :: t) | P i) F i * x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> big_cons; <span class="nb">case</span>: ifPn =&gt; Ph; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> big_cons (negbTE Ph) ih.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>1dd</q><br><q>1de</q><br><q>d5c</q><br><q>6b</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(F h + \sum_(j &lt;- t | P j) F j) * x =
\sum_(i &lt;- (h :: t) | P i) F i * x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ge0_muleDl <span class="nl">?sume_ge0</span>// <span class="nl">?F0</span>// ih// big_cons Ph.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ge0_sume_distrr</span> (<span class="nv">I</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : seq I) <span class="nv">x</span> (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; \bar R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; <span class="mi">0</span> &lt;= F i) -&gt;
  x * (\sum_(i &lt;- s | P i) F i) = \sum_(i &lt;- s | P i) (x * F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d55</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; <span class="mi">0</span> &lt;= F i) -&gt;
x * (\sum_(i &lt;- s | P i) F i) =
\sum_(i &lt;- s | P i) x * F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>d65</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; F0; <span class="nb">rewrite</span> muleC ge0_sume_distrl//; <span class="nb">under</span> eq_bigr <span class="kp">do</span> <span class="nb">rewrite</span> muleC.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le0_sume_distrl</span> (<span class="nv">I</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : seq I) <span class="nv">x</span> (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; \bar R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; F i &lt;= <span class="mi">0</span>) -&gt;
  (\sum_(i &lt;- s | P i) F i) * x = \sum_(i &lt;- s | P i) (F i * x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d55</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F i &lt;= <span class="mi">0</span>) -&gt;
(\sum_(i &lt;- s | P i) F i) * x =
\sum_(i &lt;- s | P i) F i * x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>d6a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">elim</span>: s x P F =&gt; [x P F F0|h t ih x P F F0]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">2</span>!big_nil mul0e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>1dd</q><br><q>1de</q><br><span><var>ih</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; \bar R),
(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F i &lt;= <span class="mi">0</span>) -&gt;
(\sum_(i &lt;- t | P i) F i) * x =
\sum_(i &lt;- t | P i) F i * x</span></span></span><br><q>6b</q><br><q>1df</q><br><q>339</q><br><span><var>F0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F i &lt;= <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><q>d5d</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> big_cons; <span class="nb">case</span>: ifPn =&gt; Ph; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> big_cons (negbTE Ph) ih.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>1dd</q><br><q>1de</q><br><q>d72</q><br><q>6b</q><br><q>1df</q><br><q>339</q><br><q>d73</q><br><q>d62</q><br></div><span class="goal-separator"><hr></span><q>d63</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> le0_muleDl <span class="nl">?sume_le0</span>// <span class="nl">?F0</span>// ih// big_cons Ph.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le0_sume_distrr</span> (<span class="nv">I</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : seq I) <span class="nv">x</span> (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; \bar R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; F i &lt;= <span class="mi">0</span>) -&gt;
  x * (\sum_(i &lt;- s | P i) F i) = \sum_(i &lt;- s | P i) (x * F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d55</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F i &lt;= <span class="mi">0</span>) -&gt;
x * (\sum_(i &lt;- s | P i) F i) =
\sum_(i &lt;- s | P i) x * F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>d79</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; F0; <span class="nb">rewrite</span> muleC le0_sume_distrl//; <span class="nb">under</span> eq_bigr <span class="kp">do</span> <span class="nb">rewrite</span> muleC.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fin_num_sume_distrr</span> (<span class="nv">I</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : seq I) <span class="nv">x</span> (<span class="nv">P</span> : pred I)
    (<span class="nv">F</span> : I -&gt; \bar R) :
  x \<span class="kr">is</span> a fin_num -&gt; {<span class="kr">in</span> P &amp;, <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span>, F i +? F j} -&gt;
    x * (\sum_(i &lt;- s | P i) F i) = \sum_(i &lt;- s | P i) x * F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d55</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt;
{<span class="kr">in</span> P &amp;, <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : I, F i +? F j} -&gt;
x * (\sum_(i &lt;- s | P i) F i) =
\sum_(i &lt;- s | P i) x * F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>d7e</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; xfin PF; <span class="nb">elim</span>: s =&gt; [|h t ih]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> !big_nil mule0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>6b</q><br><q>1df</q><br><q>339</q><br><span><var>xfin</var><span class="hyp-type"><b>: </b><span>x \<span class="kr">is</span> a fin_num</span></span></span><br><span><var>PF</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> P &amp;, <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : I, F i +? F j}</span></span></span><br><q>1dd</q><br><q>1de</q><br><span><var>ih</var><span class="hyp-type"><b>: </b><span>x * (\sum_(i &lt;- t | P i) F i) =
\sum_(i &lt;- t | P i) x * F i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x * (\sum_(i &lt;- (h :: t) | P i) F i) =
\sum_(i &lt;- (h :: t) | P i) x * F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> !big_cons; <span class="nb">case</span>: ifPn =&gt; Ph //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>6b</q><br><q>1df</q><br><q>339</q><br><q>d86</q><br><q>d87</q><br><q>1dd</q><br><q>1de</q><br><q>d88</q><br><q>d62</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x * (F h + \sum_(j &lt;- t | P j) F j) =
x * F h + \sum_(j &lt;- t | P j) x * F j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleDr// <span class="nl">?ih</span>// adde_def_sum// =&gt; i Pi; <span class="nb">rewrite</span> PF.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eq_infty</span> <span class="nv">x</span> : (<span class="kr">forall</span> <span class="nv">r</span>, r%:E &lt;= x) -&gt; x = +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">r</span>, r%:E &lt;= x) -&gt; x = +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>d90</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: x =&gt; [x /(_ (x + <span class="mi">1</span>)%R)|//|/(_ <span class="mi">0</span>%R)//].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x + <span class="mi">1</span>)%:E &lt;= x%:E -&gt; x%:E = +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> EFinD addeC -lee_subr_addr// subee// lee_fin ler10.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eq_ninfty</span> <span class="nv">x</span> : (<span class="kr">forall</span> <span class="nv">r</span>, x &lt;= r%:E) -&gt; x = -oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">r</span>, x &lt;= r%:E) -&gt; x = -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>d99</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; *; <span class="nb">apply</span>: (can_inj oppeK); <span class="nb">apply</span>: eq_infty =&gt; r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6b</q><br><span><var>_Hyp_</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">r</span>, x &lt;= r%:E</span></span></span><br><q>ae</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r%:E &lt;= - x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lee_oppr -EFinN.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_opp</span> <span class="nv">x</span> <span class="nv">y</span> : (- x &lt;= - y) = (y &lt;= x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- x &lt;= - y) = (y &lt;= x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>da4</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lee_oppl oppeK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_abs</span> <span class="nv">x</span> : x &lt;= `|x|.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= `|x|</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>da9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [x| |]//=; <span class="nb">rewrite</span> lee_fin ler_norm.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">abse_id</span> <span class="nv">x</span> : `| `|x| | = `|x|.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">`|`|x|| = `|x|</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>dae</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x =&gt; [x| |] //=; <span class="nb">rewrite</span> normr_id.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_absl</span> (<span class="nv">x</span> <span class="nv">y</span> : \bar R) : (`|x| &lt; y)%E = (- y &lt; x &lt; y)%E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(`|x| &lt; y) = (- y &lt; x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>db3</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //=; <span class="nb">rewrite</span> <span class="nl">?lte_fin</span> <span class="nl">?ltry</span> <span class="nl">?ltNyr</span>// ltr_norml.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eqe_absl</span> <span class="nv">x</span> <span class="nv">y</span> : (`|x| == y) = ((x == y) || (x == - y)) &amp;&amp; (<span class="mi">0</span> &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(`|x| == y) = ((x == y) || (x == - y)) &amp;&amp; (<span class="mi">0</span> &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>db8</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //=; <span class="nb">rewrite</span>? leey// !eqe eqr_norml lee_fin.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_abs_add</span> <span class="nv">x</span> <span class="nv">y</span> : `|x + y| &lt;= `|x| + `|y|.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">`|x + y| &lt;= `|x| + `|y|</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>dbd</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //; <span class="nb">rewrite</span> /abse -EFinD lee_fin ler_norm_add.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_abs_sum</span> (<span class="nv">I</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : seq I) (<span class="nv">F</span> : I -&gt; \bar R) (<span class="nv">P</span> : pred I) :
  `|\sum_(i &lt;- s | P i) F i| &lt;= \sum_(i &lt;- s | P i) `|F i|.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>19b</q><br><q>339</q><br><q>1df</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`|\sum_(i &lt;- s | P i) F i| &lt;=
\sum_(i &lt;- s | P i) `|F i|</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>dc2</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">elim</span>/big_ind2 : _ =&gt; //; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> abse0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>dc4</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x1</span> <span class="nv">x2</span> <span class="nv">y1</span> <span class="nv">y2</span> : \bar R,
`|x2| &lt;= x1 -&gt; `|y2| &lt;= y1 -&gt; `|x2 + y2| &lt;= x1 + y1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="bp">exact</span>/(le_trans (lee_abs_add _ _) (lee_add _ _)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_abs_sub</span> <span class="nv">x</span> <span class="nv">y</span> : `|x - y| &lt;= `|x| + `|y|.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">`|x - y| &lt;= `|x| + `|y|</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>dcc</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //; <span class="nb">rewrite</span> /abse -EFinD lee_fin ler_norm_sub.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">abseM</span> : {morph @abse R : x y / x * y}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{morph abse : x y / x * y}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>dd1</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> xoo r : `|r%:E * +oo| = `|r|%:E * +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>cc</q><span class="goal-separator"><hr></span><div class="goal-conclusion">`|r%:E * +oo| = `|r|%:E * +oo</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>xoo</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">r</span>, `|r%:E * +oo| = `|r|%:E * +oo</span></span></span><br></div><label class="goal-separator"><hr></label><q>dd3</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [r0|r0] := leP <span class="mi">0</span>%R r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>ae</q><br><span><var>r0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt;= r)%R</span></span></span><br></div><span class="goal-separator"><hr></span><q>dd8</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>ae</q><br><span><var>r0</var><span class="hyp-type"><b>: </b><span>(r &lt; <span class="mi">0</span>)%R</span></span></span><br></div><label class="goal-separator"><hr></label><q>dd8</q></blockquote><q>dda</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (ger0_norm r0)// gee0_abs// mule_ge0// leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>de4</q><span class="goal-separator"><hr></span><q>dd8</q></blockquote><q>dd9</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> (ltr0_norm r0)// lte0_abs// <span class="nl">?EFinN</span> <span class="nl">?mulNe</span>//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>de4</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r%:E * +oo &lt; <span class="mi">0</span></div></blockquote><q>dd9</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mule_lt0 /= eqe lt_eqF//= lte_fin r0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ddb</q><span class="goal-separator"><hr></span><q>dd3</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; [x| |] [y| |] //=; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> normrM.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>ddc</q><br><q>9a</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`|x%:E * -oo| = `|x|%:E * +oo</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>ddc</q><br><q>9e</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">`|+oo * y%:E| = +oo * `|y|%:E</div></blockquote><blockquote class="alectryon-goal"><q>ddb</q><label class="goal-separator"><hr></label><div class="goal-conclusion">`|+oo * +oo| = +oo * +oo</div></blockquote><blockquote class="alectryon-goal"><q>ddb</q><label class="goal-separator"><hr></label><div class="goal-conclusion">`|+oo * -oo| = +oo * +oo</div></blockquote><blockquote class="alectryon-goal"><q>df7</q><label class="goal-separator"><hr></label><div class="goal-conclusion">`|-oo * y%:E| = +oo * `|y|%:E</div></blockquote><blockquote class="alectryon-goal"><q>ddb</q><label class="goal-separator"><hr></label><div class="goal-conclusion">`|-oo * +oo| = +oo * +oo</div></blockquote><blockquote class="alectryon-goal"><q>ddb</q><label class="goal-separator"><hr></label><div class="goal-conclusion">+oo = +oo * +oo</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>df1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -abseN -muleNN abseN -EFinN xoo normrN.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>df7</q><span class="goal-separator"><hr></span><q>df8</q></blockquote><div class="alectryon-extra-goals"><q>df9</q><q>dfb</q><q>dfd</q><q>dff</q><q>e01</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>e05</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleC xoo muleC.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ddb</q><span class="goal-separator"><hr></span><q>dfa</q></blockquote><div class="alectryon-extra-goals"><q>dfb</q><q>dfd</q><q>dff</q><q>e01</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>e0a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulyy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ddb</q><span class="goal-separator"><hr></span><q>dfc</q></blockquote><div class="alectryon-extra-goals"><q>dfd</q><q>dff</q><q>e01</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>e0f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulyy mulyNy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>df7</q><span class="goal-separator"><hr></span><q>dfe</q></blockquote><div class="alectryon-extra-goals"><q>dff</q><q>e01</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>e14</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -abseN -muleNN abseN -EFinN xoo normrN.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ddb</q><span class="goal-separator"><hr></span><q>e00</q></blockquote><div class="alectryon-extra-goals"><q>e01</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>e19</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulyy mulNyy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ddb</q><span class="goal-separator"><hr></span><q>e02</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>e1e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulyy.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">maxEFin</span> <span class="nv">r1</span> <span class="nv">r2</span> : maxe r1%:E r2%:E = (Num.max r1 r2)%:E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>14</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">maxe r1%:E r2%:E = (Num.max r1 r2)%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e22</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">have</span> [ab|ba] := leP r1 r2;
  [<span class="nb">apply</span>/max_idPr; <span class="nb">rewrite</span> lee_fin|<span class="nb">apply</span>/max_idPl; <span class="nb">rewrite</span> lee_fin ltW].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">minEFin</span> <span class="nv">r1</span> <span class="nv">r2</span> : mine r1%:E r2%:E = (Num.min r1 r2)%:E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>e24</q><span class="goal-separator"><hr></span><div class="goal-conclusion">mine r1%:E r2%:E = (Num.min r1 r2)%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e28</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">have</span> [ab|ba] := leP r1 r2;
  [<span class="nb">apply</span>/min_idPl; <span class="nb">rewrite</span> lee_fin|<span class="nb">apply</span>/min_idPr; <span class="nb">rewrite</span> lee_fin ltW].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_maxl</span> : left_distributive (@adde R) maxe.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">left_distributive +%E maxe</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e2d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; x y z; <span class="nb">have</span> [xy|yx] := leP x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br><span><var>xy</var><span class="hyp-type"><b>: </b><span>x &lt;= y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y + z = maxe (x + z) (y + z)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br><span><var>yx</var><span class="hyp-type"><b>: </b><span>y &lt; x</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">x + z = maxe (x + z) (y + z)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/esym/max_idPr; <span class="nb">rewrite</span> lee_add2r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>e39</q><span class="goal-separator"><hr></span><q>e3b</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/esym/max_idPl; <span class="nb">rewrite</span> lee_add2r// ltW.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_maxr</span> : right_distributive (@adde R) maxe.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">right_distributive +%E maxe</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e40</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; x y z; <span class="nb">have</span> [yz|zy] := leP y z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br><span><var>yz</var><span class="hyp-type"><b>: </b><span>y &lt;= z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x + z = maxe (x + y) (x + z)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br><span><var>zy</var><span class="hyp-type"><b>: </b><span>z &lt; y</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">x + y = maxe (x + y) (x + z)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/esym/max_idPr; <span class="nb">rewrite</span> lee_add2l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>e4c</q><span class="goal-separator"><hr></span><q>e4e</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/esym/max_idPl; <span class="nb">rewrite</span> lee_add2l// ltW.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">maxye</span> : left_zero (+oo : \bar R) maxe.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">left_zero (+oo : \bar R) maxe</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e53</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x; <span class="nb">have</span> [|//] := leP +oo x; <span class="nb">rewrite</span> leye_eq =&gt; /eqP.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">maxey</span> : right_zero (+oo : \bar R) maxe.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">right_zero (+oo : \bar R) maxe</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e58</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x; <span class="nb">rewrite</span> maxC maxye.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">maxNye</span> : left_id (-oo : \bar R) maxe.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">left_id (-oo : \bar R) maxe</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e5d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x; <span class="nb">have</span> [//|] := leP -oo x; <span class="nb">rewrite</span> ltNge leNye.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">maxeNy</span> : right_id (-oo : \bar R) maxe.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">right_id (-oo : \bar R) maxe</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e62</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x; <span class="nb">rewrite</span> maxC maxNye.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">maxe_monoid</span> := Monoid.Law maxA maxNye maxeNy.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">maxe_comoid</span> := Monoid.ComLaw maxC.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">minNye</span> : left_zero (-oo : \bar R) mine.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">left_zero (-oo : \bar R) mine</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e67</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x; <span class="nb">have</span> [|//] := leP x -oo; <span class="nb">rewrite</span> leeNy_eq =&gt; /eqP.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mineNy</span> : right_zero (-oo : \bar R) mine.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">right_zero (-oo : \bar R) mine</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e6c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x; <span class="nb">rewrite</span> minC minNye.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">minye</span> : left_id (+oo : \bar R) mine.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">left_id (+oo : \bar R) mine</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e71</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x; <span class="nb">have</span> [//|] := leP x +oo; <span class="nb">rewrite</span> ltNge leey.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">miney</span> : right_id (+oo : \bar R) mine.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">right_id (+oo : \bar R) mine</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e76</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x; <span class="nb">rewrite</span> minC minye.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">mine_monoid</span> := Monoid.Law minA minye miney.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">mine_comoid</span> := Monoid.ComLaw minC.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oppe_max</span> : {morph -%E : x y / maxe x y &gt;-&gt; mine x y : \bar R}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{morph -%E : x y / maxe x y &gt;-&gt; mine x y : \bar R}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e7b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; [x| |] [y| |] //=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">- maxe x%:E y%:E = mine (- x)%:E (- y)%:E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>77e</q><label class="goal-separator"><hr></label><div class="goal-conclusion">- maxe x%:E +oo = mine (- x)%:E -oo</div></blockquote><blockquote class="alectryon-goal"><q>77e</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(- x)%:E = mine (- x)%:E +oo</div></blockquote><blockquote class="alectryon-goal"><q>783</q><label class="goal-separator"><hr></label><div class="goal-conclusion">-oo = mine -oo (- y)%:E</div></blockquote><blockquote class="alectryon-goal"><q>783</q><label class="goal-separator"><hr></label><div class="goal-conclusion">- maxe -oo y%:E = mine +oo (- y)%:E</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>e80</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> maxEFin minEFin -EFinN oppr_max.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><q>e85</q></blockquote><div class="alectryon-extra-goals"><q>e86</q><q>e88</q><q>e8a</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>e8e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> maxey mineNy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><q>e87</q></blockquote><div class="alectryon-extra-goals"><q>e88</q><q>e8a</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>e93</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> miney.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>783</q><span class="goal-separator"><hr></span><q>e89</q></blockquote><div class="alectryon-extra-goals"><q>e8a</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>e98</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> minNye.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>783</q><span class="goal-separator"><hr></span><q>e8b</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>e9d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> maxNye minye.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oppe_min</span> : {morph -%E : x y / mine x y &gt;-&gt; maxe x y : \bar R}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{morph -%E : x y / mine x y &gt;-&gt; maxe x y : \bar R}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ea1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x y; <span class="nb">rewrite</span> -[RHS]oppeK oppe_max !oppeK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">maxeMr</span> <span class="nv">z</span> <span class="nv">x</span> <span class="nv">y</span> : z \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; z -&gt;
  z * maxe x y = maxe (z * x) (z * y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>z, x, y</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt;
<span class="mi">0</span> &lt; z -&gt; z * maxe x y = maxe (z * x) (z * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ea6</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; + r0; <span class="nb">have</span> [xy|yx|-&gt;] := ltgtP x y; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> maxxx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>ea9</q><br><span><var>r0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; z</span></span></span><br><span><var>xy</var><span class="hyp-type"><b>: </b><span>x &lt; y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt; z * y = maxe (z * x) (z * y)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>ea9</q><br><q>eb0</q><br><q>e3a</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt; z * x = maxe (z * x) (z * y)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>ead</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; zfin; <span class="nb">rewrite</span> /maxe lte_pmul2l // xy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>eb5</q><span class="goal-separator"><hr></span><q>eb6</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>eb9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; zfin; <span class="nb">rewrite</span> maxC /maxe lte_pmul2l// yx.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">maxeMl</span> <span class="nv">z</span> <span class="nv">x</span> <span class="nv">y</span> : z \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; z -&gt;
  maxe x y * z = maxe (x * z) (y * z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ea8</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt;
<span class="mi">0</span> &lt; z -&gt; maxe x y * z = maxe (x * z) (y * z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ebd</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; zfin z0; <span class="nb">rewrite</span> muleC maxeMr// !(muleC z).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mineMr</span> <span class="nv">z</span> <span class="nv">x</span> <span class="nv">y</span> : z \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; z -&gt;
  z * mine x y = mine (z * x) (z * y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ea8</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt;
<span class="mi">0</span> &lt; z -&gt; z * mine x y = mine (z * x) (z * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ec2</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ? ?; <span class="nb">rewrite</span> -eqe_oppP -muleN oppe_min maxeMr// !muleN -oppe_min.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mineMl</span> <span class="nv">z</span> <span class="nv">x</span> <span class="nv">y</span> : z \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; z -&gt;
  mine x y * z = mine (x * z) (y * z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ea8</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt;
<span class="mi">0</span> &lt; z -&gt; mine x y * z = mine (x * z) (y * z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ec7</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; zfin z0; <span class="nb">rewrite</span> muleC mineMr// !(muleC z).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_pemull</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= y -&gt; <span class="mi">1</span> &lt;= x -&gt; y &lt;= x * y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= y -&gt; <span class="mi">1</span> &lt;= x -&gt; y &lt;= x * y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ecc</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x| |] [y| |] //; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> mulyy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= y%:E -&gt; <span class="mi">1</span> &lt;= x%:E -&gt; y%:E &lt;= x%:E * y%:E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>77e</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="mi">0</span> &lt;= +oo -&gt; <span class="mi">1</span> &lt;= x%:E -&gt; +oo &lt;= x%:E * +oo</div></blockquote><blockquote class="alectryon-goal"><q>783</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="mi">0</span> &lt;= y%:E -&gt; <span class="mi">1</span> &lt;= +oo -&gt; y%:E &lt;= +oo * y%:E</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>ed1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -EFinM <span class="mi">3</span>!lee_fin; <span class="bp">exact</span>: ler_pemull.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><q>ed6</q></blockquote><div class="alectryon-extra-goals"><q>ed7</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>edb</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> lee_fin =&gt; x1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9a</q><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>(<span class="mi">1</span> &lt;= x)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">+oo &lt;= x%:E * +oo</div></blockquote><q>edd</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg <span class="nl">?mul1e</span>// (lt_le_trans _ x1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>783</q><span class="goal-separator"><hr></span><q>ed8</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>ee6</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> lee_fin le_eqVlt =&gt; /predU1P[&lt;- _|y0 _]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> mule0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9e</q><br><q>4d4</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y%:E &lt;= +oo * y%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e leey.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_nemull</span> <span class="nv">x</span> <span class="nv">y</span> : y &lt;= <span class="mi">0</span> -&gt; <span class="mi">1</span> &lt;= x -&gt; x * y &lt;= y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y &lt;= <span class="mi">0</span> -&gt; <span class="mi">1</span> &lt;= x -&gt; x * y &lt;= y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>eef</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x| |] [y| |] //; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> mulyNy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y%:E &lt;= <span class="mi">0</span> -&gt; <span class="mi">1</span> &lt;= x%:E -&gt; x%:E * y%:E &lt;= y%:E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>77e</q><label class="goal-separator"><hr></label><div class="goal-conclusion">-oo &lt;= <span class="mi">0</span> -&gt; <span class="mi">1</span> &lt;= x%:E -&gt; x%:E * -oo &lt;= -oo</div></blockquote><blockquote class="alectryon-goal"><q>783</q><label class="goal-separator"><hr></label><div class="goal-conclusion">y%:E &lt;= <span class="mi">0</span> -&gt; <span class="mi">1</span> &lt;= +oo -&gt; +oo * y%:E &lt;= y%:E</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>ef4</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -EFinM <span class="mi">3</span>!lee_fin; <span class="bp">exact</span>: ler_nemull.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>77e</q><span class="goal-separator"><hr></span><q>ef9</q></blockquote><div class="alectryon-extra-goals"><q>efa</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>efe</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> lee_fin =&gt; x1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ee2</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x%:E * -oo &lt;= -oo</div></blockquote><q>f00</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg <span class="nl">?mul1e</span>// (lt_le_trans _ x1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>783</q><span class="goal-separator"><hr></span><q>efb</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>f07</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> lee_fin le_eqVlt =&gt; /predU1P[-&gt; _|y0 _]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> mule0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9e</q><br><q>d3a</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">+oo * y%:E &lt;= y%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty ltr0_sg// mulN1e leNye.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_pemulr</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= y -&gt; <span class="mi">1</span> &lt;= x -&gt; y &lt;= y * x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= y -&gt; <span class="mi">1</span> &lt;= x -&gt; y &lt;= y * x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>f10</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; y0 x1; <span class="nb">rewrite</span> muleC lee_pemull.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_nemulr</span> <span class="nv">x</span> <span class="nv">y</span> : y &lt;= <span class="mi">0</span> -&gt; <span class="mi">1</span> &lt;= x -&gt; y * x &lt;= y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y &lt;= <span class="mi">0</span> -&gt; <span class="mi">1</span> &lt;= x -&gt; y * x &lt;= y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>f15</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; y0 x1; <span class="nb">rewrite</span> muleC lee_nemull.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_natl</span> <span class="nv">x</span> <span class="nv">n</span> : n%:R%:E * x = x *+ n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>6b</q><br><q>128</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(n%:R)%:E * x = x *+ n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>f1a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">elim</span>: n =&gt; [|n]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> mul0e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f1c</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(n%:R)%:E * x = x *+ n -&gt; (n.+<span class="mi">1</span>%:R)%:E * x = x *+ n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x =&gt; [x| |] ih.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>128</q><br><q>9a</q><br><span><var>ih</var><span class="hyp-type"><b>: </b><span>(n%:R)%:E * x%:E = x%:E *+ n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(n.+<span class="mi">1</span>%:R)%:E * x%:E = x%:E *+ n.+<span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>128</q><br><span><var>ih</var><span class="hyp-type"><b>: </b><span>(n%:R)%:E * +oo = +oo *+ n</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(n.+<span class="mi">1</span>%:R)%:E * +oo = +oo *+ n.+<span class="mi">1</span></div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>128</q><br><span><var>ih</var><span class="hyp-type"><b>: </b><span>(n%:R)%:E * -oo = -oo *+ n</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(n.+<span class="mi">1</span>%:R)%:E * -oo = -oo *+ n.+<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>f24</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -EFinM mulr_natl EFin_natmul.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f2b</q><span class="goal-separator"><hr></span><q>f2d</q></blockquote><div class="alectryon-extra-goals"><q>f2e</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>f34</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulry gtr0_sg// mul1e enatmul_pinfty.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f2f</q><span class="goal-separator"><hr></span><q>f31</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>f39</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulrNy gtr0_sg// mul1e enatmul_ninfty.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_pmul</span> <span class="nv">x1</span> <span class="nv">y1</span> <span class="nv">x2</span> <span class="nv">y2</span> :
  <span class="mi">0</span> &lt;= x1 -&gt; <span class="mi">0</span> &lt;= x2 -&gt; x1 &lt; y1 -&gt; x2 &lt; y2 -&gt; x1 * x2 &lt; y1 * y2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>x1, y1, x2, y2</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x1 -&gt;
<span class="mi">0</span> &lt;= x2 -&gt; x1 &lt; y1 -&gt; x2 &lt; y2 -&gt; x1 * x2 &lt; y1 * y2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>f3d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x1 y1 x2 y2 =&gt; [x1| |] [y1| |] [x2| |] [y2| |] //;
    <span class="nb">rewrite</span> !(lte_fin,lee_fin).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>x1, y1, x2, y2</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x1)%R -&gt;
(<span class="mi">0</span> &lt;= x2)%R -&gt;
(x1 &lt; y1)%R -&gt; (x2 &lt; y2)%R -&gt; (x1 * x2 &lt; y1 * y2)%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>x1, y1, x2</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x1)%R -&gt;
(<span class="mi">0</span> &lt;= x2)%R -&gt;
(x1 &lt; y1)%R -&gt;
x2%:E &lt; +oo -&gt; x1%:E * x2%:E &lt; y1%:E * +oo</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>x1, x2, y2</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x1)%R -&gt;
(<span class="mi">0</span> &lt;= x2)%R -&gt;
x1%:E &lt; +oo -&gt;
(x2 &lt; y2)%R -&gt; x1%:E * x2%:E &lt; +oo * y2%:E</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x1)%R -&gt;
(<span class="mi">0</span> &lt;= x2)%R -&gt;
x1%:E &lt; +oo -&gt;
x2%:E &lt; +oo -&gt; x1%:E * x2%:E &lt; +oo * +oo</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>f44</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> ltr_pmul.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f4b</q><span class="goal-separator"><hr></span><q>f4d</q></blockquote><div class="alectryon-extra-goals"><q>f4e</q><q>f52</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>f58</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; x10 x20 xy1 xy2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>f4c</q><br><span><var>x10</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt;= x1)%R</span></span></span><br><span><var>x20</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt;= x2)%R</span></span></span><br><span><var>xy1</var><span class="hyp-type"><b>: </b><span>(x1 &lt; y1)%R</span></span></span><br><span><var>xy2</var><span class="hyp-type"><b>: </b><span>x2%:E &lt; +oo</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1%:E * x2%:E &lt; y1%:E * +oo</div></blockquote><q>f5a</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulry gtr0_sg <span class="nl">?mul1e</span> -<span class="nl">?EFinM</span> <span class="nl">?ltry</span>// (le_lt_trans _ xy1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f4f</q><span class="goal-separator"><hr></span><q>f51</q></blockquote><div class="alectryon-extra-goals"><q>f52</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>f66</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; x10 x20 xy1 xy2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>f50</q><br><q>f60</q><br><q>f61</q><br><span><var>xy1</var><span class="hyp-type"><b>: </b><span>x1%:E &lt; +oo</span></span></span><br><span><var>xy2</var><span class="hyp-type"><b>: </b><span>(x2 &lt; y2)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1%:E * x2%:E &lt; +oo * y2%:E</div></blockquote><q>f68</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulyr gtr0_sg <span class="nl">?mul1e</span> -<span class="nl">?EFinM</span> <span class="nl">?ltry</span>// (le_lt_trans _ xy2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f53</q><span class="goal-separator"><hr></span><q>f55</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>f72</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> mulyy -EFinM ltry.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_pmul</span> <span class="nv">x1</span> <span class="nv">y1</span> <span class="nv">x2</span> <span class="nv">y2</span> : <span class="mi">0</span> &lt;= x1 -&gt; <span class="mi">0</span> &lt;= x2 -&gt; x1 &lt;= y1 -&gt; x2 &lt;= y2 -&gt;
  x1 * x2 &lt;= y1 * y2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f3f</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x1 -&gt;
<span class="mi">0</span> &lt;= x2 -&gt; x1 &lt;= y1 -&gt; x2 &lt;= y2 -&gt; x1 * x2 &lt;= y1 * y2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>f76</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x1 y1 x2 y2 =&gt; [x1| |] [y1| |] [x2| |] [y2| |] //; <span class="nb">rewrite</span> !lee_fin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f46</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x1)%R -&gt;
(<span class="mi">0</span> &lt;= x2)%R -&gt;
(x1 &lt;= y1)%R -&gt; (x2 &lt;= y2)%R -&gt; (x1 * x2 &lt;= y1 * y2)%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>f4b</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x1)%R -&gt;
(<span class="mi">0</span> &lt;= x2)%R -&gt;
(x1 &lt;= y1)%R -&gt;
x2%:E &lt;= +oo -&gt; x1%:E * x2%:E &lt;= y1%:E * +oo</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>x1, y1</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x1)%R -&gt;
<span class="mi">0</span> &lt;= +oo -&gt;
(x1 &lt;= y1)%R -&gt;
+oo &lt;= +oo -&gt; x1%:E * +oo &lt;= y1%:E * +oo</div></blockquote><blockquote class="alectryon-goal"><q>f4f</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x1)%R -&gt;
(<span class="mi">0</span> &lt;= x2)%R -&gt;
x1%:E &lt;= +oo -&gt;
(x2 &lt;= y2)%R -&gt; x1%:E * x2%:E &lt;= +oo * y2%:E</div></blockquote><blockquote class="alectryon-goal"><q>f53</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x1)%R -&gt;
(<span class="mi">0</span> &lt;= x2)%R -&gt;
x1%:E &lt;= +oo -&gt;
x2%:E &lt;= +oo -&gt; x1%:E * x2%:E &lt;= +oo * +oo</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x1)%R -&gt;
<span class="mi">0</span> &lt;= +oo -&gt;
x1%:E &lt;= +oo -&gt; +oo &lt;= +oo -&gt; x1%:E * +oo &lt;= +oo * +oo</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>x2, y2</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="mi">0</span> &lt;= +oo -&gt;
(<span class="mi">0</span> &lt;= x2)%R -&gt;
+oo &lt;= +oo -&gt;
(x2 &lt;= y2)%R -&gt; +oo * x2%:E &lt;= +oo * y2%:E</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>x2</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="mi">0</span> &lt;= +oo -&gt;
(<span class="mi">0</span> &lt;= x2)%R -&gt;
+oo &lt;= +oo -&gt; x2%:E &lt;= +oo -&gt; +oo * x2%:E &lt;= +oo * +oo</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>f7b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">exact</span>: ler_pmul.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f4b</q><span class="goal-separator"><hr></span><q>f80</q></blockquote><div class="alectryon-extra-goals"><q>f81</q><q>f85</q><q>f87</q><q>f89</q><q>f8d</q><q>f91</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>f97</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;- x20 y10 _|x10 x20 xy1 _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>f4c</q><br><q>f61</q><br><span><var>y10</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt;= y1)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> * x2%:E &lt;= y1%:E * +oo</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>f4c</q><br><span><var>x10</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; x1)%R</span></span></span><br><q>f61</q><br><span><var>xy1</var><span class="hyp-type"><b>: </b><span>(x1 &lt;= y1)%R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">x1%:E * x2%:E &lt;= y1%:E * +oo</div></blockquote><q>f81</q><q>f85</q><q>f87</q><q>f89</q><q>f8d</q><q>f91</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mul0e mule_ge0// leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>fa3</q><span class="goal-separator"><hr></span><q>fa6</q></blockquote><q>f99</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg// <span class="nl">?mul1e</span> <span class="nl">?leey</span>// (lt_le_trans x10).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f82</q><span class="goal-separator"><hr></span><q>f84</q></blockquote><div class="alectryon-extra-goals"><q>f85</q><q>f87</q><q>f89</q><q>f8d</q><q>f91</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>fab</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;- _ y10 _|x10 _ xy1 _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>f83</q><br><q>f9f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> * +oo &lt;= y1%:E * +oo</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>f83</q><br><q>fa4</q><br><q>fa5</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">x1%:E * +oo &lt;= y1%:E * +oo</div></blockquote><q>f85</q><q>f87</q><q>f89</q><q>f8d</q><q>f91</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mul0e mule_ge0// leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>fb6</q><span class="goal-separator"><hr></span><q>fb7</q></blockquote><q>fad</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e mulr_infty gtr0_sg// <span class="nl">?mul1e</span>//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>fb6</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; y1)%R</div></blockquote><q>fad</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">exact</span>: (lt_le_trans x10).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f4f</q><span class="goal-separator"><hr></span><q>f86</q></blockquote><div class="alectryon-extra-goals"><q>f87</q><q>f89</q><q>f8d</q><q>f91</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>fc0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; x10; <span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;- _ y20|x20 _ xy2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>f50</q><br><q>f60</q><br><span><var>y20</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt;= y2)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1%:E * <span class="mi">0</span> &lt;= +oo * y2%:E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>f50</q><br><q>f60</q><br><span><var>x20</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; x2)%R</span></span></span><br><span><var>xy2</var><span class="hyp-type"><b>: </b><span>(x2 &lt;= y2)%R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">x1%:E * x2%:E &lt;= +oo * y2%:E</div></blockquote><q>f87</q><q>f89</q><q>f8d</q><q>f91</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mule0 mulr_infty mule_ge0// <span class="nl">?leey</span>// lee_fin sgr_ge0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>fcc</q><span class="goal-separator"><hr></span><q>fcf</q></blockquote><q>fc2</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg <span class="nl">?mul1e</span> <span class="nl">?leey</span>// (lt_le_trans x20).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f53</q><span class="goal-separator"><hr></span><q>f88</q></blockquote><div class="alectryon-extra-goals"><q>f89</q><q>f8d</q><q>f91</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>fd4</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x10 x20 _ _; <span class="nb">rewrite</span> mulyy leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f8a</q><span class="goal-separator"><hr></span><q>f8c</q></blockquote><div class="alectryon-extra-goals"><q>f8d</q><q>f91</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>fd9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;- _ _ _|x10 _ _ _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f8a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> * +oo &lt;= +oo * +oo</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>f8b</q><br><q>fa4</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">x1%:E * +oo &lt;= +oo * +oo</div></blockquote><q>f8d</q><q>f91</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulyy mul0e leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>fe3</q><span class="goal-separator"><hr></span><q>fe4</q></blockquote><q>fdb</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulyy mulr_infty gtr0_sg// mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f8e</q><span class="goal-separator"><hr></span><q>f90</q></blockquote><div class="alectryon-extra-goals"><q>f91</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>fe9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;- _ y20|x20 _ xy2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>f8f</q><br><q>fc8</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">+oo * <span class="mi">0</span> &lt;= +oo * y2%:E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>f8f</q><br><q>fcd</q><br><q>fce</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">+oo * x2%:E &lt;= +oo * y2%:E</div></blockquote><q>f91</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mule0 mulr_infty mule_ge0// <span class="nl">?leey</span>// lee_fin sgr_ge0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ff4</q><span class="goal-separator"><hr></span><q>ff5</q></blockquote><q>feb</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e mulr_infty gtr0_sg <span class="nl">?mul1e</span>//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ff4</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; y2)%R</div></blockquote><q>feb</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">exact</span>: (lt_le_trans x20).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f92</q><span class="goal-separator"><hr></span><q>f94</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>ffe</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;- _ _|x20 _ _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f92</q><span class="goal-separator"><hr></span><div class="goal-conclusion">+oo * <span class="mi">0</span> &lt;= +oo * +oo</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>f93</q><br><q>fcd</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">+oo * x2%:E &lt;= +oo * +oo</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mule0 mulyy leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1007</q><span class="goal-separator"><hr></span><q>1008</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e// mulyy.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_pmul2l</span> <span class="nv">x</span> : x \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; x -&gt; {mono *%E x : x y / x &lt;= y}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt;
<span class="mi">0</span> &lt; x -&gt; {mono *%E x : x y / x &lt;= y &gt;-&gt; x &lt;= y}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>100d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x =&gt; [x _|//|//] /[!(@lte_fin R)] x0 [y| |] [z| |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>9a</q><br><q>4ca</q><br><q>d0b</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x%:E * y%:E &lt;= x%:E * z%:E) = (y%:E &lt;= z%:E)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>cf2</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x%:E * y%:E &lt;= x%:E * +oo) = (y%:E &lt;= +oo)</div></blockquote><blockquote class="alectryon-goal"><q>cf2</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x%:E * y%:E &lt;= x%:E * -oo) = (y%:E &lt;= -oo)</div></blockquote><blockquote class="alectryon-goal"><q>cf6</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x%:E * +oo &lt;= x%:E * z%:E) = (+oo &lt;= z%:E)</div></blockquote><blockquote class="alectryon-goal"><q>7f6</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x%:E * +oo &lt;= x%:E * +oo) = (+oo &lt;= +oo)</div></blockquote><blockquote class="alectryon-goal"><q>7f6</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x%:E * +oo &lt;= x%:E * -oo) = (+oo &lt;= -oo)</div></blockquote><blockquote class="alectryon-goal"><q>cf6</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x%:E * -oo &lt;= x%:E * z%:E) = (-oo &lt;= z%:E)</div></blockquote><blockquote class="alectryon-goal"><q>7f6</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x%:E * -oo &lt;= x%:E * +oo) = (-oo &lt;= +oo)</div></blockquote><blockquote class="alectryon-goal"><q>7f6</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x%:E * -oo &lt;= x%:E * -oo) = (-oo &lt;= -oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1012</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -<span class="mi">2</span>!EFinM <span class="mi">2</span>!lee_fin ler_pmul2l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>cf2</q><span class="goal-separator"><hr></span><q>1018</q></blockquote><div class="alectryon-extra-goals"><q>1019</q><q>101b</q><q>101d</q><q>101f</q><q>1021</q><q>1023</q><q>1025</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1029</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulry gtr0_sg// mul1e <span class="mi">2</span>!leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>cf2</q><span class="goal-separator"><hr></span><q>101a</q></blockquote><div class="alectryon-extra-goals"><q>101b</q><q>101d</q><q>101f</q><q>1021</q><q>1023</q><q>1025</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>102e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulrNy gtr0_sg// mul1e <span class="mi">2</span>!leeNy_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>cf6</q><span class="goal-separator"><hr></span><q>101c</q></blockquote><div class="alectryon-extra-goals"><q>101d</q><q>101f</q><q>1021</q><q>1023</q><q>1025</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1033</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulry gtr0_sg// mul1e <span class="mi">2</span>!leye_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>7f6</q><span class="goal-separator"><hr></span><q>101e</q></blockquote><div class="alectryon-extra-goals"><q>101f</q><q>1021</q><q>1023</q><q>1025</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1038</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulry gtr0_sg// mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>7f6</q><span class="goal-separator"><hr></span><q>1020</q></blockquote><div class="alectryon-extra-goals"><q>1021</q><q>1023</q><q>1025</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>103d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulry mulrNy gtr0_sg// mul1e mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>cf6</q><span class="goal-separator"><hr></span><q>1022</q></blockquote><div class="alectryon-extra-goals"><q>1023</q><q>1025</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1042</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulrNy gtr0_sg// mul1e <span class="mi">2</span>!leNye.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>7f6</q><span class="goal-separator"><hr></span><q>1024</q></blockquote><div class="alectryon-extra-goals"><q>1025</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1047</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulrNy mulry gtr0_sg// <span class="mi">2</span>!mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>7f6</q><span class="goal-separator"><hr></span><q>1026</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>104c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulrNy gtr0_sg// mul1e.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_pmul2r</span> <span class="nv">x</span> : x \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; x -&gt; {mono *%E^~ x : x y / x &lt;= y}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt;
<span class="mi">0</span> &lt; x -&gt; {mono *%E^~ x : x y / x &lt;= y &gt;-&gt; x &lt;= y}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1050</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; xfin x0 y z; <span class="nb">rewrite</span> -<span class="mi">2</span>!(muleC x) lee_pmul2l.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_paddl</span> <span class="nv">y</span> <span class="nv">x</span> <span class="nv">z</span> : <span class="mi">0</span> &lt;= x -&gt; y &lt;= z -&gt; y &lt;= x + z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>y, x, z</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; y &lt;= z -&gt; y &lt;= x + z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1055</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> -[y]add0e lee_add.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_paddl</span> <span class="nv">y</span> <span class="nv">x</span> <span class="nv">z</span> : <span class="mi">0</span> &lt;= x -&gt; y &lt; z -&gt; y &lt; x + z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1057</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; y &lt; z -&gt; y &lt; x + z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>105c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x0 /lt_le_trans; <span class="nb">apply</span>; <span class="nb">rewrite</span> lee_paddl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_paddr</span> <span class="nv">y</span> <span class="nv">x</span> <span class="nv">z</span> : <span class="mi">0</span> &lt;= x -&gt; y &lt;= z -&gt; y &lt;= z + x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1057</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; y &lt;= z -&gt; y &lt;= z + x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1061</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> addeC lee_paddl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_paddr</span> <span class="nv">y</span> <span class="nv">x</span> <span class="nv">z</span> : <span class="mi">0</span> &lt;= x -&gt; y &lt; z -&gt; y &lt; z + x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1057</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; y &lt; z -&gt; y &lt; z + x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1066</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> addeC lte_paddl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_spaddre</span> <span class="nv">z</span> <span class="nv">x</span> <span class="nv">y</span> : z \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; y -&gt; z &lt;= x -&gt; z &lt; x + y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ea8</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; y -&gt; z &lt;= x -&gt; z &lt; x + y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>106b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: z y x =&gt; [z| |] [y| |] [x| |] _ //=; <span class="nb">rewrite</span> ?(lte_fin,ltry)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><span><var>z, y, x</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; y)%R -&gt; z%:E &lt;= x%:E -&gt; (z &lt; x + y)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: ltr_spaddr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_spadder</span> <span class="nv">z</span> <span class="nv">x</span> <span class="nv">y</span> : x \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; y -&gt; z &lt;= x -&gt; z &lt; x + y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ea8</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; y -&gt; z &lt;= x -&gt; z &lt; x + y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1076</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: z y x =&gt; [z| |] [y| |] [x| |] _ //=; <span class="nb">rewrite</span> ?(lte_fin,ltry,ltNyr)//.</label><small class="alectryon-output"><div><q>1070</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: ltr_spaddr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">ERealArithTh_realDomainType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> lee_sum_nneg_ord {R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> lee_sum_npos_ord {R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> lee_sum_nneg_natr {R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> lee_sum_npos_natr {R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> lee_sum_nneg_natl {R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> lee_sum_npos_natl {R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Hint Extern</span> <span class="mi">0</span> (is_true (<span class="mi">0</span> &lt;= `| _ |)%E) =&gt; <span class="kp">solve</span> [<span class="nb">apply</span>: abse_ge0] : core.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">Casts are ignored <span class="kr">in</span> patterns
[cast-<span class="kr">in</span>-<span class="nb">pattern</span>,automation]</blockquote><blockquote class="alectryon-message">Casts are ignored <span class="kr">in</span> patterns
[cast-<span class="kr">in</span>-<span class="nb">pattern</span>,automation]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[deprecated(since=<span class="s2">&quot;mathcomp-analysis 0.6&quot;</span>, note=<span class="s2">&quot;Use lte_spaddre instead.&quot;</span>)]
<span class="kn">Notation</span> <span class="nf">lte_spaddr</span> := lte_spaddre.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">DualAddTheoryRealDomain</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">DualERealArithTh_realDomainType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> DualAddTheoryNumDomain.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">R</span> : realDomainType}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">a</span> <span class="nv">b</span> : \bar R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsube_lt0</span> <span class="nv">x</span> <span class="nv">y</span> : (x - y &lt; <span class="mi">0</span>) = (x &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x - y &lt; <span class="mi">0</span>) = (x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>107d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> dual_addeE oppe_lt0 sube_gt0 lte_opp.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsube_ge0</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="mi">0</span> &lt;= y - x) = (x &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= y - x) = (x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1082</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> dual_addeE oppe_ge0 sube_le0 lee_opp.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsuber_le0</span> <span class="nv">x</span> <span class="nv">y</span> : y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= <span class="mi">0</span>) = (x &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= <span class="mi">0</span>) = (x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1087</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> dual_addeE oppe_le0 suber_ge0 <span class="nl">?fin_numN</span>// lee_opp.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsubre_le0</span> <span class="nv">y</span> <span class="nv">x</span> : y \<span class="kr">is</span> a fin_num -&gt; (y - x &lt;= <span class="mi">0</span>) = (y &lt;= x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>750</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (y - x &lt;= <span class="mi">0</span>) = (y &lt;= x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>108c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> dual_addeE oppe_le0 subre_ge0 <span class="nl">?fin_numN</span>// lee_opp.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsube_le0</span> <span class="nv">x</span> <span class="nv">y</span> : (x \<span class="kr">is</span> a fin_num) || (y \<span class="kr">is</span> a fin_num) -&gt;
  (y - x &lt;= <span class="mi">0</span>) = (y &lt;= x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x \<span class="kr">is</span> a fin_num) || (y \<span class="kr">is</span> a fin_num) -&gt;
(y - x &lt;= <span class="mi">0</span>) = (y &lt;= x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1091</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /orP[?|?]; [<span class="nb">rewrite</span> dsuber_le0|<span class="nb">rewrite</span> dsubre_le0].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_dadd</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">y</span> : a &lt; b -&gt; x &lt; y -&gt; a + x &lt; b + y.</label><small class="alectryon-output"><div><q>88f</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>88f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> !dual_addeE lte_opp -lte_opp -(lte_opp y); <span class="bp">exact</span>: lte_add.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_daddl</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= y -&gt; x &lt;= x + y.</label><small class="alectryon-output"><div><q>89c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>89c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> dual_addeE lee_oppr -oppe_le0; <span class="bp">exact</span>: gee_addl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_daddr</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= y -&gt; x &lt;= y + x.</label><small class="alectryon-output"><div><q>8a1</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>8a4</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> dual_addeE lee_oppr -oppe_le0; <span class="bp">exact</span>: gee_addr.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gee_daddl</span> <span class="nv">x</span> <span class="nv">y</span> : y &lt;= <span class="mi">0</span> -&gt; x + y &lt;= x.</label><small class="alectryon-output"><div><q>8a6</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8a6</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> dual_addeE lee_oppl -oppe_ge0; <span class="bp">exact</span>: lee_addl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gee_daddr</span> <span class="nv">x</span> <span class="nv">y</span> : y &lt;= <span class="mi">0</span> -&gt; y + x &lt;= x.</label><small class="alectryon-output"><div><q>8ab</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>8ae</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> dual_addeE lee_oppl -oppe_ge0; <span class="bp">exact</span>: lee_addr.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_daddl</span> <span class="nv">y</span> <span class="nv">x</span> : y \<span class="kr">is</span> a fin_num -&gt; (y &lt; y + x) = (<span class="mi">0</span> &lt; x).</label><small class="alectryon-output"><div><q>8b0</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8b0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -fin_numN dual_addeE lte_oppr; <span class="bp">exact</span>: gte_subl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_daddr</span> <span class="nv">y</span> <span class="nv">x</span> : y \<span class="kr">is</span> a fin_num -&gt; (y &lt; x + y) = (<span class="mi">0</span> &lt; x).</label><small class="alectryon-output"><div><q>8b5</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>8b8</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -fin_numN dual_addeE lte_oppr addeC; <span class="bp">exact</span>: gte_subl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gte_dsubl</span> <span class="nv">y</span> <span class="nv">x</span> : y \<span class="kr">is</span> a fin_num -&gt; (y - x &lt; y) = (<span class="mi">0</span> &lt; x).</label><small class="alectryon-output"><div><q>8ba</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8ba</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -fin_numN dual_addeE lte_oppl oppeK; <span class="bp">exact</span>: lte_addl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gte_dsubr</span> <span class="nv">y</span> <span class="nv">x</span> : y \<span class="kr">is</span> a fin_num -&gt; (- x + y &lt; y) = (<span class="mi">0</span> &lt; x).</label><small class="alectryon-output"><div><q>8c3</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>8c6</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -fin_numN dual_addeE lte_oppl oppeK; <span class="bp">exact</span>: lte_addr.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gte_daddl</span> <span class="nv">x</span> <span class="nv">y</span> : x \<span class="kr">is</span> a fin_num -&gt; (x + y &lt; x) = (y &lt; <span class="mi">0</span>).</label><small class="alectryon-output"><div><q>8c8</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>8cb</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -fin_numN dual_addeE lte_oppl -oppe0 lte_oppr; <span class="bp">exact</span>: lte_addl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gte_daddr</span> <span class="nv">x</span> <span class="nv">y</span> : x \<span class="kr">is</span> a fin_num -&gt; (y + x &lt; x) = (y &lt; <span class="mi">0</span>).</label><small class="alectryon-output"><div><q>8cd</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>8d0</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> daddeC; <span class="bp">exact</span>: gte_daddl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_dadd2lE</span> <span class="nv">x</span> <span class="nv">a</span> <span class="nv">b</span> : x \<span class="kr">is</span> a fin_num -&gt; (x + a &lt; x + b) = (a &lt; b).</label><small class="alectryon-output"><div><q>8d2</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>8d7</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lte_opp lte_add2lE <span class="nl">?fin_numN</span>// lte_opp.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dadd2l</span> <span class="nv">x</span> <span class="nv">a</span> <span class="nv">b</span> : a &lt;= b -&gt; x + a &lt;= x + b.</label><small class="alectryon-output"><div><q>8df</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8df</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> !dual_addeE lee_opp -lee_opp; <span class="bp">exact</span>: lee_add2l.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dadd2lE</span> <span class="nv">x</span> <span class="nv">a</span> <span class="nv">b</span> : x \<span class="kr">is</span> a fin_num -&gt; (x + a &lt;= x + b) = (a &lt;= b).</label><small class="alectryon-output"><div><q>8f9</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>8fc</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lee_opp lee_add2lE <span class="nl">?fin_numN</span>// lee_opp.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dadd2r</span> <span class="nv">x</span> <span class="nv">a</span> <span class="nv">b</span> : a &lt;= b -&gt; a + x &lt;= b + x.</label><small class="alectryon-output"><div><q>902</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>905</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> !dual_addeE lee_opp -lee_opp; <span class="bp">exact</span>: lee_add2r.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dadd</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">y</span> : a &lt;= b -&gt; x &lt;= y -&gt; a + x &lt;= b + y.</label><small class="alectryon-output"><div><q>907</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>907</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> !dual_addeE lee_opp -lee_opp -(lee_opp y); <span class="bp">exact</span>: lee_add.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_le_dadd</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">y</span> : b \<span class="kr">is</span> a fin_num -&gt; a &lt; x -&gt; b &lt;= y -&gt; a + b &lt; x + y.</label><small class="alectryon-output"><div><q>910</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>910</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> !dual_addeE lte_opp -lte_opp; <span class="bp">exact</span>: lte_le_sub.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_lt_dadd</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">y</span> : a \<span class="kr">is</span> a fin_num -&gt; a &lt;= x -&gt; b &lt; y -&gt; a + b &lt; x + y.</label><small class="alectryon-output"><div><q>91b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>91e</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; afin xa yb; <span class="nb">rewrite</span> (daddeC a) (daddeC x) lte_le_dadd.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsub</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">t</span> : x &lt;= y -&gt; t &lt;= z -&gt; x - z &lt;= y - t.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>1b8</q><br><span><var>t</var><span class="hyp-type"><b>: </b><span>dual_extended R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= y -&gt; t &lt;= z -&gt; x - z &lt;= y - t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>10b0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> !dual_addeE lee_oppl oppeK -lee_opp !oppeK; <span class="bp">exact</span>: lee_add.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_le_dsub</span> <span class="nv">z</span> <span class="nv">u</span> <span class="nv">x</span> <span class="nv">y</span> : u \<span class="kr">is</span> a fin_num -&gt; x &lt; z -&gt; u &lt;= y -&gt; x - y &lt; z - u.</label><small class="alectryon-output"><div><q>92d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>932</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> !dual_addeE lte_opp !oppeK -lte_opp; <span class="bp">exact</span>: lte_le_add.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsum</span> <span class="nv">I</span> (<span class="nv">f</span> <span class="nv">g</span> : I -&gt; \bar R) <span class="nv">s</span> (<span class="nv">P</span> : pred I) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; f i &lt;= g i) -&gt;
  \sum_(i &lt;- s | P i) f i &lt;= \sum_(i &lt;- s | P i) g i.</label><small class="alectryon-output"><div><q>98c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>98c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; Pfg; <span class="nb">rewrite</span> !dual_sumeE lee_opp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>98f</q><br><q>19b</q><br><q>1df</q><br><span><var>Pfg</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; f i &lt;= g i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(i &lt;- s | P i) - g i &lt;=
 \sum_(i &lt;- s | P i) - f i)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>: lee_sum =&gt; i Pi; <span class="nb">rewrite</span> lee_opp; <span class="bp">exact</span>: Pfg.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsum_nneg_subset</span> <span class="nv">I</span> (<span class="nv">s</span> : seq I) (<span class="nv">P</span> <span class="nv">Q</span> : {pred I}) (<span class="nv">f</span> : I -&gt; \bar R) :
  {subset Q &lt;= P} -&gt; {<span class="kr">in</span> [predD P &amp; Q], <span class="kr">forall</span> <span class="nv">i</span>, <span class="mi">0</span> &lt;= f i} -&gt;
  \sum_(i &lt;- s | Q i) f i &lt;= \sum_(i &lt;- s | P i) f i.</label><small class="alectryon-output"><div><q>993</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>998</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; QP PQf; <span class="nb">rewrite</span> !dual_sumeE lee_opp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>19b</q><br><q>996</q><br><q>1e0</q><br><q>99d</q><br><q>99e</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(i &lt;- s | P i) - f i &lt;=
 \sum_(i &lt;- s | Q i) - f i)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>: lee_sum_npos_subset =&gt; [//|i iPQ]; <span class="nb">rewrite</span> oppe_le0; <span class="bp">exact</span>: PQf.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsum_npos_subset</span> <span class="nv">I</span> (<span class="nv">s</span> : seq I) (<span class="nv">P</span> <span class="nv">Q</span> : {pred I}) (<span class="nv">f</span> : I -&gt; \bar R) :
  {subset Q &lt;= P} -&gt; {<span class="kr">in</span> [predD P &amp; Q], <span class="kr">forall</span> <span class="nv">i</span>, f i &lt;= <span class="mi">0</span>} -&gt;
  \sum_(i &lt;- s | P i) f i &lt;= \sum_(i &lt;- s | Q i) f i.</label><small class="alectryon-output"><div><q>9a1</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>9a4</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; QP PQf; <span class="nb">rewrite</span> !dual_sumeE lee_opp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>19b</q><br><q>996</q><br><q>1e0</q><br><q>99d</q><br><q>9a9</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(i &lt;- s | Q i) - f i &lt;=
 \sum_(i &lt;- s | P i) - f i)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>: lee_sum_nneg_subset =&gt; [//|i iPQ]; <span class="nb">rewrite</span> oppe_ge0; <span class="bp">exact</span>: PQf.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsum_nneg</span> (<span class="nv">I</span> : eqType) (<span class="nv">s</span> : seq I) (<span class="nv">P</span> <span class="nv">Q</span> : pred I)
  (<span class="nv">f</span> : I -&gt; \bar R) : (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; ~~ Q i -&gt; <span class="mi">0</span> &lt;= f i) -&gt;
  \sum_(i &lt;- s | P i &amp;&amp; Q i) f i &lt;= \sum_(i &lt;- s | P i) f i.</label><small class="alectryon-output"><div><q>9ac</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>9b2</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; PQf; <span class="nb">rewrite</span> !dual_sumeE lee_opp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9b6</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(i &lt;- s | P i) - f i &lt;=
 \sum_(i &lt;- s | P i &amp;&amp; Q i) - f i)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>: lee_sum_npos =&gt; i Pi nQi; <span class="nb">rewrite</span> oppe_le0; <span class="bp">exact</span>: PQf.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsum_npos</span> (<span class="nv">I</span> : eqType) (<span class="nv">s</span> : seq I) (<span class="nv">P</span> <span class="nv">Q</span> : pred I)
  (<span class="nv">f</span> : I -&gt; \bar R) : (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; ~~ Q i -&gt; f i &lt;= <span class="mi">0</span>) -&gt;
  \sum_(i &lt;- s | P i) f i &lt;= \sum_(i &lt;- s | P i &amp;&amp; Q i) f i.</label><small class="alectryon-output"><div><q>9ba</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>9bd</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; PQf; <span class="nb">rewrite</span> !dual_sumeE lee_opp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9c1</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(i &lt;- s | P i &amp;&amp; Q i) - f i &lt;=
 \sum_(i &lt;- s | P i) - f i)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>: lee_sum_nneg =&gt; i Pi nQi; <span class="nb">rewrite</span> oppe_ge0; <span class="bp">exact</span>: PQf.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsum_nneg_ord</span> (<span class="nv">f</span> : nat -&gt; \bar R) (<span class="nv">P</span> : pred nat) :
  (<span class="kr">forall</span> <span class="nv">n</span>, P n -&gt; <span class="mi">0</span> &lt;= f n)%E -&gt;
  {homo (<span class="kr">fun</span> <span class="nv">n</span> =&gt; \sum_(i &lt; n | P i) (f i)) : i j / (i &lt;= j)%N &gt;-&gt; i &lt;= j}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9c7</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; (<span class="mi">0</span> &lt;= f n)%E) -&gt;
{homo (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n | P i) f i) : i j / 
(i &lt;= j)%N &gt;-&gt; i &lt;= j}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>10d6</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; f0 m n mlen; <span class="nb">rewrite</span> !dual_sumeE lee_opp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><q>9c8</q><br><span><var>f0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; (<span class="mi">0</span> &lt;= f n)%E</span></span></span><br><q>9dd</q><br><span><var>mlen</var><span class="hyp-type"><b>: </b><span>(m &lt;= n)%N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(i | P i) - f i &lt;= \sum_(i | P i) - f i)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: (lee_sum_npos_ord (<span class="kr">fun</span> <span class="nv">i</span> =&gt; - f i)%E) =&gt; [i Pi|//].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><q>9c8</q><br><q>10de</q><br><q>9dd</q><br><q>10df</q><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><q>3ae</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(- f i &lt;= <span class="mi">0</span>)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> oppe_le0; <span class="bp">exact</span>: f0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsum_npos_ord</span> (<span class="nv">f</span> : nat -&gt; \bar R) (<span class="nv">P</span> : pred nat) :
  (<span class="kr">forall</span> <span class="nv">n</span>, P n -&gt; f n &lt;= <span class="mi">0</span>)%E -&gt;
  {homo (<span class="kr">fun</span> <span class="nv">n</span> =&gt; \sum_(i &lt; n | P i) (f i)) : i j / (i &lt;= j)%N &gt;-&gt; j &lt;= i}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9c7</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; (f n &lt;= <span class="mi">0</span>)%E) -&gt;
{homo (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n | P i) f i) : i j / 
(i &lt;= j)%N &gt;-&gt; j &lt;= i}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>10e8</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; f0 m n mlen; <span class="nb">rewrite</span> !dual_sumeE lee_opp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><q>9c8</q><br><span><var>f0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; (f n &lt;= <span class="mi">0</span>)%E</span></span></span><br><q>9dd</q><br><q>10df</q><br></div><span class="goal-separator"><hr></span><q>10e0</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: (lee_sum_nneg_ord (<span class="kr">fun</span> <span class="nv">i</span> =&gt; - f i)%E) =&gt; [i Pi|//].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>35a</q><br><q>9c8</q><br><q>10f0</q><br><q>9dd</q><br><q>10df</q><br><q>10e5</q><br><q>3ae</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= - f i)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> oppe_ge0; <span class="bp">exact</span>: f0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsum_nneg_natr</span> (<span class="nv">f</span> : nat -&gt; \bar R) (<span class="nv">P</span> : pred nat) <span class="nv">m</span> :
  (<span class="kr">forall</span> <span class="nv">n</span>, (m &lt;= n)%N -&gt; P n -&gt; <span class="mi">0</span> &lt;= f n) -&gt;
  {homo (<span class="kr">fun</span> <span class="nv">n</span> =&gt; \sum_(m &lt;= i &lt; n | P i) (f i)) : i j / (i &lt;= j)%N &gt;-&gt; i &lt;= j}.</label><small class="alectryon-output"><div><q>9e1</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>9e6</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; f0 i j le_ij; <span class="nb">rewrite</span> !dual_sumeE lee_opp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9ea</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(m &lt;= i &lt; j | P i) - f i &lt;=
 \sum_(m &lt;= i &lt; i | P i) - f i)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>: lee_sum_npos_natr =&gt; [n ? ?|//]; <span class="nb">rewrite</span> oppe_le0; <span class="bp">exact</span>: f0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsum_npos_natr</span> (<span class="nv">f</span> : nat -&gt; \bar R) (<span class="nv">P</span> : pred nat) <span class="nv">m</span> :
  (<span class="kr">forall</span> <span class="nv">n</span>, (m &lt;= n)%N -&gt; P n -&gt; f n &lt;= <span class="mi">0</span>) -&gt;
  {homo (<span class="kr">fun</span> <span class="nv">n</span> =&gt; \sum_(m &lt;= i &lt; n | P i) (f i)) : i j / (i &lt;= j)%N &gt;-&gt; j &lt;= i}.</label><small class="alectryon-output"><div><q>9ee</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>9f1</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; f0 i j le_ij; <span class="nb">rewrite</span> !dual_sumeE lee_opp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9f5</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(m &lt;= i &lt; i | P i) - f i &lt;=
 \sum_(m &lt;= i &lt; j | P i) - f i)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>: lee_sum_nneg_natr =&gt; [n ? ?|//]; <span class="nb">rewrite</span> oppe_ge0; <span class="bp">exact</span>: f0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsum_nneg_natl</span> (<span class="nv">f</span> : nat -&gt; \bar R) (<span class="nv">P</span> : pred nat) <span class="nv">n</span> :
  (<span class="kr">forall</span> <span class="nv">m</span>, (m &lt; n)%N -&gt; P m -&gt; <span class="mi">0</span> &lt;= f m) -&gt;
  {homo (<span class="kr">fun</span> <span class="nv">m</span> =&gt; \sum_(m &lt;= i &lt; n | P i) (f i)) : i j / (i &lt;= j)%N &gt;-&gt; j &lt;= i}.</label><small class="alectryon-output"><div><q>9f9</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>9fd</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; f0 i j le_ij; <span class="nb">rewrite</span> !dual_sumeE lee_opp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a01</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(i &lt;= i &lt; n | P i) - f i &lt;=
 \sum_(j &lt;= i &lt; n | P i) - f i)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>: lee_sum_npos_natl =&gt; [m ? ?|//]; <span class="nb">rewrite</span> oppe_le0; <span class="bp">exact</span>: f0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsum_npos_natl</span> (<span class="nv">f</span> : nat -&gt; \bar R) (<span class="nv">P</span> : pred nat) <span class="nv">n</span> :
  (<span class="kr">forall</span> <span class="nv">m</span>, (m &lt; n)%N -&gt; P m -&gt; f m &lt;= <span class="mi">0</span>) -&gt;
  {homo (<span class="kr">fun</span> <span class="nv">m</span> =&gt; \sum_(m &lt;= i &lt; n | P i) (f i)) : i j / (i &lt;= j)%N &gt;-&gt; i &lt;= j}.</label><small class="alectryon-output"><div><q>a0b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>a0e</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; f0 i j le_ij; <span class="nb">rewrite</span> !dual_sumeE lee_opp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a12</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(j &lt;= i &lt; n | P i) - f i &lt;=
 \sum_(i &lt;= i &lt; n | P i) - f i)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>: lee_sum_nneg_natl =&gt; [m ? ?|//]; <span class="nb">rewrite</span> oppe_ge0; <span class="bp">exact</span>: f0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsum_nneg_subfset</span> (<span class="nv">T</span> : choiceType) (<span class="nv">A</span> <span class="nv">B</span> : {fset T}%fset) (<span class="nv">P</span> : pred T)
  (<span class="nv">f</span> : T -&gt; \bar R) : {subset A &lt;= B} -&gt;
  {<span class="kr">in</span> [predD B &amp; A], <span class="kr">forall</span> <span class="nv">t</span>, P t -&gt; <span class="mi">0</span> &lt;= f t} -&gt;
  \sum_(t &lt;- A | P t) f t &lt;= \sum_(t &lt;- B | P t) f t.</label><small class="alectryon-output"><div><q>a1a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>a20</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; AB f0; <span class="nb">rewrite</span> !dual_sumeE lee_opp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a24</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(i &lt;- B | P i) - f i &lt;=
 \sum_(i &lt;- A | P i) - f i)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>: lee_sum_npos_subfset =&gt; [//|? ? ?]; <span class="nb">rewrite</span> oppe_le0; <span class="bp">exact</span>: f0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsum_npos_subfset</span> (<span class="nv">T</span> : choiceType) (<span class="nv">A</span> <span class="nv">B</span> : {fset T}%fset) (<span class="nv">P</span> : pred T)
  (<span class="nv">f</span> : T -&gt; \bar R) : {subset A &lt;= B} -&gt;
  {<span class="kr">in</span> [predD B &amp; A], <span class="kr">forall</span> <span class="nv">t</span>, P t -&gt; f t &lt;= <span class="mi">0</span>} -&gt;
  \sum_(t &lt;- B | P t) f t &lt;= \sum_(t &lt;- A | P t) f t.</label><small class="alectryon-output"><div><q>a3e</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>a41</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; AB f0; <span class="nb">rewrite</span> !dual_sumeE lee_opp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a45</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(\sum_(i &lt;- A | P i) - f i &lt;=
 \sum_(i &lt;- B | P i) - f i)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>: lee_sum_nneg_subfset =&gt; [//|? ? ?]; <span class="nb">rewrite</span> oppe_ge0; <span class="bp">exact</span>: f0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_dsubl_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; z) = (x &lt; z + y).</label><small class="alectryon-output"><div><q>a5b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>a5f</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lte_oppl lte_oppr oppeK lte_subl_addr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_dsubl_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; z) = (x &lt; y + z).</label><small class="alectryon-output"><div><q>a67</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a67</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lte_oppl lte_oppr lte_subr_addl <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_dsubr_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; (x &lt; y - z) = (x + z &lt; y).</label><small class="alectryon-output"><div><q>a6c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>a6f</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lte_oppl lte_oppr lte_subl_addr <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_dsubr_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; (x &lt; y - z) = (z + x &lt; y).</label><small class="alectryon-output"><div><q>a75</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a75</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lte_oppl lte_oppr lte_subl_addl <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_dsuber_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y \<span class="kr">is</span> a fin_num -&gt; (x &lt; y - z) = (x + z &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (x &lt; y - z) = (x + z &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>111b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lte_oppl lte_oppr lte_subel_addr <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_dsuber_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y \<span class="kr">is</span> a fin_num -&gt; (x &lt; y - z) = (z + x &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (x &lt; y - z) = (z + x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1120</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lte_oppl lte_oppr lte_subel_addl <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_dsubel_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; z) = (x &lt; z + y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; z) = (x &lt; z + y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1125</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lte_oppl lte_oppr lte_suber_addr <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_dsubel_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; z) = (x &lt; y + z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">is</span> a fin_num -&gt; (x - y &lt; z) = (x &lt; y + z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>112a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lte_oppl lte_oppr lte_suber_addl <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsubl_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= z) = (x &lt;= z + y).</label><small class="alectryon-output"><div><q>a8f</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>a92</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lee_oppl lee_oppr lee_subr_addr <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsubl_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= z) = (x &lt;= y + z).</label><small class="alectryon-output"><div><q>a98</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a98</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lee_oppl lee_oppr lee_subr_addl <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsubr_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; (x &lt;= y - z) = (x + z &lt;= y).</label><small class="alectryon-output"><div><q>a9d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>aa0</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lee_oppl lee_oppr lee_subl_addr <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsubr_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : z \<span class="kr">is</span> a fin_num -&gt; (x &lt;= y - z) = (z + x &lt;= y).</label><small class="alectryon-output"><div><q>aa8</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>aa8</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lee_oppl lee_oppr lee_subl_addl <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsubel_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= z) = (x &lt;= z + y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= z) = (x &lt;= z + y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1135</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lee_oppl lee_oppr lee_suber_addr <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsubel_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= z) = (x &lt;= y + z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (x - y &lt;= z) = (x &lt;= y + z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>113a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lee_oppl lee_oppr lee_suber_addl <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsuber_addr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; (x &lt;= y - z) = (x + z &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (x &lt;= y - z) = (x + z &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>113f</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lee_oppl lee_oppr lee_subel_addr <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dsuber_addl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; (x &lt;= y - z) = (z + x &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (x &lt;= y - z) = (z + x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1144</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> !dual_addeE lee_oppl lee_oppr lee_subel_addl <span class="nl">?fin_numN</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsuber_gt0</span> <span class="nv">x</span> <span class="nv">y</span> : x \<span class="kr">is</span> a fin_num -&gt; (<span class="mi">0</span> &lt; y - x) = (x &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt; (<span class="mi">0</span> &lt; y - x) = (x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1149</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> lte_dsubr_addl// dadde0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsubre_gt0</span> <span class="nv">x</span> <span class="nv">y</span> : y \<span class="kr">is</span> a fin_num -&gt; (<span class="mi">0</span> &lt; y - x) = (x &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">is</span> a fin_num -&gt; (<span class="mi">0</span> &lt; y - x) = (x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>114e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> lte_dsuber_addl// dadde0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dsube_gt0</span> <span class="nv">x</span> <span class="nv">y</span> : (x \<span class="kr">is</span> a fin_num) || (y \<span class="kr">is</span> a fin_num) -&gt;
  (<span class="mi">0</span> &lt; y - x) = (x &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>732</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x \<span class="kr">is</span> a fin_num) || (y \<span class="kr">is</span> a fin_num) -&gt;
(<span class="mi">0</span> &lt; y - x) = (x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1153</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /orP[?|?]; [<span class="nb">rewrite</span> dsuber_gt0|<span class="nb">rewrite</span> dsubre_gt0].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dmuleDr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; y +? z -&gt; x * (y + z) = x * y + x * z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt;
(y +? z)%E -&gt; x * (y + z) = x * y + x * z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1158</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> !dual_addeE muleN muleDr <span class="nl">?adde_defNN</span>// !muleN.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dmuleDl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x \<span class="kr">is</span> a fin_num -&gt; y +? z -&gt; (y + z) * x = y * x + z * x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>a5d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x \<span class="kr">is</span> a fin_num -&gt;
(y +? z)%E -&gt; (y + z) * x = y * x + z * x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>115d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> -!(muleC x) dmuleDr.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dge0_muleDl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : <span class="mi">0</span> &lt;= y -&gt; <span class="mi">0</span> &lt;= z -&gt; (y + z) * x = y * x + z * x.</label><small class="alectryon-output"><div><q>bae</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>bae</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> !dual_addeE mulNe le0_muleDl <span class="nl">?oppe_le0</span> <span class="nl">?mulNe</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dge0_muleDr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : <span class="mi">0</span> &lt;= y -&gt; <span class="mi">0</span> &lt;= z -&gt; x * (y + z) = x * y + x * z.</label><small class="alectryon-output"><div><q>c43</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>c46</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> !dual_addeE muleN le0_muleDr <span class="nl">?oppe_le0</span> <span class="nl">?muleN</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dle0_muleDl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y &lt;= <span class="mi">0</span> -&gt; z &lt;= <span class="mi">0</span> -&gt; (y + z) * x = y * x + z * x.</label><small class="alectryon-output"><div><q>c48</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>c48</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> !dual_addeE mulNe ge0_muleDl <span class="nl">?oppe_ge0</span> <span class="nl">?mulNe</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dle0_muleDr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : y &lt;= <span class="mi">0</span> -&gt; z &lt;= <span class="mi">0</span> -&gt; x * (y + z) = x * y + x * z.</label><small class="alectryon-output"><div><q>cca</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>ccd</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> !dual_addeE muleN ge0_muleDr <span class="nl">?oppe_ge0</span> <span class="nl">?muleN</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ge0_dsume_distrl</span> (<span class="nv">I</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : seq I) <span class="nv">x</span> (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; \bar R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; <span class="mi">0</span> &lt;= F i) -&gt;
  (\sum_(i &lt;- s | P i) F i) * x = \sum_(i &lt;- s | P i) (F i * x).</label><small class="alectryon-output"><div><q>d53</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>d57</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; F0; <span class="nb">rewrite</span> !dual_sumeE !mulNe le0_sume_distrl =&gt; [|i Pi].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>19b</q><br><q>6b</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(- (\sum_(i &lt;- s | P i) - F i * x))%E =
(- (\sum_(i &lt;- s | P i) - (F i * x)))%E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>19b</q><br><q>6b</q><br><q>1df</q><br><q>339</q><br><q>6b6</q><br><q>3e3</q><br><q>3ae</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(- F i &lt;= <span class="mi">0</span>)%E</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1169</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">under</span> eq_bigr =&gt; i _ <span class="kp">do</span> <span class="nb">rewrite</span> mulNe.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>116f</q><span class="goal-separator"><hr></span><q>1170</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1173</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> oppe_le0 F0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ge0_dsume_distrr</span> (<span class="nv">I</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : seq I) <span class="nv">x</span> (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; \bar R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; <span class="mi">0</span> &lt;= F i) -&gt;
  x * (\sum_(i &lt;- s | P i) F i) = \sum_(i &lt;- s | P i) (x * F i).</label><small class="alectryon-output"><div><q>d65</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>d68</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; F0; <span class="nb">rewrite</span> muleC ge0_dsume_distrl//; <span class="nb">under</span> eq_bigr <span class="kp">do</span> <span class="nb">rewrite</span> muleC.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le0_dsume_distrl</span> (<span class="nv">I</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : seq I) <span class="nv">x</span> (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; \bar R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; F i &lt;= <span class="mi">0</span>) -&gt;
  (\sum_(i &lt;- s | P i) F i) * x = \sum_(i &lt;- s | P i) (F i * x).</label><small class="alectryon-output"><div><q>d6a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>d6d</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; F0; <span class="nb">rewrite</span> !dual_sumeE mulNe ge0_sume_distrl =&gt; [|i Pi].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>19b</q><br><q>6b</q><br><q>1df</q><br><q>339</q><br><q>d73</q><br></div><span class="goal-separator"><hr></span><q>116c</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>cd</q><br><q>19a</q><br><q>19b</q><br><q>6b</q><br><q>1df</q><br><q>339</q><br><q>d73</q><br><q>3e3</q><br><q>3ae</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt;= - F i)%E</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1179</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">under</span> eq_bigr =&gt; i _ <span class="kp">do</span> <span class="nb">rewrite</span> mulNe.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>117e</q><span class="goal-separator"><hr></span><q>117f</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1182</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> oppe_ge0 F0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le0_dsume_distrr</span> (<span class="nv">I</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : seq I) <span class="nv">x</span> (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; \bar R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; F i &lt;= <span class="mi">0</span>) -&gt;
  x * (\sum_(i &lt;- s | P i) F i) = \sum_(i &lt;- s | P i) (x * F i).</label><small class="alectryon-output"><div><q>d79</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>d7c</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; F0; <span class="nb">rewrite</span> muleC le0_dsume_distrl//; <span class="nb">under</span> eq_bigr <span class="kp">do</span> <span class="nb">rewrite</span> muleC.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_abs_dadd</span> <span class="nv">x</span> <span class="nv">y</span> : `|x + y| &lt;= `|x| + `|y|.</label><small class="alectryon-output"><div><q>dbd</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>dc0</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //; <span class="nb">rewrite</span> /abse -dEFinD lee_fin ler_norm_add.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_abs_dsum</span> (<span class="nv">I</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : seq I) (<span class="nv">F</span> : I -&gt; \bar R) (<span class="nv">P</span> : pred I) :
  `|\sum_(i &lt;- s | P i) F i| &lt;= \sum_(i &lt;- s | P i) `|F i|.</label><small class="alectryon-output"><div><q>dc2</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>dc6</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">elim</span>/big_ind2 : _ =&gt; //; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> abse0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>dc4</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x1</span> <span class="nv">x2</span> <span class="nv">y1</span> <span class="nv">y2</span> : \bar R,
(`|x2| &lt;= x1)%E -&gt;
(`|y2| &lt;= y1)%E -&gt; (`|(x2 + y2)%dE| &lt;= (x1 + y1)%dE)%E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="bp">exact</span>/(le_trans (lee_abs_dadd _ _) (lee_dadd _ _)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_abs_dsub</span> <span class="nv">x</span> <span class="nv">y</span> : `|x - y| &lt;= `|x| + `|y|.</label><small class="alectryon-output"><div><q>dcc</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>dcf</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //; <span class="nb">rewrite</span> /abse -dEFinD lee_fin ler_norm_sub.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dadde_minl</span> : left_distributive (@dual_adde R) mine.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">left_distributive +%dE mine</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>118e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x y z; <span class="nb">rewrite</span> !dual_addeE oppe_min adde_maxl oppe_max.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dadde_minr</span> : right_distributive (@dual_adde R) mine.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>ed</q><span class="goal-separator"><hr></span><div class="goal-conclusion">right_distributive +%dE mine</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1193</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x y z; <span class="nb">rewrite</span> !dual_addeE oppe_min adde_maxr oppe_max.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dmule_natl</span> <span class="nv">x</span> <span class="nv">n</span> : n%:R%:E * x = x *+ n.</label><small class="alectryon-output"><div><q>f1a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>f1a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mule_natl ednatmulE.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_pdaddl</span> <span class="nv">y</span> <span class="nv">x</span> <span class="nv">z</span> : <span class="mi">0</span> &lt;= x -&gt; y &lt;= z -&gt; y &lt;= x + z.</label><small class="alectryon-output"><div><q>1055</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>105a</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> -[y]dadd0e lee_dadd.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_pdaddl</span> <span class="nv">y</span> <span class="nv">x</span> <span class="nv">z</span> : <span class="mi">0</span> &lt;= x -&gt; y &lt; z -&gt; y &lt; x + z.</label><small class="alectryon-output"><div><q>105c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>105f</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x0 /lt_le_trans; <span class="nb">apply</span>; <span class="nb">rewrite</span> lee_pdaddl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_pdaddr</span> <span class="nv">y</span> <span class="nv">x</span> <span class="nv">z</span> : <span class="mi">0</span> &lt;= x -&gt; y &lt;= z -&gt; y &lt;= z + x.</label><small class="alectryon-output"><div><q>1061</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>1064</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> daddeC lee_pdaddl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_pdaddr</span> <span class="nv">y</span> <span class="nv">x</span> <span class="nv">z</span> : <span class="mi">0</span> &lt;= x -&gt; y &lt; z -&gt; y &lt; z + x.</label><small class="alectryon-output"><div><q>1066</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>1069</q><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> daddeC lte_pdaddl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_spdaddre</span> <span class="nv">z</span> <span class="nv">x</span> <span class="nv">y</span> : z \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; y -&gt; z &lt;= x -&gt; z &lt; x + y.</label><small class="alectryon-output"><div><q>106b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>106e</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: z y x =&gt; [z| |] [y| |] [x| |] _ //=; <span class="nb">rewrite</span> ?(lte_fin,ltry,ltNyr)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1072</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; y)%R -&gt; (z%:E &lt;= x%:E)%E -&gt; (z &lt; x + y)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: ltr_spaddr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_spdadder</span> <span class="nv">z</span> <span class="nv">x</span> <span class="nv">y</span> : x \<span class="kr">is</span> a fin_num -&gt; <span class="mi">0</span> &lt; y -&gt; z &lt;= x -&gt; z &lt; x + y.</label><small class="alectryon-output"><div><q>1076</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><q>1079</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: z y x =&gt; [z| |] [y| |] [x| |] _ //=; <span class="nb">rewrite</span> ?(lte_fin,ltry,ltNyr)//.</label><q>119e</q><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: ltr_spaddr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">DualERealArithTh_realDomainType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> lee_dsum_nneg_ord {R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> lee_dsum_npos_ord {R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> lee_dsum_nneg_natr {R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> lee_dsum_npos_natr {R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> lee_dsum_nneg_natl {R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> lee_dsum_npos_natl {R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">DualAddTheoryRealDomain</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_opp2</span> {<span class="nv">R</span> : numDomainType} : {mono @oppe R : x y /~ x &lt;= y}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{mono -%E : y x / x &lt;= y &gt;-&gt; y &lt;= x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>11a4</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; x y; <span class="nb">case</span>: x y =&gt; [?||] [?||] //; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> !lee_fin !ler_opp2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>_r_</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(- _r_%:E &lt;= - -oo) = (-oo &lt;= _r_%:E)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>11ab</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(- +oo &lt;= - _r_%:E) = (_r_%:E &lt;= +oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span>  /Order.le/= realN.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>11ab</q><span class="goal-separator"><hr></span><q>11b0</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /Order.le/= realN.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_opp2</span> {<span class="nv">R</span> : numDomainType} : {mono @oppe R : x y /~ x &lt; y}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{mono -%E : y x / x &lt; y &gt;-&gt; y &lt; x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>11b5</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; x y; <span class="nb">case</span>: x y =&gt; [?||] [?||] //; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> !lte_fin !ltr_opp2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>11ab</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- _r_%:E &lt; - -oo) = (-oo &lt; _r_%:E)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>11ab</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(- +oo &lt; - _r_%:E) = (_r_%:E &lt; +oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span>  /Order.lt/= realN.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>11ab</q><span class="goal-separator"><hr></span><q>11bf</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /Order.lt/= realN.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">realFieldType_lemmas</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">R</span> : realFieldType.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> <span class="nv">x</span> <span class="nv">y</span> : \bar R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> <span class="nv">r</span> : R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_adde</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="kr">forall</span> <span class="nv">e</span> : {posnum R}, x &lt;= y + e%:num%:E) -&gt; x &lt;= y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>realFieldType</span></span></span><br><q>23</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">e</span> : {posnum R}, x &lt;= y + (e%:num)%:E) -&gt;
x &lt;= y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>11c4</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x||] [y||] // xleye; <span class="nb">rewrite</span> <span class="nl">?leNye</span> <span class="nl">?leey</span>//; <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><span><var>xleye</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">e</span> : {posnum R},
+oo &lt;= -oo + (e%:num)%:E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">+oo &lt;= -oo</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>9e</q><br><span><var>xleye</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">e</span> : {posnum R},
+oo &lt;= y%:E + (e%:num)%:E</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">+oo &lt;= y%:E</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>9a</q><br><span><var>xleye</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">e</span> : {posnum R},
x%:E &lt;= -oo + (e%:num)%:E</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">x%:E &lt;= -oo</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>95</q><br><span><var>xleye</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">e</span> : {posnum R},
x%:E &lt;= y%:E + (e%:num)%:E</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">x%:E &lt;= y%:E</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>11cb</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">exact</span>: (le_trans (xleye <span class="mi">1</span>%:pos%R)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>11d2</q><span class="goal-separator"><hr></span><q>11d4</q></blockquote><div class="alectryon-extra-goals"><q>11d5</q><q>11d9</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>11df</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: (!! xleye <span class="mi">1</span>%:pos%R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>11d6</q><span class="goal-separator"><hr></span><q>11d8</q></blockquote><div class="alectryon-extra-goals"><q>11d9</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>11e4</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: (!! xleye <span class="mi">1</span>%:pos%R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>11da</q><span class="goal-separator"><hr></span><q>11dc</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> leNgt; <span class="nb">apply</span>/negP =&gt; yltx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>95</q><br><q>11db</q><br><span><var>yltx</var><span class="hyp-type"><b>: </b><span>y%:E &lt; x%:E</span></span></span><br></div><span class="goal-separator"><hr></span><q>6a0</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> xmy_gt0 : (<span class="mi">0</span> &lt; (x - y) / <span class="mi">2</span>)%R <span class="bp">by</span> <span class="nb">rewrite</span> ltr_pdivl_mulr// mul0r subr_gt0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>95</q><br><q>11db</q><br><q>11ef</q><br><span><var>xmy_gt0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; (x - y) / <span class="mi">2</span>)%R</span></span></span><br></div><span class="goal-separator"><hr></span><q>6a0</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: (xleye (PosNum xmy_gt0)); <span class="nb">apply</span>/negP; <span class="nb">rewrite</span> -ltNge /= -EFinD lte_fin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>11f3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(y + (x - y) / <span class="mi">2</span> &lt; x)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> [Y <span class="kr">in</span> (Y + _)%R]splitr [X <span class="kr">in</span> (_ &lt; X)%R]splitr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>11f3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(y / <span class="mi">2</span> + y / <span class="mi">2</span> + (x - y) / <span class="mi">2</span> &lt; x / <span class="mi">2</span> + x / <span class="mi">2</span>)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -!mulrDl ltr_pmul2r// addrCA addrK ltr_add2l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_mul01Pr</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt;= x -&gt;
  reflect (<span class="kr">forall</span> <span class="nv">r</span>, (<span class="mi">0</span> &lt; r &lt; <span class="mi">1</span>)%R -&gt; r%:E * x &lt;= y) (x &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>11c6</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt;
reflect (<span class="kr">forall</span> <span class="nv">r</span>, (<span class="mi">0</span> &lt; r &lt; <span class="mi">1</span>)%R -&gt; r%:E * x &lt;= y)
  (x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>11fe</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; x0; <span class="nb">apply</span>/(iffP idP) =&gt; [xy r /andP[r0 r1]|h].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>23</q><br><span><var>x0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= x</span></span></span><br><q>e35</q><br><q>ae</q><br><span><var>r0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; r)%R</span></span></span><br><span><var>r1</var><span class="hyp-type"><b>: </b><span>(r &lt; <span class="mi">1</span>)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r%:E * x &lt;= y</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>23</q><br><q>1206</q><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">r</span>, (<span class="mi">0</span> &lt; r &lt; <span class="mi">1</span>)%R -&gt; r%:E * x &lt;= y</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">x &lt;= y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x0 xy; <span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;-|x0 xy]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> mule0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>23</q><br><q>ae</q><br><q>1207</q><br><q>1208</q><br><q>b49</q><br><q>e35</q><br></div><span class="goal-separator"><hr></span><q>1209</q></blockquote><q>120a</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (le_trans _ xy) // gee_pmull // ltW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>120c</q><span class="goal-separator"><hr></span><q>120e</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> h01 : (<span class="mi">0</span> &lt; (<span class="mi">2</span>^-<span class="mi">1</span> : R) &lt; <span class="mi">1</span>)%R <span class="bp">by</span> <span class="nb">rewrite</span> invr_gt0 <span class="nl">?invf_lt1</span> <span class="nl">?ltr0n</span> <span class="nl">?ltr1n</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>23</q><br><q>1206</q><br><q>120d</q><br><span><var>h01</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; <span class="mi">2</span>^-<span class="mi">1</span> &lt; <span class="mi">1</span>)%R</span></span></span><br></div><span class="goal-separator"><hr></span><q>120e</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: x y =&gt; [x||] [y||] // <span class="kr">in</span> x0 h *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>121a</q><br><q>95</q><br><q>7cc</q><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">r</span>, (<span class="mi">0</span> &lt; r &lt; <span class="mi">1</span>)%R -&gt; r%:E * x%:E &lt;= y%:E</span></span></span><br></div><span class="goal-separator"><hr></span><q>11dc</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>121a</q><br><q>9a</q><br><q>7cc</q><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">r</span>, (<span class="mi">0</span> &lt; r &lt; <span class="mi">1</span>)%R -&gt; r%:E * x%:E &lt;= +oo</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">x%:E &lt;= +oo</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>121a</q><br><q>9a</q><br><q>7cc</q><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">r</span>, (<span class="mi">0</span> &lt; r &lt; <span class="mi">1</span>)%R -&gt; r%:E * x%:E &lt;= -oo</span></span></span><br></div><label class="goal-separator"><hr></label><q>11d8</q></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>121a</q><br><q>9e</q><br><span><var>x0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= +oo</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">r</span>, (<span class="mi">0</span> &lt; r &lt; <span class="mi">1</span>)%R -&gt; r%:E * +oo &lt;= y%:E</span></span></span><br></div><label class="goal-separator"><hr></label><q>11d4</q></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>121a</q><br><q>122a</q><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">r</span>, (<span class="mi">0</span> &lt; r &lt; <span class="mi">1</span>)%R -&gt; r%:E * +oo &lt;= -oo</span></span></span><br></div><label class="goal-separator"><hr></label><q>11cf</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>121c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: (x0); <span class="nb">rewrite</span> lee_fin le_eqVlt =&gt; /predU1P[&lt;-|{}x0].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>121e</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= y%:E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>121a</q><br><q>95</q><br><q>121f</q><br><q>4ca</q><br></div><label class="goal-separator"><hr></label><q>11dc</q></blockquote><q>1221</q><q>1225</q><q>1228</q><q>122c</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (le_trans _ (h _ h01))// mule_ge0// lee_fin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1236</q><span class="goal-separator"><hr></span><q>11dc</q></blockquote><q>1220</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> y0 : (<span class="mi">0</span> &lt; y)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1236</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; y)%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>121a</q><br><q>95</q><br><q>121f</q><br><q>4ca</q><br><q>4d4</q><br></div><label class="goal-separator"><hr></label><q>11dc</q></blockquote><q>1221</q><q>1225</q><q>1228</q><q>122c</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -lte_fin (lt_le_trans _ (h _ h01))// mule_gt0// lte_fin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1240</q><span class="goal-separator"><hr></span><q>11dc</q></blockquote><q>1220</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> lee_fin leNgt; <span class="nb">apply</span>/negP =&gt; yx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>121a</q><br><q>95</q><br><q>121f</q><br><q>4ca</q><br><q>4d4</q><br><span><var>yx</var><span class="hyp-type"><b>: </b><span>(y &lt; x)%R</span></span></span><br></div><span class="goal-separator"><hr></span><q>6a0</q></blockquote><q>1220</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> /h : (<span class="mi">0</span> &lt; (y + x) / (<span class="mi">2</span> * x) &lt; <span class="mi">1</span>)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1247</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; (y + x) / (<span class="mi">2</span> * x) &lt; <span class="mi">1</span>)%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>1247</q><label class="goal-separator"><hr></label><div class="goal-conclusion">((y + x) / (<span class="mi">2</span> * x))%:E * x%:E &lt;= y%:E -&gt; <span class="kt">False</span></div></blockquote><q>1221</q><q>1225</q><q>1228</q><q>122c</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/andP; <span class="nb">split</span>; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> divr_gt0 // <span class="nl">?addr_gt0</span>// <span class="nl">?mulr_gt0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1247</q><span class="goal-separator"><hr></span><div class="goal-conclusion">((y + x) / (<span class="mi">2</span> * x) &lt; <span class="mi">1</span>)%R</div></blockquote><q>124d</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltr_pdivr_mulr <span class="nl">?mulr_gt0</span>// mul1r mulr_natl mulr2n ltr_add2r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1247</q><span class="goal-separator"><hr></span><q>124f</q></blockquote><q>1220</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -(EFinM _ x) lee_fin invrM <span class="nl">?unitfE</span>// <span class="nl">?gt_eqF</span>// -mulrA mulrAC.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1247</q><span class="goal-separator"><hr></span><div class="goal-conclusion">((y + x) * (x^-<span class="mi">1</span> * x / <span class="mi">2</span>) &lt;= y)%R -&gt; <span class="kt">False</span></div></blockquote><q>1220</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulVr <span class="nl">?unitfE</span> <span class="nl">?gt_eqF</span>// mul1r; <span class="nb">apply</span>/negP; <span class="nb">rewrite</span> -ltNge midf_lt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1222</q><span class="goal-separator"><hr></span><q>1224</q></blockquote><div class="alectryon-extra-goals"><q>1225</q><q>1228</q><q>122c</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>125c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1226</q><span class="goal-separator"><hr></span><q>11d8</q></blockquote><div class="alectryon-extra-goals"><q>1228</q><q>122c</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1261</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">have</span> := h _ h01.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1229</q><span class="goal-separator"><hr></span><q>11d4</q></blockquote><div class="alectryon-extra-goals"><q>122c</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1266</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">have</span> := h _ h01; <span class="nb">rewrite</span> mulr_infty sgrV gtr0_sg // mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>122d</q><span class="goal-separator"><hr></span><q>11cf</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>126b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">have</span> := h _ h01; <span class="nb">rewrite</span> mulr_infty sgrV gtr0_sg // mul1e.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_pdivr_mull</span> <span class="nv">r</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="mi">0</span> &lt; r)%R -&gt; (r^-<span class="mi">1</span>%:E * y &lt; x) = (y &lt; r%:E * x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>23</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; r)%R -&gt; ((r^-<span class="mi">1</span>)%:E * y &lt; x) = (y &lt; r%:E * x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>126f</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; r0; <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>1207</q><br><q>95</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((r^-<span class="mi">1</span>)%:E * y%:E &lt; x%:E) = (y%:E &lt; r%:E * x%:E)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>1207</q><br><q>9a</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">((r^-<span class="mi">1</span>)%:E * +oo &lt; x%:E) = (+oo &lt; r%:E * x%:E)</div></blockquote><blockquote class="alectryon-goal"><q>127b</q><label class="goal-separator"><hr></label><div class="goal-conclusion">((r^-<span class="mi">1</span>)%:E * -oo &lt; x%:E) = (-oo &lt; r%:E * x%:E)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>1207</q><br><q>9e</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">((r^-<span class="mi">1</span>)%:E * y%:E &lt; +oo) = (y%:E &lt; r%:E * +oo)</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>1207</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">((r^-<span class="mi">1</span>)%:E * +oo &lt; +oo) = (+oo &lt; r%:E * +oo)</div></blockquote><blockquote class="alectryon-goal"><q>1283</q><label class="goal-separator"><hr></label><div class="goal-conclusion">((r^-<span class="mi">1</span>)%:E * -oo &lt; +oo) = (-oo &lt; r%:E * +oo)</div></blockquote><blockquote class="alectryon-goal"><q>1280</q><label class="goal-separator"><hr></label><div class="goal-conclusion">((r^-<span class="mi">1</span>)%:E * y%:E &lt; -oo) = (y%:E &lt; r%:E * -oo)</div></blockquote><blockquote class="alectryon-goal"><q>1283</q><label class="goal-separator"><hr></label><div class="goal-conclusion">((r^-<span class="mi">1</span>)%:E * +oo &lt; -oo) = (+oo &lt; r%:E * -oo)</div></blockquote><blockquote class="alectryon-goal"><q>1283</q><label class="goal-separator"><hr></label><div class="goal-conclusion">((r^-<span class="mi">1</span>)%:E * -oo &lt; -oo) = (-oo &lt; r%:E * -oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1275</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">2</span>!lte_fin ltr_pdivr_mull.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>127b</q><span class="goal-separator"><hr></span><q>127c</q></blockquote><div class="alectryon-extra-goals"><q>127d</q><q>127f</q><q>1282</q><q>1285</q><q>1287</q><q>1289</q><q>128b</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>128f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty sgrV gtr0_sg// mul1e <span class="mi">2</span>!ltNge <span class="mi">2</span>!leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>127b</q><span class="goal-separator"><hr></span><q>127e</q></blockquote><div class="alectryon-extra-goals"><q>127f</q><q>1282</q><q>1285</q><q>1287</q><q>1289</q><q>128b</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1294</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty sgrV gtr0_sg// mul1e -EFinM <span class="mi">2</span>!ltNyr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1280</q><span class="goal-separator"><hr></span><q>1281</q></blockquote><div class="alectryon-extra-goals"><q>1282</q><q>1285</q><q>1287</q><q>1289</q><q>128b</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1299</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e <span class="mi">2</span>!ltry.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1283</q><span class="goal-separator"><hr></span><q>1284</q></blockquote><div class="alectryon-extra-goals"><q>1285</q><q>1287</q><q>1289</q><q>128b</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>129e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty [<span class="kr">in</span> RHS]mulr_infty sgrV gtr0_sg// mul1e ltxx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1283</q><span class="goal-separator"><hr></span><q>1286</q></blockquote><div class="alectryon-extra-goals"><q>1287</q><q>1289</q><q>128b</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>12a3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty [<span class="kr">in</span> RHS]mulr_infty sgrV gtr0_sg// <span class="mi">2</span>!mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1280</q><span class="goal-separator"><hr></span><q>1288</q></blockquote><div class="alectryon-extra-goals"><q>1289</q><q>128b</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>12a8</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1283</q><span class="goal-separator"><hr></span><q>128a</q></blockquote><div class="alectryon-extra-goals"><q>128b</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>12ad</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty [<span class="kr">in</span> RHS]mulr_infty sgrV gtr0_sg// <span class="mi">2</span>!mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1283</q><span class="goal-separator"><hr></span><q>128c</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>12b2</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty [<span class="kr">in</span> RHS]mulr_infty sgrV gtr0_sg// mul1e.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_pdivr_mulr</span> <span class="nv">r</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="mi">0</span> &lt; r)%R -&gt; (y * r^-<span class="mi">1</span>%:E &lt; x) = (y &lt; x * r%:E).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1271</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; r)%R -&gt; (y * (r^-<span class="mi">1</span>)%:E &lt; x) = (y &lt; x * r%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>12b6</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; r0; <span class="nb">rewrite</span> muleC lte_pdivr_mull// muleC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_pdivl_mull</span> <span class="nv">r</span> <span class="nv">y</span> <span class="nv">x</span> : (<span class="mi">0</span> &lt; r)%R -&gt; (x &lt; r^-<span class="mi">1</span>%:E * y) = (r%:E * x &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>751</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; r)%R -&gt; (x &lt; (r^-<span class="mi">1</span>)%:E * y) = (r%:E * x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>12bb</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; r0; <span class="nb">move</span>: x y =&gt; [x| |] [y| |] //=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1277</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x%:E &lt; (r^-<span class="mi">1</span>)%:E * y%:E) = (r%:E * x%:E &lt; y%:E)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>127b</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x%:E &lt; (r^-<span class="mi">1</span>)%:E * +oo) = (r%:E * x%:E &lt; +oo)</div></blockquote><blockquote class="alectryon-goal"><q>127b</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(x%:E &lt; (r^-<span class="mi">1</span>)%:E * -oo) = (r%:E * x%:E &lt; -oo)</div></blockquote><blockquote class="alectryon-goal"><q>1280</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(+oo &lt; (r^-<span class="mi">1</span>)%:E * y%:E) = (r%:E * +oo &lt; y%:E)</div></blockquote><blockquote class="alectryon-goal"><q>1283</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(+oo &lt; (r^-<span class="mi">1</span>)%:E * +oo) = (r%:E * +oo &lt; +oo)</div></blockquote><blockquote class="alectryon-goal"><q>1283</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(+oo &lt; (r^-<span class="mi">1</span>)%:E * -oo) = (r%:E * +oo &lt; -oo)</div></blockquote><blockquote class="alectryon-goal"><q>1280</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(-oo &lt; (r^-<span class="mi">1</span>)%:E * y%:E) = (r%:E * -oo &lt; y%:E)</div></blockquote><blockquote class="alectryon-goal"><q>1283</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(-oo &lt; (r^-<span class="mi">1</span>)%:E * +oo) = (r%:E * -oo &lt; +oo)</div></blockquote><blockquote class="alectryon-goal"><q>1283</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(-oo &lt; (r^-<span class="mi">1</span>)%:E * -oo) = (r%:E * -oo &lt; -oo)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>12c1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">2</span>!lte_fin ltr_pdivl_mull.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>127b</q><span class="goal-separator"><hr></span><q>12c6</q></blockquote><div class="alectryon-extra-goals"><q>12c7</q><q>12c9</q><q>12cb</q><q>12cd</q><q>12cf</q><q>12d1</q><q>12d3</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>12d7</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty sgrV gtr0_sg// mul1e <span class="mi">2</span>!ltry.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>127b</q><span class="goal-separator"><hr></span><q>12c8</q></blockquote><div class="alectryon-extra-goals"><q>12c9</q><q>12cb</q><q>12cd</q><q>12cf</q><q>12d1</q><q>12d3</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>12dc</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty sgrV gtr0_sg// mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1280</q><span class="goal-separator"><hr></span><q>12ca</q></blockquote><div class="alectryon-extra-goals"><q>12cb</q><q>12cd</q><q>12cf</q><q>12d1</q><q>12d3</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>12e1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1283</q><span class="goal-separator"><hr></span><q>12cc</q></blockquote><div class="alectryon-extra-goals"><q>12cd</q><q>12cf</q><q>12d1</q><q>12d3</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>12e6</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty [<span class="kr">in</span> RHS]mulr_infty sgrV gtr0_sg// mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1283</q><span class="goal-separator"><hr></span><q>12ce</q></blockquote><div class="alectryon-extra-goals"><q>12cf</q><q>12d1</q><q>12d3</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>12eb</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty [<span class="kr">in</span> RHS]mulr_infty sgrV gtr0_sg// <span class="mi">2</span>!mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1280</q><span class="goal-separator"><hr></span><q>12d0</q></blockquote><div class="alectryon-extra-goals"><q>12d1</q><q>12d3</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>12f0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty gtr0_sg// mul1e <span class="mi">2</span>!ltNyr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1283</q><span class="goal-separator"><hr></span><q>12d2</q></blockquote><div class="alectryon-extra-goals"><q>12d3</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>12f5</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty [<span class="kr">in</span> RHS]mulr_infty sgrV gtr0_sg// <span class="mi">2</span>!mul1e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1283</q><span class="goal-separator"><hr></span><q>12d4</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>12fa</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mulr_infty [<span class="kr">in</span> RHS]mulr_infty sgrV gtr0_sg// mul1e.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_pdivl_mulr</span> <span class="nv">r</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="mi">0</span> &lt; r)%R -&gt; (x &lt; y * r^-<span class="mi">1</span>%:E) = (x * r%:E &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1271</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; r)%R -&gt; (x &lt; y * (r^-<span class="mi">1</span>)%:E) = (x * r%:E &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>12fe</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; r0; <span class="nb">rewrite</span> muleC lte_pdivl_mull// muleC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_ndivl_mulr</span> <span class="nv">r</span> <span class="nv">x</span> <span class="nv">y</span> : (r &lt; <span class="mi">0</span>)%R -&gt; (x &lt; y * r^-<span class="mi">1</span>%:E) = (y &lt; x * r%:E).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1271</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r &lt; <span class="mi">0</span>)%R -&gt; (x &lt; y * (r^-<span class="mi">1</span>)%:E) = (y &lt; x * r%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1303</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -oppr0 ltr_oppr =&gt; r0; <span class="nb">rewrite</span> -{<span class="mi">1</span>}(opprK r) invrN.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>23</q><br><span><var>r0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; - r)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt; y * (- (- r)^-<span class="mi">1</span>)%:E) = (y &lt; x * r%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> EFinN muleN lte_oppr lte_pdivr_mulr// EFinN muleNN.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_ndivl_mull</span> <span class="nv">r</span> <span class="nv">x</span> <span class="nv">y</span> : (r &lt; <span class="mi">0</span>)%R -&gt; (x &lt; r^-<span class="mi">1</span>%:E * y) = (y &lt; r%:E * x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1271</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r &lt; <span class="mi">0</span>)%R -&gt; (x &lt; (r^-<span class="mi">1</span>)%:E * y) = (y &lt; r%:E * x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>130e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; r0; <span class="nb">rewrite</span> muleC lte_ndivl_mulr// muleC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_ndivr_mull</span> <span class="nv">r</span> <span class="nv">x</span> <span class="nv">y</span> : (r &lt; <span class="mi">0</span>)%R -&gt; (r^-<span class="mi">1</span>%:E * y &lt; x) = (r%:E * x &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1271</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r &lt; <span class="mi">0</span>)%R -&gt; ((r^-<span class="mi">1</span>)%:E * y &lt; x) = (r%:E * x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1313</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -oppr0 ltr_oppr =&gt; r0; <span class="nb">rewrite</span> -{<span class="mi">1</span>}(opprK r) invrN.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>130a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">((- (- r)^-<span class="mi">1</span>)%:E * y &lt; x) = (r%:E * x &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> EFinN mulNe lte_oppl lte_pdivl_mull// EFinN muleNN.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lte_ndivr_mulr</span> <span class="nv">r</span> <span class="nv">x</span> <span class="nv">y</span> : (r &lt; <span class="mi">0</span>)%R -&gt; (y * r^-<span class="mi">1</span>%:E &lt; x) = (x * r%:E &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1271</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r &lt; <span class="mi">0</span>)%R -&gt; (y * (r^-<span class="mi">1</span>)%:E &lt; x) = (x * r%:E &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>131c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; r0; <span class="nb">rewrite</span> muleC lte_ndivr_mull// muleC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_pdivr_mull</span> <span class="nv">r</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="mi">0</span> &lt; r)%R -&gt; (r^-<span class="mi">1</span>%:E * y &lt;= x) = (y &lt;= r%:E * x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1271</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; r)%R -&gt; ((r^-<span class="mi">1</span>)%:E * y &lt;= x) = (y &lt;= r%:E * x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1321</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; r0; <span class="nb">apply</span>/idP/idP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>23</q><br><q>1207</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(r^-<span class="mi">1</span>)%:E * y &lt;= x -&gt; y &lt;= r%:E * x</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>1328</q><label class="goal-separator"><hr></label><div class="goal-conclusion">y &lt;= r%:E * x -&gt; (r^-<span class="mi">1</span>)%:E * y &lt;= x</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1326</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;-|]; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> lte_pdivr_mull// =&gt; /ltW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1328</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y &lt;= r%:E * ((r^-<span class="mi">1</span>)%:E * y)</div></blockquote><q>132a</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleA -EFinM divrr <span class="nl">?mul1e</span>// unitfE gt_eqF.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1328</q><span class="goal-separator"><hr></span><q>132c</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1333</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[-&gt;|]; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> -lte_pdivr_mull// =&gt; /ltW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1328</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r^-<span class="mi">1</span>)%:E * (r%:E * x) &lt;= x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleA -EFinM mulVr <span class="nl">?mul1e</span>// unitfE gt_eqF.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_pdivr_mulr</span> <span class="nv">r</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="mi">0</span> &lt; r)%R -&gt; (y * r^-<span class="mi">1</span>%:E &lt;= x) = (y &lt;= x * r%:E).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1271</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; r)%R -&gt; (y * (r^-<span class="mi">1</span>)%:E &lt;= x) = (y &lt;= x * r%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>133b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; r0; <span class="nb">rewrite</span> muleC lee_pdivr_mull// muleC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_pdivl_mull</span> <span class="nv">r</span> <span class="nv">y</span> <span class="nv">x</span> : (<span class="mi">0</span> &lt; r)%R -&gt; (x &lt;= r^-<span class="mi">1</span>%:E * y) = (r%:E * x &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>12bd</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; r)%R -&gt; (x &lt;= (r^-<span class="mi">1</span>)%:E * y) = (r%:E * x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1340</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; r0; <span class="nb">apply</span>/idP/idP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>751</q><br><q>1207</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= (r^-<span class="mi">1</span>)%:E * y -&gt; r%:E * x &lt;= y</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>1347</q><label class="goal-separator"><hr></label><div class="goal-conclusion">r%:E * x &lt;= y -&gt; x &lt;= (r^-<span class="mi">1</span>)%:E * y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1345</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[-&gt;|]; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> lte_pdivl_mull// =&gt; /ltW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1347</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r%:E * ((r^-<span class="mi">1</span>)%:E * y) &lt;= y</div></blockquote><q>1349</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleA -EFinM divrr <span class="nl">?mul1e</span>// unitfE gt_eqF.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1347</q><span class="goal-separator"><hr></span><q>134b</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1352</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;-|]; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> -lte_pdivl_mull// =&gt; /ltW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1347</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= (r^-<span class="mi">1</span>)%:E * (r%:E * x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> muleA -EFinM mulVr <span class="nl">?mul1e</span>// unitfE gt_eqF.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_pdivl_mulr</span> <span class="nv">r</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="mi">0</span> &lt; r)%R -&gt; (x &lt;= y * r^-<span class="mi">1</span>%:E) = (x * r%:E &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1271</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; r)%R -&gt; (x &lt;= y * (r^-<span class="mi">1</span>)%:E) = (x * r%:E &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>135a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; r0; <span class="nb">rewrite</span> muleC lee_pdivl_mull// muleC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_ndivl_mulr</span> <span class="nv">r</span> <span class="nv">x</span> <span class="nv">y</span> : (r &lt; <span class="mi">0</span>)%R -&gt; (x &lt;= y * r^-<span class="mi">1</span>%:E) = (y &lt;= x * r%:E).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1271</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r &lt; <span class="mi">0</span>)%R -&gt; (x &lt;= y * (r^-<span class="mi">1</span>)%:E) = (y &lt;= x * r%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>135f</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -oppr0 ltr_oppr =&gt; r0; <span class="nb">rewrite</span> -{<span class="mi">1</span>}(opprK r) invrN.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>130a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt;= y * (- (- r)^-<span class="mi">1</span>)%:E) = (y &lt;= x * r%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> EFinN muleN lee_oppr lee_pdivr_mulr// EFinN muleNN.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_ndivl_mull</span> <span class="nv">r</span> <span class="nv">x</span> <span class="nv">y</span> : (r &lt; <span class="mi">0</span>)%R -&gt; (x &lt;= r^-<span class="mi">1</span>%:E * y) = (y &lt;= r%:E * x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1271</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r &lt; <span class="mi">0</span>)%R -&gt; (x &lt;= (r^-<span class="mi">1</span>)%:E * y) = (y &lt;= r%:E * x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1368</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; r0; <span class="nb">rewrite</span> muleC lee_ndivl_mulr// muleC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_ndivr_mull</span> <span class="nv">r</span> <span class="nv">x</span> <span class="nv">y</span> : (r &lt; <span class="mi">0</span>)%R -&gt; (r^-<span class="mi">1</span>%:E * y &lt;= x) = (r%:E * x &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1271</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r &lt; <span class="mi">0</span>)%R -&gt; ((r^-<span class="mi">1</span>)%:E * y &lt;= x) = (r%:E * x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>136d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -oppr0 ltr_oppr =&gt; r0; <span class="nb">rewrite</span> -{<span class="mi">1</span>}(opprK r) invrN.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>130a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">((- (- r)^-<span class="mi">1</span>)%:E * y &lt;= x) = (r%:E * x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> EFinN mulNe lee_oppl lee_pdivl_mull// EFinN muleNN.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_ndivr_mulr</span> <span class="nv">r</span> <span class="nv">x</span> <span class="nv">y</span> : (r &lt; <span class="mi">0</span>)%R -&gt; (y * r^-<span class="mi">1</span>%:E &lt;= x) = (x * r%:E &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1271</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r &lt; <span class="mi">0</span>)%R -&gt; (y * (r^-<span class="mi">1</span>)%:E &lt;= x) = (x * r%:E &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1376</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; r0; <span class="nb">rewrite</span> muleC lee_ndivr_mull// muleC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">realFieldType_lemmas</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">DualAddTheoryRealField</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> DualAddTheoryNumDomain DualAddTheoryRealDomain.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">DualRealFieldType_lemmas</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">R</span> : realFieldType.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> <span class="nv">x</span> <span class="nv">y</span> : \bar R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lee_dadde</span> <span class="nv">x</span> <span class="nv">y</span> : (<span class="kr">forall</span> <span class="nv">e</span> : {posnum R}, x &lt;= y + e%:num%:E) -&gt; x &lt;= y.</label><small class="alectryon-output"><div><q>11c4</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>11c4</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; xye; <span class="nb">apply</span>: lee_adde =&gt; e; <span class="nb">case</span>: x {xye} (xye e).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">DualRealFieldType_lemmas</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">DualAddTheoryRealField</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">DualAddTheory</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Export</span> DualAddTheoryNumDomain.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Export</span> DualAddTheoryRealDomain.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Export</span> DualAddTheoryRealField.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">DualAddTheory</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">ConstructiveDualAddTheory</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Export</span> DualAddTheory.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">ConstructiveDualAddTheory</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">posnume</span> (<span class="nv">R</span> : numDomainType) <span class="nv">of</span> <span class="nv">phant</span> <span class="nv">R</span> := {&gt; <span class="mi">0</span> : \bar R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;{ &#39;posnum&#39; &#39;\bar&#39; R }&quot;</span> := (@posnume _ (Phant R))  : type_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">nonnege</span> (<span class="nv">R</span> : numDomainType) <span class="nv">of</span> <span class="nv">phant</span> <span class="nv">R</span> := {&gt;= <span class="mi">0</span> : \bar R}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;{ &#39;nonneg&#39; &#39;\bar&#39; R }&quot;</span> := (@nonnege _ (Phant R))  : type_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x %:pos&quot;</span> := (widen_signed x%:sgn : {posnum \bar _}) (<span class="kn">only parsing</span>)
  : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x %:pos&quot;</span> := (widen_signed x%:sgn : {posnum \bar _}) (<span class="kn">only parsing</span>)
  : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x %:nng&quot;</span> := (widen_signed x%:sgn : {nonneg \bar _}) (<span class="kn">only parsing</span>)
  : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x %:nng&quot;</span> := (widen_signed x%:sgn : {nonneg \bar _}) (<span class="kn">only parsing</span>)
  : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x %:pos&quot;</span> := (@widen_signed ereal_display _ _ _ _
    (@Signed.<span class="kn">from</span> _ _ _ _ _ _ (Phantom _ x))
    !=<span class="mi">0</span> (KnownSign.Real (KnownSign.Sign &gt;=<span class="mi">0</span>)) _ _)
  (<span class="kn">only printing</span>) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x %:pos&quot;</span> := (@widen_signed ereal_display _ _ _ _
    (@Signed.<span class="kn">from</span> _ _ _ _ _ _ (Phantom _ x))
    !=<span class="mi">0</span> (KnownSign.Real (KnownSign.Sign &gt;=<span class="mi">0</span>)) _ _)
  (<span class="kn">only printing</span>) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x %:nng&quot;</span> := (@widen_signed ereal_display _ _ _ _
    (@Signed.<span class="kn">from</span> _ _ _ _ _ _ (Phantom _ x))
    ?=<span class="mi">0</span> (KnownSign.Real (KnownSign.Sign &gt;=<span class="mi">0</span>)) _ _)
  (<span class="kn">only printing</span>) : ereal_dual_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x %:nng&quot;</span> := (@widen_signed ereal_display _ _ _ _
    (@Signed.<span class="kn">from</span> _ _ _ _ _ _ (Phantom _ x))
    ?=<span class="mi">0</span> (KnownSign.Real (KnownSign.Sign &gt;=<span class="mi">0</span>)) _ _)
  (<span class="kn">only printing</span>) : ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Hint Extern</span> <span class="mi">0</span> (is_true (<span class="mi">0</span>%E &lt; _)%O) =&gt; <span class="kp">solve</span> [<span class="nb">apply</span>: gt0] : core.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Hint Extern</span> <span class="mi">0</span> (is_true (_ &lt; <span class="mi">0</span>%E)%O) =&gt; <span class="kp">solve</span> [<span class="nb">apply</span>: lt0] : core.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Hint Extern</span> <span class="mi">0</span> (is_true (<span class="mi">0</span>%E &lt;= _)%O) =&gt; <span class="kp">solve</span> [<span class="nb">apply</span>: ge0] : core.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Hint Extern</span> <span class="mi">0</span> (is_true (_ &lt;= <span class="mi">0</span>%E)%O) =&gt; <span class="kp">solve</span> [<span class="nb">apply</span>: le0] : core.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Hint Extern</span> <span class="mi">0</span> (is_true (<span class="mi">0</span>%E &gt;=&lt; _)%O) =&gt; <span class="kp">solve</span> [<span class="nb">apply</span>: cmp0] : core.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Hint Extern</span> <span class="mi">0</span> (is_true (_ != <span class="mi">0</span>%E)%O) =&gt; <span class="kp">solve</span> [<span class="nb">apply</span>: neq0] : core.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">SignedNumDomainStability</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">R</span> : numDomainType}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">pinfty_snum_subproof</span> : Signed.spec <span class="mi">0</span> !=<span class="mi">0</span> &gt;=<span class="mi">0</span> (+oo : \bar R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">Signed.spec <span class="mi">0</span> !=<span class="mi">0</span> &gt;=<span class="mi">0</span> (+oo : \bar R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>137d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /= le0y.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">pinfty_snum</span> := Signed.mk (pinfty_snum_subproof).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ninfty_snum_subproof</span> : Signed.spec <span class="mi">0</span> !=<span class="mi">0</span> &lt;=<span class="mi">0</span> (-oo : \bar R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>29</q><span class="goal-separator"><hr></span><div class="goal-conclusion">Signed.spec <span class="mi">0</span> !=<span class="mi">0</span> &lt;=<span class="mi">0</span> (-oo : \bar R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1382</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /= leNy0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">ninfty_snum</span> := Signed.mk (ninfty_snum_subproof).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">EFin_snum_subproof</span> <span class="nv">nz</span> <span class="nv">cond</span> (<span class="nv">x</span> : {num R &amp; nz &amp; cond}) :
  Signed.spec <span class="mi">0</span> nz cond x%:num%:E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>nz</var><span class="hyp-type"><b>: </b><span>KnownSign.nullity</span></span></span><br><span><var>cond</var><span class="hyp-type"><b>: </b><span>KnownSign.reality</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>{num R &amp; nz &amp; cond}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(KnownSign.nullity_bool nz ==&gt; ((x%:num)%:E != <span class="mi">0</span>)) &amp;&amp;
Signed.reality_cond <span class="mi">0</span> cond (x%:num)%:E</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1387</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/andP; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1389</q><span class="goal-separator"><hr></span><div class="goal-conclusion">KnownSign.nullity_bool nz ==&gt; ((x%:num)%:E != <span class="mi">0</span>)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>1389</q><label class="goal-separator"><hr></label><div class="goal-conclusion">Signed.reality_cond <span class="mi">0</span> cond (x%:num)%:E</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: cond nz x =&gt; [[[]|]|] [] x //=;
    <span class="kp">do</span> ?[<span class="bp">by</span> <span class="nb">case</span>: (bottom x)|<span class="bp">by</span> <span class="nb">rewrite</span> eqe eq0F].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1389</q><span class="goal-separator"><hr></span><q>1395</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">case</span>: cond nz x =&gt; [[[]|]|] [] x //=;
  <span class="kp">do</span> ?[<span class="bp">by</span> <span class="nb">case</span>: (bottom x)|<span class="bp">by</span> <span class="nb">rewrite</span> <span class="nl">?lee_fin</span> ?(eq0, ge0, le0) ?[_ || _]cmp0].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">EFin_snum</span> nz cond (x : {num R &amp; nz &amp; cond}) :=
  Signed.mk (EFin_snum_subproof x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fine_snum_subproof</span> (<span class="nv">xnz</span> : KnownSign.nullity) (<span class="nv">xr</span> : KnownSign.reality)
    (<span class="nv">x</span> : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; xnz &amp; xr}) :
  Signed.spec <span class="mi">0</span>%R ?=<span class="mi">0</span> xr (fine x%:num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>xnz</var><span class="hyp-type"><b>: </b><span>KnownSign.nullity</span></span></span><br><span><var>xr</var><span class="hyp-type"><b>: </b><span>KnownSign.reality</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>{<span class="nb">compare</span> <span class="mi">0</span> : \bar R &amp; xnz &amp; xr}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(KnownSign.nullity_bool ?=<span class="mi">0</span> ==&gt; (fine x%:num != <span class="mi">0</span>%R)) &amp;&amp;
Signed.reality_cond <span class="mi">0</span>%R xr (fine x%:num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>139a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: xr x =&gt; [[[]|]|]//= [x /andP[_]]/=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>139d</q><br><span><var>x</var><span class="hyp-type"><b>: </b><span>ereal_porderType</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x == <span class="mi">0</span> -&gt; fine x == <span class="mi">0</span>%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>13a5</q><label class="goal-separator"><hr></label><q>107</q></blockquote><blockquote class="alectryon-goal"><q>13a5</q><label class="goal-separator"><hr></label><q>116</q></blockquote><blockquote class="alectryon-goal"><q>13a5</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">0</span> &lt;= x) || (x &lt;= <span class="mi">0</span>) -&gt;
(<span class="mi">0</span> &lt;= fine x)%R || (fine x &lt;= <span class="mi">0</span>)%R</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>13a3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /eqP -&gt;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>13a5</q><span class="goal-separator"><hr></span><q>107</q></blockquote><div class="alectryon-extra-goals"><q>13aa</q><q>13ab</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>13af</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>13a5</q><span class="goal-separator"><hr></span><q>116</q></blockquote><div class="alectryon-extra-goals"><q>13ab</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>13b4</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>13a5</q><span class="goal-separator"><hr></span><q>13ac</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>13b9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /orP[]; <span class="nb">case</span>: x =&gt; [x||]//=; <span class="nb">rewrite</span> lee_fin =&gt; -&gt;; <span class="nb">rewrite</span> <span class="nl">?orbT</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">fine_snum</span> (xnz : KnownSign.nullity) (xr : KnownSign.reality)
    (x : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; xnz &amp; xr}) :=
  Signed.mk (fine_snum_subproof x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oppe_snum_subproof</span> (<span class="nv">xnz</span> : KnownSign.nullity) (<span class="nv">xr</span> : KnownSign.reality)
    (<span class="nv">x</span> : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; xnz &amp; xr}) (<span class="nv">r</span> := opp_reality_subdef xnz xr) :
  Signed.spec <span class="mi">0</span> xnz r (- x%:num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>139d</q><br><q>139e</q><br><q>139f</q><br><span><var>r</var><span><span class="hyp-body"><b>:= </b><span>opp_reality_subdef xnz xr</span></span><span class="hyp-type"><b>: </b><span>KnownSign.reality</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Signed.spec <span class="mi">0</span> xnz r (- x%:num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>13bd</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> {}/r; <span class="nb">case</span>: xr xnz x =&gt; [[[]|]|] [] x //=;
  <span class="kp">do</span> ?[<span class="bp">by</span> <span class="nb">case</span>: (bottom x)
      |<span class="bp">by</span> <span class="nb">rewrite</span> <span class="nl">?eqe_oppLR</span> <span class="nl">?oppe0</span> <span class="mi">1</span><span class="nl">?eq0</span>//;
          <span class="nb">rewrite</span> <span class="nl">?oppe_le0</span> <span class="nl">?oppe_ge0</span> ?(eq0, eq0F, ge0, le0)//;
          <span class="nb">rewrite</span> orbC [_ || _]cmp0].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">oppe_snum</span> (xnz : KnownSign.nullity) (xr : KnownSign.reality)
    (x : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; xnz &amp; xr}) :=
  Signed.mk (oppe_snum_subproof x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">adde_snum_subproof</span> (<span class="nv">xnz</span> <span class="nv">ynz</span> : KnownSign.nullity)
    (<span class="nv">xr</span> <span class="nv">yr</span> : KnownSign.reality)
    (<span class="nv">x</span> : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; xnz &amp; xr})
    (<span class="nv">y</span> : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; ynz &amp; yr})
    (<span class="nv">rnz</span> := add_nonzero_subdef xnz ynz xr yr)
    (<span class="nv">rrl</span> := add_reality_subdef xnz ynz xr yr) :
  Signed.spec <span class="mi">0</span> rnz rrl (x%:num + y%:num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><span><var>xnz, ynz</var><span class="hyp-type"><b>: </b><span>KnownSign.nullity</span></span></span><br><span><var>xr, yr</var><span class="hyp-type"><b>: </b><span>KnownSign.reality</span></span></span><br><q>139f</q><br><span><var>y</var><span class="hyp-type"><b>: </b><span>{<span class="nb">compare</span> <span class="mi">0</span> : \bar R &amp; ynz &amp; yr}</span></span></span><br><span><var>rnz</var><span><span class="hyp-body"><b>:= </b><span>add_nonzero_subdef xnz ynz xr yr</span></span><span class="hyp-type"><b>: </b><span>KnownSign.nullity</span></span></span></span><br><span><var>rrl</var><span><span class="hyp-body"><b>:= </b><span>add_reality_subdef xnz ynz xr yr</span></span><span class="hyp-type"><b>: </b><span>KnownSign.reality</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Signed.spec <span class="mi">0</span> rnz rrl (x%:num + y%:num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>13c4</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> {}/rnz {}/rrl; <span class="nb">apply</span>/andP; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>13c7</q><br><q>13c8</q><br><q>139f</q><br><q>13c9</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">KnownSign.nullity_bool
  (add_nonzero_subdef xnz ynz xr yr) ==&gt;
(x%:num + y%:num != <span class="mi">0</span>)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>13d1</q><label class="goal-separator"><hr></label><div class="goal-conclusion">Signed.reality_cond <span class="mi">0</span>
  (add_reality_subdef xnz ynz xr yr) (x%:num + y%:num)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: xr yr xnz ynz x y =&gt; [[[]|]|] [[[]|]|] [] []//= x y;
  <span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">1</span><span class="nl">?adde_ss_eq0</span> ?(eq0F, ge0, le0, andbF, orbT).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>13d1</q><span class="goal-separator"><hr></span><q>13d5</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">move</span>: xr yr xnz ynz x y =&gt; [[[]|]|] [[[]|]|] [] []//= x y;
  <span class="kp">do</span> ?[<span class="bp">by</span> <span class="nb">case</span>: (bottom x)|<span class="bp">by</span> <span class="nb">case</span>: (bottom y)
      |<span class="bp">by</span> <span class="nb">rewrite</span> adde_ge0|<span class="bp">by</span> <span class="nb">rewrite</span> adde_le0
      |<span class="bp">exact</span>: realDe|<span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">2</span>!eq0 add0e].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">adde_snum</span> (xnz ynz : KnownSign.nullity)
    (xr yr : KnownSign.reality)
    (x : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; xnz &amp; xr})
    (y : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; ynz &amp; yr}) :=
  Signed.mk (adde_snum_subproof x y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> DualAddTheory.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dadde_snum_subproof</span> (<span class="nv">xnz</span> <span class="nv">ynz</span> : KnownSign.nullity)
    (<span class="nv">xr</span> <span class="nv">yr</span> : KnownSign.reality)
    (<span class="nv">x</span> : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; xnz &amp; xr})
    (<span class="nv">y</span> : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; ynz &amp; yr})
    (<span class="nv">rnz</span> := add_nonzero_subdef xnz ynz xr yr)
    (<span class="nv">rrl</span> := add_reality_subdef xnz ynz xr yr) :
  Signed.spec <span class="mi">0</span> rnz rrl (x%:num + y%:num)%dE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>13c6</q><span class="goal-separator"><hr></span><div class="goal-conclusion">Signed.spec <span class="mi">0</span> rnz rrl (x%:num + y%:num)%dE</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>13da</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> {}/rnz {}/rrl; <span class="nb">apply</span>/andP; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>13d1</q><span class="goal-separator"><hr></span><div class="goal-conclusion">KnownSign.nullity_bool
  (add_nonzero_subdef xnz ynz xr yr) ==&gt;
((x%:num + y%:num)%dE != <span class="mi">0</span>)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>13d1</q><label class="goal-separator"><hr></label><div class="goal-conclusion">Signed.reality_cond <span class="mi">0</span>
  (add_reality_subdef xnz ynz xr yr)
  (x%:num + y%:num)%dE</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: xr yr xnz ynz x y =&gt; [[[]|]|] [[[]|]|] [] []//= x y;
  <span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">1</span><span class="nl">?dadde_ss_eq0</span> ?(eq0F, ge0, le0, andbF, orbT).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>13d1</q><span class="goal-separator"><hr></span><q>13e4</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">move</span>: xr yr xnz ynz x y =&gt; [[[]|]|] [[[]|]|] [] []//= x y;
  <span class="kp">do</span> ?[<span class="bp">by</span> <span class="nb">case</span>: (bottom x)|<span class="bp">by</span> <span class="nb">case</span>: (bottom y)
      |<span class="bp">by</span> <span class="nb">rewrite</span> dadde_ge0|<span class="bp">by</span> <span class="nb">rewrite</span> dadde_le0
      |<span class="bp">exact</span>: realDed|<span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">2</span>!eq0 dadd0e].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">dadde_snum</span> (xnz ynz : KnownSign.nullity)
    (xr yr : KnownSign.reality)
    (x : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; xnz &amp; xr})
    (y : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; ynz &amp; yr}) :=
  Signed.mk (dadde_snum_subproof x y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mule_snum_subproof</span> (<span class="nv">xnz</span> <span class="nv">ynz</span> : KnownSign.nullity)
    (<span class="nv">xr</span> <span class="nv">yr</span> : KnownSign.reality)
    (<span class="nv">x</span> : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; xnz &amp; xr})
    (<span class="nv">y</span> : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; ynz &amp; yr})
    (<span class="nv">rnz</span> := mul_nonzero_subdef xnz ynz xr yr)
    (<span class="nv">rrl</span> := mul_reality_subdef xnz ynz xr yr) :
  Signed.spec <span class="mi">0</span> rnz rrl (x%:num * y%:num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>13c7</q><br><q>13c8</q><br><q>139f</q><br><q>13c9</q><br><span><var>rnz</var><span><span class="hyp-body"><b>:= </b><span>mul_nonzero_subdef xnz ynz xr yr</span></span><span class="hyp-type"><b>: </b><span>KnownSign.nullity</span></span></span></span><br><span><var>rrl</var><span><span class="hyp-body"><b>:= </b><span>mul_reality_subdef xnz ynz xr yr</span></span><span class="hyp-type"><b>: </b><span>KnownSign.reality</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(KnownSign.nullity_bool rnz ==&gt; (x%:num * y%:num != <span class="mi">0</span>)) &amp;&amp;
Signed.reality_cond <span class="mi">0</span> rrl (x%:num * y%:num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>13e9</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> {}/rnz {}/rrl; <span class="nb">apply</span>/andP; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>13d1</q><span class="goal-separator"><hr></span><div class="goal-conclusion">KnownSign.nullity_bool
  (mul_nonzero_subdef xnz ynz xr yr) ==&gt;
(x%:num * y%:num != <span class="mi">0</span>)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>13d1</q><label class="goal-separator"><hr></label><div class="goal-conclusion">Signed.reality_cond <span class="mi">0</span>
  (mul_reality_subdef xnz ynz xr yr) (x%:num * y%:num)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: xr yr xnz ynz x y =&gt; [[[]|]|] [[[]|]|] [] []// x y;
     <span class="nb">rewrite</span> mule_neq0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>13d1</q><span class="goal-separator"><hr></span><q>13f6</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: xr yr xnz ynz x y =&gt; [[[]|]|] [[[]|]|] [] []/= x y //;
  <span class="kp">do</span> ?[<span class="bp">by</span> <span class="nb">case</span>: (bottom x)|<span class="bp">by</span> <span class="nb">case</span>: (bottom y)
      |<span class="bp">by</span> <span class="nb">rewrite</span> mule_ge0|<span class="bp">by</span> <span class="nb">rewrite</span> mule_le0_ge0
      |<span class="bp">by</span> <span class="nb">rewrite</span> mule_ge0_le0|<span class="bp">by</span> <span class="nb">rewrite</span> mule_le0|<span class="bp">exact</span>: realMe
      |<span class="bp">by</span> <span class="nb">rewrite</span> eq0 <span class="nl">?mule0</span>// mul0e].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">mule_snum</span> (xnz ynz : KnownSign.nullity) (xr yr : KnownSign.reality)
    (x : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; xnz &amp; xr})
    (y : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; ynz &amp; yr}) :=
  Signed.mk (mule_snum_subproof x y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">abse_reality_subdef</span> (<span class="nv">xnz</span> : KnownSign.nullity)
    (<span class="nv">xr</span> : KnownSign.reality) := (<span class="kr">if</span> xr <span class="kr">is</span> =<span class="mi">0</span> <span class="kr">then</span> =<span class="mi">0</span> <span class="kr">else</span> &gt;=<span class="mi">0</span>)%snum_sign.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> abse_reality_subdef /.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">abse_snum_subproof</span> (<span class="nv">xnz</span> : KnownSign.nullity) (<span class="nv">xr</span> : KnownSign.reality)
    (<span class="nv">x</span> : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; xnz &amp; xr}) (<span class="nv">r</span> := abse_reality_subdef xnz xr) :
  Signed.spec <span class="mi">0</span> xnz r `|x%:num|.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>139d</q><br><q>139e</q><br><q>139f</q><br><span><var>r</var><span><span class="hyp-body"><b>:= </b><span>abse_reality_subdef xnz xr</span></span><span class="hyp-type"><b>: </b><span>KnownSign.sign</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Signed.spec <span class="mi">0</span> xnz r `|x%:num|</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>13fb</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> {}/r; <span class="nb">case</span>: xr xnz x =&gt; [[[]|]|] [] x //=;
  <span class="kp">do</span> ?[<span class="bp">by</span> <span class="nb">case</span>: (bottom x)|<span class="bp">by</span> <span class="nb">rewrite</span> eq0 abse0
      |<span class="bp">by</span> <span class="nb">rewrite</span> abse_ge0// andbT gee0_abs
      |<span class="bp">by</span> <span class="nb">rewrite</span> abse_ge0// andbT lee0_abs
      |<span class="bp">by</span> <span class="nb">rewrite</span> abse_ge0// andbT abse_eq0].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">abse_snum</span> (xnz : KnownSign.nullity) (xr : KnownSign.reality)
    (x : {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; xnz &amp; xr}) :=
  Signed.mk (abse_snum_subproof x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">SignedNumDomainStability</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">MorphNum</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">R</span> : numDomainType} {<span class="nv">nz</span> : KnownSign.nullity} {<span class="nv">cond</span> : KnownSign.reality}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="nf">nR</span> := {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; nz &amp; cond}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> (<span class="nv">a</span> : \bar R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">num_abse_eq0</span> <span class="nv">a</span> : (`|a|%:nng == <span class="mi">0</span>%:nng) = (a == <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>138a</q><br><q>138b</q><br><span><var>a</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`|a|%:nng == <span class="mi">0</span>%:nng :&gt; {nonneg \bar R}) = (a == <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1402</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -abse_eq0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">MorphNum</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">MorphReal</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">R</span> : numDomainType} {<span class="nv">nz</span> : KnownSign.nullity} {<span class="nv">r</span> : KnownSign.real}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="nf">nR</span> := {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; nz &amp; r}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Type</span> <span class="nf">x</span> y : nR.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="nf">num</span> := (@num _ _ (<span class="mi">0</span> : R) nz r).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">num_lee_maxr</span> <span class="nv">a</span> <span class="nv">x</span> <span class="nv">y</span> :
  a &lt;= maxe x%:num y%:num = (a &lt;= x%:num) || (a &lt;= y%:num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>138a</q><br><span><var>r</var><span class="hyp-type"><b>: </b><span>KnownSign.real</span></span></span><br><q>1405</q><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>{<span class="nb">compare</span> <span class="mi">0</span> : \bar R &amp; nz &amp; r}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a &lt;= maxe x%:num y%:num) =
(a &lt;= x%:num) || (a &lt;= y%:num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1409</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -comparable_le_maxr// ereal_comparable.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">num_lee_maxl</span> <span class="nv">a</span> <span class="nv">x</span> <span class="nv">y</span> :
  maxe x%:num  y%:num &lt;= a = (x%:num &lt;= a) &amp;&amp; (y%:num &lt;= a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>140b</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(maxe x%:num y%:num &lt;= a) =
(x%:num &lt;= a) &amp;&amp; (y%:num &lt;= a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1411</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -comparable_le_maxl// ereal_comparable.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">num_lee_minr</span> <span class="nv">a</span> <span class="nv">x</span> <span class="nv">y</span> :
  a &lt;= mine x%:num y%:num = (a &lt;= x%:num) &amp;&amp; (a &lt;= y%:num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>140b</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(a &lt;= mine x%:num y%:num) =
(a &lt;= x%:num) &amp;&amp; (a &lt;= y%:num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1416</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -comparable_le_minr// ereal_comparable.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">num_lee_minl</span> <span class="nv">a</span> <span class="nv">x</span> <span class="nv">y</span> :
  mine x%:num y%:num &lt;= a = (x%:num &lt;= a) || (y%:num &lt;= a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>140b</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(mine x%:num y%:num &lt;= a) =
(x%:num &lt;= a) || (y%:num &lt;= a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>141b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -comparable_le_minl// ereal_comparable.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">num_lte_maxr</span> <span class="nv">a</span> <span class="nv">x</span> <span class="nv">y</span> :
  a &lt; maxe x%:num y%:num = (a &lt; x%:num) || (a &lt; y%:num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>140b</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(a &lt; maxe x%:num y%:num) =
(a &lt; x%:num) || (a &lt; y%:num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1420</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -comparable_lt_maxr// ereal_comparable.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">num_lte_maxl</span> <span class="nv">a</span> <span class="nv">x</span> <span class="nv">y</span> :
  maxe x%:num  y%:num &lt; a = (x%:num &lt; a) &amp;&amp; (y%:num &lt; a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>140b</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(maxe x%:num y%:num &lt; a) =
(x%:num &lt; a) &amp;&amp; (y%:num &lt; a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1425</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -comparable_lt_maxl// ereal_comparable.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">num_lte_minr</span> <span class="nv">a</span> <span class="nv">x</span> <span class="nv">y</span> :
  a &lt; mine x%:num y%:num = (a &lt; x%:num) &amp;&amp; (a &lt; y%:num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>140b</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(a &lt; mine x%:num y%:num) =
(a &lt; x%:num) &amp;&amp; (a &lt; y%:num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>142a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -comparable_lt_minr// ereal_comparable.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">num_lte_minl</span> <span class="nv">a</span> <span class="nv">x</span> <span class="nv">y</span> :
  mine x%:num y%:num &lt; a = (x%:num &lt; a) || (y%:num &lt; a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>140b</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(mine x%:num y%:num &lt; a) =
(x%:num &lt; a) || (y%:num &lt; a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>142f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -comparable_lt_minl// ereal_comparable.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">MorphReal</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">MorphGe0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">R</span> : numDomainType} {<span class="nv">nz</span> : KnownSign.nullity}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="nf">nR</span> := {<span class="nb">compare</span> (<span class="mi">0</span> : \bar R) &amp; ?=<span class="mi">0</span> &amp; &gt;=<span class="mi">0</span>}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Type</span> <span class="nf">x</span> y : nR.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="nf">num</span> := (@num _ _ (<span class="mi">0</span> : \bar R) ?=<span class="mi">0</span> &gt;=<span class="mi">0</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">num_abse_le</span> <span class="nv">a</span> <span class="nv">x</span> : <span class="mi">0</span> &lt;= a -&gt; (`|a|%:nng &lt;= x)%O = (a &lt;= x%:num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>138a</q><br><q>1405</q><br><span><var>x</var><span class="hyp-type"><b>: </b><span>{<span class="nb">compare</span> <span class="mi">0</span> : \bar R &amp; ?=<span class="mi">0</span> &amp; &gt;=<span class="mi">0</span>}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= a -&gt;
((`|a|%:nng : {nonneg \bar R}) &lt;= x) = (a &lt;= x%:num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1434</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; a0; <span class="nb">rewrite</span> -num_le//= gee0_abs.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">num_abse_lt</span> <span class="nv">a</span> <span class="nv">x</span> : <span class="mi">0</span> &lt;= a -&gt; (`|a|%:nng &lt; x)%O = (a &lt; x%:num).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1436</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= a -&gt;
((`|a|%:nng : {nonneg \bar R}) &lt; x) = (a &lt; x%:num)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>143b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; a0; <span class="nb">rewrite</span> -num_lt/= gee0_abs.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">MorphGe0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variant</span> <span class="nf">posnume_spec</span> (<span class="nv">R</span> : numDomainType) (<span class="nv">x</span> : \bar R) :
  \bar R -&gt; bool -&gt; bool -&gt; bool -&gt; <span class="kt">Type</span> :=
| IsPinftyPosnume :
  posnume_spec x +oo false true true
| IsRealPosnume (p : {posnum R}) :
  posnume_spec x (p%:num%:E) false true true.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">posnumeP</span> (<span class="nv">R</span> : numDomainType) (<span class="nv">x</span> : \bar R) : <span class="mi">0</span> &lt; x -&gt;
  posnume_spec x x (x == <span class="mi">0</span>) (<span class="mi">0</span> &lt;= x) (<span class="mi">0</span> &lt; x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x -&gt; posnume_spec x x (x == <span class="mi">0</span>) (<span class="mi">0</span> &lt;= x) (<span class="mi">0</span> &lt; x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1440</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: x =&gt; [x|_|//]; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> le0y lt0y; <span class="bp">exact</span>: IsPinftyPosnume.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>99</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; x%:E -&gt;
posnume_spec x%:E x%:E (x%:E == <span class="mi">0</span>) (<span class="mi">0</span> &lt;= x%:E)
  (<span class="mi">0</span> &lt; x%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> lte_fin lee_fin eqe =&gt; x_gt0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>22</q><br><q>9a</q><br><span><var>x_gt0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; x)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">posnume_spec x%:E x%:E (x == <span class="mi">0</span>%R) (<span class="mi">0</span> &lt;= x)%R (<span class="mi">0</span> &lt; x)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> x_gt0 (ltW x_gt0) (negbTE (lt0r_neq0 x_gt0)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>144b</q><span class="goal-separator"><hr></span><div class="goal-conclusion">posnume_spec x%:E x%:E false true true</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: IsRealPosnume (PosNum x_gt0).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variant</span> <span class="nf">nonnege_spec</span> (<span class="nv">R</span> : numDomainType) (<span class="nv">x</span> : \bar R) :
  \bar R -&gt; bool -&gt; <span class="kt">Type</span> :=
| IsPinftyNonnege : nonnege_spec x +oo true
| IsRealNonnege (p : {nonneg R}) : nonnege_spec x (p%:num%:E) true.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">nonnegeP</span> (<span class="nv">R</span> : numDomainType) (<span class="nv">x</span> : \bar R) : <span class="mi">0</span> &lt;= x -&gt;
  nonnege_spec x x (<span class="mi">0</span> &lt;= x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>6a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; nonnege_spec x x (<span class="mi">0</span> &lt;= x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1453</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: x =&gt; [x|_|//]; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> le0y; <span class="bp">exact</span>: IsPinftyNonnege.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>99</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x%:E -&gt; nonnege_spec x%:E x%:E (<span class="mi">0</span> &lt;= x%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lee_fin =&gt; /[dup] x_ge0 -&gt;; <span class="bp">exact</span>: IsRealNonnege (NngNum x_ge0).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">contract_expand</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">R</span> : realFieldType.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> (<span class="nv">x</span> : \bar R) (<span class="nv">r</span> : R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> ereal_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">contract</span> <span class="nv">x</span> : R :=
  <span class="kr">match</span> x <span class="kr">with</span>
  | r%:E =&gt; r / (<span class="mi">1</span> + `|r|) | +oo =&gt; <span class="mi">1</span> | -oo =&gt; -<span class="mi">1</span>
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">contract_lt1</span> <span class="nv">r</span> : (`|contract r%:E| &lt; <span class="mi">1</span>)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`|contract r%:E| &lt; <span class="mi">1</span>)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>145c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> normrM normrV <span class="nl">?unitfE</span> //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>145e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(`|r| / `|<span class="mi">1</span> + `|r|| &lt; <span class="mi">1</span>)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> ltr_pdivr_mulr // <span class="nl">?mul1r</span>//; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> gtr0_norm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>145e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(`|r| &lt; `|<span class="mi">1</span> + `|r||)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> [ltRHS]gtr0_norm <span class="nl">?ltr_addr</span>// ltr_spaddl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">contract_le1</span> <span class="nv">x</span> : (`|contract x| &lt;= <span class="mi">1</span>)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>6b</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`|contract x| &lt;= <span class="mi">1</span>)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>146a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; [r| |] /=; <span class="nb">rewrite</span> <span class="nl">?normrN1</span> <span class="nl">?normr1</span> // (ltW (contract_lt1 _)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">contract0</span> : contract <span class="mi">0</span> = <span class="mi">0</span>%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contract <span class="mi">0</span> = <span class="mi">0</span>%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1470</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /contract mul0r.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">contractN</span> <span class="nv">x</span> : contract (- x) = (- contract x)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>146c</q><span class="goal-separator"><hr></span><div class="goal-conclusion">contract (- x) = (- contract x)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1476</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x =&gt; //= [r|]; [ <span class="nb">rewrite</span> normrN mulNr | <span class="nb">rewrite</span> opprK].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* TODO: not exploited yet: expand is nondecreasing everywhere so it should be</span>
<span class="c">   possible to use some of the homoRL/homoLR lemma where monoRL/monoLR do not</span>
<span class="c">   apply *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">expand</span> <span class="nv">r</span> : \bar R :=
  <span class="kr">if</span> (r &gt;= <span class="mi">1</span>)%R <span class="kr">then</span> +oo <span class="kr">else</span> <span class="kr">if</span> (r &lt;= -<span class="mi">1</span>)%R <span class="kr">then</span> -oo <span class="kr">else</span> (r / (<span class="mi">1</span> - `|r|))%:E.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">expand1</span> <span class="nv">r</span> : (<span class="mi">1</span> &lt;= r)%R -&gt; expand r = +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>145e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">1</span> &lt;= r)%R -&gt; expand r = +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>147b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; r1; <span class="nb">rewrite</span> /expand r1.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">expandN</span> <span class="nv">r</span> : expand (- r)%R = - expand r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>145e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">expand (- r) = - expand r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1480</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> /expand; <span class="nb">case</span>: ifPn =&gt; [r1|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><span><var>r1</var><span class="hyp-type"><b>: </b><span>(<span class="mi">1</span> &lt;= - r)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">+oo =
-
(<span class="kr">if</span> (<span class="mi">1</span> &lt;= r)%R
 <span class="kr">then</span> +oo
 <span class="kr">else</span> <span class="kr">if</span> (r &lt;= -<span class="mi">1</span>)%R <span class="kr">then</span> -oo <span class="kr">else</span> (r / (<span class="mi">1</span> - `|r|))%:E)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>145e</q><label class="goal-separator"><hr></label><div class="goal-conclusion">~~ (<span class="mi">1</span> &lt;= - r)%R -&gt;
(<span class="kr">if</span> (- r &lt;= -<span class="mi">1</span>)%R
 <span class="kr">then</span> -oo
 <span class="kr">else</span> (- r / (<span class="mi">1</span> - `|- r|))%:E) =
-
(<span class="kr">if</span> (<span class="mi">1</span> &lt;= r)%R
 <span class="kr">then</span> +oo
 <span class="kr">else</span> <span class="kr">if</span> (r &lt;= -<span class="mi">1</span>)%R <span class="kr">then</span> -oo <span class="kr">else</span> (r / (<span class="mi">1</span> - `|r|))%:E)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> ifF; [<span class="bp">by</span> <span class="nb">rewrite</span> ifT // -ler_oppr|<span class="nb">apply</span>/negbTE].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1487</q><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ (<span class="mi">1</span> &lt;= r)%R</div></blockquote><q>148a</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -ltNge -(opprK r) -ltr_oppl (lt_le_trans _ r1) // -subr_gt0 opprK.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>145e</q><span class="goal-separator"><hr></span><q>148c</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -ltNge =&gt; r1; <span class="nb">case</span>: ifPn; <span class="nb">rewrite</span> ler_oppl opprK; [<span class="bp">by</span> <span class="nb">move</span>=&gt; -&gt;|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><span><var>r1</var><span class="hyp-type"><b>: </b><span>(- r &lt; <span class="mi">1</span>)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ (<span class="mi">1</span> &lt;= r)%R -&gt;
(- r / (<span class="mi">1</span> - `|- r|))%:E =
-
(<span class="kr">if</span> (<span class="mi">1</span> &lt;= r)%R
 <span class="kr">then</span> +oo
 <span class="kr">else</span> <span class="kr">if</span> (r &lt;= -<span class="mi">1</span>)%R <span class="kr">then</span> -oo <span class="kr">else</span> (r / (<span class="mi">1</span> - `|r|))%:E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -ltNge leNgt =&gt; -&gt;; <span class="nb">rewrite</span> leNgt -ltr_oppl r1 /= mulNr normrN.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">expandN1</span> <span class="nv">r</span> : (r &lt;= -<span class="mi">1</span>)%R -&gt; expand r = -oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>145e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r &lt;= -<span class="mi">1</span>)%R -&gt; expand r = -oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>149b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ler_oppr =&gt; /expand1/eqP; <span class="nb">rewrite</span> expandN eqe_oppLR =&gt; /eqP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">expand0</span> : expand <span class="mi">0</span>%R = <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1472</q><span class="goal-separator"><hr></span><div class="goal-conclusion">expand <span class="mi">0</span> = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>14a0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /expand leNgt ltr01 /= oppr_ge0 leNgt ltr01 /= mul0r.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">expandK</span> : {<span class="kr">in</span> [pred r | `|r| &lt;= <span class="mi">1</span>]%R, cancel expand contract}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1472</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> [pred r | (`|r| &lt;= <span class="mi">1</span>)%R], cancel expand contract}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>14a5</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; r; <span class="nb">rewrite</span> inE le_eqVlt =&gt; /orP[|r1].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>145e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">`|r|%R == <span class="mi">1</span>%R -&gt; contract (expand r) = r</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><span><var>r1</var><span class="hyp-type"><b>: </b><span>(`|r| &lt; <span class="mi">1</span>)%R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">contract (expand r) = r</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> eqr_norml =&gt; /andP[/orP[]/eqP-&gt;{r}] _;
    <span class="bp">by</span> [<span class="nb">rewrite</span> expand1|<span class="nb">rewrite</span> expandN1].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14af</q><span class="goal-separator"><hr></span><q>14b1</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> /expand <span class="mi">2</span>!leNgt ltr_oppl; <span class="nb">case</span>/ltr_normlP : (r1) =&gt; -&gt; -&gt; /=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14af</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r / (<span class="mi">1</span> - `|r|) / (<span class="mi">1</span> + `|r / (<span class="mi">1</span> - `|r|)|) = r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> r_pneq0 : (<span class="mi">1</span> + r / (<span class="mi">1</span> - r) != <span class="mi">0</span>)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14af</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">1</span> + r / (<span class="mi">1</span> - r))%R != <span class="mi">0</span>%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>14b0</q><br><span><var>r_pneq0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">1</span> + r / (<span class="mi">1</span> - r))%R != <span class="mi">0</span>%R</span></span></span><br></div><label class="goal-separator"><hr></label><q>14b8</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -[X <span class="kr">in</span> (X + _)%R](@divrr _ (<span class="mi">1</span> - r)%R) -<span class="nl">?mulrDl</span>; <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14af</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">1</span> - r)%R \<span class="kr">is</span> a GRing.unit</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>14af</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">1</span> - r + r) / (<span class="mi">1</span> - r) != <span class="mi">0</span>%R</div></blockquote><q>14be</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> unitfE subr_eq0 eq_sym lt_eqF // ltr_normlW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14af</q><span class="goal-separator"><hr></span><q>14c7</q></blockquote><q>14bd</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> subrK mulf_neq0 // invr_eq0 subr_eq0 eq_sym lt_eqF // ltr_normlW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14bf</q><span class="goal-separator"><hr></span><q>14b8</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> r_nneq0 : (<span class="mi">1</span> - r / (<span class="mi">1</span> + r) != <span class="mi">0</span>)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14bf</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">1</span> - r / (<span class="mi">1</span> + r))%R != <span class="mi">0</span>%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>14b0</q><br><q>14c0</q><br><span><var>r_nneq0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">1</span> - r / (<span class="mi">1</span> + r))%R != <span class="mi">0</span>%R</span></span></span><br></div><label class="goal-separator"><hr></label><q>14b8</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -[X <span class="kr">in</span> (X + _)%R](@divrr _ (<span class="mi">1</span> + r)%R) -<span class="nl">?mulrBl</span>; <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14bf</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">1</span> + r)%R \<span class="kr">is</span> a GRing.unit</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>14bf</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">1</span> + r - r) / (<span class="mi">1</span> + r) != <span class="mi">0</span>%R</div></blockquote><q>14d3</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> unitfE addrC addr_eq0 gt_eqF // ltrNnormlW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14bf</q><span class="goal-separator"><hr></span><q>14dc</q></blockquote><q>14d2</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> addrK mulf_neq0 // invr_eq0 addr_eq0 -eqr_oppLR eq_sym gt_eqF //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14bf</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(-<span class="mi">1</span> &lt; r)%R</div></blockquote><q>14d2</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">exact</span>: ltrNnormlW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14d4</q><span class="goal-separator"><hr></span><q>14b8</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">wlog</span> : r r1 r_pneq0 r_nneq0 / (<span class="mi">0</span> &lt;= r)%R =&gt; wlog_r0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>14b0</q><br><q>14c0</q><br><q>14d5</q><br><span><var>wlog_r0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">r</span> : R,
(`|r| &lt; <span class="mi">1</span>)%R -&gt;
(<span class="mi">1</span> + r / (<span class="mi">1</span> - r))%R != <span class="mi">0</span>%R -&gt;
(<span class="mi">1</span> - r / (<span class="mi">1</span> + r))%R != <span class="mi">0</span>%R -&gt;
(<span class="mi">0</span> &lt;= r)%R -&gt;
r / (<span class="mi">1</span> - `|r|) / (<span class="mi">1</span> + `|r / (<span class="mi">1</span> - `|r|)|) = r</span></span></span><br></div><span class="goal-separator"><hr></span><q>14b8</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>14b0</q><br><q>14c0</q><br><q>14d5</q><br><span><var>wlog_r0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt;= r)%R</span></span></span><br></div><label class="goal-separator"><hr></label><q>14b8</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [r0|r0] := lerP <span class="mi">0</span> r; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> wlog_r0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>14b0</q><br><q>14c0</q><br><q>14d5</q><br><q>14eb</q><br><q>de5</q><br></div><span class="goal-separator"><hr></span><q>14b8</q></blockquote><q>14ec</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: (wlog_r0 (- r)%R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14f3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">((`|- r| &lt; <span class="mi">1</span>)%R -&gt;
 (<span class="mi">1</span> + - r / (<span class="mi">1</span> - - r))%R != <span class="mi">0</span>%R -&gt;
 (<span class="mi">1</span> - - r / (<span class="mi">1</span> - r))%R != <span class="mi">0</span>%R -&gt;
 (<span class="mi">0</span> &lt;= - r)%R -&gt;
 - r / (<span class="mi">1</span> - `|(- r)%R|) /
 (<span class="mi">1</span> + `|- r / (<span class="mi">1</span> - `|(- r)%R|)|) = (- r)%R) -&gt;
r / (<span class="mi">1</span> - `|r|) / (<span class="mi">1</span> + `|r / (<span class="mi">1</span> - `|r|)|) = r</div></blockquote><q>14ec</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> !(normrN, opprK, mulNr) oppr_ge0 =&gt; /(_ r1 r_nneq0 r_pneq0 (ltW r0)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14f3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- (r / (<span class="mi">1</span> - `|r|) / (<span class="mi">1</span> + `|r / (<span class="mi">1</span> - `|r|)|)))%R =
(- r)%R -&gt;
r / (<span class="mi">1</span> - `|r|) / (<span class="mi">1</span> + `|r / (<span class="mi">1</span> - `|r|)|) = r</div></blockquote><q>14ec</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>/eqP; <span class="nb">rewrite</span> eqr_opp =&gt; /eqP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14ee</q><span class="goal-separator"><hr></span><q>14b8</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> /contract !ger0_norm //; <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14ee</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;= r / (<span class="mi">1</span> - r))%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>14ee</q><label class="goal-separator"><hr></label><div class="goal-conclusion">r / (<span class="mi">1</span> - r) / (<span class="mi">1</span> + r / (<span class="mi">1</span> - r)) = r</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> divr_ge0 // subr_ge0 (le_trans _ (ltW r1)) // ler_norm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14ee</q><span class="goal-separator"><hr></span><q>1505</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: (@mulIr _ (<span class="mi">1</span> + r / (<span class="mi">1</span> - r))%R); <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> unitfE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14ee</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r / (<span class="mi">1</span> - r) / (<span class="mi">1</span> + r / (<span class="mi">1</span> - r)) * (<span class="mi">1</span> + r / (<span class="mi">1</span> - r)))%R =
(r * (<span class="mi">1</span> + r / (<span class="mi">1</span> - r)))%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -(mulrA (r / _)) mulVr <span class="nl">?unitfE</span> // mulr1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14ee</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r / (<span class="mi">1</span> - r) = (r * (<span class="mi">1</span> + r / (<span class="mi">1</span> - r)))%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -[X <span class="kr">in</span> (X + _ / _)%R](@divrr _ (<span class="mi">1</span> - r)%R) -<span class="nl">?mulrDl</span> <span class="nl">?subrK</span> <span class="nl">?div1r</span> //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>14ee</q><span class="goal-separator"><hr></span><q>14c4</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> unitfE subr_eq0 eq_sym lt_eqF // ltr_normlW.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_contract</span> : {mono contract : x y / (x &lt;= y)%O}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1472</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{mono contract : x y / x &lt;= y &gt;-&gt; (x &lt;= y)%R}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1515</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: le_mono; <span class="nb">move</span>=&gt; -[r0 | | ] [r1 | _ | _] //=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>11c</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r0%:E &lt; r1%:E -&gt;
(r0 / (<span class="mi">1</span> + `|r0|) &lt; r1 / (<span class="mi">1</span> + `|r1|))%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><span><var>r0</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(r0 / (<span class="mi">1</span> + `|r0|) &lt; <span class="mi">1</span>)%R</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><span><var>r1</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">-oo &lt; r1%:E -&gt; (-<span class="mi">1</span> &lt; r1 / (<span class="mi">1</span> + `|r1|))%R</div></blockquote><blockquote class="alectryon-goal"><q>1472</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(-<span class="mi">1</span> &lt; <span class="mi">1</span>)%R</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>151a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> lte_fin =&gt; r0r1; <span class="nb">rewrite</span> ltr_pdivr_mulr <span class="nl">?ltr_paddr</span>//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>11c</q><br><span><var>r0r1</var><span class="hyp-type"><b>: </b><span>(r0 &lt; r1)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(r0 &lt; r1 / (<span class="mi">1</span> + `|r1|) * (<span class="mi">1</span> + `|r0|))%R</div></blockquote><q>151e</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> mulrAC ltr_pdivl_mulr <span class="nl">?ltr_paddr</span>// <span class="mi">2</span><span class="nl">?mulrDr</span> <span class="mi">2</span><span class="nl">?mulr1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>152d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r0 + r0 * `|r1| &lt; r1 + r1 * `|r0|)%R</div></blockquote><q>151e</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [r10|?] := ler0P r1; <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>11c</q><br><q>152e</q><br><span><var>_i_</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; r1)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(r0 + r0 * r1 &lt; r1 + r1 * `|r0|)%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>11c</q><br><q>152e</q><br><span><var>r10</var><span class="hyp-type"><b>: </b><span>(r1 &lt;= <span class="mi">0</span>)%R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(r0 + r0 * - r1 &lt; r1 + r1 * `|r0|)%R</div></blockquote><q>151f</q><q>1523</q><q>1527</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> ltr_le_add // mulrC; <span class="nb">have</span> [r00|//] := ler0P r0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>11c</q><br><q>152e</q><br><q>1538</q><br><span><var>r00</var><span class="hyp-type"><b>: </b><span>(r0 &lt;= <span class="mi">0</span>)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(r0 * r1 &lt;= - r0 * r1)%R</div></blockquote><q>153a</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (@le_trans _ _ <span class="mi">0</span>%R) // <span class="nl">?pmulr_lle0</span>// mulr_ge0// <span class="nl">?oppr_ge0</span>// ltW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>153c</q><span class="goal-separator"><hr></span><q>153e</q></blockquote><q>151e</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [?|r00] := ler0P r0; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> ltr_le_add // <span class="mi">2</span>!mulrN mulrC.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>11c</q><br><q>152e</q><br><q>153d</q><br><span><var>r00</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; r0)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(r0 + r0 * - r1 &lt; r1 + r1 * r0)%R</div></blockquote><q>151e</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: (le_lt_trans r10 (lt_trans r00 r0r1)); <span class="nb">rewrite</span> ltxx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1520</q><span class="goal-separator"><hr></span><q>1522</q></blockquote><div class="alectryon-extra-goals"><q>1523</q><q>1527</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>154f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltr_pdivr_mulr <span class="nl">?ltr_paddr</span>// mul1r ltr_spaddl // ler_norm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1524</q><span class="goal-separator"><hr></span><q>1526</q></blockquote><div class="alectryon-extra-goals"><q>1527</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1554</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> ltr_pdivl_mulr <span class="nl">?mulN1r</span> <span class="nl">?ltr_paddr</span>// =&gt; _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1524</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(- (<span class="mi">1</span> + `|r1|) &lt; r1)%R</div></blockquote><q>1556</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltr_oppl ltr_spaddl // ler_normr lexx orbT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1472</q><span class="goal-separator"><hr></span><q>1528</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>155d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -subr_gt0 opprK.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lt_contract</span> := leW_mono le_contract.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">contract_inj</span> := mono_inj lexx le_anti le_contract.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_expand_in</span> : {<span class="kr">in</span> [pred r | `|r| &lt;= <span class="mi">1</span>]%R &amp;,
  {mono expand : x y / (x &lt;= y)%O}}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1472</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> [pred r | (`|r| &lt;= <span class="mi">1</span>)%R] &amp;,
  {mono expand : x y / (x &lt;= y)%R &gt;-&gt; x &lt;= y}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1561</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: can_mono_in (onW_can_in predT expandK) _ (in2W le_contract).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lt_expand</span> := leW_mono_in le_expand_in.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">expand_inj</span> := mono_inj_in lexx le_anti le_expand_in.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fine_expand</span> <span class="nv">r</span> : (`|r| &lt; <span class="mi">1</span>)%R -&gt;
  (fine (expand r))%:E = expand r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>145e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(`|r| &lt; <span class="mi">1</span>)%R -&gt; (fine (expand r))%:E = expand r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1566</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; r1; <span class="nb">rewrite</span> /expand <span class="mi">2</span>!leNgt ltr_oppl; <span class="nb">case</span>/ltr_normlP : r1 =&gt; -&gt; -&gt;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_expand</span> : {homo expand : x y / (x &lt;= y)%O}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1472</q><span class="goal-separator"><hr></span><div class="goal-conclusion">{homo expand : x y / (x &lt;= y)%R &gt;-&gt; x &lt;= y}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>156b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; x y xy; <span class="nb">have</span> [x1|] := lerP `|x| <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>95</q><br><span><var>xy</var><span class="hyp-type"><b>: </b><span>(x &lt;= y)%R</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>(`|x| &lt;= <span class="mi">1</span>)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">expand x &lt;= expand y</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>95</q><br><q>1573</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(<span class="mi">1</span> &lt; `|x|)%R -&gt; expand x &lt;= expand y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [y_le1|/ltW /expand1-&gt;] := leP y <span class="mi">1</span>%R; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>95</q><br><q>1573</q><br><q>1574</q><br><span><var>y_le1</var><span class="hyp-type"><b>: </b><span>(y &lt;= <span class="mi">1</span>)%R</span></span></span><br></div><span class="goal-separator"><hr></span><q>1575</q></blockquote><q>1576</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> le_expand_in <span class="nl">?inE</span>// ler_norml y_le1 (le_trans _ xy)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>157d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(-<span class="mi">1</span> &lt;= x)%R</div></blockquote><q>1576</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ler_oppl (ler_normlP _ _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1578</q><span class="goal-separator"><hr></span><q>1579</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> ltr_normr =&gt; /orP[|] x1; <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>95</q><br><q>1573</q><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>(<span class="mi">1</span> &lt; - x)%R</span></span></span><br></div><span class="goal-separator"><hr></span><q>1575</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>95</q><br><q>1573</q><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>(<span class="mi">1</span> &lt; x)%R</span></span></span><br></div><label class="goal-separator"><hr></label><q>1575</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> expandN1 // <span class="nl">?leNye</span> // ler_oppr ltW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>158d</q><span class="goal-separator"><hr></span><q>1575</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> expand1; [<span class="nb">rewrite</span> expand1 // (le_trans _ xy) // ltW | <span class="bp">exact</span>: ltW].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">expand_eqoo</span> <span class="nv">r</span> : (expand r == +oo) = (<span class="mi">1</span> &lt;= r)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>145e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(expand r == +oo) = (<span class="mi">1</span> &lt;= r)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1593</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /expand; <span class="nb">case</span>: ifP =&gt; //; <span class="nb">case</span>: ifP.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">expand_eqNoo</span> <span class="nv">r</span> : (expand r == -oo) = (r &lt;= -<span class="mi">1</span>)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>145e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(expand r == -oo) = (r &lt;= -<span class="mi">1</span>)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1598</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> /expand; <span class="nb">case</span>: ifP =&gt; /= r1; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">case</span>: ifP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><span><var>r1</var><span class="hyp-type"><b>: </b><span>(<span class="mi">1</span> &lt;= r)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(+oo == -oo) = (r &lt;= -<span class="mi">1</span>)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/esym/negbTE; <span class="nb">rewrite</span> -ltNge (lt_le_trans _ r1) // -subr_gt0 opprK.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">contract_expand</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">ereal_PseudoMetric</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">R</span> : realFieldType.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> (<span class="nv">x</span> <span class="nv">y</span> : \bar R) (<span class="nv">r</span> : R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ereal_ball</span> <span class="nv">x</span> <span class="nv">r</span> <span class="nv">y</span> := (`|contract x - contract y| &lt; r)%R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ereal_ball_center</span> <span class="nv">x</span> <span class="nv">r</span> : (<span class="mi">0</span> &lt; r)%R -&gt; ereal_ball x r x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>6b</q><br><q>ae</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; r)%R -&gt; ereal_ball x r x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>15a3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; e0; <span class="nb">rewrite</span> /ereal_ball subrr normr0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ereal_ball_sym</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">r</span> : ereal_ball x r y -&gt; ereal_ball y r x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>23</q><br><q>ae</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ereal_ball x r y -&gt; ereal_ball y r x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>15a9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /ereal_ball distrC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ereal_ball_triangle</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">r1</span> <span class="nv">r2</span> :
  ereal_ball x r1 y -&gt; ereal_ball y r2 z -&gt; ereal_ball x (r1 + r2) z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>1b8</q><br><q>14</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ereal_ball x r1 y -&gt;
ereal_ball y r2 z -&gt; ereal_ball x (r1 + r2) z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>15af</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> /ereal_ball =&gt; h1 h2; <span class="nb">rewrite</span> -[X <span class="kr">in</span> (X - _)%R](subrK (contract y)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>1b8</q><br><q>14</q><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>(`|contract x - contract y| &lt; r1)%R</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>(`|contract y - contract z| &lt; r2)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`|contract x - contract y + contract y - contract z| &lt;
 r1 + r2)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -addrA (le_lt_trans (ler_norm_add _ _)) // ltr_add.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ereal_ballN</span> <span class="nv">x</span> <span class="nv">y</span> (<span class="nv">e</span> : {posnum R}) :
  ereal_ball (- x) e%:num (- y) -&gt; ereal_ball x e%:num y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>23</q><br><span><var>e</var><span class="hyp-type"><b>: </b><span>{posnum R}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ereal_ball (- x) e%:num (- y) -&gt; ereal_ball x e%:num y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>15bc</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /ereal_ball <span class="mi">2</span>!contractN opprK -opprB normrN addrC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ereal_ball_ninfty_oversize</span> (<span class="nv">e</span> : {posnum R}) <span class="nv">x</span> :
  (<span class="mi">2</span> &lt; e%:num)%R -&gt; ereal_ball -oo e%:num x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>15bf</q><br><q>6b</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">2</span> &lt; e%:num)%R -&gt; ereal_ball -oo e%:num x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>15c3</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; e2; <span class="nb">rewrite</span> /ereal_ball /= (le_lt_trans _ e2) // -opprB normrN opprK.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>15bf</q><br><q>6b</q><br><span><var>e2</var><span class="hyp-type"><b>: </b><span>(<span class="mi">2</span> &lt; e%:num)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(`|contract x + <span class="mi">1</span>| &lt;= <span class="mi">2</span>)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> (le_trans (ler_norm_add _ _)) // normr1 -ler_subr_addr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>15cb</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(`|contract x| &lt;= <span class="mi">2</span> - <span class="mi">1</span>)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (le_trans (contract_le1 _)) // (_ : <span class="mi">2</span> = <span class="mi">1</span> + <span class="mi">1</span>)%R // addrK.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">contract_ereal_ball_pinfty</span> <span class="nv">r</span> (<span class="nv">e</span> : {posnum R}) :
  (<span class="mi">1</span> &lt; contract r%:E + e%:num)%R -&gt; ereal_ball r%:E e%:num +oo.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>15bf</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">1</span> &lt; contract r%:E + e%:num)%R -&gt;
ereal_ball r%:E e%:num +oo</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>15d3</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; re1; <span class="nb">rewrite</span> /ereal_ball; <span class="nb">rewrite</span> [contract +oo]/= ler0_norm; <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>15bf</q><br><span><var>re1</var><span class="hyp-type"><b>: </b><span>(<span class="mi">1</span> &lt; contract r%:E + e%:num)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(contract r%:E - <span class="mi">1</span> &lt;= <span class="mi">0</span>)%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>15db</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(- (contract r%:E - <span class="mi">1</span>) &lt; e%:num)%R</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> subr_le0; <span class="nb">case</span>/ler_normlP: (contract_le1 r%:E).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>15db</q><span class="goal-separator"><hr></span><q>15e0</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> opprB ltr_subl_addl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">ereal_PseudoMetric</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* TODO: generalize to numFieldType? *)</span>
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lt_ereal_nbhs</span> (<span class="nv">R</span> : realFieldType) (<span class="nv">a</span> <span class="nv">b</span> : \bar R) (<span class="nv">r</span> : R) :
  a &lt; r%:E -&gt; r%:E &lt; b -&gt;
  <span class="kr">exists</span> <span class="nv">delta</span> : {posnum R},
    <span class="kr">forall</span> <span class="nv">y</span>, (`|y - r| &lt; delta%:num)%R -&gt; (a &lt; y%:E) &amp;&amp; (y%:E &lt; b).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>\bar R</span></span></span><br><q>ae</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt; r%:E -&gt;
r%:E &lt; b -&gt;
<span class="kr">exists</span> <span class="nv">delta</span> : {posnum R},
  <span class="kr">forall</span> <span class="nv">y</span> : R,
  (`|y - r| &lt; delta%:num)%R -&gt; a &lt; y%:E &lt; b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>15e5</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; [:<span class="nb">wlog</span>]; <span class="nb">case</span>: a b =&gt; [a||] [b||] //= ltax ltxb.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><span><var>wlog</var><span class="hyp-type"><b>: </b><span>&lt;hidden <span class="mi">1</span>&gt;</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>ltax</var><span class="hyp-type"><b>: </b><span>a%:E &lt; r%:E</span></span></span><br><span><var>ltxb</var><span class="hyp-type"><b>: </b><span>r%:E &lt; b%:E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">delta</span> : {posnum R},
  <span class="kr">forall</span> <span class="nv">y</span> : R,
  (`|y - r| &lt; delta%:num)%R -&gt; a%:E &lt; y%:E &lt; b%:E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>15ef</q><br><q>8ea</q><br><q>15f1</q><br><span><var>ltxb</var><span class="hyp-type"><b>: </b><span>r%:E &lt; +oo</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">delta</span> : {posnum R},
  <span class="kr">forall</span> <span class="nv">y</span> : R,
  (`|y - r| &lt; delta%:num)%R -&gt; a%:E &lt; y%:E &lt; +oo</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>15ef</q><br><span><var>b</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>ltax</var><span class="hyp-type"><b>: </b><span>-oo &lt; r%:E</span></span></span><br><q>15f2</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">delta</span> : {posnum R},
  <span class="kr">forall</span> <span class="nv">y</span> : R,
  (`|y - r| &lt; delta%:num)%R -&gt; -oo &lt; y%:E &lt; b%:E</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>15ef</q><br><q>15fc</q><br><q>15f7</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">delta</span> : {posnum R},
  <span class="kr">forall</span> <span class="nv">y</span> : R,
  (`|y - r| &lt; delta%:num)%R -&gt; -oo &lt; y%:E &lt; +oo</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>15ec</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: a b ltax ltxb; <span class="kp">abstract</span>: <span class="nb">wlog</span>. <span class="c">(*BUG*)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>15e7</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : R,
a%:E &lt; r%:E -&gt;
r%:E &lt; b%:E -&gt;
<span class="kr">exists</span> <span class="nv">delta</span> : {posnum R},
  <span class="kr">forall</span> <span class="nv">y</span> : R,
  (`|y - r| &lt; delta%:num)%R -&gt; a%:E &lt; y%:E &lt; b%:E</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><span><var>wlog</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : R,
 a%:E &lt; r%:E -&gt;
 r%:E &lt; b%:E -&gt;
 <span class="kr">exists</span> <span class="nv">delta</span> : {posnum R},
   <span class="kr">forall</span> <span class="nv">y</span> : R,
   (`|y - r| &lt; delta%:num)%R -&gt;
   a%:E &lt; y%:E &lt; b%:E) <span class="c">(*1*)</span></span></span></span><br><q>8ea</q><br><q>15f1</q><br><q>15f7</q><br></div><label class="goal-separator"><hr></label><q>15f8</q></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>1609</q><br><q>15fb</q><br><q>15fc</q><br><q>15f2</q><br></div><label class="goal-separator"><hr></label><q>15fd</q></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>1609</q><br><q>15fc</q><br><q>15f7</q><br></div><label class="goal-separator"><hr></label><q>1600</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; {}a {}b ltxa ltxb.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><span><var>r, a, b</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>ltxa</var><span class="hyp-type"><b>: </b><span>a%:E &lt; r%:E</span></span></span><br><q>15f2</q><br></div><span class="goal-separator"><hr></span><q>15f3</q></blockquote><q>1606</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> m_gt0 : (Num.min ((r - a) / <span class="mi">2</span>) ((b - r) / <span class="mi">2</span>) &gt; <span class="mi">0</span>)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1611</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; Num.min ((r - a) / <span class="mi">2</span>) ((b - r) / <span class="mi">2</span>))%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>1612</q><br><q>1613</q><br><q>15f2</q><br><span><var>m_gt0</var><span class="hyp-type"><b>: </b><span>(<span class="mi">0</span> &lt; Num.min ((r - a) / <span class="mi">2</span>) ((b - r) / <span class="mi">2</span>))%R</span></span></span><br></div><label class="goal-separator"><hr></label><q>15f3</q></blockquote><q>1607</q><q>160a</q><q>160c</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> lt_minr !divr_gt0 // <span class="nl">?subr_gt0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>161a</q><span class="goal-separator"><hr></span><q>15f3</q></blockquote><q>1606</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kr">exists</span> (<span class="nv">PosNum</span> <span class="nv">m_gt0</span>) =&gt; y //=; <span class="nb">rewrite</span> lt_minr !ltr_distl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>1612</q><br><q>1613</q><br><q>15f2</q><br><q>161b</q><br><q>9e</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[&amp;&amp; (r - (r - a) / <span class="mi">2</span> &lt; y &lt; r + (r - a) / <span class="mi">2</span>)%R,
    (r - (b - r) / <span class="mi">2</span> &lt; y)%R
  &amp; (y &lt; r + (b - r) / <span class="mi">2</span>)%R] -&gt; 
a%:E &lt; y%:E &lt; b%:E</div></blockquote><q>1606</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; /andP[/andP[ay _] /andP[_ yb]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>1612</q><br><q>1613</q><br><q>15f2</q><br><q>161b</q><br><q>9e</q><br><span><var>ay</var><span class="hyp-type"><b>: </b><span>(r - (r - a) / <span class="mi">2</span> &lt; y)%R</span></span></span><br><span><var>yb</var><span class="hyp-type"><b>: </b><span>(y &lt; r + (b - r) / <span class="mi">2</span>)%R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a%:E &lt; y%:E &lt; b%:E</div></blockquote><q>1606</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> <span class="mi">2</span>!lte_fin (lt_trans _ ay) ?(lt_trans yb) //=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1627</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(r + (b - r) / <span class="mi">2</span> &lt; b)%R</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>1627</q><label class="goal-separator"><hr></label><div class="goal-conclusion">(a &lt; r - (r - a) / <span class="mi">2</span>)%R</div></blockquote><q>1607</q><q>160a</q><q>160c</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -subr_gt0 opprD addrA {<span class="mi">1</span>}[(b - r)%R]splitr addrK.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1627</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; (b - r) / <span class="mi">2</span>)%R</div></blockquote><q>162f</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> divr_gt0 <span class="nl">?subr_gt0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1627</q><span class="goal-separator"><hr></span><q>1631</q></blockquote><q>1606</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -subr_gt0 addrAC {<span class="mi">1</span>}[(r - a)%R]splitr addrK divr_gt0 <span class="nl">?subr_gt0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1608</q><span class="goal-separator"><hr></span><q>15f8</q></blockquote><div class="alectryon-extra-goals"><q>160a</q><q>160c</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>163a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [//||d dP] := <span class="nb">wlog</span> a (r + <span class="mi">1</span>)%R; <span class="nb">rewrite</span> <span class="nl">?lte_fin</span> <span class="nl">?ltr_addl</span> //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>1609</q><br><q>8ea</q><br><q>15f1</q><br><q>15f7</q><br><span><var>d</var><span class="hyp-type"><b>: </b><span>{posnum R}</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : R,
(`|y - r| &lt; d%:num)%R -&gt; a%:E &lt; y%:E &lt; (r + <span class="mi">1</span>)%:E</span></span></span><br></div><span class="goal-separator"><hr></span><q>15f8</q></blockquote><q>163c</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">d</span> =&gt; y /dP /andP[-&gt;] /= /lt_le_trans; <span class="nb">apply</span>; <span class="nb">rewrite</span> leey.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>160b</q><span class="goal-separator"><hr></span><q>15fd</q></blockquote><div class="alectryon-extra-goals"><q>160c</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1645</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [//||d dP] := <span class="nb">wlog</span> (r - <span class="mi">1</span>)%R b; <span class="nb">rewrite</span> <span class="nl">?lte_fin</span> <span class="nl">?gtr_addl</span> <span class="nl">?ltrN10</span> //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>11c7</q><br><q>ae</q><br><q>1609</q><br><q>15fb</q><br><q>15fc</q><br><q>15f2</q><br><q>1642</q><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : R,
(`|y - r| &lt; d%:num)%R -&gt; (r - <span class="mi">1</span>)%:E &lt; y%:E &lt; b%:E</span></span></span><br></div><span class="goal-separator"><hr></span><q>15fd</q></blockquote><q>1647</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">d</span> =&gt; y /dP /andP[_ -&gt;] /=; <span class="nb">rewrite</span> ltNyr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>160d</q><span class="goal-separator"><hr></span><q>1600</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>164f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> <span class="mi">1</span>%:pos%R =&gt; ? ?; <span class="nb">rewrite</span> ltNyr ltry.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre></article></body></html>