<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>mathcomp_extra.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><script>
    // Resolve backreferences
    document.addEventListener("DOMContentLoaded", function() {
        var references = document.querySelectorAll([
           ".alectryon-io .alectryon-extra-goals",
           ".alectryon-io .alectryon-goal",
           ".alectryon-io .alectryon-goals",
           ".alectryon-io .alectryon-output",
           ".alectryon-io .goal-conclusion",
           ".alectryon-io .goal-hyps",
           ".alectryon-io .goal-hyps > span"].join(", "));
        document.querySelectorAll('.alectryon-io q').forEach(function (q) {
            q.replaceWith(references[parseInt(q.innerText, 16)].cloneNode(true)) });
    });

    // Add checkboxes
    document.addEventListener("DOMContentLoaded", function() {
        var input = document.createElement("input");
        input.type = "checkbox";
        input.style = "display: none";

        input.className = "alectryon-extra-goal-toggle";
        document.querySelectorAll('.alectryon-io label.goal-separator').forEach(function(lbl, idx) {
            var goal = lbl.parentNode, box = input.cloneNode(true);
            lbl.htmlFor = box.id = "alectryon-hyps-chk" + idx;
            goal.parentNode.insertBefore(box, goal);
        });

        input.className = "alectryon-toggle";
        document.querySelectorAll('.alectryon-io .alectryon-output').forEach(function(div, idx) {
            var box = input.cloneNode(true), lbl = div.previousSibling;
            box.checked = div.classList.contains("a:show");
            if (lbl && lbl.tagName == "LABEL") {
                lbl.htmlFor = box.id = "alectryon-output-chk" + idx;
            }
            div.parentNode.insertBefore(box, lbl || div);
        });
    });
</script><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-centered alectryon-coqdoc alectryon-minified"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.15.0+0.15.0. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="c">(* mathcomp analysis (c) 2022 Inria and AIST. License: CeCILL-C.              *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> BinPos.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> mathcomp <span class="kn">Require</span> choice.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="c">(* Missing coercion (done before Import to avoid redeclaration error,</span>
<span class="c">   thanks to KS for the trick) *)</span>
<span class="c">(* MathComp 1.15 addition *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Coercion</span> <span class="nf">choice</span>.Choice.mixin : choice.Choice.class_of &gt;-&gt; choice.Choice.mixin_of.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">From</span> mathcomp <span class="kn">Require Import</span> all_ssreflect finmap ssralg ssrnum ssrint rat.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ predI _ &amp; _ ]&quot;</span> was already used <span class="kr">in</span> scope
fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ predU _ &amp; _ ]&quot;</span> was already used <span class="kr">in</span> scope
fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ predD _ &amp; _ ]&quot;</span> was already used <span class="kr">in</span> scope
fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ predC _ ]&quot;</span> was already used <span class="kr">in</span> scope
fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ preim _ of _ ]&quot;</span> was already used <span class="kr">in</span> scope
fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ + _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ - _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt;= _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt; _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &gt;= _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &gt; _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt;= _ &lt;= _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt; _ &lt;= _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt;= _ &lt; _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt; _ &lt; _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ * _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message">New coercion path [GRing.subring_closedM;
                   GRing.smulr_closedN] : GRing.subring_closed &gt;-&gt; GRing.oppr_closed <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.subring_closedB; GRing.zmod_closedN] : GRing.subring_closed &gt;-&gt; GRing.oppr_closed.
[ambiguous-paths,typechecker]</blockquote><blockquote class="alectryon-message">New coercion path [GRing.subring_closed_semi;
                   GRing.semiring_closedM] : GRing.subring_closed &gt;-&gt; GRing.mulr_closed <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.subring_closedM; GRing.smulr_closedM] : GRing.subring_closed &gt;-&gt; GRing.mulr_closed.
New coercion path [GRing.subring_closed_semi;
                   GRing.semiring_closedD] : GRing.subring_closed &gt;-&gt; GRing.addr_closed <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.subring_closedB; GRing.zmod_closedD] : GRing.subring_closed &gt;-&gt; GRing.addr_closed.
[ambiguous-paths,typechecker]</blockquote><blockquote class="alectryon-message">New coercion path [GRing.sdivr_closed_div;
                   GRing.divr_closedM] : GRing.sdivr_closed &gt;-&gt; GRing.mulr_closed <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.sdivr_closedM; GRing.smulr_closedM] : GRing.sdivr_closed &gt;-&gt; GRing.mulr_closed.
[ambiguous-paths,typechecker]</blockquote><blockquote class="alectryon-message">New coercion path [GRing.subalg_closedBM;
                   GRing.subring_closedB] : GRing.subalg_closed &gt;-&gt; GRing.zmod_closed <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.subalg_closedZ; GRing.submod_closedB] : GRing.subalg_closed &gt;-&gt; GRing.zmod_closed.
[ambiguous-paths,typechecker]</blockquote><blockquote class="alectryon-message">New coercion path [GRing.divring_closed_div;
                   GRing.sdivr_closedM] : GRing.divring_closed &gt;-&gt; GRing.smulr_closed <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.divring_closedBM; GRing.subring_closedM] : GRing.divring_closed &gt;-&gt; GRing.smulr_closed.
[ambiguous-paths,typechecker]</blockquote><blockquote class="alectryon-message">New coercion path [GRing.divalg_closedBdiv;
                   GRing.divring_closedBM] : GRing.divalg_closed &gt;-&gt; GRing.subring_closed <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.divalg_closedZ; GRing.subalg_closedBM] : GRing.divalg_closed &gt;-&gt; GRing.subring_closed.
[ambiguous-paths,typechecker]</blockquote><blockquote class="alectryon-message">New coercion path [GRing.Pred.subring_smul;
                   GRing.Pred.smul_mul] : GRing.Pred.subring &gt;-&gt; GRing.Pred.mul <span class="kr">is</span> ambiguous <span class="kr">with</span> existing 
[GRing.Pred.subring_semi; GRing.Pred.semiring_mul] : GRing.Pred.subring &gt;-&gt; GRing.Pred.mul.
[ambiguous-paths,typechecker]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> mathcomp <span class="kn">Require Import</span> finset interval.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(***************************)</span>
<span class="c">(* MathComp 1.15 additions *)</span>
<span class="sd">(***************************)</span>

<span class="sd">(******************************************************************************)</span>
<span class="c">(* This files contains lemmas and definitions missing from MathComp.          *)</span>
<span class="c">(*                                                                            *)</span>
<span class="c">(*               f \max g := fun x =&gt; Num.max (f x) (g x)                     *)</span>
<span class="c">(*                oflit f := Some \o f                                        *)</span>
<span class="c">(*          pred_oapp T D := [pred x | oapp (mem D) false x]                  *)</span>
<span class="c">(*                 f \* g := fun x =&gt; f x * g x                               *)</span>
<span class="c">(*                   \- f := fun x =&gt; - f x                                   *)</span>
<span class="c">(*     lteBSide, bnd_simp == multirule to simplify inequalities between       *)</span>
<span class="c">(*                           interval bounds                                  *)</span>
<span class="c">(*               miditv i == middle point of interval i                       *)</span>
<span class="c">(*                                                                            *)</span>
<span class="c">(*               proj i f == f i, where f : forall i, T i                     *)</span>
<span class="c">(*             dfwith f x == fun j =&gt; x if j = i, and f j otherwise           *)</span>
<span class="c">(*                           given x : T i                                    *)</span>
<span class="c">(*                 swap x := (x.2, x.1)                                       *)</span>
<span class="c">(*                                                                            *)</span>
<span class="sd">(******************************************************************************)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Set Implicit Arguments</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Unset Strict Implicit</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Unset Printing Implicit Defensive</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Reserved Notation</span> <span class="s2">&quot;f \* g&quot;</span> (<span class="kn">at level</span> <span class="mi">40</span>, <span class="kn">left associativity</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Reserved Notation</span> <span class="s2">&quot;f \- g&quot;</span> (<span class="kn">at level</span> <span class="mi">50</span>, <span class="kn">left associativity</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Reserved Notation</span> <span class="s2">&quot;\- f&quot;</span>  (<span class="kn">at level</span> <span class="mi">35</span>, f <span class="kn">at level</span> <span class="mi">35</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Reserved Notation</span> <span class="s2">&quot;f \max g&quot;</span> (<span class="kn">at level</span> <span class="mi">50</span>, <span class="kn">left associativity</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">Number <span class="kn">Notation</span> <span class="nf">positive</span> Pos.of_num_int Pos.to_num_uint : AC_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">all_sig2_cond</span> {<span class="nv">I</span> : <span class="kt">Type</span>} {<span class="nv">T</span> : <span class="kt">Type</span>} (<span class="nv">D</span> : pred I)
   (<span class="nv">P</span> <span class="nv">Q</span> : I -&gt; T -&gt; <span class="kt">Prop</span>) : T -&gt;
    (<span class="kr">forall</span> <span class="nv">x</span> : I, D x -&gt; {y : T | P x y &amp; Q x y}) -&gt;
  {f : <span class="kr">forall</span> <span class="nv">x</span> : I, T | <span class="kr">forall</span> <span class="nv">x</span> : I, D x -&gt; P x (f x) &amp; <span class="kr">forall</span> <span class="nv">x</span> : I, D x -&gt; Q x (f x)}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>I, T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>pred I</span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>I -&gt; T -&gt; <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">T -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : I, D x -&gt; {y : T | P x y &amp; Q x y}) -&gt;
{f : I -&gt; T | <span class="kr">forall</span> <span class="nv">x</span> : I, D x -&gt; P x (f x) &amp;
<span class="kr">forall</span> <span class="nv">x</span> : I, D x -&gt; Q x (f x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /all_sig_cond/[<span class="nb">apply</span>]-[f Pf]; <span class="kr">exists</span> <span class="nv">f</span> =&gt; i Di; <span class="nb">have</span> [] := Pf i Di.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">olift</span> <span class="nv">aT</span> <span class="nv">rT</span> (<span class="nv">f</span> : aT -&gt; rT) := Some \o f.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oapp_comp</span> <span class="nv">aT</span> <span class="nv">rT</span> <span class="nv">sT</span> (<span class="nv">f</span> : aT -&gt; rT) (<span class="nv">g</span> : rT -&gt; sT) <span class="nv">x</span> :
  oapp (g \o f) x =<span class="mi">1</span> (@oapp _ _)^~ x g \o omap f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>aT, rT, sT</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>aT -&gt; rT</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>rT -&gt; sT</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>sT</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">oapp (g \o f) x =<span class="mi">1</span> ((oapp (rT:=sT))^~ x) g \o omap f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">olift_comp</span> <span class="nv">aT</span> <span class="nv">rT</span> <span class="nv">sT</span> (<span class="nv">f</span> : aT -&gt; rT) (<span class="nv">g</span> : rT -&gt; sT) :
  olift (g \o f) = olift g \o f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>e</q><br><q>f</q><br><q>10</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">olift (g \o f) = olift g \o f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>15</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">compA</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : B -&gt; A) (<span class="nv">g</span> : C -&gt; B) (<span class="nv">h</span> : D -&gt; C) :
  f \o (g \o h) = (f \o g) \o h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>C -&gt; B</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>D -&gt; C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f \o (g \o h) = (f \o g) \o h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">can_in_pcan</span> [rT aT : <span class="kt">Type</span>] (A : {pred aT}) [f : aT -&gt; rT] [g : rT -&gt; aT] :
  {<span class="kr">in</span> A, cancel f g} -&gt; {<span class="kr">in</span> A, pcancel f (<span class="kr">fun</span> <span class="nv">y</span> : rT =&gt; Some (g y))}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>rT, aT</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>{pred aT}</span></span></span><br><q>f</q><br><span><var>g</var><span class="hyp-type"><b>: </b><span>rT -&gt; aT</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> A, cancel f g} -&gt;
{<span class="kr">in</span> A, pcancel f (<span class="kr">fun</span> <span class="nv">y</span> : rT =&gt; Some (g y))}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>25</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; fK x Ax; <span class="nb">rewrite</span> fK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">pcan_in_inj</span> [rT aT : <span class="kt">Type</span>] [A : {pred aT}] [f : aT -&gt; rT] [g : rT -&gt; option aT] :
  {<span class="kr">in</span> A, pcancel f g} -&gt; {<span class="kr">in</span> A &amp;, injective f}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>28</q><br><q>29</q><br><q>f</q><br><span><var>g</var><span class="hyp-type"><b>: </b><span>rT -&gt; option aT</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> A, pcancel f g} -&gt; {<span class="kr">in</span> A &amp;, injective f}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; fK x y Ax Ay /(congr1 g); <span class="nb">rewrite</span> !fK// =&gt; -[].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pred_oapp</span> <span class="nv">T</span> (<span class="nv">D</span> : {pred T}) : pred (option T) :=
  [pred x | oapp (mem D) false x].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ocan_in_comp</span> [A B C : <span class="kt">Type</span>] (D : {pred B}) (D&#39; : {pred C})
    [f : B -&gt; option A] [h : C -&gt; option B]
    [f&#39; : A -&gt; B] [h&#39; : B -&gt; C] :
  {homo h : x / x \<span class="kr">in</span> D&#39; &gt;-&gt; x \<span class="kr">in</span> pred_oapp D} -&gt;
  {<span class="kr">in</span> D, ocancel f f&#39;} -&gt; {<span class="kr">in</span> D&#39;, ocancel h h&#39;} -&gt;
  {<span class="kr">in</span> D&#39;, ocancel (obind f \o h) (h&#39; \o f&#39;)}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>{pred B}</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>{pred C}</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; option B</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{homo h : x / x \<span class="kr">in</span> D&#39; &gt;-&gt; x \<span class="kr">in</span> pred_oapp D} -&gt;
{<span class="kr">in</span> D, ocancel f f&#39;} -&gt;
{<span class="kr">in</span> D&#39;, ocancel h h&#39;} -&gt;
{<span class="kr">in</span> D&#39;, ocancel (obind f \o h) (h&#39; \o f&#39;)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>35</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; hD fK hK c cD /=; <span class="nb">rewrite</span> -[RHS]hK/=; <span class="nb">case</span> hcE : (h c) =&gt; [b|]//=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>38</q><br><q>39</q><br><q>3a</q><br><q>3b</q><br><q>3c</q><br><q>3d</q><br><q>3e</q><br><span><var>hD</var><span class="hyp-type"><b>: </b><span>{homo h : x / x \<span class="kr">in</span> D&#39; &gt;-&gt; x \<span class="kr">in</span> pred_oapp D}</span></span></span><br><span><var>fK</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> D, ocancel f f&#39;}</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> D&#39;, ocancel h h&#39;}</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cD</var><span class="hyp-type"><b>: </b><span>c \<span class="kr">in</span> D&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>hcE</var><span class="hyp-type"><b>: </b><span>h c = Some b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">oapp (h&#39; \o f&#39;) c (f b) = h&#39; b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> bD : b \<span class="kr">in</span> D <span class="bp">by</span> <span class="nb">have</span> := hD _ cD; <span class="nb">rewrite</span> hcE inE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>38</q><br><q>39</q><br><q>3a</q><br><q>3b</q><br><q>3c</q><br><q>3d</q><br><q>3e</q><br><q>45</q><br><q>46</q><br><q>47</q><br><q>48</q><br><q>49</q><br><q>4a</q><br><q>4b</q><br><span><var>bD</var><span class="hyp-type"><b>: </b><span>b \<span class="kr">in</span> D</span></span></span><br></div><span class="goal-separator"><hr></span><q>4c</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -[b <span class="kr">in</span> RHS]fK; <span class="nb">case</span>: (f b) =&gt; //=; <span class="nb">have</span> /hK := cD; <span class="nb">rewrite</span> hcE.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eqbRL</span> (<span class="nv">b1</span> <span class="nv">b2</span> : bool) : b1 = b2 -&gt; b2 -&gt; b1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b1 = b2 -&gt; b2 -&gt; b1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>53</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>-&gt;.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">mul_fun</span> <span class="nv">T</span> (<span class="nv">R</span> : ringType) (<span class="nv">f</span> <span class="nv">g</span> : T -&gt; R) <span class="nv">x</span> := (f x * g x)%R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;f \* g&quot;</span> := (mul_fun f g) : ring_scope.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ \* _&quot;</span> was already used <span class="kr">in</span> scope
ring_scope. [notation-overridden,parsing]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> mul_fun {T R} _ _ _ /.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">opp_fun</span> <span class="nv">T</span> (<span class="nv">R</span> : zmodType) (<span class="nv">f</span> : T -&gt; R) <span class="nv">x</span> := (- f x)%R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;\- f&quot;</span> := (opp_fun f) : ring_scope.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;\- _&quot;</span> was already used <span class="kr">in</span> scope ring_scope.
[notation-overridden,parsing]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> opp_fun {T R} _ _ /.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Coercion</span> <span class="nf">pair_of_interval</span> T (I : interval T) : itv_bound T * itv_bound T :=
  <span class="kr">let</span>: Interval b1 b2 := I <span class="kr">in</span> (b1, b2).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Order.TTheory GRing.Theory Num.Theory.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">itv_simp</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variables</span> (<span class="nv">d</span> : unit) (<span class="nv">T</span> : porderType d).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> (<span class="nv">x</span> <span class="nv">y</span> : T) (<span class="nv">b</span> : bool).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ltBSide</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">b</span> <span class="nv">b&#39;</span> :
  ((BSide b x &lt; BSide b&#39; y) = (x &lt; y ?&lt;= <span class="kr">if</span> b &amp;&amp; ~~ b&#39;))%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>d</var><span class="hyp-type"><b>: </b><span>unit</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>porderType d</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>T</span></span></span><br><span><var>b, b'</var><span class="hyp-type"><b>: </b><span>bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(BSide b x &lt; BSide b&#39; y)%O =
(x &lt; y ?&lt;= <span class="kr">if</span> b &amp;&amp; ~~ b&#39;)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">leBSide</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">b</span> <span class="nv">b&#39;</span> :
  ((BSide b x &lt;= BSide b&#39; y) = (x &lt; y ?&lt;= <span class="kr">if</span> b&#39; ==&gt; b))%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>5e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(BSide b x &lt;= BSide b&#39; y)%O =
(x &lt; y ?&lt;= <span class="kr">if</span> b&#39; ==&gt; b)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>66</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lteBSide</span> := (ltBSide, leBSide).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BLeft_ltE</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">b</span> : (BSide b x &lt; BLeft y)%O = (x &lt; y)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>61</q><br><span><var>b</var><span class="hyp-type"><b>: </b><span>bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(BSide b x &lt; BLeft y)%O = (x &lt; y)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>6b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: b.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BRight_leE</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">b</span> : (BSide b x &lt;= BRight y)%O = (x &lt;= y)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><span><var>BLeft_ltE</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">b</span>,
(BSide b x &lt; BLeft y)%O = (x &lt; y)%O</span></span></span><br><q>61</q><br><q>6e</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(BSide b x &lt;= BRight y)%O = (x &lt;= y)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>72</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: b.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BRight_BLeft_leE</span> <span class="nv">x</span> <span class="nv">y</span> : (BRight x &lt;= BLeft y)%O = (x &lt; y)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><span><var>BRight_leE</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">b</span>,
(BSide b x &lt;= BRight y)%O = (x &lt;= y)%O</span></span></span><br><q>61</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(BRight x &lt;= BLeft y)%O = (x &lt; y)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>79</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BLeft_BRight_ltE</span> <span class="nv">x</span> <span class="nv">y</span> : (BLeft x &lt; BRight y)%O = (x &lt;= y)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><span><var>BRight_BLeft_leE</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>,
(BRight x &lt;= BLeft y)%O = (x &lt; y)%O</span></span></span><br><q>61</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(BLeft x &lt; BRight y)%O = (x &lt;= y)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>80</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BRight_BSide_ltE</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">b</span> : (BRight x &lt; BSide b y)%O = (x &lt; y)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><span><var>BLeft_BRight_ltE</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>,
(BLeft x &lt; BRight y)%O = (x &lt;= y)%O</span></span></span><br><q>61</q><br><q>6e</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(BRight x &lt; BSide b y)%O = (x &lt; y)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>87</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: b.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BLeft_BSide_leE</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">b</span> : (BLeft x &lt;= BSide b y)%O = (x &lt;= y)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><span><var>BRight_BSide_ltE</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">b</span>,
(BRight x &lt; BSide b y)%O =
(x &lt; y)%O</span></span></span><br><q>61</q><br><q>6e</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(BLeft x &lt;= BSide b y)%O = (x &lt;= y)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>8e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: b.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BSide_ltE</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">b</span> : (BSide b x &lt; BSide b y)%O = (x &lt; y)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><span><var>BLeft_BSide_leE</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">b</span>,
(BLeft x &lt;= BSide b y)%O =
(x &lt;= y)%O</span></span></span><br><q>61</q><br><q>6e</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(BSide b x &lt; BSide b y)%O = (x &lt; y)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>95</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: b.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BSide_leE</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">b</span> : (BSide b x &lt;= BSide b y)%O = (x &lt;= y)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><q>98</q><br><span><var>BSide_ltE</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">b</span>,
(BSide b x &lt; BSide b y)%O = (x &lt; y)%O</span></span></span><br><q>61</q><br><q>6e</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(BSide b x &lt;= BSide b y)%O = (x &lt;= y)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>9c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: b.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BInfty_leE</span> <span class="nv">a</span> : (a &lt;= BInfty T false)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><q>98</q><br><q>9f</q><br><span><var>BSide_leE</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">b</span>,
(BSide b x &lt;= BSide b y)%O = (x &lt;= y)%O</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>itv_bound_porderType T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a &lt;= +oo)%O</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: a =&gt; [[] a|[]].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BInfty_geE</span> <span class="nv">a</span> : (BInfty T true &lt;= a)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><q>98</q><br><q>9f</q><br><q>a6</q><br><span><var>BInfty_leE</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : itv_bound_porderType T,
(a &lt;= +oo)%O</span></span></span><br><q>a7</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(-oo &lt;= a)%O</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ab</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: a =&gt; [[] a|[]].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BInfty_le_eqE</span> <span class="nv">a</span> : (BInfty T false &lt;= a)%O = (a == BInfty T false).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><q>98</q><br><q>9f</q><br><q>a6</q><br><q>ae</q><br><span><var>BInfty_geE</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : itv_bound_porderType T,
(-oo &lt;= a)%O</span></span></span><br><q>a7</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(+oo &lt;= a)%O = (a == +oo%O)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b2</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: a =&gt; [[] a|[]].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BInfty_ge_eqE</span> <span class="nv">a</span> : (a &lt;= BInfty T true)%O = (a == BInfty T true).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><q>98</q><br><q>9f</q><br><q>a6</q><br><q>ae</q><br><q>b5</q><br><span><var>BInfty_le_eqE</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : itv_bound_porderType T,
(+oo &lt;= a)%O = (a == +oo%O)</span></span></span><br><q>a7</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a &lt;= -oo)%O = (a == -oo%O)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>b9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: a =&gt; [[] a|[]].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BInfty_ltE</span> <span class="nv">a</span> : (a &lt; BInfty T false)%O = (a != BInfty T false).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><q>98</q><br><q>9f</q><br><q>a6</q><br><q>ae</q><br><q>b5</q><br><q>bc</q><br><span><var>BInfty_ge_eqE</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : itv_bound_porderType T,
(a &lt;= -oo)%O = (a == -oo%O)</span></span></span><br><q>a7</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a &lt; +oo)%O = (a != +oo%O)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>c0</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: a =&gt; [[] a|[]].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BInfty_gtE</span> <span class="nv">a</span> : (BInfty T true &lt; a)%O = (a != BInfty T true).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><q>98</q><br><q>9f</q><br><q>a6</q><br><q>ae</q><br><q>b5</q><br><q>bc</q><br><q>c3</q><br><span><var>BInfty_ltE</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : itv_bound_porderType T,
(a &lt; +oo)%O = (a != +oo%O)</span></span></span><br><q>a7</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(-oo &lt; a)%O = (a != -oo%O)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>c7</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: a =&gt; [[] a|[]].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BInfty_ltF</span> <span class="nv">a</span> : (BInfty T false &lt; a)%O = false.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><q>98</q><br><q>9f</q><br><q>a6</q><br><q>ae</q><br><q>b5</q><br><q>bc</q><br><q>c3</q><br><q>ca</q><br><span><var>BInfty_gtE</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : itv_bound_porderType T,
(-oo &lt; a)%O = (a != -oo%O)</span></span></span><br><q>a7</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(+oo &lt; a)%O = false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ce</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: a =&gt; [[] a|[]].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BInfty_gtF</span> <span class="nv">a</span> : (a &lt; BInfty T true)%O = false.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><q>98</q><br><q>9f</q><br><q>a6</q><br><q>ae</q><br><q>b5</q><br><q>bc</q><br><q>c3</q><br><q>ca</q><br><q>d1</q><br><span><var>BInfty_ltF</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : itv_bound_porderType T,
(+oo &lt; a)%O = false</span></span></span><br><q>a7</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a &lt; -oo)%O = false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>d5</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: a =&gt; [[] a|[]].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">BInfty_BInfty_ltE</span> : (BInfty T true &lt; BInfty T false)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><q>98</q><br><q>9f</q><br><q>a6</q><br><q>ae</q><br><q>b5</q><br><q>bc</q><br><q>c3</q><br><q>ca</q><br><q>d1</q><br><q>d8</q><br><span><var>BInfty_gtF</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : itv_bound_porderType T,
(a &lt; -oo)%O = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(-oo &lt; +oo)%O</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>dc</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ltBRight_leBLeft</span> (<span class="nv">a</span> : itv_bound T) (<span class="nv">r</span> : T) :
  (a &lt; BRight r)%O = (a &lt;= BLeft r)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><q>98</q><br><q>9f</q><br><q>a6</q><br><q>ae</q><br><q>b5</q><br><q>bc</q><br><q>c3</q><br><q>ca</q><br><q>d1</q><br><q>d8</q><br><q>df</q><br><span><var>BInfty_BInfty_ltE</var><span class="hyp-type"><b>: </b><span>(-oo &lt; +oo)%O</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>itv_bound T</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a &lt; BRight r)%O = (a &lt;= BLeft r)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>e3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: a =&gt; [[] a|[]].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">leBRight_ltBLeft</span> (<span class="nv">a</span> : itv_bound T) (<span class="nv">r</span> : T) :
  (BRight r &lt;= a)%O = (BLeft r &lt; a)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>e5</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(BRight r &lt;= a)%O = (BLeft r &lt; a)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ec</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>: a =&gt; [[] a|[]].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">bnd_simp</span> := (BLeft_ltE, BRight_leE,
  BRight_BLeft_leE, BLeft_BRight_ltE,
  BRight_BSide_ltE, BLeft_BSide_leE, BSide_ltE, BSide_leE,
  BInfty_leE, BInfty_geE, BInfty_BInfty_ltE,
  BInfty_le_eqE, BInfty_ge_eqE, BInfty_ltE, BInfty_gtE, BInfty_ltF, BInfty_gtF,
  @lexx _ T, @ltxx _ T, @eqxx T).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">itv_splitU1</span> (<span class="nv">a</span> : itv_bound T) (<span class="nv">x</span> : T) : (a &lt;= BLeft x)%O -&gt;
  Interval a (BRight x) =i [predU1 x &amp; Interval a (BLeft x)].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><q>98</q><br><q>9f</q><br><q>a6</q><br><q>ae</q><br><q>b5</q><br><q>bc</q><br><q>c3</q><br><q>ca</q><br><q>d1</q><br><q>d8</q><br><q>df</q><br><q>e6</q><br><q>e7</q><br><span><var>x</var><span class="hyp-type"><b>: </b><span>T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a &lt;= BLeft x)%O -&gt;
Interval a (BRight x)
  =i [predU1 x &amp; Interval a (BLeft x)]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>f1</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; ax z; <span class="nb">rewrite</span> !inE/= !subitvE <span class="nl">?bnd_simp</span>//= lt_neqAle.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><q>98</q><br><q>9f</q><br><q>a6</q><br><q>ae</q><br><q>b5</q><br><q>bc</q><br><q>c3</q><br><q>ca</q><br><q>d1</q><br><q>d8</q><br><q>df</q><br><q>e6</q><br><q>e7</q><br><q>f4</q><br><span><var>ax</var><span class="hyp-type"><b>: </b><span>(a &lt;= BLeft x)%O</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a &lt;= BLeft z)%O &amp;&amp; (z &lt;= x)%O =
(z == x) || [&amp;&amp; (a &lt;= BLeft z)%O, z != x &amp; (z &lt;= x)%O]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: (eqVneq z x) =&gt; [-&gt;|]//=; <span class="nb">rewrite</span> lexx ax.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">itv_split1U</span> (<span class="nv">a</span> : itv_bound T) (<span class="nv">x</span> : T) : (BRight x &lt;= a)%O -&gt;
  Interval (BLeft x) a =i [predU1 x &amp; Interval (BRight x) a].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>f3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(BRight x &lt;= a)%O -&gt;
Interval (BLeft x) a
  =i [predU1 x &amp; Interval (BRight x) a]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ff</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; ax z; <span class="nb">rewrite</span> !inE/= !subitvE <span class="nl">?bnd_simp</span>//= lt_neqAle.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>75</q><br><q>7c</q><br><q>83</q><br><q>8a</q><br><q>91</q><br><q>98</q><br><q>9f</q><br><q>a6</q><br><q>ae</q><br><q>b5</q><br><q>bc</q><br><q>c3</q><br><q>ca</q><br><q>d1</q><br><q>d8</q><br><q>df</q><br><q>e6</q><br><q>e7</q><br><q>f4</q><br><span><var>ax</var><span class="hyp-type"><b>: </b><span>(BRight x &lt;= a)%O</span></span></span><br><q>fc</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt;= z)%O &amp;&amp; (BRight z &lt;= a)%O =
(z == x)
|| (x != z) &amp;&amp; (x &lt;= z)%O &amp;&amp; (BRight z &lt;= a)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: (eqVneq z x) =&gt; [-&gt;|]//=; <span class="nb">rewrite</span> lexx ax.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">itv_simp</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">miditv</span> (<span class="nv">R</span> : numDomainType) (<span class="nv">i</span> : interval R) : R :=
  <span class="kr">match</span> i <span class="kr">with</span>
  | Interval (BSide _ a) (BSide _ b) =&gt; (a + b) / <span class="mi">2</span>%:R
  | Interval -oo%O (BSide _ b) =&gt; b - <span class="mi">1</span>
  | Interval (BSide _ a) +oo%O =&gt; a + <span class="mi">1</span>
  | Interval -oo%O +oo%O =&gt; <span class="mi">0</span>
  | _ =&gt; <span class="mi">0</span>
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">miditv_lemmas</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">R</span> : numFieldType.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> <span class="nv">i</span> : interval R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mem_miditv</span> <span class="nv">i</span> : (i.<span class="mi">1</span> &lt; i.<span class="mi">2</span>)%O -&gt; miditv i \<span class="kr">in</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>numFieldType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>interval R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(i.<span class="mi">1</span> &lt; i.<span class="mi">2</span>)%O -&gt; miditv i \<span class="kr">in</span> i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>10a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: i =&gt; [[ba a|[]] [bb b|[]]] //= ab; <span class="kp">first</span> <span class="bp">exact</span>: mid_in_itv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><span><var>ba</var><span class="hyp-type"><b>: </b><span>bool</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>ab</var><span class="hyp-type"><b>: </b><span>(BSide ba a &lt; +oo)%O</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a + <span class="mi">1</span>)%R \<span class="kr">in</span> Interval (BSide ba a) +oo%O</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><span><var>bb</var><span class="hyp-type"><b>: </b><span>bool</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>ab</var><span class="hyp-type"><b>: </b><span>(-oo &lt; BSide bb b)%O</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">(b - <span class="mi">1</span>)%R \<span class="kr">in</span> Interval -oo%O (BSide bb b)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !in_itv -lteif_subl_addl subrr lteif01.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>11b</q><span class="goal-separator"><hr></span><q>11f</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !in_itv lteif_subl_addr -lteif_subl_addl subrr lteif01.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">miditv_le_left</span> <span class="nv">i</span> <span class="nv">b</span> : (i.<span class="mi">1</span> &lt; i.<span class="mi">2</span>)%O -&gt; (BSide b (miditv i) &lt;= i.<span class="mi">2</span>)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><q>10e</q><br><q>6e</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(i.<span class="mi">1</span> &lt; i.<span class="mi">2</span>)%O -&gt; (BSide b (miditv i) &lt;= i.<span class="mi">2</span>)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>124</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: i =&gt; [x y] lti; <span class="nb">have</span> := mem_miditv lti; <span class="nb">rewrite</span> inE =&gt; /andP[_ ].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><q>6e</q><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>itv_bound R</span></span></span><br><span><var>lti</var><span class="hyp-type"><b>: </b><span>((Interval x y).<span class="mi">1</span> &lt; (Interval x y).<span class="mi">2</span>)%O</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(BRight (miditv (Interval x y)) &lt;= y)%O -&gt;
(BSide b (miditv (Interval x y)) &lt;= (Interval x y).<span class="mi">2</span>)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: le_trans; <span class="nb">rewrite</span> !bnd_simp.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">miditv_ge_right</span> <span class="nv">i</span> <span class="nv">b</span> : (i.<span class="mi">1</span> &lt; i.<span class="mi">2</span>)%O -&gt; (i.<span class="mi">1</span> &lt;= BSide b (miditv i))%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>126</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(i.<span class="mi">1</span> &lt; i.<span class="mi">2</span>)%O -&gt; (i.<span class="mi">1</span> &lt;= BSide b (miditv i))%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>131</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: i =&gt; [x y] lti; <span class="nb">have</span> := mem_miditv lti; <span class="nb">rewrite</span> inE =&gt; /andP[+ _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>12c</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(x &lt;= BLeft (miditv (Interval x y)))%O -&gt;
((Interval x y).<span class="mi">1</span> &lt;= BSide b (miditv (Interval x y)))%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /le_trans; <span class="nb">apply</span>; <span class="nb">rewrite</span> !bnd_simp.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">miditv_lemmas</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">itv_porderType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variables</span> (<span class="nv">d</span> : unit) (<span class="nv">T</span> : orderType d).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> (<span class="nv">a</span> : itv_bound T) (<span class="nv">x</span> <span class="nv">y</span> : T) (<span class="nv">i</span> <span class="nv">j</span> : interval T) (<span class="nv">b</span> : bool).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">predC_itvl</span> <span class="nv">a</span> : [predC Interval -oo%O a] =i Interval a +oo%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><span><var>T</var><span class="hyp-type"><b>: </b><span>orderType d</span></span></span><br><q>e7</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[predC Interval -oo%O a] =i Interval a +oo%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>13a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: a =&gt; [b x|[]//] y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>6e</q><br><q>61</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(y \<span class="kr">in</span> [predC Interval -oo%O (BSide b x)]) =
(y \<span class="kr">in</span> Interval (BSide b x) +oo%O)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !inE !subitvE/= bnd_simp andbT !lteBSide/= lteifNE negbK.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">predC_itvr</span> <span class="nv">a</span> : [predC Interval a +oo%O] =i Interval -oo%O a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>13c</q><span class="goal-separator"><hr></span><div class="goal-conclusion">[predC Interval a +oo%O] =i Interval -oo%O a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>146</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; y; <span class="nb">rewrite</span> inE/= -predC_itvl negbK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">predC_itv</span> <span class="nv">i</span> : [predC i] =i [predU Interval -oo%O i.<span class="mi">1</span> &amp; Interval i.<span class="mi">2</span> +oo%O].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><span><var>i</var><span class="hyp-type"><b>: </b><span>interval T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[predC i]
  =i [predU Interval -oo%O i.<span class="mi">1</span> &amp; Interval i.<span class="mi">2</span> +oo%O]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>14b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: i =&gt; [a a&#39;]; <span class="nb">move</span>=&gt; x; <span class="nb">rewrite</span> inE/= itv_splitI negb_and.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>itv_bound T</span></span></span><br><q>f4</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x \notin Interval a +oo%O)
|| (x \notin Interval -oo%O a&#39;) =
(x \<span class="kr">in</span> [predU Interval -oo%O a &amp; Interval a&#39; +oo%O])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">symmetry</span>; <span class="nb">rewrite</span> inE/= -predC_itvl -predC_itvr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">itv_porderType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sumr_le0</span> (<span class="nv">R</span> : numDomainType) <span class="nv">I</span> (<span class="nv">r</span> : seq I) (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; F i &lt;= <span class="mi">0</span>)%R -&gt; (\sum_(i &lt;- r | P i) F i &lt;= <span class="mi">0</span>)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>numDomainType</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>seq I</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>pred I</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>I -&gt; R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; (F i &lt;= <span class="mi">0</span>)%R) -&gt;
(\sum_(i &lt;- r | P i) F i &lt;= <span class="mi">0</span>)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>158</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; F0; <span class="nb">elim</span>/big_rec : _ =&gt; // i x Pi; <span class="nb">apply</span>/ler_naddl/F0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">enum_ord0</span> : enum &#39;I_0 = [::].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">enum &#39;I_0 = [::]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>163</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/eqP; <span class="nb">rewrite</span> -size_eq0 size_enum_ord.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">enum_ordSr</span> <span class="nv">n</span> : enum &#39;I_n.+<span class="mi">1</span> =
  rcons (map (widen_ord (leqnSn _)) (enum &#39;I_n)) ord_max.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">enum &#39;I_n.+<span class="mi">1</span> =
rcons [seq widen_ord (leqnSn n) i | i &lt;- enum &#39;I_n]
  ord_max</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>168</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: (inj_map val_inj); <span class="nb">rewrite</span> val_enum_ord.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>16a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">iota <span class="mi">0</span> n.+<span class="mi">1</span> =
[seq val i
   | i &lt;- rcons
            [seq widen_ord (leqnSn n) i
               | i &lt;- enum &#39;I_n] ord_max]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -[<span class="kr">in</span> iota _  _]addn1 iotaD/= cats1 map_rcons; <span class="nb">congr</span> (rcons _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>16a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">iota <span class="mi">0</span> n =
[seq i
   | i &lt;- [seq widen_ord (leqnSn n) i
             | i &lt;- enum &#39;I_n]]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -map_comp/= (@eq_map _ _ _ val) <span class="nl">?val_enum_ord</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">obindEapp</span> {<span class="nv">aT</span> <span class="nv">rT</span>} (<span class="nv">f</span> : aT -&gt; option rT) : obind f = oapp f None.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>aT, rT</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>aT -&gt; option rT</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">obind f = oapp f None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>177</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">omapEbind</span> {<span class="nv">aT</span> <span class="nv">rT</span>} (<span class="nv">f</span> : aT -&gt; rT) : omap f = obind (olift f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>17a</q><br><q>f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">omap f = obind (olift f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>17f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">omapEapp</span> {<span class="nv">aT</span> <span class="nv">rT</span>} (<span class="nv">f</span> : aT -&gt; rT) : omap f = oapp (olift f) None.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>181</q><span class="goal-separator"><hr></span><div class="goal-conclusion">omap f = oapp (olift f) None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>185</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oappEmap</span> {<span class="nv">aT</span> <span class="nv">rT</span>} (<span class="nv">f</span> : aT -&gt; rT) (<span class="nv">y0</span> : rT) <span class="nv">x</span> :
  oapp f y0 x = odflt y0 (omap f x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>17a</q><br><q>f</q><br><span><var>y0</var><span class="hyp-type"><b>: </b><span>rT</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>option aT</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">oapp f y0 x = odflt y0 (omap f x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>18a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: x.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">omap_comp</span> <span class="nv">aT</span> <span class="nv">rT</span> <span class="nv">sT</span> (<span class="nv">f</span> : aT -&gt; rT) (<span class="nv">g</span> : rT -&gt; sT) :
  omap (g \o f) =<span class="mi">1</span> omap g \o omap f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>17</q><span class="goal-separator"><hr></span><div class="goal-conclusion">omap (g \o f) =<span class="mi">1</span> omap g \o omap f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>192</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oapp_comp_f</span> {<span class="nv">aT</span> <span class="nv">rT</span> <span class="nv">sT</span>} (<span class="nv">f</span> : aT -&gt; rT) (<span class="nv">g</span> : rT -&gt; sT) (<span class="nv">x</span> : rT) :
  oapp (g \o f) (g x) =<span class="mi">1</span> g \o oapp f x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>e</q><br><q>f</q><br><q>10</q><br><span><var>x</var><span class="hyp-type"><b>: </b><span>rT</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">oapp (g \o f) (g x) =<span class="mi">1</span> g \o oapp f x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>197</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">can_in_comp</span> [A B C : <span class="kt">Type</span>] (D : {pred B}) (D&#39; : {pred C})
    [f : B -&gt; A] [h : C -&gt; B]
    [f&#39; : A -&gt; B] [h&#39; : B -&gt; C] :
  {homo h : x / x \<span class="kr">in</span> D&#39; &gt;-&gt; x \<span class="kr">in</span> D} -&gt;
  {<span class="kr">in</span> D, cancel f f&#39;} -&gt; {<span class="kr">in</span> D&#39;, cancel h h&#39;} -&gt;
  {<span class="kr">in</span> D&#39;, cancel (f \o h) (h&#39; \o f&#39;)}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>38</q><br><q>39</q><br><q>3a</q><br><q>1f</q><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; B</span></span></span><br><q>3d</q><br><q>3e</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{homo h : x / x \<span class="kr">in</span> D&#39; &gt;-&gt; x \<span class="kr">in</span> D} -&gt;
{<span class="kr">in</span> D, cancel f f&#39;} -&gt;
{<span class="kr">in</span> D&#39;, cancel h h&#39;} -&gt;
{<span class="kr">in</span> D&#39;, cancel (f \o h) (h&#39; \o f&#39;)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>19e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; hD fK hK c cD /=; <span class="nb">rewrite</span> fK <span class="nl">?hK</span> <span class="nl">?hD</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">in_inj_comp</span> <span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> (<span class="nv">f</span> : B -&gt; A) (<span class="nv">h</span> : C -&gt; B) (<span class="nv">P</span> : pred B) (<span class="nv">Q</span> : pred C) :
  {<span class="kr">in</span> P &amp;, injective f} -&gt; {<span class="kr">in</span> Q &amp;, injective h} -&gt; {homo h : x / Q x &gt;-&gt; P x} -&gt;
  {<span class="kr">in</span> Q &amp;, injective (f \o h)}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>38</q><br><q>1f</q><br><q>1a1</q><br><span><var>P</var><span class="hyp-type"><b>: </b><span>pred B</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>pred C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> P &amp;, injective f} -&gt;
{<span class="kr">in</span> Q &amp;, injective h} -&gt;
{homo h : x / Q x &gt;-&gt; P x} -&gt;
{<span class="kr">in</span> Q &amp;, injective (f \o h)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1a5</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; Pf Qh QP x y xQ yQ xy; <span class="nb">apply</span> Qh =&gt; //; <span class="nb">apply</span> Pf =&gt; //; <span class="nb">apply</span> QP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">pcan_in_comp</span> [A B C : <span class="kt">Type</span>] (D : {pred B}) (D&#39; : {pred C})
    [f : B -&gt; A] [h : C -&gt; B]
    [f&#39; : A -&gt; option B] [h&#39; : B -&gt; option C] :
  {homo h : x / x \<span class="kr">in</span> D&#39; &gt;-&gt; x \<span class="kr">in</span> D} -&gt;
  {<span class="kr">in</span> D, pcancel f f&#39;} -&gt; {<span class="kr">in</span> D&#39;, pcancel h h&#39;} -&gt;
  {<span class="kr">in</span> D&#39;, pcancel (f \o h) (obind h&#39; \o f&#39;)}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>38</q><br><q>39</q><br><q>3a</q><br><q>1f</q><br><q>1a1</q><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>B -&gt; option C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{homo h : x / x \<span class="kr">in</span> D&#39; &gt;-&gt; x \<span class="kr">in</span> D} -&gt;
{<span class="kr">in</span> D, pcancel f f&#39;} -&gt;
{<span class="kr">in</span> D&#39;, pcancel h h&#39;} -&gt;
{<span class="kr">in</span> D&#39;, pcancel (f \o h) (obind h&#39; \o f&#39;)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1ad</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; hD fK hK c cD /=; <span class="nb">rewrite</span> fK/= <span class="nl">?hK</span> <span class="nl">?hD</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ocan_comp</span> [A B C : <span class="kt">Type</span>] [f : B -&gt; option A] [h : C -&gt; option B]
    [f&#39; : A -&gt; B] [h&#39; : B -&gt; C] :
  ocancel f f&#39; -&gt; ocancel h h&#39; -&gt; ocancel (obind f \o h) (h&#39; \o f&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>38</q><br><q>3b</q><br><q>3c</q><br><q>3d</q><br><q>3e</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ocancel f f&#39; -&gt;
ocancel h h&#39; -&gt; ocancel (obind f \o h) (h&#39; \o f&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1b5</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; fK hK c /=; <span class="nb">rewrite</span> -[RHS]hK/=; <span class="nb">case</span> hcE : (h c) =&gt; [b|]//=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>38</q><br><q>3b</q><br><q>3c</q><br><q>3d</q><br><q>3e</q><br><span><var>fK</var><span class="hyp-type"><b>: </b><span>ocancel f f&#39;</span></span></span><br><span><var>hK</var><span class="hyp-type"><b>: </b><span>ocancel h h&#39;</span></span></span><br><q>48</q><br><q>4a</q><br><q>4b</q><br></div><span class="goal-separator"><hr></span><q>4c</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -[b <span class="kr">in</span> RHS]fK; <span class="nb">case</span>: (f b) =&gt; //=; <span class="nb">have</span> := hK c; <span class="nb">rewrite</span> hcE.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eqbLR</span> (<span class="nv">b1</span> <span class="nv">b2</span> : bool) : b1 = b2 -&gt; b1 -&gt; b2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>55</q><span class="goal-separator"><hr></span><div class="goal-conclusion">b1 = b2 -&gt; b1 -&gt; b2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1c1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>-&gt;.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">max_fun</span> <span class="nv">T</span> (<span class="nv">R</span> : numDomainType) (<span class="nv">f</span> <span class="nv">g</span> : T -&gt; R) <span class="nv">x</span> := Num.max (f x) (g x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;f \max g&quot;</span> := (max_fun f g) : ring_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> max_fun {T R} _ _ _ /.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gtr_opp</span> (<span class="nv">R</span> : numDomainType) (<span class="nv">r</span> : R) : (<span class="mi">0</span> &lt; r)%R -&gt; (- r &lt; r)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>15b</q><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; r)%R -&gt; (- r &lt; r)%R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1c6</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; n0; <span class="nb">rewrite</span> -subr_lt0 -opprD oppr_lt0 addr_gt0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_le_trans</span> {<span class="nv">disp</span> : unit} {<span class="nv">T</span> : porderType disp} (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">t</span> : T) :
  (z &lt;= x)%O -&gt; (y &lt;= t)%O -&gt; (x &lt;= y)%O -&gt; (z &lt;= t)%O.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>disp</var><span class="hyp-type"><b>: </b><span>unit</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>porderType disp</span></span></span><br><span><var>x, y, z, t</var><span class="hyp-type"><b>: </b><span>T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(z &lt;= x)%O -&gt; (y &lt;= t)%O -&gt; (x &lt;= y)%O -&gt; (z &lt;= t)%O</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1cd</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; + /(le_trans _)/[<span class="nb">apply</span>]; <span class="nb">apply</span>: le_trans.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="nf">eqLHS</span> := (X <span class="kr">in</span> (X == _))%<span class="nb">pattern</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="nf">eqRHS</span> := (X <span class="kr">in</span> (_ == X))%<span class="nb">pattern</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="nf">leLHS</span> := (X <span class="kr">in</span> (X &lt;= _)%O)%<span class="nb">pattern</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="nf">leRHS</span> := (X <span class="kr">in</span> (_ &lt;= X)%O)%<span class="nb">pattern</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="nf">ltLHS</span> := (X <span class="kr">in</span> (X &lt; _)%O)%<span class="nb">pattern</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="nf">ltRHS</span> := (X <span class="kr">in</span> (_ &lt; X)%O)%<span class="nb">pattern</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">boxed</span> <span class="nv">T</span> := Box of T.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eq_bigl_supp</span> [R : eqType] [idx : R] [op : Monoid.law idx] [I : <span class="kt">Type</span>]
  [r : seq I] [P1 : pred I] (P2 : pred I) (F : I -&gt; R) :
  {<span class="kr">in</span> [pred x | F x != idx], P1 =<span class="mi">1</span> P2} -&gt;
  \big[op/idx]_(i &lt;- r | P1 i) F i = \big[op/idx]_(i &lt;- r | P2 i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>eqType</span></span></span><br><span><var>idx</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid.law idx</span></span></span><br><q>15c</q><br><q>15d</q><br><span><var>P1, P2</var><span class="hyp-type"><b>: </b><span>pred I</span></span></span><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> [pred x | F x != idx], P1 =<span class="mi">1</span> P2} -&gt;
\big[op/idx]_(i &lt;- r | P1 i) F i =
\big[op/idx]_(i &lt;- r | P2 i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1d6</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; P12; <span class="nb">rewrite</span> big_mkcond [RHS]big_mkcond; <span class="nb">apply</span>: eq_bigr =&gt; i _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>1d9</q><br><q>1da</q><br><q>1db</q><br><q>15c</q><br><q>15d</q><br><q>1dc</q><br><q>15f</q><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> [pred x | F x != idx], P1 =<span class="mi">1</span> P2}</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>I</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> P1 i <span class="kr">then</span> F i <span class="kr">else</span> idx) =
(<span class="kr">if</span> P2 i <span class="kr">then</span> F i <span class="kr">else</span> idx)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: (eqVneq (F i) idx) =&gt; [-&gt;|/P12-&gt;]; <span class="nb">rewrite</span> <span class="nl">?if_same</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">perm_big_supp_cond</span> [R : eqType] [idx : R] [op : Monoid.com_law idx] [I : eqType]
  [r s : seq I] [P : pred I] (F : I -&gt; R) :
  perm_eq [seq i &lt;- r | P i &amp;&amp; (F i != idx)] [seq i &lt;- s | P i &amp;&amp; (F i != idx)] -&gt;
  \big[op/idx]_(i &lt;- r | P i) F i = \big[op/idx]_(i &lt;- s| P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>1d9</q><br><q>1da</q><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid.com_law idx</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span>eqType</span></span></span><br><span><var>r, s</var><span class="hyp-type"><b>: </b><span>seq I</span></span></span><br><q>15e</q><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">perm_eq [seq i &lt;- r | P i &amp; F i != idx]
  [seq i &lt;- s | P i &amp; F i != idx] -&gt;
\big[op/idx]_(i &lt;- r | P i) F i =
\big[op/idx]_(i &lt;- s | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1e7</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; prs; <span class="nb">rewrite</span> !(bigID [pred i | F i == idx] P F)/=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>1d9</q><br><q>1da</q><br><q>1ea</q><br><q>1eb</q><br><q>1ec</q><br><q>15e</q><br><q>15f</q><br><span><var>prs</var><span class="hyp-type"><b>: </b><span>perm_eq [seq i &lt;- r | P i &amp; F i != idx] [seq i &lt;- s | P i &amp; F i != idx]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">op (\big[op/idx]_(i &lt;- r | P i &amp;&amp; (F i == idx)) F i)
  (\big[op/idx]_(i &lt;- r | P i &amp;&amp; (F i != idx)) F i) =
op (\big[op/idx]_(i &lt;- s | P i &amp;&amp; (F i == idx)) F i)
  (\big[op/idx]_(i &lt;- s | P i &amp;&amp; (F i != idx)) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> big1 <span class="nl">?Monoid</span>.mul1m; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">move</span>=&gt; i /andP[_ /eqP-&gt;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1f2</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[op/idx]_(i &lt;- r | P i &amp;&amp; (F i != idx)) F i =
op (\big[op/idx]_(i &lt;- s | P i &amp;&amp; (F i == idx)) F i)
  (\big[op/idx]_(i &lt;- s | P i &amp;&amp; (F i != idx)) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> [<span class="kr">in</span> RHS]big1 <span class="nl">?Monoid</span>.mul1m; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">move</span>=&gt; i /andP[_ /eqP-&gt;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1f2</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[op/idx]_(i &lt;- r | P i &amp;&amp; (F i != idx)) F i =
\big[op/idx]_(i &lt;- s | P i &amp;&amp; (F i != idx)) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -[<span class="kr">in</span> LHS]big_filter -[<span class="kr">in</span> RHS]big_filter; <span class="nb">apply</span> perm_big.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">perm_big_supp</span> [R : eqType] [idx : R] [op : Monoid.com_law idx] [I : eqType]
  [r s : seq I] [P : pred I] (F : I -&gt; R) :
  perm_eq [seq i &lt;- r | (F i != idx)] [seq i &lt;- s | (F i != idx)] -&gt;
  \big[op/idx]_(i &lt;- r | P i) F i = \big[op/idx]_(i &lt;- s| P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1e9</q><span class="goal-separator"><hr></span><div class="goal-conclusion">perm_eq [seq i &lt;- r | F i != idx]
  [seq i &lt;- s | F i != idx] -&gt;
\big[op/idx]_(i &lt;- r | P i) F i =
\big[op/idx]_(i &lt;- s | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>1fe</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">apply</span>: perm_big_supp_cond; <span class="nb">rewrite</span> !filter_predI perm_filter.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> order_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> ring_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> GRing.Theory Order.TTheory.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">mulr_ge0_gt0</span> (<span class="nv">R</span> : numDomainType) (<span class="nv">x</span> <span class="nv">y</span> : R) : <span class="mi">0</span> &lt;= x -&gt; <span class="mi">0</span> &lt;= y -&gt;
  (<span class="mi">0</span> &lt; x * y) = (<span class="mi">0</span> &lt; x) &amp;&amp; (<span class="mi">0</span> &lt; y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>15b</q><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= x -&gt; <span class="mi">0</span> &lt;= y -&gt; (<span class="mi">0</span> &lt; x * y) = (<span class="mi">0</span> &lt; x) &amp;&amp; (<span class="mi">0</span> &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>203</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;-|x0]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> mul0r ltxx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>15b</q><br><q>206</q><br><span><var>x0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= y -&gt; (<span class="mi">0</span> &lt; x * y) = (<span class="mi">0</span> &lt; x) &amp;&amp; (<span class="mi">0</span> &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[&lt;-|y0]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> mulr0 ltxx andbC.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>15b</q><br><q>206</q><br><q>20d</q><br><span><var>y0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt; x * y) = (<span class="mi">0</span> &lt; x) &amp;&amp; (<span class="mi">0</span> &lt; y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/idP/andP=&gt; [|_]; <span class="nb">rewrite</span> pmulr_rgt0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">lt_le_gt_ge</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> (<span class="nv">R</span> : numFieldType).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">a</span> <span class="nv">b</span> : R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">splitr</span> <span class="nv">x</span> : x = x / <span class="mi">2</span>%:R + x / <span class="mi">2</span>%:R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><span><var>x</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = x / <span class="mi">2</span> + x / <span class="mi">2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>216</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -mulr2n -mulr_natr mulfVK //= pnatr_eq0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ler_addgt0Pr</span> <span class="nv">x</span> <span class="nv">y</span> : reflect (<span class="kr">forall</span> <span class="nv">e</span>, e &gt; <span class="mi">0</span> -&gt; x &lt;= y + e) (x &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><q>206</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect (<span class="kr">forall</span> <span class="nv">e</span> : R, <span class="mi">0</span> &lt; e -&gt; x &lt;= y + e) (x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>21d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/(iffP idP)=&gt; [lexy e e_gt0 | lexye]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> ler_paddr// ltW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><q>206</q><br><span><var>lexye</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">e</span> : R, <span class="mi">0</span> &lt; e -&gt; x &lt;= y + e</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [||ltyx]// := comparable_leP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>225</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &gt;=&lt; y</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><q>206</q><br><q>226</q><br><span><var>ltyx</var><span class="hyp-type"><b>: </b><span>y &lt; x</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">false</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> (@comparabler_trans _ (y + <span class="mi">1</span>))// /Order.comparable <span class="nl">?lexye</span> <span class="nl">?ltr01</span>//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>225</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(y + <span class="mi">1</span> &lt;= y) || (y &lt;= y + <span class="mi">1</span>)</div></blockquote><q>22c</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ler_addl ler01 orbT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>22e</q><span class="goal-separator"><hr></span><q>230</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> /midf_lt [_] := ltyx; <span class="nb">rewrite</span> le_gtF//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>22e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= (y + x) / <span class="mi">2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -(@addrK _ y y) addrAC -addrA <span class="mi">2</span>!mulrDl -splitr lexye//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>22e</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; (x - y) / <span class="mi">2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> divr_gt0// <span class="nl">?ltr0n</span>// subr_gt0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ler_addgt0Pl</span> <span class="nv">x</span> <span class="nv">y</span> : reflect (<span class="kr">forall</span> <span class="nv">e</span>, e &gt; <span class="mi">0</span> -&gt; x &lt;= e + y) (x &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21f</q><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect (<span class="kr">forall</span> <span class="nv">e</span> : R, <span class="mi">0</span> &lt; e -&gt; x &lt;= e + y) (x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>241</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/(equivP (ler_addgt0Pr x y)); <span class="nb">split</span>=&gt; lexy e /lexy; <span class="nb">rewrite</span> addrC.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">in_segment_addgt0Pr</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> :
  reflect (<span class="kr">forall</span> <span class="nv">e</span>, e &gt; <span class="mi">0</span> -&gt; y \<span class="kr">in</span> `[x - e, z + e]) (y \<span class="kr">in</span> `[x, z]).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect
  (<span class="kr">forall</span> <span class="nv">e</span> : R, <span class="mi">0</span> &lt; e -&gt; y \<span class="kr">in</span> `[(x - e), (z + e)])
  (y \<span class="kr">in</span> `[x, z])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>246</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/(iffP idP)=&gt; [xyz e /[dup] e_gt0 /ltW e_ge0 | xyz_e].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><q>249</q><br><span><var>xyz</var><span class="hyp-type"><b>: </b><span>y \<span class="kr">in</span> `[x, z]</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>e_gt0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; e</span></span></span><br><span><var>e_ge0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= e</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">in</span> `[(x - e), (z + e)]</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><q>249</q><br><span><var>xyz_e</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">e</span> : R,
<span class="mi">0</span> &lt; e -&gt; y \<span class="kr">in</span> `[(x - e), (z + e)]</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">y \<span class="kr">in</span> `[x, z]</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> in_itv /= ler_subl_addr !ler_paddr// (itvP xyz).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>257</q><span class="goal-separator"><hr></span><q>259</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> in_itv /= ; <span class="nb">apply</span>/andP; <span class="nb">split</span>; <span class="nb">apply</span>/ler_addgt0Pr =&gt; ? /xyz_e;
   <span class="nb">rewrite</span> in_itv /= ler_subl_addr =&gt; /andP [].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">in_segment_addgt0Pl</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> :
  reflect (<span class="kr">forall</span> <span class="nv">e</span>, e &gt; <span class="mi">0</span> -&gt; y \<span class="kr">in</span> `[(- e + x), (e + z)]) (y \<span class="kr">in</span> `[x, z]).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>248</q><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect
  (<span class="kr">forall</span> <span class="nv">e</span> : R, <span class="mi">0</span> &lt; e -&gt; y \<span class="kr">in</span> `[(- e + x), (e + z)])
  (y \<span class="kr">in</span> `[x, z])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>25e</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/(equivP (in_segment_addgt0Pr x y z)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>248</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">e</span> : R, <span class="mi">0</span> &lt; e -&gt; y \<span class="kr">in</span> `[(x - e), (z + e)]) &lt;-&gt;
(<span class="kr">forall</span> <span class="nv">e</span> : R, <span class="mi">0</span> &lt; e -&gt; y \<span class="kr">in</span> `[(- e + x), (e + z)])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span>=&gt; zxy e /zxy; <span class="nb">rewrite</span> [z + _]addrC [_ + x]addrC.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lt_le</span> <span class="nv">a</span> <span class="nv">b</span> : (<span class="kr">forall</span> <span class="nv">x</span>, x &lt; a -&gt; x &lt; b) -&gt; a &lt;= b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span>, x &lt; a -&gt; x &lt; b) -&gt; a &lt;= b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>267</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; ab; <span class="nb">apply</span>/ler_addgt0Pr =&gt; e e_gt0; <span class="nb">rewrite</span> -ler_subl_addr ltW//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><q>26a</q><br><span><var>ab</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span>, x &lt; a -&gt; x &lt; b</span></span></span><br><q>251</q><br><q>252</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a - e &lt; b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ab // ltr_subl_addr -ltr_subl_addl subrr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gt_ge</span> <span class="nv">a</span> <span class="nv">b</span> : (<span class="kr">forall</span> <span class="nv">x</span>, b &lt; x -&gt; a &lt; x) -&gt; a &lt;= b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>269</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span>, b &lt; x -&gt; a &lt; x) -&gt; a &lt;= b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>274</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; ab; <span class="nb">apply</span>/ler_addgt0Pr =&gt; e e_gt0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><q>26a</q><br><span><var>ab</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span>, b &lt; x -&gt; a &lt; x</span></span></span><br><q>251</q><br><q>252</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt;= b + e</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltW// ab// -ltr_subl_addl subrr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">lt_le_gt_ge</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">itvxx</span> <span class="nv">d</span> (<span class="nv">T</span> : porderType d) (<span class="nv">x</span> : T) : `[x, x] =i pred1 x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>f4</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`[x, x] =i pred1 x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>27f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; y; <span class="nb">rewrite</span> in_itv/= -eq_le eq_sym.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">itvxxP</span> <span class="nv">d</span> (<span class="nv">T</span> : porderType d) (<span class="nv">x</span> <span class="nv">y</span> : T) : reflect (y = x) (y \<span class="kr">in</span> `[x, x]).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>61</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect (y = x) (y \<span class="kr">in</span> `[x, x])</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>285</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> itvxx; <span class="nb">apply</span>/eqP.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">subset_itv_oo_cc</span> <span class="nv">d</span> (<span class="nv">T</span> : porderType d) (<span class="nv">a</span> <span class="nv">b</span> : T) : {subset `]a, b[ &lt;= `[a, b]}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{subset `]a, b[ &lt;= `[a, b]}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>28b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: subitvP; <span class="nb">rewrite</span> subitvE !bound_lexx.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(**********************************)</span>
<span class="c">(* End of MathComp 1.15 additions *)</span>
<span class="sd">(**********************************)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Reserved Notation</span> <span class="s2">&quot;`1- r&quot;</span> (<span class="kn">format</span> <span class="s2">&quot;`1- r&quot;</span>, <span class="kn">at level</span> <span class="mi">2</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Reserved Notation</span> <span class="s2">&quot;f \^-1&quot;</span> (<span class="kn">at level</span> <span class="mi">3</span>, <span class="kn">format</span> <span class="s2">&quot;f \^-1&quot;</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">natr1</span> (<span class="nv">R</span> : ringType) (<span class="nv">n</span> : nat) : (n%:R + <span class="mi">1</span> = n.+<span class="mi">1</span>%:R :&gt; R)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>ringType</span></span></span><br><q>16b</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n%:R + <span class="mi">1</span> = n.+<span class="mi">1</span>%:R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>292</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> GRing.mulrSr.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">nat1r</span> (<span class="nv">R</span> : ringType) (<span class="nv">n</span> : nat) : (<span class="mi">1</span> + n%:R = n.+<span class="mi">1</span>%:R :&gt; R)%R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>294</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> + n%:R = n.+<span class="mi">1</span>%:R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>299</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> GRing.mulrS.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* To be backported to finmap *)</span>

</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">fset_nat_maximum</span> (<span class="nv">X</span> : choiceType) (<span class="nv">A</span> : {fset X})
    (<span class="nv">f</span> : X -&gt; nat) : A != fset0 -&gt;
  (<span class="kr">exists</span> <span class="nv">i</span>, i \<span class="kr">in</span> A /\ <span class="kr">forall</span> <span class="nv">j</span>, j \<span class="kr">in</span> A -&gt; f j &lt;= f i)%nat.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span>choiceType</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>{fset X}</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A != fset0 -&gt;
<span class="kr">exists</span> <span class="nv">i</span> : X,
  i \<span class="kr">in</span> A /\ (<span class="kr">forall</span> <span class="nv">j</span> : X, j \<span class="kr">in</span> A -&gt; (f j &lt;= f i)%N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>29e</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; /fset0Pn[x Ax].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2a1</q><br><q>2a2</q><br><q>2a3</q><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>Ax</var><span class="hyp-type"><b>: </b><span>x \<span class="kr">in</span> A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">i</span> : X,
  i \<span class="kr">in</span> A /\ (<span class="kr">forall</span> <span class="nv">j</span> : X, j \<span class="kr">in</span> A -&gt; (f j &lt;= f i)%N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [/= y _ /(_ _ isT) mf] := @arg_maxnP _ [` Ax]%fset xpredT (f \o val) isT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2a1</q><br><q>2a2</q><br><q>2a3</q><br><q>2aa</q><br><q>2ab</q><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>mf</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f0</span> : A, (f (fsval f0) &lt;= f (fsval y))%N</span></span></span><br></div><span class="goal-separator"><hr></span><q>2ac</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kr">exists</span> (<span class="nv">val</span> <span class="nv">y</span>); <span class="nb">split</span>; <span class="kp">first</span> <span class="bp">exact</span>: valP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2b0</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">j</span> : X, j \<span class="kr">in</span> A -&gt; (f j &lt;= f (val y))%N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; z Az; <span class="nb">have</span> := mf [` Az]%fset.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">image_nat_maximum</span> <span class="nv">n</span> (<span class="nv">f</span> : nat -&gt; nat) :
  (<span class="kr">exists</span> <span class="nv">i</span>, i &lt;= n /\ <span class="kr">forall</span> <span class="nv">j</span>, j &lt;= n -&gt; f j &lt;= f i)%N.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>16b</q><br><span><var>f</var><span class="hyp-type"><b>: </b><span>nat -&gt; nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">i</span> : nat,
  (i &lt;= n)%N /\
  (<span class="kr">forall</span> <span class="nv">j</span> : nat, (j &lt;= n)%N -&gt; (f j &lt;= f i)%N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2b8</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [i _ /(_ _ isT) mf] := @arg_maxnP _ (@ord0 n) xpredT f isT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>16b</q><br><q>2bb</q><br><span><var>i</var><span class="hyp-type"><b>: </b><span>ordinal_finType n.+<span class="mi">1</span></span></span></span><br><span><var>mf</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">s</span> : ordinal_finType n.+<span class="mi">1</span>, geq (f i) (f s)</span></span></span><br></div><span class="goal-separator"><hr></span><q>2bc</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">i</span>; <span class="nb">split</span>; <span class="nb">rewrite</span> <span class="nl">?leq_ord</span>// =&gt; j jn; <span class="nb">have</span> := mf (@Ordinal n.+<span class="mi">1</span> j jn).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">card_fset_sum1</span> (<span class="nv">T</span> : choiceType) (<span class="nv">A</span> : {fset T}) :
  #|` A| = (\sum_(i &lt;- A) <span class="mi">1</span>)%N.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span>choiceType</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>{fset T}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">#|` A| = (\sum_(i &lt;- A) <span class="mi">1</span>)%N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2c5</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> big_seq_fsetE/= sum1_card cardfE.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> big_rmcond {R idx op I r} P.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> big_rmcond_in {R idx op I r} P.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(*******************************)</span>
<span class="c">(* MathComp &gt; 1.15.0 additions *)</span>
<span class="sd">(*******************************)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">bigminr_maxr</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Num.Def.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigminr_maxr</span> (<span class="nv">R</span> : realDomainType) <span class="nv">I</span> <span class="nv">r</span> (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; R) <span class="nv">x</span> :
  \big[minr/x]_(i &lt;- r | P i) F i = - \big[maxr/- x]_(i &lt;- r | P i) - F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>realDomainType</span></span></span><br><q>15c</q><br><q>15d</q><br><q>15e</q><br><q>15f</q><br><q>219</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[minr/x]_(i &lt;- r | P i) F i =
- (\big[maxr/(- x)]_(i &lt;- r | P i) - F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2cd</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">elim</span>/big_rec2: _ =&gt; [|i y _ _ -&gt;]; <span class="nb">rewrite</span> <span class="nl">?oppr_max</span> opprK.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">bigminr_maxr</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">SemiGroupProperties</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variables</span> (<span class="nv">R</span> : <span class="kt">Type</span>) (<span class="nv">op</span> : R -&gt; R -&gt; R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Hypothesis</span> <span class="nv">opA</span> : associative op.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* Convert an AC op : R -&gt; R -&gt; R to a com_law on option R *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">AC_subdef</span> <span class="nv">of</span> <span class="nv">associative</span> <span class="nv">op</span> &amp; commutative op :=
  <span class="kr">fun</span> <span class="nv">x</span> =&gt; oapp (<span class="kr">fun</span> <span class="nv">y</span> =&gt; Some (oapp (op^~ y) y x)) x.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">oAC</span> := nosimpl AC_subdef.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Hypothesis</span> <span class="nv">opC</span> : commutative op.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">opCA</span> : left_commutative op.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>R -&gt; R -&gt; R</span></span></span><br><span><var>opA</var><span class="hyp-type"><b>: </b><span>associative op</span></span></span><br><span><var>opC</var><span class="hyp-type"><b>: </b><span>commutative op</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">left_commutative op</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2d4</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; x *; <span class="nb">rewrite</span> !opA (opC x).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">opAC</span> : right_commutative op.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><span><var>opCA</var><span class="hyp-type"><b>: </b><span>left_commutative op</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">right_commutative op</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2de</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; *; <span class="nb">rewrite</span> -!opA [X <span class="kr">in</span> op _ X]opC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Hypothesis</span> <span class="nv">opyy</span> : idempotent op.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="nf">oop</span> := (oAC opA opC).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">opACE</span> <span class="nv">x</span> <span class="nv">y</span> : oop (Some x) (Some y) = some (op x y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><span><var>opAC</var><span class="hyp-type"><b>: </b><span>right_commutative op</span></span></span><br><span><var>opyy</var><span class="hyp-type"><b>: </b><span>idempotent op</span></span></span><br><q>206</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">oop (Some x) (Some y) = Some (op x y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2e5</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oopA_subdef</span> : associative oop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">associative oop</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2ed</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; [x|] [y|] [z|]//; <span class="nb">rewrite</span> /oAC/= opA.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oopx1_subdef</span> : left_id None oop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2ef</q><span class="goal-separator"><hr></span><div class="goal-conclusion">left_id None oop</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2f3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oop1x_subdef</span> : right_id None oop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2ef</q><span class="goal-separator"><hr></span><div class="goal-conclusion">right_id None oop</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2f8</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> [].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">oopC_subdef</span> : commutative oop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2ef</q><span class="goal-separator"><hr></span><div class="goal-conclusion">commutative oop</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2fd</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; [x|] [y|]//; <span class="nb">rewrite</span> /oAC/= opC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">opAC_law</span> := Monoid.Law oopA_subdef oopx1_subdef oop1x_subdef.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Canonical</span> <span class="nf">opAC_com_law</span> := Monoid.ComLaw oopC_subdef.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> [x : R].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">some_big_AC</span> [I : <span class="kt">Type</span>] r P (F : I -&gt; R) :
  Some (\big[op/x]_(i &lt;- r | P i) F i) =
  oop (\big[oop/None]_(i &lt;- r | P i) Some (F i)) (Some x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>15c</q><br><q>15d</q><br><span><var>P</var><span class="hyp-type"><b>: </b><span>I -&gt; bool</span></span></span><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some (\big[op/x]_(i &lt;- r | P i) F i) =
oop (\big[oop/None]_(i &lt;- r | P i) Some (F i))
  (Some x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>302</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">elim</span>/big_rec2 : _ =&gt; //= i [y|] _ Pi [] -&gt; //=; <span class="nb">rewrite</span> opA.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">big_ACE</span> [I : <span class="kt">Type</span>] r P (F : I -&gt; R) :
  \big[op/x]_(i &lt;- r | P i) F i =
  odflt x (oop (\big[oop/None]_(i &lt;- r | P i) Some (F i)) (Some x)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>304</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[op/x]_(i &lt;- r | P i) F i =
odflt x
  (oop (\big[oop/None]_(i &lt;- r | P i) Some (F i))
     (Some x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>309</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: Some_inj; <span class="nb">rewrite</span> some_big_AC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">big_undup_AC</span> [I : eqType] r P (F : I -&gt; R) (opK : idempotent op) :
  \big[op/x]_(i &lt;- undup r | P i) F i = \big[op/x]_(i &lt;- r | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>1eb</q><br><q>15d</q><br><q>305</q><br><q>15f</q><br><span><var>opK</var><span class="hyp-type"><b>: </b><span>idempotent op</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[op/x]_(i &lt;- undup r | P i) F i =
\big[op/x]_(i &lt;- r | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>30e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !big_ACE !big_undup//; <span class="nb">case</span>=&gt; //= ?; <span class="nb">rewrite</span> /oAC/= opK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">perm_big_AC</span> [I : eqType] [r] s [P : pred I] [F : I -&gt; R] :
 perm_eq r s -&gt; \big[op/x]_(i &lt;- r | P i) F i = \big[op/x]_(i &lt;- s | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>1eb</q><br><q>1ec</q><br><q>15e</q><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">perm_eq r s -&gt;
\big[op/x]_(i &lt;- r | P i) F i =
\big[op/x]_(i &lt;- s | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>315</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !big_ACE =&gt; /(@perm_big _ _)-&gt;.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Id</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Hypothesis</span> <span class="nv">opxx</span> : op x x = x.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">big_const_idem</span> <span class="nv">I</span> (<span class="nv">r</span> : seq I) <span class="nv">P</span> : \big[op/x]_(i &lt;- r | P i) x = x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><span><var>opxx</var><span class="hyp-type"><b>: </b><span>op x x = x</span></span></span><br><q>15c</q><br><q>15d</q><br><q>305</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[op/x]_(i &lt;- r | P i) x = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>31b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">elim</span>/big_ind : _ =&gt; // _ _ -&gt; -&gt;.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">big_id_idem</span> <span class="nv">I</span> (<span class="nv">r</span> : seq I) <span class="nv">P</span> <span class="nv">F</span> :
  op (\big[op/x]_(i &lt;- r | P i) F i) x = \big[op/x]_(i &lt;- r | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>31e</q><br><q>15c</q><br><q>15d</q><br><q>305</q><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">op (\big[op/x]_(i &lt;- r | P i) F i) x =
\big[op/x]_(i &lt;- r | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>322</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">elim</span>/big_rec : _ =&gt; // ? ? ?; <span class="nb">rewrite</span> -opA =&gt; -&gt;.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">big_mkcond_idem</span> <span class="nv">I</span> <span class="nv">r</span> (<span class="nv">P</span> : pred I) <span class="nv">F</span> :
  \big[op/x]_(i &lt;- r | P i) F i = \big[op/x]_(i &lt;- r) (<span class="kr">if</span> P i <span class="kr">then</span> F i <span class="kr">else</span> x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>31e</q><br><q>15c</q><br><q>15d</q><br><q>15e</q><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[op/x]_(i &lt;- r | P i) F i =
\big[op/x]_(i &lt;- r) (<span class="kr">if</span> P i <span class="kr">then</span> F i <span class="kr">else</span> x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>328</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">elim</span>: r =&gt; [|i r]; <span class="nb">rewrite</span> ?(big_nil, big_cons)//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>31e</q><br><q>15c</q><br><q>15e</q><br><q>15f</q><br><q>1e4</q><br><q>15d</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[op/x]_(i &lt;- r | P i) F i =
\big[op/x]_(i &lt;- r) (<span class="kr">if</span> P i <span class="kr">then</span> F i <span class="kr">else</span> x) -&gt;
(<span class="kr">if</span> P i
 <span class="kr">then</span> op (F i) (\big[op/x]_(j &lt;- r | P j) F j)
 <span class="kr">else</span> \big[op/x]_(j &lt;- r | P j) F j) =
op (<span class="kr">if</span> P i <span class="kr">then</span> F i <span class="kr">else</span> x)
  (\big[op/x]_(j &lt;- r) (<span class="kr">if</span> P j <span class="kr">then</span> F j <span class="kr">else</span> x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: ifPn =&gt; Pi -&gt;//; <span class="nb">rewrite</span> -[<span class="kr">in</span> LHS]big_id_idem.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">big_split_idem</span> <span class="nv">I</span> <span class="nv">r</span> (<span class="nv">P</span> : pred I) <span class="nv">F1</span> <span class="nv">F2</span> :
  \big[op/x]_(i &lt;- r | P i) op (F1 i) (F2 i) =
    op (\big[op/x]_(i &lt;- r | P i) F1 i) (\big[op/x]_(i &lt;- r | P i) F2 i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>31e</q><br><q>15c</q><br><q>15d</q><br><q>15e</q><br><span><var>F1, F2</var><span class="hyp-type"><b>: </b><span>I -&gt; R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[op/x]_(i &lt;- r | P i) op (F1 i) (F2 i) =
op (\big[op/x]_(i &lt;- r | P i) F1 i)
  (\big[op/x]_(i &lt;- r | P i) F2 i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>333</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">elim</span>/big_rec3 : _ =&gt; [//|i ? ? _ _ -&gt;]; <span class="nb">rewrite</span> // opCA -!opA opCA.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">big_id_idem_AC</span> <span class="nv">I</span> (<span class="nv">r</span> : seq I) <span class="nv">P</span> <span class="nv">F</span> :
  \big[op/x]_(i &lt;- r | P i) op (F i) x = \big[op/x]_(i &lt;- r | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>324</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[op/x]_(i &lt;- r | P i) op (F i) x =
\big[op/x]_(i &lt;- r | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>33a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> big_split_idem big_const_idem <span class="nl">?big_id_idem</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigID_idem</span> <span class="nv">I</span> <span class="nv">r</span> (<span class="nv">a</span> <span class="nv">P</span> : pred I) <span class="nv">F</span> :
  \big[op/x]_(i &lt;- r | P i) F i =
    op (\big[op/x]_(i &lt;- r | P i &amp;&amp; a i) F i)
       (\big[op/x]_(i &lt;- r | P i &amp;&amp; ~~ a i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>31e</q><br><q>15c</q><br><q>15d</q><br><span><var>a, P</var><span class="hyp-type"><b>: </b><span>pred I</span></span></span><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[op/x]_(i &lt;- r | P i) F i =
op (\big[op/x]_(i &lt;- r | P i &amp;&amp; a i) F i)
  (\big[op/x]_(i &lt;- r | P i &amp;&amp; ~~ a i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>33f</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -big_id_idem_AC big_mkcond_idem !(big_mkcond_idem _ _ F) -big_split_idem.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>341</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[op/x]_(i &lt;- r) (<span class="kr">if</span> P i <span class="kr">then</span> op (F i) x <span class="kr">else</span> x) =
\big[op/x]_(i &lt;- r)
   op (<span class="kr">if</span> P i &amp;&amp; a i <span class="kr">then</span> F i <span class="kr">else</span> x)
     (<span class="kr">if</span> P i &amp;&amp; ~~ a i <span class="kr">then</span> F i <span class="kr">else</span> x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: eq_bigr =&gt; i; <span class="nb">case</span>: ifPn =&gt; //=; <span class="nb">case</span>: ifPn.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Id</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">big_rem_AC</span> (<span class="nv">I</span> : eqType) (<span class="nv">r</span> : seq I) <span class="nv">z</span> (<span class="nv">P</span> : pred I) <span class="nv">F</span> : z \<span class="kr">in</span> r -&gt;
  \big[op/x]_(y &lt;- r | P y) F y =
    <span class="kr">if</span> P z <span class="kr">then</span> op (F z) (\big[op/x]_(y &lt;- rem z r | P y) F y)
           <span class="kr">else</span> \big[op/x]_(y &lt;- rem z r | P y) F y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>1eb</q><br><q>15d</q><br><span><var>z</var><span class="hyp-type"><b>: </b><span>I</span></span></span><br><q>15e</q><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">z \<span class="kr">in</span> r -&gt;
\big[op/x]_(y &lt;- r | P y) F y =
(<span class="kr">if</span> P z
 <span class="kr">then</span> op (F z) (\big[op/x]_(y &lt;- rem z r | P y) F y)
 <span class="kr">else</span> \big[op/x]_(y &lt;- rem z r | P y) F y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>34a</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /[!big_ACE] /(big_rem _)-&gt;//; <span class="nb">case</span>: ifP; <span class="nb">case</span>: (bigop _ _ _) =&gt; /=.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigD1_AC</span> (<span class="nv">I</span> : finType) <span class="nv">j</span> (<span class="nv">P</span> : pred I) <span class="nv">F</span> : P j -&gt;
  \big[op/x]_(i | P i) F i = op (F j) (\big[op/x]_(i | P i &amp;&amp; (i != j)) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><span><var>I</var><span class="hyp-type"><b>: </b><span>finType</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>I</span></span></span><br><q>15e</q><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P j -&gt;
\big[op/x]_(i | P i) F i =
op (F j) (\big[op/x]_(i | P i &amp;&amp; (i != j)) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>351</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /[!big_ACE] /(bigD1 _)-&gt;; <span class="nb">case</span>: (bigop _ _) =&gt; /=.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">le</span> : rel R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Hypothesis</span> <span class="nv">le_refl</span> : reflexive le.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Hypothesis</span> <span class="nv">op_incr</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, le x (op x y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub_big</span> <span class="nv">I</span> [s] (P P&#39; : {pred I}) (F : I -&gt; R) : (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; P&#39; i) -&gt;
  le (\big[op/x]_(i &lt;- s | P i) F i) (\big[op/x]_(i &lt;- s | P&#39; i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><span><var>le</var><span class="hyp-type"><b>: </b><span>rel R</span></span></span><br><span><var>le_refl</var><span class="hyp-type"><b>: </b><span>reflexive le</span></span></span><br><span><var>op_incr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : R, le x (op x y)</span></span></span><br><q>15c</q><br><span><var>s</var><span class="hyp-type"><b>: </b><span>seq I</span></span></span><br><span><var>P, P'</var><span class="hyp-type"><b>: </b><span>{pred I}</span></span></span><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; P&#39; i) -&gt;
le (\big[op/x]_(i &lt;- s | P i) F i)
  (\big[op/x]_(i &lt;- s | P&#39; i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>359</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; PP&#39;; <span class="nb">rewrite</span> !big_ACE (bigID P P&#39;)/=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>15c</q><br><q>35f</q><br><q>360</q><br><q>15f</q><br><span><var>PP'</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; P&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">le
  (oapp (op^~ x) x
     (\big[oop/None]_(i &lt;- s | P i) Some (F i)))
  (oapp (op^~ x) x
     (oop
        (\big[oop/None]_(i &lt;- s | P&#39; i &amp;&amp; P i)
            Some (F i))
        (\big[oop/None]_(i &lt;- s | P&#39; i &amp;&amp; ~~ P i)
            Some (F i))))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">under</span> [<span class="kr">in</span> X <span class="kr">in</span> le _ X]eq_bigl <span class="kp">do</span> <span class="nb">rewrite</span> (andb_idl (PP&#39; _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>366</q><span class="goal-separator"><hr></span><div class="goal-conclusion">le
  (oapp (op^~ x) x
     (\big[oop/None]_(i &lt;- s | P i) Some (F i)))
  (oapp (op^~ x) x
     (oop (\big[oop/None]_(i &lt;- s | P i) Some (F i))
        (\big[oop/None]_(i &lt;- s | P&#39; i &amp;&amp; ~~ P i)
            Some (F i))))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: (bigop _ _ _) (bigop _ _ _) =&gt; [y|] [z|]//=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>15c</q><br><q>35f</q><br><q>360</q><br><q>15f</q><br><q>367</q><br><span><var>y, z</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">le (op z x) (op (op z y) x)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>15c</q><br><q>35f</q><br><q>360</q><br><q>15f</q><br><q>367</q><br><span><var>y</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">le x (op y x)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> opAC op_incr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>375</q><span class="goal-separator"><hr></span><q>377</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> opC op_incr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub_big_seq</span> (<span class="nv">I</span> : eqType) <span class="nv">s</span> <span class="nv">s&#39;</span> <span class="nv">P</span> (<span class="nv">F</span> : I -&gt; R) :
  (<span class="kr">forall</span> <span class="nv">i</span>, count_mem i s &lt;= count_mem i s&#39;)%N -&gt;
  le (\big[op/x]_(i &lt;- s | P i) F i) (\big[op/x]_(i &lt;- s&#39; | P i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>1eb</q><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>seq I</span></span></span><br><q>305</q><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, (count_mem i s &lt;= count_mem i s&#39;)%N) -&gt;
le (\big[op/x]_(i &lt;- s | P i) F i)
  (\big[op/x]_(i &lt;- s&#39; | P i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>37c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> !big_ACE =&gt; /count_subseqP[_ /subseqP[m sm -&gt;]]/(perm_big _)-&gt;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>1eb</q><br><q>37f</q><br><q>305</q><br><q>15f</q><br><span><var>m</var><span class="hyp-type"><b>: </b><span>seq bool</span></span></span><br><span><var>sm</var><span class="hyp-type"><b>: </b><span>size m = size s&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">le
  (odflt x
     (oop
        (\big[opAC_com_law/None]_(i &lt;- mask m s&#39; | 
         P i) Some (F i)) (Some x)))
  (odflt x
     (oop (\big[oop/None]_(i &lt;- s&#39; | P i) Some (F i))
        (Some x)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> big_mask big_tnth// -!big_ACE sub_big// =&gt; j /andP[].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub_big_seq_cond</span> (<span class="nv">I</span> : eqType) <span class="nv">s</span> <span class="nv">s&#39;</span> <span class="nv">P</span> <span class="nv">P&#39;</span> (<span class="nv">F</span> : I -&gt; R) :
    (<span class="kr">forall</span> <span class="nv">i</span>, count_mem i (filter P s) &lt;= count_mem i (filter P&#39; s&#39;))%N -&gt;
  le (\big[op/x]_(i &lt;- s | P i) F i) (\big[op/x]_(i &lt;- s&#39; | P&#39; i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>1eb</q><br><q>37f</q><br><span><var>P, P'</var><span class="hyp-type"><b>: </b><span>pred I</span></span></span><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I,
 (count_mem i [seq x &lt;- s | P x] &lt;=
  count_mem i [seq x &lt;- s&#39; | P&#39; x])%N) -&gt;
le (\big[op/x]_(i &lt;- s | P i) F i)
  (\big[op/x]_(i &lt;- s&#39; | P&#39; i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>38a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span>  <span class="nb">move</span>=&gt; /(sub_big_seq xpredT F); <span class="nb">rewrite</span> !big_filter.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">uniq_sub_big</span> (<span class="nv">I</span> : eqType) <span class="nv">s</span> <span class="nv">s&#39;</span> <span class="nv">P</span> (<span class="nv">F</span> : I -&gt; R) : uniq s -&gt; uniq s&#39; -&gt;
    {subset s &lt;= s&#39;} -&gt;
  le (\big[op/x]_(i &lt;- s | P i) F i) (\big[op/x]_(i &lt;- s&#39; | P i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>37e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">uniq s -&gt;
uniq s&#39; -&gt;
{subset s &lt;= s&#39;} -&gt;
le (\big[op/x]_(i &lt;- s | P i) F i)
  (\big[op/x]_(i &lt;- s&#39; | P i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>391</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; us us&#39; ss&#39;; <span class="nb">rewrite</span> sub_big_seq =&gt; // i; <span class="nb">rewrite</span> !count_uniq_mem//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>1eb</q><br><q>37f</q><br><q>305</q><br><q>15f</q><br><span><var>us</var><span class="hyp-type"><b>: </b><span>uniq s</span></span></span><br><span><var>us'</var><span class="hyp-type"><b>: </b><span>uniq s&#39;</span></span></span><br><span><var>ss'</var><span class="hyp-type"><b>: </b><span>{subset s &lt;= s&#39;}</span></span></span><br><q>1e4</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((i \<span class="kr">in</span> s) &lt;= (i \<span class="kr">in</span> s&#39;))%N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">have</span> /implyP := ss&#39; i; <span class="nb">case</span>: (_ \<span class="kr">in</span> s) (_ \<span class="kr">in</span> s&#39;) =&gt; [] [].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">uniq_sub_big_cond</span> (<span class="nv">I</span> : eqType) <span class="nv">s</span> <span class="nv">s&#39;</span> <span class="nv">P</span> <span class="nv">P&#39;</span> (<span class="nv">F</span> : I -&gt; R) :
    uniq (filter P s) -&gt; uniq (filter P&#39; s&#39;) -&gt;
    {subset [seq i &lt;- s | P i] &lt;= [seq i &lt;- s&#39; | P&#39; i]} -&gt;
  le (\big[op/x]_(i &lt;- s | P i) F i) (\big[op/x]_(i &lt;- s&#39; | P&#39; i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>38c</q><span class="goal-separator"><hr></span><div class="goal-conclusion">uniq [seq x &lt;- s | P x] -&gt;
uniq [seq x &lt;- s&#39; | P&#39; x] -&gt;
{subset [seq i &lt;- s | P i] &lt;= [seq i &lt;- s&#39; | P&#39; i]} -&gt;
le (\big[op/x]_(i &lt;- s | P i) F i)
  (\big[op/x]_(i &lt;- s&#39; | P&#39; i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>39e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; u u&#39; /(uniq_sub_big xpredT F u u&#39;); <span class="nb">rewrite</span> !big_filter.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub_big_idem</span> (<span class="nv">I</span> : eqType) <span class="nv">s</span> <span class="nv">s&#39;</span> <span class="nv">P</span> (<span class="nv">F</span> : I -&gt; R) :
    {subset s &lt;= s&#39;} -&gt;
  le (\big[op/x]_(i &lt;- s | P i) F i) (\big[op/x]_(i &lt;- s&#39; | P i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>1eb</q><br><span><var>s, s'</var><span class="hyp-type"><b>: </b><span>seq_predType I</span></span></span><br><q>305</q><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{subset s &lt;= s&#39;} -&gt;
le (\big[op/x]_(i &lt;- s | P i) F i)
  (\big[op/x]_(i &lt;- s&#39; | P i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>3a3</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; ss&#39;; <span class="nb">rewrite</span> -big_undup_AC// -[X <span class="kr">in</span> le _ X]big_undup_AC//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>1eb</q><br><q>3a6</q><br><q>305</q><br><q>15f</q><br><q>39b</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">le (\big[op/x]_(i &lt;- undup s | P i) F i)
  (\big[op/x]_(i &lt;- undup s&#39; | P i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> uniq_sub_big <span class="nl">?undup_uniq</span>// =&gt; i; <span class="nb">rewrite</span> !mem_undup; <span class="nb">apply</span>: ss&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub_big_idem_cond</span> (<span class="nv">I</span> : eqType) <span class="nv">s</span> <span class="nv">s&#39;</span> <span class="nv">P</span> <span class="nv">P&#39;</span> (<span class="nv">F</span> : I -&gt; R) :
    {subset [seq i &lt;- s | P i] &lt;= [seq i &lt;- s&#39; | P&#39; i]} -&gt;
  le (\big[op/x]_(i &lt;- s | P i) F i) (\big[op/x]_(i &lt;- s&#39; | P&#39; i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>1eb</q><br><q>37f</q><br><span><var>P, P'</var><span class="hyp-type"><b>: </b><span>I -&gt; bool</span></span></span><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{subset [seq i &lt;- s | P i] &lt;= [seq i &lt;- s&#39; | P&#39; i]} -&gt;
le (\big[op/x]_(i &lt;- s | P i) F i)
  (\big[op/x]_(i &lt;- s&#39; | P&#39; i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>3af</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span>  <span class="nb">move</span>=&gt; /(sub_big_idem xpredT F); <span class="nb">rewrite</span> !big_filter.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub_in_big</span> [I : eqType] (s : seq I) (P P&#39; : {pred I}) (F : I -&gt; R) :
    {<span class="kr">in</span> s, <span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; P&#39; i} -&gt;
  le (\big[op/x]_(i &lt;- s | P i) F i) (\big[op/x]_(i &lt;- s | P&#39; i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>1eb</q><br><q>35f</q><br><q>360</q><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> s, <span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; P&#39; i} -&gt;
le (\big[op/x]_(i &lt;- s | P i) F i)
  (\big[op/x]_(i &lt;- s | P&#39; i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>3b6</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; PP&#39;; <span class="nb">apply</span>: sub_big_seq_cond =&gt; i; <span class="nb">rewrite</span> leq_count_subseq//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>1eb</q><br><q>35f</q><br><q>360</q><br><q>15f</q><br><span><var>PP'</var><span class="hyp-type"><b>: </b><span>{<span class="kr">in</span> s, <span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; P&#39; i}</span></span></span><br><q>1e4</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subseq [seq x &lt;- s | P x] [seq x &lt;- s | P&#39; x]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> subseq_filter filter_subseq andbT; <span class="nb">apply</span>/allP =&gt; j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>1eb</q><br><q>35f</q><br><q>360</q><br><q>15f</q><br><q>3bf</q><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>I</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j \<span class="kr">in</span> [seq x &lt;- s | P x] -&gt; P&#39; j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !mem_filter =&gt; /andP[/PP&#39;/[<span class="nb">apply</span>]-&gt;].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_big_ord</span> <span class="nv">n</span> <span class="nv">m</span> [P : {pred nat}] [F : nat -&gt; R] : (n &lt;= m)%N -&gt;
  le (\big[op/x]_(i &lt; n | P i) F i) (\big[op/x]_(i &lt; m | P i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>{pred nat}</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>nat -&gt; R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(n &lt;= m)%N -&gt;
le (\big[op/x]_(i &lt; n | P i) F i)
  (\big[op/x]_(i &lt; m | P i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>3c8</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; nm; <span class="nb">rewrite</span> (big_ord_widen_cond m)// sub_big =&gt; //= ? /andP[].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">subset_big</span> [I : finType] [A A&#39; P : {pred I}] (F : I -&gt; R) :
    A \subset A&#39; -&gt;
  le (\big[op/x]_(i <span class="kr">in</span> A | P i) F i) (\big[op/x]_(i <span class="kr">in</span> A&#39; | P i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>354</q><br><span><var>A, A', P</var><span class="hyp-type"><b>: </b><span>{pred I}</span></span></span><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A \subset A&#39; -&gt;
le (\big[op/x]_(i <span class="kr">in</span> A | P i) F i)
  (\big[op/x]_(i <span class="kr">in</span> A&#39; | P i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>3d1</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; AA&#39;; <span class="nb">apply</span>: sub_big =&gt; y /andP[yA yP]; <span class="nb">apply</span>/andP; <span class="nb">split</span> =&gt; //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>354</q><br><q>3d4</q><br><q>15f</q><br><span><var>AA'</var><span class="hyp-type"><b>: </b><span>A \subset A&#39;</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>I</span></span></span><br><span><var>yA</var><span class="hyp-type"><b>: </b><span>y \<span class="kr">in</span> A</span></span></span><br><span><var>yP</var><span class="hyp-type"><b>: </b><span>P y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">in</span> A&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: subsetP yA.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">subset_big_cond</span> (<span class="nv">I</span> : finType) (<span class="nv">A</span> <span class="nv">A&#39;</span> <span class="nv">P</span> <span class="nv">P&#39;</span> : {pred I}) (<span class="nv">F</span> : I -&gt; R) :
    [<span class="nb">set</span> i <span class="kr">in</span> A | P i]  \subset [<span class="nb">set</span> i <span class="kr">in</span> A&#39; | P&#39; i] -&gt;
  le (\big[op/x]_(i <span class="kr">in</span> A | P i) F i) (\big[op/x]_(i <span class="kr">in</span> A&#39; | P&#39; i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>354</q><br><span><var>A, A', P, P'</var><span class="hyp-type"><b>: </b><span>{pred I}</span></span></span><br><q>15f</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[<span class="nb">set</span> i <span class="kr">in</span> A | P i] \subset [<span class="nb">set</span> i <span class="kr">in</span> A&#39; | P&#39; i] -&gt;
le (\big[op/x]_(i <span class="kr">in</span> A | P i) F i)
  (\big[op/x]_(i <span class="kr">in</span> A&#39; | P&#39; i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>3e1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /subsetP AP; <span class="nb">apply</span>: sub_big =&gt; i; <span class="nb">have</span> /[!inE] := AP i.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_big_nat_cond</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">n&#39;</span> <span class="nv">m&#39;</span> (<span class="nv">P</span> <span class="nv">P&#39;</span> : {pred nat}) (<span class="nv">F</span> : nat -&gt; R) :
    (n&#39; &lt;= n)%N -&gt; (m &lt;= m&#39;)%N -&gt; (<span class="kr">forall</span> <span class="nv">i</span>, (n &lt;= i &lt; m)%N -&gt; P i -&gt; P&#39; i) -&gt;
  le (\big[op/x]_(n &lt;= i &lt; m | P i) F i) (\big[op/x]_(n&#39; &lt;= i &lt; m&#39; | P&#39; i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><span><var>n, m, n', m'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P, P'</var><span class="hyp-type"><b>: </b><span>{pred nat}</span></span></span><br><q>3cd</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(n&#39; &lt;= n)%N -&gt;
(m &lt;= m&#39;)%N -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : nat, (n &lt;= i &lt; m)%N -&gt; P i -&gt; P&#39; i) -&gt;
le (\big[op/x]_(n &lt;= i &lt; m | P i) F i)
  (\big[op/x]_(n&#39; &lt;= i &lt; m&#39; | P&#39; i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>3e8</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; len&#39;n lemm&#39; PP&#39;i; <span class="nb">rewrite</span> uniq_sub_big_cond <span class="nl">?filter_uniq</span> <span class="nl">?iota_uniq</span>//.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>3eb</q><br><q>3ec</q><br><q>3cd</q><br><span><var>len'n</var><span class="hyp-type"><b>: </b><span>(n&#39; &lt;= n)%N</span></span></span><br><span><var>lemm'</var><span class="hyp-type"><b>: </b><span>(m &lt;= m&#39;)%N</span></span></span><br><span><var>PP'i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : nat, (n &lt;= i &lt; m)%N -&gt; P i -&gt; P&#39; i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{subset [seq i &lt;- index_iota n m | P i]
     &lt;= [seq i &lt;- index_iota n&#39; m&#39; | P&#39; i]}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; i; <span class="nb">rewrite</span> !mem_filter !mem_index_iota =&gt; /and3P[Pi ni im].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>3eb</q><br><q>3ec</q><br><q>3cd</q><br><q>3f3</q><br><q>3f4</q><br><q>3f5</q><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat_eqType</span></span></span><br><span><var>Pi</var><span class="hyp-type"><b>: </b><span>P i</span></span></span><br><span><var>ni</var><span class="hyp-type"><b>: </b><span>(n &lt;= i)%N</span></span></span><br><span><var>im</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[&amp;&amp; P&#39; i, (n&#39; &lt;= i)%N &amp; (i &lt; m&#39;)%N]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> PP&#39;i <span class="nl">?ni</span>//= (leq_trans _ ni)// (leq_trans im).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_big_nat</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">n&#39;</span> <span class="nv">m&#39;</span> [P] [F : nat -&gt; R] : (n&#39; &lt;= n)%N -&gt; (m &lt;= m&#39;)%N -&gt;
  le (\big[op/x]_(n &lt;= i &lt; m | P i) F i) (\big[op/x]_(n&#39; &lt;= i &lt; m&#39; | P i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>3eb</q><br><span><var>P</var><span class="hyp-type"><b>: </b><span>nat -&gt; bool</span></span></span><br><q>3cd</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(n&#39; &lt;= n)%N -&gt;
(m &lt;= m&#39;)%N -&gt;
le (\big[op/x]_(n &lt;= i &lt; m | P i) F i)
  (\big[op/x]_(n&#39; &lt;= i &lt; m&#39; | P i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>401</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; len&#39;n lemm&#39;; <span class="nb">rewrite</span> le_big_nat_cond.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_big_ord_cond</span> <span class="nv">n</span> <span class="nv">m</span> (<span class="nv">P</span> <span class="nv">P&#39;</span> : {pred nat}) (<span class="nv">F</span> : nat -&gt; R) :
    (n &lt;= m)%N -&gt; (<span class="kr">forall</span> <span class="nv">i</span> : &#39;I_n, P i -&gt; P&#39; i) -&gt;
  le (\big[op/x]_(i &lt; n | P i) F i) (\big[op/x]_(i &lt; m | P&#39; i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>3cb</q><br><q>3ec</q><br><q>3cd</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(n &lt;= m)%N -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : &#39;I_n, P i -&gt; P&#39; i) -&gt;
le (\big[op/x]_(i &lt; n | P i) F i)
  (\big[op/x]_(i &lt; m | P&#39; i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>408</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; nm PP&#39;; <span class="nb">rewrite</span> -!big_mkord le_big_nat_cond//= =&gt; i ni.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>2d7</q><br><q>2d8</q><br><q>2d9</q><br><q>2da</q><br><q>2e1</q><br><q>2e8</q><br><q>2e9</q><br><q>219</q><br><q>35c</q><br><q>35d</q><br><q>35e</q><br><q>3cb</q><br><q>3ec</q><br><q>3cd</q><br><span><var>nm</var><span class="hyp-type"><b>: </b><span>(n &lt;= m)%N</span></span></span><br><span><var>PP'</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : &#39;I_n, P i -&gt; P&#39; i</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>ni</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P i -&gt; P&#39; i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">have</span> := PP&#39; (Ordinal ni).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">SemiGroupProperties</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">bigmaxmin</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="nf">max</span> := Order.max.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="nf">min</span> := Order.min.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> order_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variables</span> (<span class="nv">d</span> : _) (<span class="nv">T</span> : porderType d).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variables</span> (<span class="nv">I</span> : <span class="kt">Type</span>) (<span class="nv">r</span> : seq I) (<span class="nv">f</span> : I -&gt; T) (<span class="nv">x0</span> <span class="nv">x</span> : T) (<span class="nv">P</span> : pred I).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmax_le</span> :
  x0 &lt;= x -&gt; (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; f i &lt;= x) -&gt; \big[max/x0]_(i &lt;- r | P i) f i &lt;= x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>60</q><br><q>15c</q><br><q>15d</q><br><span><var>f</var><span class="hyp-type"><b>: </b><span>I -&gt; T</span></span></span><br><span><var>x0, x</var><span class="hyp-type"><b>: </b><span>T</span></span></span><br><q>15e</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x0 &lt;= x -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; f i &lt;= x) -&gt;
\big[max/x0]_(i &lt;- r | P i) f i &lt;= x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>417</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ? ?; <span class="nb">elim</span>/big_ind: _ =&gt; // *; <span class="nb">rewrite</span> maxEle; <span class="nb">case</span>: ifPn.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmax_lt</span> :
  x0 &lt; x -&gt; (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; f i &lt; x) -&gt; \big[max/x0]_(i &lt;- r | P i) f i &lt; x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>419</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x0 &lt; x -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; f i &lt; x) -&gt;
\big[max/x0]_(i &lt;- r | P i) f i &lt; x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>41f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ? ?; <span class="nb">elim</span>/big_ind: _ =&gt; // *; <span class="nb">rewrite</span> maxElt; <span class="nb">case</span>: ifPn.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lt_bigmin</span> :
  x &lt; x0 -&gt; (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; x &lt; f i) -&gt; x &lt; \big[min/x0]_(i &lt;- r | P i) f i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>419</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt; x0 -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; x &lt; f i) -&gt;
x &lt; \big[min/x0]_(i &lt;- r | P i) f i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>424</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ? ?; <span class="nb">elim</span>/big_ind: _ =&gt; // *; <span class="nb">rewrite</span> minElt; <span class="nb">case</span>: ifPn.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_bigmin</span> :
  x &lt;= x0 -&gt; (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; x &lt;= f i) -&gt; x &lt;= \big[min/x0]_(i &lt;- r | P i) f i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>419</q><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= x0 -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; x &lt;= f i) -&gt;
x &lt;= \big[min/x0]_(i &lt;- r | P i) f i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>429</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ? ?; <span class="nb">elim</span>/big_ind: _ =&gt; // *; <span class="nb">rewrite</span> minEle; <span class="nb">case</span>: ifPn.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">bigmaxmin</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">bigmax</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="nf">max</span> := Order.max.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> order_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variables</span> (<span class="nv">d</span> : unit) (<span class="nv">T</span> : orderType d).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">bigmax_Type</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variables</span> (<span class="nv">I</span> : <span class="kt">Type</span>) (<span class="nv">r</span> : seq I) (<span class="nv">x</span> : T).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> (<span class="nv">P</span> <span class="nv">a</span> : pred I) (<span class="nv">F</span> : I -&gt; T).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmax_mkcond</span> <span class="nv">P</span> <span class="nv">F</span> : \big[max/x]_(i &lt;- r | P i) F i =
  \big[max/x]_(i &lt;- r) (<span class="kr">if</span> P i <span class="kr">then</span> F i <span class="kr">else</span> x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>15c</q><br><q>15d</q><br><q>f4</q><br><q>15e</q><br><span><var>F</var><span class="hyp-type"><b>: </b><span>I -&gt; T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[max/x]_(i &lt;- r | P i) F i =
\big[max/x]_(i &lt;- r) (<span class="kr">if</span> P i <span class="kr">then</span> F i <span class="kr">else</span> x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>42e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> big_mkcond_idem <span class="nl">?maxxx</span>//; [<span class="bp">exact</span>: maxA|<span class="bp">exact</span>: maxC].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmax_split</span> <span class="nv">P</span> <span class="nv">F1</span> <span class="nv">F2</span> :
  \big[max/x]_(i &lt;- r | P i) (max (F1 i) (F2 i)) =
  max (\big[max/x]_(i &lt;- r | P i) F1 i) (\big[max/x]_(i &lt;- r | P i) F2 i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>15c</q><br><q>15d</q><br><q>f4</q><br><q>15e</q><br><span><var>F1, F2</var><span class="hyp-type"><b>: </b><span>I -&gt; T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[max/x]_(i &lt;- r | P i) max (F1 i) (F2 i) =
max (\big[max/x]_(i &lt;- r | P i) F1 i)
  (\big[max/x]_(i &lt;- r | P i) F2 i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>435</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> big_split_idem <span class="nl">?maxxx</span>//; [<span class="bp">exact</span>: maxA|<span class="bp">exact</span>: maxC].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmax_idl</span> <span class="nv">P</span> <span class="nv">F</span> :
  \big[max/x]_(i &lt;- r | P i) F i = max x (\big[max/x]_(i &lt;- r | P i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>430</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[max/x]_(i &lt;- r | P i) F i =
max x (\big[max/x]_(i &lt;- r | P i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>43c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> maxC big_id_idem <span class="nl">?maxxx</span>//; <span class="bp">exact</span>: maxA.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmax_idr</span> <span class="nv">P</span> <span class="nv">F</span> :
  \big[max/x]_(i &lt;- r | P i) F i = max (\big[max/x]_(i &lt;- r | P i) F i) x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>430</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[max/x]_(i &lt;- r | P i) F i =
max (\big[max/x]_(i &lt;- r | P i) F i) x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>441</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> [LHS]bigmax_idl maxC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmaxID</span> <span class="nv">a</span> <span class="nv">P</span> <span class="nv">F</span> : \big[max/x]_(i &lt;- r | P i) F i =
  max (\big[max/x]_(i &lt;- r | P i &amp;&amp; a i) F i)
      (\big[max/x]_(i &lt;- r | P i &amp;&amp; ~~ a i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>15c</q><br><q>15d</q><br><q>f4</q><br><q>342</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[max/x]_(i &lt;- r | P i) F i =
max (\big[max/x]_(i &lt;- r | P i &amp;&amp; a i) F i)
  (\big[max/x]_(i &lt;- r | P i &amp;&amp; ~~ a i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>446</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (bigID_idem maxA maxC _ _ a) <span class="nl">?maxxx</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">bigmax_Type</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">le_maxr_id</span> (<span class="nv">x</span> <span class="nv">y</span> : T) : x &lt;= max x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>61</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x &lt;= max x y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>44c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> le_maxr lexx.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub_bigmax</span> [x0] I s (P P&#39; : {pred I}) (F : I -&gt; T) :
     (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; P&#39; i) -&gt;
  \big[max/x0]_(i &lt;- s | P i) F i &lt;= \big[max/x0]_(i &lt;- s | P&#39; i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><span><var>le_maxr_id</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : T, x &lt;= max x y</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>T</span></span></span><br><q>15c</q><br><q>35f</q><br><q>360</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; P&#39; i) -&gt;
\big[max/x0]_(i &lt;- s | P i) F i &lt;=
\big[max/x0]_(i &lt;- s | P&#39; i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>452</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (sub_big maxA maxC).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub_bigmax_seq</span> [x0] (I : eqType) s s&#39; P (F : I -&gt; T) : {subset s &lt;= s&#39;} -&gt;
  \big[max/x0]_(i &lt;- s | P i) F i &lt;= \big[max/x0]_(i &lt;- s&#39; | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>456</q><br><q>1eb</q><br><q>3a6</q><br><q>305</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{subset s &lt;= s&#39;} -&gt;
\big[max/x0]_(i &lt;- s | P i) F i &lt;=
\big[max/x0]_(i &lt;- s&#39; | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>45a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (sub_big_idem maxA maxC maxxx).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub_bigmax_cond</span> [x0] (I : eqType) s s&#39; P P&#39; (F : I -&gt; T) :
    {subset [seq i &lt;- s | P i] &lt;= [seq i &lt;- s&#39; | P&#39; i]} -&gt;
  \big[max/x0]_(i &lt;- s | P i) F i &lt;= \big[max/x0]_(i &lt;- s&#39; | P&#39; i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>456</q><br><q>1eb</q><br><q>37f</q><br><q>3b2</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{subset [seq i &lt;- s | P i] &lt;= [seq i &lt;- s&#39; | P&#39; i]} -&gt;
\big[max/x0]_(i &lt;- s | P i) F i &lt;=
\big[max/x0]_(i &lt;- s&#39; | P&#39; i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>460</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (sub_big_idem_cond maxA maxC maxxx).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub_in_bigmax</span> [x0] [I : eqType] (s : seq I) (P P&#39; : {pred I}) (F : I -&gt; T) :
    {<span class="kr">in</span> s, <span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; P&#39; i} -&gt;
  \big[max/x0]_(i &lt;- s | P i) F i &lt;= \big[max/x0]_(i &lt;- s | P&#39; i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>456</q><br><q>1eb</q><br><q>35f</q><br><q>360</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> s, <span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; P&#39; i} -&gt;
\big[max/x0]_(i &lt;- s | P i) F i &lt;=
\big[max/x0]_(i &lt;- s | P&#39; i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>466</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (sub_in_big maxA maxC).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_bigmax_nat</span> [x0] n m n&#39; m&#39; P (F : nat -&gt; T) : n&#39; &lt;= n -&gt; m &lt;= m&#39; -&gt;
  \big[max/x0]_(n &lt;= i &lt; m | P i) F i &lt;= \big[max/x0]_(n&#39; &lt;= i &lt; m&#39; | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>456</q><br><span><var>n, m, n', m'</var><span class="hyp-type"><b>: </b><span>Order.NatOrder.porderType</span></span></span><br><q>404</q><br><span><var>F</var><span class="hyp-type"><b>: </b><span>nat -&gt; T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n&#39; &lt;= n -&gt;
m &lt;= m&#39; -&gt;
\big[max/x0]_(n &lt;= i &lt; m | P i) F i &lt;=
\big[max/x0]_(n&#39; &lt;= i &lt; m&#39; | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>46c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (le_big_nat maxA maxC).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_bigmax_nat_cond</span> [x0] n m n&#39; m&#39; (P P&#39; : {pred nat}) (F : nat -&gt; T) :
    (n&#39; &lt;= n)%N -&gt; (m &lt;= m&#39;)%N -&gt; (<span class="kr">forall</span> <span class="nv">i</span>, n &lt;= i &lt; m -&gt; P i -&gt; P&#39; i) -&gt;
  \big[max/x0]_(n &lt;= i &lt; m | P i) F i &lt;= \big[max/x0]_(n&#39; &lt;= i &lt; m&#39; | P&#39; i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>456</q><br><q>3eb</q><br><q>3ec</q><br><q>470</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(n&#39; &lt;= n)%N -&gt;
(m &lt;= m&#39;)%N -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Order.NatOrder.porderType,
 n &lt;= i &lt; m -&gt; P i -&gt; P&#39; i) -&gt;
\big[max/x0]_(n &lt;= i &lt; m | P i) F i &lt;=
\big[max/x0]_(n&#39; &lt;= i &lt; m&#39; | P&#39; i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>474</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (le_big_nat_cond maxA maxC).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_bigmax_ord</span> [x0] n m (P : {pred nat}) (F : nat -&gt; T) : (n &lt;= m)%N -&gt;
  \big[max/x0]_(i &lt; n | P i) F i &lt;= \big[max/x0]_(i &lt; m | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>456</q><br><q>3cb</q><br><q>3cc</q><br><q>470</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(n &lt;= m)%N -&gt;
\big[max/x0]_(i &lt; n | P i) F i &lt;=
\big[max/x0]_(i &lt; m | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>47a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (le_big_ord maxA maxC).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_bigmax_ord_cond</span> [x0] n m (P P&#39; : {pred nat}) (F : nat -&gt; T) :
    (n &lt;= m)%N -&gt; (<span class="kr">forall</span> <span class="nv">i</span> : &#39;I_n, P i -&gt; P&#39; i) -&gt;
  \big[max/x0]_(i &lt; n | P i) F i &lt;= \big[max/x0]_(i &lt; m | P&#39; i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>456</q><br><q>3cb</q><br><q>3ec</q><br><q>470</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(n &lt;= m)%N -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : &#39;I_n, P i -&gt; P&#39; i) -&gt;
\big[max/x0]_(i &lt; n | P i) F i &lt;=
\big[max/x0]_(i &lt; m | P&#39; i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>480</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (le_big_ord_cond maxA maxC).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">subset_bigmax</span> [x0] [I : finType] (A A&#39; P : {pred I}) (F : I -&gt; T) :
    A \subset A&#39; -&gt;
  \big[max/x0]_(i <span class="kr">in</span> A | P i) F i &lt;= \big[max/x0]_(i <span class="kr">in</span> A&#39; | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>456</q><br><q>354</q><br><q>3d4</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A \subset A&#39; -&gt;
\big[max/x0]_(i <span class="kr">in</span> A | P i) F i &lt;=
\big[max/x0]_(i <span class="kr">in</span> A&#39; | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>486</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (subset_big maxA maxC).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">subset_bigmax_cond</span> [x0] (I : finType) (A A&#39; P P&#39; : {pred I}) (F : I -&gt; T) :
    [<span class="nb">set</span> i <span class="kr">in</span> A | P i]  \subset [<span class="nb">set</span> i <span class="kr">in</span> A&#39; | P&#39; i] -&gt;
  \big[max/x0]_(i <span class="kr">in</span> A | P i) F i &lt;= \big[max/x0]_(i <span class="kr">in</span> A&#39; | P&#39; i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>456</q><br><q>354</q><br><q>3e4</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[<span class="nb">set</span> i <span class="kr">in</span> A | P i] \subset [<span class="nb">set</span> i <span class="kr">in</span> A&#39; | P&#39; i] -&gt;
\big[max/x0]_(i <span class="kr">in</span> A | P i) F i &lt;=
\big[max/x0]_(i <span class="kr">in</span> A&#39; | P&#39; i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>48c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (subset_big_cond maxA maxC).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">bigmax_finType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variables</span> (<span class="nv">I</span> : finType) (<span class="nv">x</span> : T).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; T).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmaxD1</span> <span class="nv">j</span> <span class="nv">P</span> <span class="nv">F</span> : P j -&gt;
  \big[max/x]_(i | P i) F i = max (F j) (\big[max/x]_(i | P i &amp;&amp; (i != j)) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>354</q><br><q>f4</q><br><q>355</q><br><q>15e</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P j -&gt;
\big[max/x]_(i | P i) F i =
max (F j) (\big[max/x]_(i | P i &amp;&amp; (i != j)) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>492</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>/(bigD1_AC maxA maxC) -&gt;.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_bigmax_cond</span> <span class="nv">j</span> <span class="nv">P</span> <span class="nv">F</span> : P j -&gt; F j &lt;= \big[max/x]_(i | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>494</q><span class="goal-separator"><hr></span><div class="goal-conclusion">P j -&gt; F j &lt;= \big[max/x]_(i | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>498</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; Pj; <span class="nb">rewrite</span> (bigmaxD1 _ Pj) le_maxr lexx.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_bigmax</span> <span class="nv">F</span> <span class="nv">j</span> : F j &lt;= \big[max/x]_i F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>354</q><br><q>f4</q><br><q>431</q><br><q>355</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F j &lt;= \big[max/x]_i F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>49d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: le_bigmax_cond.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* NB: as of [2022-08-02], bigop.bigmax_sup already exists for nat *)</span>
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmax_sup</span> <span class="nv">j</span> <span class="nv">P</span> <span class="nv">m</span> <span class="nv">F</span> : P j -&gt; m &lt;= F j -&gt; m &lt;= \big[max/x]_(i | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>354</q><br><q>f4</q><br><q>355</q><br><q>15e</q><br><span><var>m</var><span class="hyp-type"><b>: </b><span>T</span></span></span><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P j -&gt; m &lt;= F j -&gt; m &lt;= \big[max/x]_(i | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4a3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; Pj ?; <span class="nb">apply</span>: le_trans (le_bigmax_cond _ Pj).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmax_leP</span> <span class="nv">m</span> <span class="nv">P</span> <span class="nv">F</span> : reflect (x &lt;= m /\ <span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; F i &lt;= m)
                                 (\big[max/x]_(i | P i) F i &lt;= m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>354</q><br><span><var>x, m</var><span class="hyp-type"><b>: </b><span>T</span></span></span><br><q>15e</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect (x &lt;= m /\ (<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F i &lt;= m))
  (\big[max/x]_(i | P i) F i &lt;= m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4aa</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: (iffP idP) =&gt; [|[? ?]]; <span class="nb">last</span> <span class="bp">exact</span>: bigmax_le.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>4ac</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[max/x]_(i | P i) F i &lt;= m -&gt;
x &lt;= m /\ (<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F i &lt;= m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> bigmax_idl le_maxl =&gt; /andP[-&gt; leFm]; <span class="nb">split</span>=&gt; // i Pi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>354</q><br><q>4ad</q><br><q>15e</q><br><q>431</q><br><span><var>leFm</var><span class="hyp-type"><b>: </b><span>\big[max/x]_(i | P i) F i &lt;= m</span></span></span><br><q>1e4</q><br><q>3fc</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F i &lt;= m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: le_trans leFm; <span class="bp">exact</span>: le_bigmax_cond.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmax_ltP</span> <span class="nv">m</span> <span class="nv">P</span> <span class="nv">F</span> :
  reflect (x &lt; m /\ <span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; F i &lt; m) (\big[max/x]_(i | P i) F i &lt; m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>4ac</q><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect (x &lt; m /\ (<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F i &lt; m))
  (\big[max/x]_(i | P i) F i &lt; m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4bb</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: (iffP idP) =&gt; [|[? ?]]; <span class="nb">last</span> <span class="bp">exact</span>: bigmax_lt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>4ac</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[max/x]_(i | P i) F i &lt; m -&gt;
x &lt; m /\ (<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F i &lt; m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> bigmax_idl lt_maxl =&gt; /andP[-&gt; ltFm]; <span class="nb">split</span>=&gt; // i Pi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>354</q><br><q>4ad</q><br><q>15e</q><br><q>431</q><br><span><var>ltFm</var><span class="hyp-type"><b>: </b><span>\big[max/x]_(i | P i) F i &lt; m</span></span></span><br><q>1e4</q><br><q>3fc</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F i &lt; m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: le_lt_trans ltFm; <span class="bp">exact</span>: le_bigmax_cond.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmax_eq_arg</span> <span class="nv">j</span> <span class="nv">P</span> <span class="nv">F</span> : P j -&gt; (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; x &lt;= F i) -&gt;
  \big[max/x]_(i | P i) F i = F [arg max_(i &gt; j | P i) F i].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>494</q><span class="goal-separator"><hr></span><div class="goal-conclusion">P j -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; x &lt;= F i) -&gt;
\big[max/x]_(i | P i) F i =
F [arg max_(i &gt; j | P i) F i]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4ca</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; Pi0; <span class="nb">case</span>: arg_maxP =&gt; //= i Pi PF PxF.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>354</q><br><q>f4</q><br><q>355</q><br><q>15e</q><br><q>431</q><br><span><var>Pi0</var><span class="hyp-type"><b>: </b><span>P j</span></span></span><br><q>1e4</q><br><q>3fc</q><br><span><var>PF</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : I, P j -&gt; F j &lt;= F i</span></span></span><br><span><var>PxF</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; x &lt;= F i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[max/x]_(i | P i) F i = F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/eqP; <span class="nb">rewrite</span> eq_le le_bigmax_cond // andbT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>4d1</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[max/x]_(i | P i) F i &lt;= F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/bigmax_leP; <span class="nb">split</span> =&gt; //; <span class="bp">exact</span>: PxF.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eq_bigmax</span> <span class="nv">j</span> <span class="nv">P</span> <span class="nv">F</span> : P j -&gt; (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; x &lt;= F i) -&gt;
  {i0 | i0 \<span class="kr">in</span> I &amp; \big[max/x]_(i | P i) F i = F i0}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>494</q><span class="goal-separator"><hr></span><div class="goal-conclusion">P j -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; x &lt;= F i) -&gt;
{i0 : I | i0 \<span class="kr">in</span> I &amp; \big[max/x]_(i | P i) F i = F i0}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4db</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; Pi0 Hx; <span class="nb">rewrite</span> (bigmax_eq_arg Pi0) //; <span class="nb">eexists</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_bigmax2</span> <span class="nv">P</span> <span class="nv">F1</span> <span class="nv">F2</span> : (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; F1 i &lt;= F2 i) -&gt;
  \big[max/x]_(i | P i) F1 i &lt;= \big[max/x]_(i | P i) F2 i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>354</q><br><q>f4</q><br><q>15e</q><br><q>438</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F1 i &lt;= F2 i) -&gt;
\big[max/x]_(i | P i) F1 i &lt;=
\big[max/x]_(i | P i) F2 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4e0</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; FG; <span class="nb">elim</span>/big_ind2 : _ =&gt; // a b e f ba fe.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>354</q><br><q>f4</q><br><q>15e</q><br><q>438</q><br><span><var>FG</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F1 i &lt;= F2 i</span></span></span><br><span><var>a, b, e, f</var><span class="hyp-type"><b>: </b><span>T</span></span></span><br><span><var>ba</var><span class="hyp-type"><b>: </b><span>b &lt;= a</span></span></span><br><span><var>fe</var><span class="hyp-type"><b>: </b><span>f &lt;= e</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">max b f &lt;= max a e</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> le_maxr <span class="mi">2</span>!le_maxl ba fe /= andbT; <span class="nb">have</span> [//|/= af] := leP f a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>455</q><br><q>354</q><br><q>f4</q><br><q>15e</q><br><q>438</q><br><q>4e9</q><br><q>4ea</q><br><q>4eb</q><br><q>4ec</q><br><span><var>af</var><span class="hyp-type"><b>: </b><span>a &lt; f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b &lt;= e</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (le_trans ba) // (le_trans _ fe) // ltW.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">bigmax_finType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">bigmax</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> bigmax_mkcond {d T I r}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> bigmaxID {d T I r}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> bigmaxD1 {d T I x} j.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> bigmax_sup {d T I x} j.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> bigmax_eq_arg {d T I} x j.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> eq_bigmax {d T I x} j.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">bigmin</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="nf">min</span> := Order.min.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> order_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variables</span> (<span class="nv">d</span> : _) (<span class="nv">T</span> : orderType d).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">bigmin_Type</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> (<span class="nv">I</span> : <span class="kt">Type</span>) (<span class="nv">r</span> : seq I) (<span class="nv">x</span> : T).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> (<span class="nv">P</span> <span class="nv">a</span> : pred I) (<span class="nv">F</span> : I -&gt; T).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmin_mkcond</span> <span class="nv">P</span> <span class="nv">F</span> : \big[min/x]_(i &lt;- r | P i) F i =
   \big[min/x]_(i &lt;- r) (<span class="kr">if</span> P i <span class="kr">then</span> F i <span class="kr">else</span> x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>430</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[min/x]_(i &lt;- r | P i) F i =
\big[min/x]_(i &lt;- r) (<span class="kr">if</span> P i <span class="kr">then</span> F i <span class="kr">else</span> x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4f5</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> big_mkcond_idem <span class="nl">?minxx</span>//; [<span class="bp">exact</span>: minA|<span class="bp">exact</span>: minC].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmin_split</span> <span class="nv">P</span> <span class="nv">F1</span> <span class="nv">F2</span> :
  \big[min/x]_(i &lt;- r | P i) (min (F1 i) (F2 i)) =
  min (\big[min/x]_(i &lt;- r | P i) F1 i) (\big[min/x]_(i &lt;- r | P i) F2 i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>437</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[min/x]_(i &lt;- r | P i) min (F1 i) (F2 i) =
min (\big[min/x]_(i &lt;- r | P i) F1 i)
  (\big[min/x]_(i &lt;- r | P i) F2 i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4fa</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> big_split_idem <span class="nl">?minxx</span>//; [<span class="bp">exact</span>: minA|<span class="bp">exact</span>: minC].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmin_idl</span> <span class="nv">P</span> <span class="nv">F</span> :
  \big[min/x]_(i &lt;- r | P i) F i = min x (\big[min/x]_(i &lt;- r | P i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>430</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[min/x]_(i &lt;- r | P i) F i =
min x (\big[min/x]_(i &lt;- r | P i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>4ff</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> minC big_id_idem <span class="nl">?minxx</span>//; <span class="bp">exact</span>: minA.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmin_idr</span> <span class="nv">P</span> <span class="nv">F</span> :
  \big[min/x]_(i &lt;- r | P i) F i = min (\big[min/x]_(i &lt;- r | P i) F i) x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>430</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[min/x]_(i &lt;- r | P i) F i =
min (\big[min/x]_(i &lt;- r | P i) F i) x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>504</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> [LHS]bigmin_idl minC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigminID</span> <span class="nv">a</span> <span class="nv">P</span> <span class="nv">F</span> : \big[min/x]_(i &lt;- r | P i) F i =
  min (\big[min/x]_(i &lt;- r | P i &amp;&amp; a i) F i)
      (\big[min/x]_(i &lt;- r | P i &amp;&amp; ~~ a i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>448</q><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[min/x]_(i &lt;- r | P i) F i =
min (\big[min/x]_(i &lt;- r | P i &amp;&amp; a i) F i)
  (\big[min/x]_(i &lt;- r | P i &amp;&amp; ~~ a i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>509</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (bigID_idem minA minC _ _ a) <span class="nl">?minxx</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">bigmin_Type</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Let</span> <span class="nf">le_minr_id</span> (<span class="nv">x</span> <span class="nv">y</span> : T) : x &gt;= min x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>44e</q><span class="goal-separator"><hr></span><div class="goal-conclusion">min x y &lt;= x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>50e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> le_minl lexx.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub_bigmin</span> [x0] I s (P P&#39; : {pred I}) (F : I -&gt; T) :
     (<span class="kr">forall</span> <span class="nv">i</span>, P&#39; i -&gt; P i) -&gt;
  \big[min/x0]_(i &lt;- s | P i) F i &lt;= \big[min/x0]_(i &lt;- s | P&#39; i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><span><var>le_minr_id</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : T, min x y &lt;= x</span></span></span><br><q>456</q><br><q>15c</q><br><q>35f</q><br><q>360</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> : I, P&#39; i -&gt; P i) -&gt;
\big[min/x0]_(i &lt;- s | P i) F i &lt;=
\big[min/x0]_(i &lt;- s | P&#39; i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>513</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (sub_big minA minC ge_refl).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub_bigmin_cond</span> [x0] (I : eqType) s s&#39; P P&#39; (F : I -&gt; T) :
    {subset [seq i &lt;- s | P i] &lt;= [seq i &lt;- s&#39; | P&#39; i]} -&gt;
  \big[min/x0]_(i &lt;- s&#39; | P&#39; i) F i &lt;= \big[min/x0]_(i &lt;- s | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>456</q><br><q>1eb</q><br><q>37f</q><br><q>3b2</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{subset [seq i &lt;- s | P i] &lt;= [seq i &lt;- s&#39; | P&#39; i]} -&gt;
\big[min/x0]_(i &lt;- s&#39; | P&#39; i) F i &lt;=
\big[min/x0]_(i &lt;- s | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>51a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (sub_big_idem_cond minA minC minxx ge_refl).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub_bigmin_seq</span> [x0] (I : eqType) s s&#39; P (F : I -&gt; T) : {subset s&#39; &lt;= s} -&gt;
  \big[min/x0]_(i &lt;- s | P i) F i &lt;= \big[min/x0]_(i &lt;- s&#39; | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>456</q><br><q>1eb</q><br><q>3a6</q><br><q>305</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{subset s&#39; &lt;= s} -&gt;
\big[min/x0]_(i &lt;- s | P i) F i &lt;=
\big[min/x0]_(i &lt;- s&#39; | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>520</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (sub_big_idem minA minC minxx ge_refl).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">sub_in_bigmin</span> [x0] [I : eqType] (s : seq I) (P P&#39; : {pred I}) (F : I -&gt; T) :
    {<span class="kr">in</span> s, <span class="kr">forall</span> <span class="nv">i</span>, P&#39; i -&gt; P i} -&gt;
  \big[min/x0]_(i &lt;- s | P i) F i &lt;= \big[min/x0]_(i &lt;- s | P&#39; i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>456</q><br><q>1eb</q><br><q>35f</q><br><q>360</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{<span class="kr">in</span> s, <span class="kr">forall</span> <span class="nv">i</span> : I, P&#39; i -&gt; P i} -&gt;
\big[min/x0]_(i &lt;- s | P i) F i &lt;=
\big[min/x0]_(i &lt;- s | P&#39; i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>526</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (sub_in_big minA minC ge_refl).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_bigmin_nat</span> [x0] n m n&#39; m&#39; P (F : nat -&gt; T) :
  (n &lt;= n&#39;)%N -&gt; (m&#39; &lt;= m)%N -&gt;
  \big[min/x0]_(n &lt;= i &lt; m | P i) F i &lt;= \big[min/x0]_(n&#39; &lt;= i &lt; m&#39; | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>456</q><br><q>3eb</q><br><q>404</q><br><q>470</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(n &lt;= n&#39;)%N -&gt;
(m&#39; &lt;= m)%N -&gt;
\big[min/x0]_(n &lt;= i &lt; m | P i) F i &lt;=
\big[min/x0]_(n&#39; &lt;= i &lt; m&#39; | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>52c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (le_big_nat minA minC ge_refl).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_bigmin_nat_cond</span> [x0] n m n&#39; m&#39; (P P&#39; : pred nat) (F : nat -&gt; T) :
    (n &lt;= n&#39;)%N -&gt; (m&#39; &lt;= m)%N -&gt; (<span class="kr">forall</span> <span class="nv">i</span>, n&#39; &lt;= i &lt; m&#39; -&gt; P&#39; i -&gt; P i) -&gt;
  \big[min/x0]_(n &lt;= i &lt; m | P i) F i &lt;= \big[min/x0]_(n&#39; &lt;= i &lt; m&#39; | P&#39; i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>456</q><br><q>3eb</q><br><span><var>P, P'</var><span class="hyp-type"><b>: </b><span>pred nat</span></span></span><br><q>470</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(n &lt;= n&#39;)%N -&gt;
(m&#39; &lt;= m)%N -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Order.NatOrder.porderType,
 n&#39; &lt;= i &lt; m&#39; -&gt; P&#39; i -&gt; P i) -&gt;
\big[min/x0]_(n &lt;= i &lt; m | P i) F i &lt;=
\big[min/x0]_(n&#39; &lt;= i &lt; m&#39; | P&#39; i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>532</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (le_big_nat_cond minA minC ge_refl).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_bigmin_ord</span> [x0] n m (P : pred nat) (F : nat -&gt; T) : (m &lt;= n)%N -&gt;
  \big[min/x0]_(i &lt; n | P i) F i &lt;= \big[min/x0]_(i &lt; m | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>456</q><br><q>3cb</q><br><span><var>P</var><span class="hyp-type"><b>: </b><span>pred nat</span></span></span><br><q>470</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(m &lt;= n)%N -&gt;
\big[min/x0]_(i &lt; n | P i) F i &lt;=
\big[min/x0]_(i &lt; m | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>539</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (le_big_ord minA minC ge_refl).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">le_bigmin_ord_cond</span> [x0] n m (P P&#39; : pred nat) (F : nat -&gt; T) :
    (m &lt;= n)%N -&gt; (<span class="kr">forall</span> <span class="nv">i</span> : &#39;I_m, P&#39; i -&gt; P i) -&gt;
  \big[min/x0]_(i &lt; n | P i) F i &lt;= \big[min/x0]_(i &lt; m | P&#39; i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>456</q><br><q>3cb</q><br><q>535</q><br><q>470</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(m &lt;= n)%N -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : &#39;I_m, P&#39; i -&gt; P i) -&gt;
\big[min/x0]_(i &lt; n | P i) F i &lt;=
\big[min/x0]_(i &lt; m | P&#39; i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>540</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (le_big_ord_cond minA minC ge_refl).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">subset_bigmin</span> [x0] [I : finType] [A A&#39; P : {pred I}] (F : I -&gt; T) :
    A&#39; \subset A -&gt;
  \big[min/x0]_(i <span class="kr">in</span> A | P i) F i &lt;= \big[min/x0]_(i <span class="kr">in</span> A&#39; | P i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>456</q><br><q>354</q><br><q>3d4</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A&#39; \subset A -&gt;
\big[min/x0]_(i <span class="kr">in</span> A | P i) F i &lt;=
\big[min/x0]_(i <span class="kr">in</span> A&#39; | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>546</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (subset_big minA minC ge_refl).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">subset_bigmin_cond</span> [x0] (I : finType) (A A&#39; P P&#39; : {pred I}) (F : I -&gt; T) :
    [<span class="nb">set</span> i <span class="kr">in</span> A&#39; | P&#39; i]  \subset [<span class="nb">set</span> i <span class="kr">in</span> A | P i] -&gt;
  \big[min/x0]_(i <span class="kr">in</span> A | P i) F i &lt;= \big[min/x0]_(i <span class="kr">in</span> A&#39; | P&#39; i) F i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>456</q><br><q>354</q><br><q>3e4</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[<span class="nb">set</span> i <span class="kr">in</span> A&#39; | P&#39; i] \subset [<span class="nb">set</span> i <span class="kr">in</span> A | P i] -&gt;
\big[min/x0]_(i <span class="kr">in</span> A | P i) F i &lt;=
\big[min/x0]_(i <span class="kr">in</span> A&#39; | P&#39; i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>54c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: (subset_big_cond minA minC ge_refl).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">bigmin_finType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> (<span class="nv">I</span> : finType) (<span class="nv">x</span> : T).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> (<span class="nv">P</span> : pred I) (<span class="nv">F</span> : I -&gt; T).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigminD1</span> <span class="nv">j</span> <span class="nv">P</span> <span class="nv">F</span> : P j -&gt;
  \big[min/x]_(i | P i) F i = min (F j) (\big[min/x]_(i | P i &amp;&amp; (i != j)) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>354</q><br><q>f4</q><br><q>355</q><br><q>15e</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P j -&gt;
\big[min/x]_(i | P i) F i =
min (F j) (\big[min/x]_(i | P i &amp;&amp; (i != j)) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>552</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>/(bigD1_AC minA minC) -&gt;.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmin_le_cond</span> <span class="nv">j</span> <span class="nv">P</span> <span class="nv">F</span> : P j -&gt; \big[min/x]_(i | P i) F i &lt;= F j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>554</q><span class="goal-separator"><hr></span><div class="goal-conclusion">P j -&gt; \big[min/x]_(i | P i) F i &lt;= F j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>558</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> := mem_index_enum j; <span class="nb">rewrite</span> <span class="nb">unlock</span>; <span class="nb">elim</span>: (index_enum I) =&gt; //= i l ih.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>354</q><br><q>f4</q><br><q>355</q><br><q>15e</q><br><q>431</q><br><q>1e4</q><br><span><var>l</var><span class="hyp-type"><b>: </b><span>seq I</span></span></span><br><span><var>ih</var><span class="hyp-type"><b>: </b><span>j \<span class="kr">in</span> l -&gt;
P j -&gt;
reducebig x l
  (<span class="kr">fun</span> <span class="nv">i</span> : I =&gt; BigBody i min (P i) (F i)) &lt;= 
F j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j \<span class="kr">in</span> i :: l -&gt;
P j -&gt;
(<span class="kr">if</span> P i
 <span class="kr">then</span>
  min (F i)
    (reducebig x l
       (<span class="kr">fun</span> <span class="nv">i</span> : I =&gt; BigBody i min (P i) (F i)))
 <span class="kr">else</span>
  reducebig x l
    (<span class="kr">fun</span> <span class="nv">i</span> : I =&gt; BigBody i min (P i) (F i))) &lt;= F j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> inE =&gt; /orP [/eqP-&gt; -&gt;|/ih leminlfi Pi]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> le_minl lexx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>354</q><br><q>f4</q><br><q>355</q><br><q>15e</q><br><q>431</q><br><q>1e4</q><br><q>560</q><br><q>561</q><br><span><var>leminlfi</var><span class="hyp-type"><b>: </b><span>P j -&gt;
reducebig x l
  (<span class="kr">fun</span> <span class="nv">i</span> : I =&gt; BigBody i min (P i) (F i)) &lt;=
F j</span></span></span><br><span><var>Pi</var><span class="hyp-type"><b>: </b><span>P j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> P i
 <span class="kr">then</span>
  min (F i)
    (reducebig x l
       (<span class="kr">fun</span> <span class="nv">i</span> : I =&gt; BigBody i min (P i) (F i)))
 <span class="kr">else</span>
  reducebig x l
    (<span class="kr">fun</span> <span class="nv">i</span> : I =&gt; BigBody i min (P i) (F i))) &lt;= F j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: ifPn =&gt; Pj; [<span class="nb">rewrite</span> le_minl leminlfi// orbC|<span class="bp">exact</span>: leminlfi].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmin_le</span> <span class="nv">j</span> <span class="nv">F</span> : \big[min/x]_i F i &lt;= F j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>354</q><br><q>f4</q><br><q>355</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[min/x]_i F i &lt;= F j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>56b</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span>: bigmin_le_cond.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmin_inf</span> <span class="nv">j</span> <span class="nv">P</span> <span class="nv">m</span> <span class="nv">F</span> : P j -&gt; F j &lt;= m -&gt; \big[min/x]_(i | P i) F i &lt;= m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>354</q><br><q>f4</q><br><q>355</q><br><q>15e</q><br><q>4a6</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P j -&gt; F j &lt;= m -&gt; \big[min/x]_(i | P i) F i &lt;= m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>571</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; Pj ?; <span class="nb">apply</span>: le_trans (bigmin_le_cond _ Pj) _.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmin_geP</span> <span class="nv">m</span> <span class="nv">P</span> <span class="nv">F</span> : reflect (m &lt;= x /\ <span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; m &lt;= F i)
                                 (m &lt;= \big[min/x]_(i | P i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>354</q><br><q>4ad</q><br><q>15e</q><br><q>431</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect (m &lt;= x /\ (<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; m &lt;= F i))
  (m &lt;= \big[min/x]_(i | P i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>577</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: (iffP idP) =&gt; [lemFi|[lemx lemPi]]; [<span class="nb">split</span>|<span class="bp">exact</span>: le_bigmin].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>354</q><br><q>4ad</q><br><q>15e</q><br><q>431</q><br><span><var>lemFi</var><span class="hyp-type"><b>: </b><span>m &lt;= \big[min/x]_(i | P i) F i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m &lt;= x</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>57f</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; m &lt;= F i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>57d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (le_trans lemFi)// bigmin_idl le_minl lexx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>57f</q><span class="goal-separator"><hr></span><q>584</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>587</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; i Pi; <span class="nb">rewrite</span> (le_trans lemFi)// (bigminD1 _ Pi)// le_minl lexx.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmin_gtP</span> <span class="nv">m</span> <span class="nv">P</span> <span class="nv">F</span> :
  reflect (m &lt; x /\ <span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; m &lt; F i) (m &lt; \big[min/x]_(i | P i) F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>579</q><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect (m &lt; x /\ (<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; m &lt; F i))
  (m &lt; \big[min/x]_(i | P i) F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>58b</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: (iffP idP) =&gt; [lemFi|[lemx lemPi]]; [<span class="nb">split</span>|<span class="bp">exact</span>: lt_bigmin].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>354</q><br><q>4ad</q><br><q>15e</q><br><q>431</q><br><span><var>lemFi</var><span class="hyp-type"><b>: </b><span>m &lt; \big[min/x]_(i | P i) F i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m &lt; x</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>592</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; m &lt; F i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>590</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (lt_le_trans lemFi)// bigmin_idl le_minl lexx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>592</q><span class="goal-separator"><hr></span><q>597</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>59a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; i Pi; <span class="nb">rewrite</span> (lt_le_trans lemFi)// (bigminD1 _ Pi)// le_minl lexx.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">bigmin_eq_arg</span> <span class="nv">j</span> <span class="nv">P</span> <span class="nv">F</span> : P j -&gt; (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; F i &lt;= x) -&gt;
  \big[min/x]_(i | P i) F i = F [arg min_(i &lt; j | P i) F i].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>554</q><span class="goal-separator"><hr></span><div class="goal-conclusion">P j -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F i &lt;= x) -&gt;
\big[min/x]_(i | P i) F i =
F [arg min_(i &lt; j | P i) F i]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>59e</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; Pi0; <span class="nb">case</span>: arg_minP =&gt; //= i Pi PF PFx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5f</q><br><q>13d</q><br><q>516</q><br><q>354</q><br><q>f4</q><br><q>355</q><br><q>15e</q><br><q>431</q><br><q>4d2</q><br><q>1e4</q><br><q>3fc</q><br><span><var>PF</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : I, P j -&gt; F i &lt;= F j</span></span></span><br><span><var>PFx</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F i &lt;= x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">\big[min/x]_(i | P i) F i = F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/eqP; <span class="nb">rewrite</span> eq_le bigmin_le_cond //=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>5a5</q><span class="goal-separator"><hr></span><div class="goal-conclusion">F i &lt;= \big[min/x]_(i | P i) F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/bigmin_geP; <span class="nb">split</span> =&gt; //; <span class="bp">exact</span>: PFx.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eq_bigmin</span> <span class="nv">j</span> <span class="nv">P</span> <span class="nv">F</span> : P j -&gt; (<span class="kr">forall</span> <span class="nv">i</span>, P i -&gt; F i &lt;= x) -&gt;
  {i0 | i0 \<span class="kr">in</span> I &amp; \big[min/x]_(i | P i) F i = F i0}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>554</q><span class="goal-separator"><hr></span><div class="goal-conclusion">P j -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : I, P i -&gt; F i &lt;= x) -&gt;
{i0 : I | i0 \<span class="kr">in</span> I &amp; \big[min/x]_(i | P i) F i = F i0}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5ae</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; Pi0 Hx; <span class="nb">rewrite</span> (bigmin_eq_arg Pi0) //; <span class="nb">eexists</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">bigmin_finType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">bigmin</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> bigmin_mkcond {d T I r}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> bigminID {d T I r}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> bigminD1 {d T I x} j.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> bigmin_inf {d T I x} j.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> bigmin_eq_arg {d T I} x j.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> eq_bigmin {d T I x} j.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">onem</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">R</span> : numDomainType.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Implicit Types</span> <span class="nv">r</span> : R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">onem</span> <span class="nv">r</span> := <span class="mi">1</span> - r.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Notation</span> <span class="s2">&quot;`1- r&quot;</span> := (onem r).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">onem0</span> : `<span class="mi">1</span>-<span class="mi">0</span> = <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>15b</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`<span class="mi">1</span>-<span class="mi">0</span> = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5b3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /onem subr0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">onem1</span> : `<span class="mi">1</span>-<span class="mi">1</span> = <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>5b5</q><span class="goal-separator"><hr></span><div class="goal-conclusion">`<span class="mi">1</span>-<span class="mi">1</span> = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5b9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /onem subrr.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">onemK</span> <span class="nv">r</span> : `<span class="mi">1</span>-(`<span class="mi">1</span>-r) = r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1c8</q><span class="goal-separator"><hr></span><div class="goal-conclusion">`<span class="mi">1</span>-(`<span class="mi">1</span>-r) = r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5be</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /onem opprB addrCA subrr addr0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">add_onemK</span> <span class="nv">r</span> : r + `<span class="mi">1</span>- r = <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1c8</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r + `<span class="mi">1</span>-r = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5c3</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /onem addrC subrK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">onem_gt0</span> <span class="nv">r</span> : r &lt; <span class="mi">1</span> -&gt; <span class="mi">0</span> &lt; `<span class="mi">1</span>-r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1c8</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r &lt; <span class="mi">1</span> -&gt; <span class="mi">0</span> &lt; `<span class="mi">1</span>-r</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5c8</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> subr_gt0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">onem_ge0</span> <span class="nv">r</span> : r &lt;= <span class="mi">1</span> -&gt; <span class="mi">0</span> &lt;= `<span class="mi">1</span>-r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1c8</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r &lt;= <span class="mi">1</span> -&gt; <span class="mi">0</span> &lt;= `<span class="mi">1</span>-r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5cd</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> le_eqVlt =&gt; /predU1P[-&gt;|/onem_gt0/ltW]; <span class="nb">rewrite</span> <span class="nl">?onem1</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">onem_le1</span> <span class="nv">r</span> : <span class="mi">0</span> &lt;= r -&gt; `<span class="mi">1</span>-r &lt;= <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1c8</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= r -&gt; `<span class="mi">1</span>-r &lt;= <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5d2</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ler_subl_addr ler_addl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">onem_lt1</span> <span class="nv">r</span> : <span class="mi">0</span> &lt; r -&gt; `<span class="mi">1</span>-r &lt; <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1c8</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; r -&gt; `<span class="mi">1</span>-r &lt; <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5d7</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltr_subl_addr ltr_addl.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">onemX_ge0</span> <span class="nv">r</span> <span class="nv">n</span> : <span class="mi">0</span> &lt;= r -&gt; r &lt;= <span class="mi">1</span> -&gt; <span class="mi">0</span> &lt;= `<span class="mi">1</span>-(r ^+ n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>15b</q><br><q>1c9</q><br><q>16b</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= r -&gt; r &lt;= <span class="mi">1</span> -&gt; <span class="mi">0</span> &lt;= `<span class="mi">1</span>-(r ^+ n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5dc</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ? ?; <span class="nb">rewrite</span> subr_ge0 exprn_ile1.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">onemX_lt1</span> <span class="nv">r</span> <span class="nv">n</span> : <span class="mi">0</span> &lt; r -&gt; `<span class="mi">1</span>-(r ^+ n) &lt; <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>5de</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; r -&gt; `<span class="mi">1</span>-(r ^+ n) &lt; <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5e2</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> onem_lt1// exprn_gt0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">onemD</span> <span class="nv">r</span> <span class="nv">s</span> : `<span class="mi">1</span>-(r + s) = `<span class="mi">1</span>-r - s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>15b</q><br><span><var>r, s</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`<span class="mi">1</span>-(r + s) = `<span class="mi">1</span>-r - s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5e7</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /onem addrAC opprD addrA addrAC.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">onemMr</span> <span class="nv">r</span> <span class="nv">s</span> : s * `<span class="mi">1</span>-r = s - s * r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>5e9</q><span class="goal-separator"><hr></span><div class="goal-conclusion">s * `<span class="mi">1</span>-r = s - s * r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5ee</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /onem mulrBr mulr1.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">onemM</span> <span class="nv">r</span> <span class="nv">s</span> : `<span class="mi">1</span>-(r * s) = `<span class="mi">1</span>-r + `<span class="mi">1</span>-s - `<span class="mi">1</span>-r * `<span class="mi">1</span>-s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>5e9</q><span class="goal-separator"><hr></span><div class="goal-conclusion">`<span class="mi">1</span>-(r * s) = `<span class="mi">1</span>-r + `<span class="mi">1</span>-s - `<span class="mi">1</span>-r * `<span class="mi">1</span>-s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5f3</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> /onem mulrBr mulr1 mulrBl mul1r opprB -addrA.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>5e9</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> - r * s = <span class="mi">1</span> - r + (<span class="mi">1</span> - s + (s - r * s - (<span class="mi">1</span> - r)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (addrC (<span class="mi">1</span> - r)) !addrA subrK opprB addrA subrK addrK.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">onem</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;`1- r&quot;</span> := (onem r) : ring_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">lez_abs2</span> (<span class="nv">a</span> <span class="nv">b</span> : int) : <span class="mi">0</span> &lt;= a -&gt; a &lt;= b -&gt; (`|a| &lt;= `|b|)%N.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, b</var><span class="hyp-type"><b>: </b><span>int</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;= a -&gt; a &lt;= b -&gt; (`|a| &lt;= `|b|)%N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>5fc</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: a =&gt; //= n _; <span class="nb">case</span>: b.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ler_gtP</span> (<span class="nv">R</span> : numFieldType) (<span class="nv">x</span> <span class="nv">y</span> : R) :
  reflect (<span class="kr">forall</span> <span class="nv">z</span>, z &gt; y -&gt; x &lt;= z) (x &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21f</q><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect (<span class="kr">forall</span> <span class="nv">z</span> : R, y &lt; z -&gt; x &lt;= z) (x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>603</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: (equivP (ler_addgt0Pr _ _)); <span class="nb">split</span>=&gt; [xy z|xz e e_gt0].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><q>206</q><br><span><var>xy</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">e</span> : R, <span class="mi">0</span> &lt; e -&gt; x &lt;= y + e</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y &lt; z -&gt; x &lt;= z</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><q>206</q><br><span><var>xz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">z</span> : R, y &lt; z -&gt; x &lt;= z</span></span></span><br><q>251</q><br><q>252</q><br></div><label class="goal-separator"><hr></label><div class="goal-conclusion">x &lt;= y + e</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -subr_gt0 =&gt; /xy; <span class="nb">rewrite</span> addrC addrNK.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>610</q><span class="goal-separator"><hr></span><q>612</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: xz; <span class="nb">rewrite</span> -[ltLHS]addr0 ler_lt_add.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">ler_ltP</span> (<span class="nv">R</span> : numFieldType) (<span class="nv">x</span> <span class="nv">y</span> : R) :
  reflect (<span class="kr">forall</span> <span class="nv">z</span>, z &lt; x -&gt; z &lt;= y) (x &lt;= y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>21f</q><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect (<span class="kr">forall</span> <span class="nv">z</span> : R, z &lt; x -&gt; z &lt;= y) (x &lt;= y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>617</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: (equivP (ler_addgt0Pr _ _)); <span class="nb">split</span>=&gt; [xy z|xz e e_gt0].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>60a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">z &lt; x -&gt; z &lt;= y</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>10d</q><br><q>206</q><br><span><var>xz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">z</span> : R, z &lt; x -&gt; z &lt;= y</span></span></span><br><q>251</q><br><q>252</q><br></div><label class="goal-separator"><hr></label><q>612</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -subr_gt0 =&gt; /xy; <span class="nb">rewrite</span> addrCA -[leLHS]addr0 ler_add2l subr_ge0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>621</q><span class="goal-separator"><hr></span><q>612</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -ler_subl_addr xz// -[ltRHS]subr0 ler_lt_sub.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">inv_fun</span> <span class="nv">T</span> (<span class="nv">R</span> : unitRingType) (<span class="nv">f</span> : T -&gt; R) <span class="nv">x</span> := (f x)^-<span class="mi">1</span>%R.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;f \^-1&quot;</span> := (inv_fun f) : ring_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> inv_fun {T R} _ _ /.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">bound_side</span> <span class="nv">d</span> (<span class="nv">T</span> : porderType d) (<span class="nv">c</span> : bool) (<span class="nv">x</span> : itv_bound T) :=
  <span class="kr">if</span> x <span class="kr">is</span> BSide c&#39; _ <span class="kr">then</span> c == c&#39; <span class="kr">else</span> false.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">real_ltr_distlC</span> [R : numDomainType] [x y : R] (e : R) :
  x - y \<span class="kr">is</span> Num.real -&gt; (`|x - y| &lt; e) = (x - e &lt; y &lt; x + e).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>15b</q><br><span><var>x, y, e</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x - y \<span class="kr">is</span> Num.real -&gt;
(`|x - y| &lt; e) = (x - e &lt; y &lt; x + e)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>627</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; ?; <span class="nb">rewrite</span> distrC real_ltr_distl// -rpredN opprB.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">proj</span> {<span class="nv">I</span>} {<span class="nv">T</span> : I -&gt; <span class="kt">Type</span>} <span class="nv">i</span> (<span class="nv">f</span> : <span class="kr">forall</span> <span class="nv">i</span>, T i) := f i.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">DFunWith</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variables</span> (<span class="nv">I</span> : eqType) (<span class="nv">T</span> : I -&gt; <span class="kt">Type</span>) (<span class="nv">f</span> : <span class="kr">forall</span> <span class="nv">i</span>, T i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">dfwith</span> <span class="nv">i</span> (<span class="nv">x</span> : T i) (<span class="nv">j</span> : I) : T j :=
  <span class="kr">if</span> (i =P j) <span class="kr">is</span> ReflectT ij <span class="kr">then</span> ecast j (T j) ij x <span class="kr">else</span> f j.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dfwithin</span> <span class="nv">i</span> <span class="nv">x</span> : dfwith x i = x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>1eb</q><br><span><var>T</var><span class="hyp-type"><b>: </b><span>I -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : I, T i</span></span></span><br><q>1e4</q><br><span><var>x</var><span class="hyp-type"><b>: </b><span>T i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dfwith x i = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>62e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /dfwith; <span class="nb">case</span>: eqP =&gt; // ii; <span class="nb">rewrite</span> eq_axiomK.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dfwithout</span> <span class="nv">i</span> (<span class="nv">x</span> : T i) <span class="nv">j</span> : i != j -&gt; dfwith x j = f j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>1eb</q><br><q>631</q><br><q>632</q><br><q>1e4</q><br><q>633</q><br><q>355</q><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i != j -&gt; dfwith x j = f j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>637</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /dfwith; <span class="nb">case</span>: eqP.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variant</span> <span class="nf">dfwith_spec</span> <span class="nv">i</span> (<span class="nv">x</span> : T i) : <span class="kr">forall</span> <span class="nv">j</span>, T j -&gt; <span class="kt">Type</span> :=
  | DFunWithin : dfwith_spec x x
  | DFunWithout j : i != j -&gt; dfwith_spec x (f j).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">dfwithP</span> <span class="nv">i</span> (<span class="nv">x</span> : T i) (<span class="nv">j</span> : I) : dfwith_spec x (dfwith x j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>639</q><span class="goal-separator"><hr></span><div class="goal-conclusion">dfwith_spec x (dfwith x j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>63d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: (eqVneq i j) =&gt; [&lt;-|nij];
   [<span class="nb">rewrite</span> dfwithin|<span class="nb">rewrite</span> dfwithout//]; <span class="nb">constructor</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">projK</span> <span class="nv">i</span> (<span class="nv">x</span> : T i) : cancel (@dfwith i) (proj i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>630</q><span class="goal-separator"><hr></span><div class="goal-conclusion">cancel (dfwith (i:=i)) (proj i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>642</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; z; <span class="nb">rewrite</span> /proj dfwithin.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">DFunWith</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> dfwith {I T} f i x.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">swap</span> (<span class="nv">T1</span> <span class="nv">T2</span> : <span class="kt">Type</span>) (<span class="nv">x</span> : T1 * T2) := (x.<span class="mi">2</span>, x.<span class="mi">1</span>).</span></span></pre></article></body></html>