<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>functions</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library functions</h1>

<div class="code">
<span class="comment">(*&nbsp;mathcomp&nbsp;analysis&nbsp;(c)&nbsp;2017&nbsp;Inria&nbsp;and&nbsp;AIST.&nbsp;License:&nbsp;CeCILL-C.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">all_ssreflect</span> <span class="id" title="var">finmap</span> <span class="id" title="var">ssralg</span> <span class="id" title="var">ssrnum</span> <span class="id" title="var">ssrint</span> <span class="id" title="var">rat</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">HB</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">structures</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">mathcomp_extra</span> <span class="id" title="var">boolp</span> <span class="id" title="var">classical_sets</span>.<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="keyword">Search</span> <span class="id" title="var">Blacklist</span> "__canonical__".<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="keyword">Search</span> <span class="id" title="var">Blacklist</span> "__functions_".<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="keyword">Search</span> <span class="id" title="var">Blacklist</span> "_factory_".<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="keyword">Search</span> <span class="id" title="var">Blacklist</span> "_mixin_".<br/>

<br/>
</div>

<div class="doc">
                            Theory of functions                             

<div class="paragraph"> </div>

 This file provides a theory of functions whose domain and codomain are     
 represented by sets.                                                       

<div class="paragraph"> </div>

          set_fun A B f == f : aT -&gt; rT is a function with domain           
                           A : set aT and codomain B : set rT               
         set_surj A B f == f is surjective                                  
          set inj A B f == f is injective                                   
          set_bij A B f == f is bijective                                   

<div class="paragraph"> </div>

          {fun A &gt;-&gt; B} == type of functions f : aT -&gt; rT from A : set aT   
                           to B : set rT.                                   
                           funS f  is a proof of  set_fun A B f             
       {oinv aT &gt;-&gt; rT} == type of functions with a partial inverse         
      {oinvfun A &gt;-&gt; B} == combination of {fun A &gt;-&gt; B} and                 
                           {oinv aT &gt;-&gt; rT}                                 
        {inv aT &gt;-&gt; rT} == type of functions with an inverse                
                  f ^-1 == inverse of f : {inv aT &gt;-&gt; rT}                   
       {invfun A &gt;-&gt; B} == combination of {fun A &gt;-&gt; B} and {inv aT &gt;-&gt; rT} 
         {surj A &gt;-&gt; B} == type of surjective functions                     
      {surjfun A &gt;-&gt; B} == combination of {fun A &gt;-&gt; B} and {surj A &gt;-&gt; B}  
    {splitsurj A &gt;-&gt; B} == type of surjective functions with an inverse     
 {splitsurjfun A &gt;-&gt; B} == combination of {fun A &gt;-&gt; B} and                 
                           {splitsurj A &gt;-&gt; B}                              
         {inj A &gt;-&gt; rT} == type of injective functions                      
       {injfun A &gt;-&gt; B} == combination of {fun A &gt;-&gt; B} and {inj A &gt;-&gt; rT}  
     {splitinj A &gt;-&gt; B} == type of injective functions with an inverse      
  {splitinjfun A &gt;-&gt; B} == combination of {fun A &gt;-&gt; B} and                 
                           {splitinj A &gt;-&gt; B}                               
          {bij A &gt;-&gt; B} == combination of {injfun A &gt;-&gt; B} and              
                           {surjfun A &gt;-&gt; B}                                
     {splitbij A &gt;-&gt; B} == combination of {splitinj A &gt;-&gt; B} and            
                           {splitsurj A &gt;-&gt; B}                              
                'inj f == proof of {in A &amp;, injective f} where f has type  
                           {splitinj A &gt;-&gt; _}                               

<div class="paragraph"> </div>

              funin A f == alias for f : aT -&gt; rT, with A : set aT          
             [fun f in A] == the function f from the set A to the set f @` A
            'split d f == partial injection from aT : Type to rt : Type;   
                           f : aT -&gt; rT, d : rT -&gt; aT                       
                  split := 'split_point                                     
             @to_setT T == function that associates to x : T a dependent    
                           pair of x with a proof that x belongs to setT    
                           (i.e., the type set_type [set: T])               
                incl AB == identity function from T to T, where AB is a     
                           proof of A `&lt;=` B, with A, B : set T             
                inclT A := incl (@subsetT _ )                              
              eqincl AB == identity function from T to T, where AB is a     
                           proof of A = B, with A, B : set T                
              mkfun fAB == builds a function {fun A &gt;-&gt; B} given a function 
                           f : aT -&gt; rT and a proof fAB that                
                           {homo f : x / A x &gt;-&gt; B x}                       
           @set_val T A == injection from set_type A to T, where A has      
                           type set T                                       
             @ssquash T == function of type                                 
                           {splitsurj [set: T] &gt;-&gt; [set: $| T | ]}           
        @finset_val T X == function that turns an element x : X             
                           (with X : {fset T}) into a dependent pair of x   
                           with a proof that x belongs to X                 
                           (i.e., the type set_type [set` X])               
        @val_finset T X == function of type [set` X] -&gt; X with X : {fset T} 
                           that cancels finset_val                          
         glue XY AB f g == function that behaves as f over X, as g over Y   
                           XY is a proof that sets X and Y are disjoint,    
                           AB is a proof that sets A and B are disjoint,    
                           A and B are intended to be the ranges of f and g 
           'pinv d A f == inverse of the function [fun f in A] over        
                           f @` A, function d outside of f @` A             
                  pinv := notation for 'pinv_point                          

<div class="paragraph"> </div>

<a id="lab10"></a><h1 class="section">Function restriction:</h1>

            patch d A f == "partial function" that behaves as the function  
                           f over the set A and as the function d otherwise 
           restrict D f := patch (fun=&gt; point) D f                          
                 f \_ D := restrict D f                                     
               sigL A f == "left restriction"; given a set A : set U and a  
                           function f : U -&gt; V, returns the corresponding   
                           function of type set_type A -&gt; V                 
               sigR A f == "right restriction"; given a set B : set V and a 
                           function f : {fun [set: U] &gt;-&gt; B}, returns the   
                           corresponding function of type U -&gt; set_type B   
            sigLR A B f == the function of type set_type A -&gt; set_type B    
                           corresponding to f : {fun A &gt;-&gt; B}               
                valL v == function cancelled by sigL A, with A : set U and 
                           v : V                                            
                 valR f == the function of type U -&gt; V corresponding to     
                           f : U -&gt; set_type B, with B : set V              
               valR_fun == the function of type {fun [set: U] &gt;-&gt; B}        
                           corresponding to f : U -&gt; set_type B, with       
                           B : set V                                        
              valLR v f == the function of type U -&gt; V corresponding to     
                           f : set_type A -&gt; set_type B (where v : V),      
                           i.e., 'valL v \o valR_fun                       
       valLfun v A B f := [fun of valL f] with f : {fun [set: A] &gt;-&gt; B}   
                   valL := 'valL point                                     
             valLRfun v := 'valLfun v \o valR_fun                          

<div class="paragraph"> </div>

 Section function_space == canonical ringType and lmodType                  
                           structures for functions whose range is          
                           a ringType, comRingType, or lmodType.            
                   fctE == multi-rule for fct                               
                                                                             
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;f \_ D" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 10).<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'fun' A '&gt;-&gt;' B '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'fun'  A  '&gt;-&gt;'  B '}'").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'oinv' T '&gt;-&gt;' U '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'oinv'  T  '&gt;-&gt;'  U '}'").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'inv' T '&gt;-&gt;' U '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'inv'  T  '&gt;-&gt;'  U '}'").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'oinvfun' T '&gt;-&gt;' U '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'oinvfun'  T  '&gt;-&gt;'  U '}'").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'invfun' T '&gt;-&gt;' U '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'invfun'  T  '&gt;-&gt;'  U '}'").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'inj' A '&gt;-&gt;' T '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'inj'  A  '&gt;-&gt;'  T '}'").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'splitinj' A '&gt;-&gt;' T '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'splitinj'  A  '&gt;-&gt;'  T '}'").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'surj' A '&gt;-&gt;' B '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'surj'  A  '&gt;-&gt;'  B '}'").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'splitsurj' A '&gt;-&gt;' B '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'splitsurj'  A  '&gt;-&gt;'  B '}'").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'injfun' A '&gt;-&gt;' B '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'injfun'  A  '&gt;-&gt;'  B '}'").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'surjfun' A '&gt;-&gt;' B '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'surjfun'  A  '&gt;-&gt;'  B '}'").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'splitinjfun' A '&gt;-&gt;' B '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'splitinjfun'  A  '&gt;-&gt;'  B '}'").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'splitsurjfun' A '&gt;-&gt;' B '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'splitsurjfun'  A  '&gt;-&gt;'  B '}'").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'bij' A '&gt;-&gt;' B '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'bij'  A  '&gt;-&gt;'  B '}'").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;'{' 'splitbij' A '&gt;-&gt;' B '}'"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "'{' 'splitbij'  A  '&gt;-&gt;'  B '}'").<br/>

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'fun' 'of' f ]" (<span class="id" title="var">format</span> "[ 'fun'  'of'  f ]").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'oinv' 'of' f ]" (<span class="id" title="var">format</span> "[ 'oinv'  'of'  f ]").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'inv' 'of' f ]" (<span class="id" title="var">format</span> "[ 'inv'  'of'  f ]").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'oinv' 'of' f ]" (<span class="id" title="var">format</span> "[ 'oinv'  'of'  f ]").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'inv' 'of' f ]" (<span class="id" title="var">format</span> "[ 'inv'  'of'  f ]").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'inj' 'of' f ]" (<span class="id" title="var">format</span> "[ 'inj'  'of'  f ]").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'splitinj' 'of' f ]" (<span class="id" title="var">format</span> "[ 'splitinj'  'of'  f ]").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'surj' 'of' f ]" (<span class="id" title="var">format</span> "[ 'surj'  'of'  f ]").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'splitsurj' 'of' f ]" (<span class="id" title="var">format</span> "[ 'splitsurj'  'of'  f ]").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'injfun' 'of' f ]" (<span class="id" title="var">format</span> "[ 'injfun'  'of'  f ]").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'surjfun' 'of' f ]" (<span class="id" title="var">format</span> "[ 'surjfun'  'of'  f ]").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'splitinjfun' 'of' f ]"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "[ 'splitinjfun'  'of'  f ]").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'splitsurjfun' 'of' f ]"<br/>
&nbsp;&nbsp;(<span class="id" title="var">format</span> "[ 'splitsurjfun'  'of'  f ]").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'bij' 'of' f ]" (<span class="id" title="var">format</span> "[ 'bij'  'of'  f ]").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;[ 'splitbij' 'of' f ]" (<span class="id" title="var">format</span> "[ 'splitbij'  'of'  f ]").<br/>

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''oinv_' f" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''oinv_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''funS_' f" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''funS_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''mem_fun_' f"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span>  "''mem_fun_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''oinvK_' f"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''oinvK_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''oinvS_' f"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''oinvS_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''oinvP_' f"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''oinvP_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''oinvT_' f"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''oinvT_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''invK_' f"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''invK_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''invS_' f"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''invS_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''funoK_' f"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''funoK_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''inj_' f"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''inj_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''funK_' f"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''funK_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''totalfun_' A"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">A</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''totalfun_' A").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''surj_' f"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''surj_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''split_' a"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">a</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''split_' a").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''bijTT_'  f"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''bijTT_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''bij_' f" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''bij_' f").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''valL_' v" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">v</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''valL_' v").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''valLfun_' v"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">v</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''valLfun_' v").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''pinv_' dflt"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">dflt</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''pinv_' dflt").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''pPbij_' dflt"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">dflt</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''pPbij_' dflt").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''pPinj_' dflt"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">dflt</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''pPinj_' dflt").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''injpPfun_' dflt"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">dflt</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''injpPfun_' dflt").<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;''funpPinj_' dflt"<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">dflt</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2, <span class="id" title="var">format</span> "''funpPinj_' dflt").<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">classical_set_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">MainProperties</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>}  (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">set_fun</span> := {<span class="id" title="var">homo</span> <span class="id" title="var">f</span> : <span class="id" title="var">x</span> / <span class="id" title="var">A</span> <span class="id" title="var">x</span> &gt;-&gt; <span class="id" title="var">B</span> <span class="id" title="var">x</span>}.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">set_surj</span> := <span class="id" title="var">B</span> `&lt;=` <span class="id" title="var">f</span> @` <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">set_inj</span> := {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>}.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">set_bij</span> := [/\ <span class="id" title="var">set_fun</span>, <span class="id" title="var">set_inj</span> &amp; <span class="id" title="var">set_surj</span>].<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">MainProperties</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'fun' A &gt;-&gt; B }" := (@<span class="id" title="var">Fun.type</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">form_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'fun'  'of'  f ]" := [<span class="id" title="var">the</span> {<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span>] : <span class="id" title="var">form_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'oinv' aT &gt;-&gt; rT }" := (@<span class="id" title="var">OInversible.type</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span>) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'oinv'  'of'  f ]" := [<span class="id" title="var">the</span> {<span class="id" title="var">oinv</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span>] :<br/>
&nbsp;&nbsp;<span class="id" title="var">form_scope</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_oinv</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>})<br/>
&nbsp;&nbsp;<span class="id" title="keyword">of</span> <span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">oinv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;''oinv_' f" := (@<span class="id" title="var">phant_oinv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>%<span class="id" title="var">FUN</span>)).<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'oinvfun' A &gt;-&gt; B }" := (@<span class="id" title="var">OInvFun.type</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'oinvfun'  'of'  f ]" :=<br/>
&nbsp;&nbsp;[<span class="id" title="var">the</span> {<span class="id" title="var">oinvfun</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span>] : <span class="id" title="var">form_scope</span>.<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'inv' aT &gt;-&gt;  rT }" := (@<span class="id" title="var">Inversible.type</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span>) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'inv'  'of'  f ]" := [<span class="id" title="var">the</span> {<span class="id" title="var">inv</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span>] : <span class="id" title="var">form_scope</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_inv</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">inv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>}) <span class="id" title="keyword">of</span> <span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">inv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;f ^-1" := (@<span class="id" title="var">inv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>%<span class="id" title="var">FUN</span>) (<span class="id" title="var">only</span> <span class="id" title="var">printing</span>) : <span class="id" title="var">fun_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;f ^-1" := (@<span class="id" title="var">inv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>%<span class="id" title="var">function</span>) (<span class="id" title="var">only</span> <span class="id" title="var">printing</span>) : <span class="id" title="var">function_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;f ^-1" := (@<span class="id" title="var">phant_inv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>%<span class="id" title="var">FUN</span>)) : <span class="id" title="var">fun_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;f ^-1" := (@<span class="id" title="var">phant_inv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>%<span class="id" title="var">function</span>)) : <span class="id" title="var">function_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'invfun' A &gt;-&gt; B }" := (@<span class="id" title="var">InvFun.type</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'invfun'  'of'  f ]" :=<br/>
&nbsp;&nbsp;[<span class="id" title="var">the</span> {<span class="id" title="var">invfun</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span>] : <span class="id" title="var">form_scope</span>.<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'surj' A &gt;-&gt; B }" := (@<span class="id" title="var">Surject.type</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'surj'  'of'  f ]" :=<br/>
&nbsp;&nbsp;[<span class="id" title="var">the</span> {<span class="id" title="var">surj</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span>] : <span class="id" title="var">form_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'surjfun' A &gt;-&gt; B }" := (@<span class="id" title="var">SurjFun.type</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'surjfun'  'of'  f ]" :=<br/>
&nbsp;&nbsp;[<span class="id" title="var">the</span> {<span class="id" title="var">surjfun</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span>] : <span class="id" title="var">form_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'splitsurj' A &gt;-&gt; B }" := (@<span class="id" title="var">SplitSurj.type</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'splitsurj'  'of'  f ]" :=<br/>
&nbsp;&nbsp;[<span class="id" title="var">the</span> {<span class="id" title="var">splitsurj</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span>] : <span class="id" title="var">form_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'splitsurjfun' A &gt;-&gt; B }" := (@<span class="id" title="var">SplitSurjFun.type</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'splitsurjfun'  'of'  f ]" :=<br/>
&nbsp;&nbsp;[<span class="id" title="var">the</span> {<span class="id" title="var">splitsurjfun</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span>] : <span class="id" title="var">form_scope</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'inj' A &gt;-&gt; rT }" := (@<span class="id" title="var">Inject.type</span> <span class="id" title="var">_</span> <span class="id" title="var">rT</span> <span class="id" title="var">A</span>) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'inj'  'of'  f ]" := [<span class="id" title="var">the</span> {<span class="id" title="var">inj</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span>] : <span class="id" title="var">form_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'injfun' A &gt;-&gt; B }" := (@<span class="id" title="var">InjFun.type</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'injfun'  'of'  f ]" :=<br/>
&nbsp;&nbsp;[<span class="id" title="var">the</span> {<span class="id" title="var">injfun</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span>] : <span class="id" title="var">form_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'splitinj' A &gt;-&gt; rT }" := (@<span class="id" title="var">SplitInj.type</span> <span class="id" title="var">_</span> <span class="id" title="var">rT</span> <span class="id" title="var">A</span>) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'splitinj'  'of'  f ]" :=<br/>
&nbsp;&nbsp;[<span class="id" title="var">the</span> {<span class="id" title="var">splitinj</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span>] : <span class="id" title="var">form_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'splitinjfun' A &gt;-&gt; B }" := (@<span class="id" title="var">SplitInjFun.type</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'splitinjfun'  'of'  f ]" :=<br/>
&nbsp;&nbsp;[<span class="id" title="var">the</span> {<span class="id" title="var">splitinjfun</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span>] : <span class="id" title="var">form_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'bij' A &gt;-&gt; B }" := (@<span class="id" title="var">Bij.type</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'bij'  'of'  f ]" := [<span class="id" title="var">the</span> {<span class="id" title="var">bij</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span>] : <span class="id" title="var">form_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;{ 'splitbij' A &gt;-&gt; B }" := (@<span class="id" title="var">SplitBij.type</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'splitbij'  'of'  f ]" := [<span class="id" title="var">the</span> {<span class="id" title="var">splitbij</span> <span class="id" title="var">_</span> &gt;-&gt; <span class="id" title="var">_</span>} <span class="id" title="keyword">of</span> <span class="id" title="var">f</span>] : <span class="id" title="var">form_scope</span>.<br/>

<br/>
</div>

<div class="doc">
 begin hide 
 Hint View for move / Inversible.sort inv | 2. 
 Hint View for apply / Inversible.sort inv | 2. 
 end hide  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">ShortFunSyntax</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;A ~&gt; B" := {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;aT &lt;=&gt; rT" := {<span class="id" title="var">oinv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;A &lt;~ B" := {<span class="id" title="var">oinvfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;aT &lt;&lt;=&gt; rT" := {<span class="id" title="var">inv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;A &lt;&lt;~ B" := {<span class="id" title="var">invfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;A =&gt;&gt; B" := {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;A ~&gt;&gt; B" := {<span class="id" title="var">surjfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;A ==&gt;&gt; B" := {<span class="id" title="var">splitsurj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;A ~~&gt;&gt; B" := {<span class="id" title="var">splitsurjfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;A &gt;=&gt; rT" := {<span class="id" title="var">inj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;A &gt;~&gt; B" := {<span class="id" title="var">injfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;A &gt;&gt;=&gt; rT" := {<span class="id" title="var">splitinj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;A &gt;&gt;~&gt; B" := {<span class="id" title="var">splitinjfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;A &lt;~&gt; B" := {<span class="id" title="var">bij</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;A &lt;&lt;~&gt; B" := {<span class="id" title="var">splitbij</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">ShortFunSyntax</span>.<br/>

<br/>
</div>

<div class="doc">
 Theory  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_funS</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) <span class="id" title="keyword">of</span> <span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">funS</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;'funS_  f" := (<span class="id" title="var">phant_funS</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2) : <span class="id" title="var">form_scope</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<span class="id" title="var">set_fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ⇒ <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">apply</span>: <span class="id" title="var">funS</span>] : <span class="id" title="var">core</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<span class="id" title="var">prop_in1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ⇒ <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">apply</span>: <span class="id" title="var">funS</span>] : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fun_image_sub</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">image_subP</span>.2 (@<span class="id" title="var">funS</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">fun_image_sub</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>}.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<span class="id" title="var">_</span> @` <span class="id" title="var">_</span> `&lt;=` <span class="id" title="var">_</span>) ⇒ <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">apply</span>: <span class="id" title="var">fun_image_sub</span>] : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mem_fun</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">homo_setP</span>.2 (@<span class="id" title="var">funS</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>).<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<span class="id" title="var">prop_in1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ⇒ <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">apply</span>: <span class="id" title="var">mem_fun</span>] : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_mem_fun</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) <span class="id" title="keyword">of</span> <span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := <span class="id" title="var">homo_setP</span>.2 (@<span class="id" title="var">funS</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Notation</span> &quot;'mem_fun_  f" := (<span class="id" title="var">phant_mem_fun</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 8, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2) : <span class="id" title="var">form_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">some_inv</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">f</span> : {<span class="id" title="var">inv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>}) <span class="id" title="var">x</span> : <span class="id" title="var">Some</span> (<span class="id" title="var">f</span>^-1 <span class="id" title="var">x</span>) = '<span class="id" title="var">oinv_f</span> <span class="id" title="var">x</span>.<br/>
 
<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_oinvK</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) <span class="id" title="keyword">of</span> <span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">oinvK</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;'oinvK_ f" := (<span class="id" title="var">phant_oinvK</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>)) : <span class="id" title="var">form_scope</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="var">oinvK</span> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_oinvS</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) <span class="id" title="keyword">of</span> <span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">oinvS</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;'oinvS_ f" := (<span class="id" title="var">phant_oinvS</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>)) : <span class="id" title="var">form_scope</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="var">oinvS</span> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Variant</span> <span class="id" title="var">oinv_spec</span> {<span class="id" title="var">aT</span>} {<span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) <span class="id" title="var">y</span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">rT</span> → <span class="id" title="var">option</span> <span class="id" title="var">aT</span> → <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">OInvSpec</span> (<span class="id" title="var">x</span> : <span class="id" title="var">aT</span>) <span class="id" title="keyword">of</span> <span class="id" title="var">A</span> <span class="id" title="var">x</span> &amp; <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">y</span> : <span class="id" title="var">oinv_spec</span> <span class="id" title="var">f</span> <span class="id" title="var">y</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="var">Some</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinvP</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) (<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) <span class="id" title="var">y</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">B</span> <span class="id" title="var">y</span> → <span class="id" title="var">oinv_spec</span> <span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">y</span> ('<span class="id" title="var">oinv_f</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_oinvP</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) <span class="id" title="keyword">of</span> <span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">oinvP</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;'oinvP_ f" := (<span class="id" title="var">phant_oinvP</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>)) : <span class="id" title="var">form_scope</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="var">oinvP</span> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinvT</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}} <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">B</span> <span class="id" title="var">x</span> → '<span class="id" title="var">oinv_f</span> <span class="id" title="var">x</span>.<br/>
 <span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_oinvT</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) <span class="id" title="keyword">of</span> <span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">oinvT</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;'oinvT_ f" := (<span class="id" title="var">phant_oinvT</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>)) : <span class="id" title="var">form_scope</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="var">oinvT</span> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">invK</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">splitsurj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}} :<br/>
&nbsp;&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">B</span>, <span class="id" title="var">cancel</span> <span class="id" title="var">f</span>^-1 <span class="id" title="var">f</span>}.<br/>
 <span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_invK</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : {<span class="id" title="var">splitsurj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) <span class="id" title="keyword">of</span> <span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">invK</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;'invK_ f" := (<span class="id" title="var">phant_invK</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>)) : <span class="id" title="var">form_scope</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="var">invK</span> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">invS</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">splitsurj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}} :<br/>
&nbsp;&nbsp;{<span class="id" title="var">homo</span> <span class="id" title="var">f</span>^-1 : <span class="id" title="var">x</span> / <span class="id" title="var">B</span> <span class="id" title="var">x</span> &gt;-&gt; <span class="id" title="var">A</span> <span class="id" title="var">x</span>}.<br/>
 <span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_invS</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>)<br/>
&nbsp;&nbsp;&nbsp;{<span class="id" title="var">f</span> : {<span class="id" title="var">splitsurjfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}} <span class="id" title="keyword">of</span> <span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">invS</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;'invS_ f" := (<span class="id" title="var">phant_invS</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>)) : <span class="id" title="var">form_scope</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="var">invS</span> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_funoK</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">f</span> : {<span class="id" title="var">inj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>})<br/>
&nbsp;&nbsp;<span class="id" title="keyword">of</span> <span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">funoK</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;'funoK_ f" := (<span class="id" title="var">phant_funoK</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>)) : <span class="id" title="var">form_scope</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="var">funoK</span> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">inj</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="var">nonPropType</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">inj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>}} :<br/>
&nbsp;&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>} := <span class="id" title="var">pcan_in_inj</span> <span class="id" title="var">funoK</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_inj</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">f</span> : {<span class="id" title="var">inj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>}) <span class="id" title="keyword">of</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">inj</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;'inj_ f" := (<span class="id" title="var">phant_inj</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>)) : <span class="id" title="var">form_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">inj_hint</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">inj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>}} :<br/>
&nbsp;&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>} := <span class="id" title="var">inj</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 {<span class="id" title="tactic">in</span> <span class="id" title="var">_</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">_</span>} ⇒ <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">apply</span>: <span class="id" title="var">inj_hint</span>] : <span class="id" title="var">core</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<span class="id" title="var">set_inj</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ⇒ <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">apply</span>: <span class="id" title="var">inj_hint</span>] : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">injT</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">inj</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">aT</span>] &gt;-&gt; <span class="id" title="var">rT</span>}} : <span class="id" title="var">injective</span> <span class="id" title="var">f</span>.<br/>
 #[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<span class="id" title="var">injective</span> <span class="id" title="var">_</span>) ⇒ <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">apply</span>: <span class="id" title="var">injT</span>] : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">funK</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">s</span> : {<span class="id" title="var">splitinj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>}} :<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">cancel</span> <span class="id" title="var">s</span> <span class="id" title="var">s</span>^-1}.<br/>
 
<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_funK</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">f</span> : {<span class="id" title="var">splitinj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>})<br/>
&nbsp;&nbsp;<span class="id" title="keyword">of</span> <span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">funK</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;'funK_  f" := (<span class="id" title="var">phant_funK</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>)) : <span class="id" title="var">form_scope</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="var">funK</span> : <span class="id" title="var">core</span>.<br/>

<br/>
</div>

<div class="doc">
 Structure Equality  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">funP</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) :<br/>
&nbsp;&nbsp;<span class="id" title="var">f</span> = <span class="id" title="var">g</span> ↔ <span class="id" title="var">f</span> =1 <span class="id" title="var">g</span>.<br/>

<br/>
</div>

<div class="doc">
 Preliminary Builders  
</div>
<div class="code">

<br/>
 
<br/>
&nbsp;&nbsp;#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinvK</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">B</span>, <span class="id" title="var">ocancel</span> '<span class="id" title="var">oinv_f</span> <span class="id" title="var">f</span>}.<br/>
 &nbsp;&nbsp;#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinvS</span> : {<span class="id" title="var">homo</span> '<span class="id" title="var">oinv_f</span> : <span class="id" title="var">x</span> / <span class="id" title="var">B</span> <span class="id" title="var">x</span> &gt;-&gt; (<span class="id" title="var">some</span> @` <span class="id" title="var">A</span>) <span class="id" title="var">x</span>}.<br/>
 
<br/>
</div>

<div class="doc">
 Trivial instances  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">OInverse</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>}.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinvV</span> {<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>}} : '<span class="id" title="var">oinv_</span>('<span class="id" title="var">oinv_f</span>) = <span class="id" title="var">omap</span> <span class="id" title="var">f</span>.<br/>
 
<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surjoinv_inj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : <span class="id" title="var">OInv_Can</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">B</span> '<span class="id" title="var">oinv_f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">injoinv_surj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">injfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) :<br/>
&nbsp;&nbsp;<span class="id" title="var">OInv_CanV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">B</span> (<span class="id" title="var">some</span> @` <span class="id" title="var">A</span>) '<span class="id" title="var">oinv_f</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">OInverse</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Inverse</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>}.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">invV</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">inv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>}) : <span class="id" title="var">f</span>^-1^-1 = <span class="id" title="var">f</span>.  <br/>

<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Inverse</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Some</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">T</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>}.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_some</span> : '<span class="id" title="var">oinv_</span>(@<span class="id" title="var">Some</span> <span class="id" title="var">T</span>) = <span class="id" title="var">id</span>.  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">some_can_subproof</span> : @<span class="id" title="var">OInv_Can</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> (@<span class="id" title="var">Some</span> <span class="id" title="var">T</span>).  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">some_canV_subproof</span> : <span class="id" title="var">OInv_CanV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> (<span class="id" title="var">some</span> @` <span class="id" title="var">A</span>) (@<span class="id" title="var">Some</span> <span class="id" title="var">T</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">some_fun_subproof</span> : <span class="id" title="var">isFun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> (<span class="id" title="var">some</span> @` <span class="id" title="var">A</span>) (@<span class="id" title="var">Some</span> <span class="id" title="var">T</span>).<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Some</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">OApply</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">b0</span> : <span class="id" title="var">rT</span>}.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_oapp</span> {<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>}} : (<span class="id" title="var">oapp</span> <span class="id" title="var">f</span>)^-1 = '<span class="id" title="var">oinv_f</span>.<br/>
 <span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_oapp</span>  {<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>}} : '<span class="id" title="var">oinv_</span>(<span class="id" title="var">oapp</span> <span class="id" title="var">f</span>) = <span class="id" title="var">olift</span> '<span class="id" title="var">oinv_f</span>.<br/>
 <span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_oappV</span> {<span class="id" title="var">f</span> : {<span class="id" title="var">inv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>}} : <span class="id" title="var">olift</span> <span class="id" title="var">f</span>^-1 = (<span class="id" title="var">oapp</span> <span class="id" title="var">f</span>)^-1.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oapp_can_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">inj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>}) : <span class="id" title="var">Inv_Can</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">some</span> @` <span class="id" title="var">A</span>) (<span class="id" title="var">oapp</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oapp_surj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : <span class="id" title="var">Inv_CanV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">some</span> @` <span class="id" title="var">A</span>) <span class="id" title="var">B</span> (<span class="id" title="var">oapp</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oapp_fun_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : <span class="id" title="var">isFun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">some</span> @` <span class="id" title="var">A</span>) <span class="id" title="var">B</span> (<span class="id" title="var">oapp</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">OApply</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">OBind</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> (<span class="id" title="var">option</span> <span class="id" title="var">rT</span>)}.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_obind</span> {<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">orT</span>}} : (<span class="id" title="var">obind</span> <span class="id" title="var">f</span>)^-1 = '<span class="id" title="var">oinv_f</span>.<br/>
 <span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_obind</span> {<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">orT</span>}} : '<span class="id" title="var">oinv_</span>(<span class="id" title="var">obind</span> <span class="id" title="var">f</span>) = <span class="id" title="var">olift</span> '<span class="id" title="var">oinv_f</span>.<br/>
 <span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_obindV</span> {<span class="id" title="var">f</span> : {<span class="id" title="var">inv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">orT</span>}} : (<span class="id" title="var">obind</span> <span class="id" title="var">f</span>)^-1 = <span class="id" title="var">olift</span> <span class="id" title="var">f</span>^-1.<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">OBind</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Composition</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">sT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">C</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">sT</span>}.<br/>

<br/>
 
<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">OInv</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>}} {<span class="id" title="var">g</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">rT</span> &gt;-&gt; <span class="id" title="var">sT</span>}}.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_comp</span> : '<span class="id" title="var">oinv_</span>(<span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>) = (<span class="id" title="var">obind</span> '<span class="id" title="var">oinv_f</span>) \<span class="id" title="var">o</span> '<span class="id" title="var">oinv_g</span>.<br/>
 <span class="id" title="keyword">End</span> <span class="id" title="var">OInv</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">OInv</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">f</span> : {<span class="id" title="var">inv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>}} {<span class="id" title="var">g</span> : {<span class="id" title="var">inv</span> <span class="id" title="var">rT</span> &gt;-&gt; <span class="id" title="var">sT</span>}}.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">some_comp_inv</span> : <span class="id" title="var">olift</span> (<span class="id" title="var">f</span>^-1 \<span class="id" title="var">o</span> <span class="id" title="var">g</span>^-1) = '<span class="id" title="var">oinv_</span>(<span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>).<br/>
 <span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_comp</span> : (<span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>)^-1 = <span class="id" title="var">f</span>^-1 \<span class="id" title="var">o</span> <span class="id" title="var">g</span>^-1.  <br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">OInv</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">comp_can_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">injfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) (<span class="id" title="var">g</span> : {<span class="id" title="var">inj</span> <span class="id" title="var">B</span> &gt;-&gt; <span class="id" title="var">sT</span>}) :<br/>
&nbsp;&nbsp;<span class="id" title="var">OInv_Can</span> <span class="id" title="var">aT</span> <span class="id" title="var">sT</span> <span class="id" title="var">A</span> (<span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Composition</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Composition</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">sT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">C</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">sT</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">comp_surj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) (<span class="id" title="var">g</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">B</span> &gt;-&gt; <span class="id" title="var">C</span>}) :<br/>
&nbsp;&nbsp;<span class="id" title="var">OInv_CanV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> (<span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Composition</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">totalfun</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>}.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">totalfun_</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) := <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>}.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">totalfun</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;''totalfun_' A" := (<span class="id" title="var">totalfun_</span> <span class="id" title="var">A</span>) : <span class="id" title="var">form_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">totalfun</span> := (<span class="id" title="var">totalfun_</span> <span class="id" title="var">setT</span>).<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Olift</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>}.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_olift</span>  {<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>}} : '<span class="id" title="var">oinv_</span>(<span class="id" title="var">olift</span> <span class="id" title="var">f</span>) = <span class="id" title="var">obind</span> '<span class="id" title="var">oinv_f</span>.<br/>
 
<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Olift</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Map</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>}.<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_omap</span> {<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>}} : (<span class="id" title="var">omap</span> <span class="id" title="var">f</span>)^-1 = <span class="id" title="var">obind</span> '<span class="id" title="var">oinv_f</span>.<br/>
 <span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_omap</span> {<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>}} : '<span class="id" title="var">oinv_</span>(<span class="id" title="var">omap</span> <span class="id" title="var">f</span>) = <span class="id" title="var">olift</span> (<span class="id" title="var">obind</span> '<span class="id" title="var">oinv_f</span>).<br/>
 <span class="id" title="keyword">Lemma</span> <span class="id" title="var">omapV</span> {<span class="id" title="var">f</span> : {<span class="id" title="var">inv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>}} : <span class="id" title="var">omap</span> <span class="id" title="var">f</span>^-1 = (<span class="id" title="var">omap</span> <span class="id" title="var">f</span>)^-1.<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Map</span>.<br/>

<br/>
</div>

<div class="doc">
 Builders  
</div>
<div class="code">

<br/>

<br/>

<br/>

<br/>
<span class="comment">(*&nbsp;bug&nbsp;if&nbsp;swap&nbsp;f&nbsp;and&nbsp;A&nbsp;*)</span><br/>

<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <span class="id" title="var">mem_inv</span> := <span class="id" title="var">homo_setP</span>.2 <span class="id" title="var">invS</span>.<br/>
 
<br/>
 
<br/>
</div>

<div class="doc">
 Fun in  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">surj_oinv</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>} (<span class="id" title="var">fsurj</span> : <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">surjective_oinv</span> (<span class="id" title="var">y</span> : <span class="id" title="var">rT</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">pselect</span> (<span class="id" title="var">B</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">is</span> <span class="id" title="tactic">left</span> <span class="id" title="var">By</span> <span class="id" title="keyword">then</span> <span class="id" title="var">some</span> (<span class="id" title="var">projT1</span> (<span class="id" title="var">cid2</span> (<span class="id" title="var">fsurj</span> <span class="id" title="var">By</span>))) <span class="id" title="keyword">else</span> <span class="id" title="var">None</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surjective_oinvK</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">B</span>, <span class="id" title="var">ocancel</span> <span class="id" title="var">surjective_oinv</span> <span class="id" title="var">f</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surjective_oinvS</span> : <span class="id" title="var">set_fun</span> <span class="id" title="var">B</span> (<span class="id" title="var">some</span> @` <span class="id" title="var">A</span>) <span class="id" title="var">surjective_oinv</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">surj_oinv</span>.<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">surjective_ocanV</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fS</span> : <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">OCanV.Build</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> (<span class="id" title="var">surjective_oinvS</span> <span class="id" title="var">fS</span>) (<span class="id" title="var">surjective_oinvK</span> <span class="id" title="var">fS</span>).<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Psurj</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>} (<span class="id" title="var">fsurj</span> : <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>).<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> : <span class="id" title="var">OCanV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> := <span class="id" title="var">fsurj</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">surjection_of_surj</span> := [<span class="id" title="var">surj</span> <span class="id" title="keyword">of</span> <span class="id" title="var">f</span>].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Psurj</span> : {<span class="id" title="var">s</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">s</span>}.  <br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Psurj</span>.<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">surjection_of_surj</span> : <span class="id" title="var">set_surj</span> &gt;-&gt; <span class="id" title="var">Surject.type</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_surj</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>}<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fS</span> : <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>) <span class="id" title="var">y</span> :<br/>
&nbsp;'<span class="id" title="var">oinv_fS</span> <span class="id" title="var">y</span> = <span class="id" title="keyword">if</span> <span class="id" title="var">pselect</span> (<span class="id" title="var">B</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">is</span> <span class="id" title="tactic">left</span> <span class="id" title="var">By</span> <span class="id" title="keyword">then</span> <span class="id" title="var">some</span> (<span class="id" title="var">projT1</span> (<span class="id" title="var">cid2</span> (<span class="id" title="var">fS</span> <span class="id" title="var">y</span> <span class="id" title="var">By</span>))) <span class="id" title="keyword">else</span> <span class="id" title="var">None</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surj</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}} : <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_surj</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) (<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>})<br/>
&nbsp;&nbsp;<span class="id" title="keyword">of</span> <span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">surj</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;'surj_  f" := (<span class="id" title="var">phant_surj</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>)) : <span class="id" title="var">form_scope</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<span class="id" title="var">set_surj</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ⇒ <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">apply</span>: <span class="id" title="var">surj</span>] : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">funin_surj</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">funin</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) := <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_fun_image</span> : <span class="id" title="var">set_fun</span> <span class="id" title="var">A</span> (<span class="id" title="var">f</span> @` <span class="id" title="var">A</span>) <span class="id" title="var">f</span>.<br/>
 
<br/>

<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">funin_surj</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[ 'fun' f 'in' A ]" := (<span class="id" title="var">funin</span> <span class="id" title="var">A</span> <span class="id" title="var">f</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="var">next</span> <span class="id" title="keyword">level</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">format</span> "[ 'fun'  f  'in'  A ]") : <span class="id" title="var">function_scope</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="var">set_fun_image</span> : <span class="id" title="var">core</span>.<br/>

<br/>
</div>

<div class="doc">
 Partial injection  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">split_</span> (<span class="id" title="var">dflt</span> : <span class="id" title="var">rT</span> → <span class="id" title="var">aT</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) := <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span> (<span class="id" title="var">dflt</span> : <span class="id" title="var">rT</span> → <span class="id" title="var">aT</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">oinv</span>.<br/>
<span class="id" title="keyword">Context</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">rT</span>}).<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">g</span> <span class="id" title="var">y</span> := <span class="id" title="var">odflt</span> (<span class="id" title="var">dflt</span> <span class="id" title="var">y</span>) ('<span class="id" title="var">oinv_f</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splitV</span> : (<span class="id" title="tactic">split</span> <span class="id" title="var">f</span>)^-1 = <span class="id" title="var">g</span>.  <br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">oinv</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splitis_inj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">inj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>}) : <span class="id" title="var">Inv_Can</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splitid</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">splitinjfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : (<span class="id" title="tactic">split</span> <span class="id" title="var">f</span>)^-1 = <span class="id" title="var">f</span>^-1.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splitsurj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : <span class="id" title="var">Inv_CanV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">f</span>).<br/>
 
<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;''split_' a" := (<span class="id" title="var">split_</span> <span class="id" title="var">a</span>) : <span class="id" title="var">form_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="tactic">split</span> := '<span class="id" title="var">split_point</span>.<br/>

<br/>
</div>

<div class="doc">
 More Builders  
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">funoK</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">pcancel</span> <span class="id" title="var">f</span> '<span class="id" title="var">oinv_f</span>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <span class="id" title="var">g</span> := <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <span class="id" title="var">fcan</span> : <span class="id" title="var">OInv_Can</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">A</span> <span class="id" title="var">f</span>.<br/>

<br/>
 
<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Inverses</span>.<br/>
<span class="id" title="keyword">Context</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>}.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Inverses</span>.<br/>

<br/>
</div>

<div class="doc">
 Simple Factories  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Pinj</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>} (<span class="id" title="var">finj</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>}).<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">Inj.Build</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">finj</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pinj</span> : {<span class="id" title="var">i</span> : {<span class="id" title="var">inj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">i</span>}.  <br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Pinj</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Pfun</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">ffun</span> : {<span class="id" title="var">homo</span> <span class="id" title="var">f</span> : <span class="id" title="var">x</span> / <span class="id" title="var">A</span> <span class="id" title="var">x</span> &gt;-&gt; <span class="id" title="var">B</span> <span class="id" title="var">x</span>}).<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">g</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span> := <span class="id" title="var">f</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">isFun.Build</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">g</span> <span class="id" title="var">ffun</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pfun</span> : {<span class="id" title="var">i</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">i</span>}.  <br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Pfun</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">injPfun</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">inj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>}}<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ffun</span> : {<span class="id" title="var">homo</span> <span class="id" title="var">f</span> : <span class="id" title="var">x</span> / <span class="id" title="var">A</span> <span class="id" title="var">x</span> &gt;-&gt; <span class="id" title="var">B</span> <span class="id" title="var">x</span>}).<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">g</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span> := <span class="id" title="var">f</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">Inject.on</span> <span class="id" title="var">g</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">isFun.Build</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">g</span> <span class="id" title="var">ffun</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">injPfun</span> : {<span class="id" title="var">i</span> : {<span class="id" title="var">injfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">i</span> :&gt; (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>)}.<br/>
 <span class="id" title="keyword">End</span> <span class="id" title="var">injPfun</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">funPinj</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}}<br/>
&nbsp;&nbsp;(<span class="id" title="var">finj</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>}).<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">g</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span> := <span class="id" title="var">f</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">Fun.on</span> <span class="id" title="var">g</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">Inj.Build</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">g</span> <span class="id" title="var">finj</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">funPinj</span> : {<span class="id" title="var">i</span> : {<span class="id" title="var">injfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">i</span>}.<br/>
 <span class="id" title="keyword">End</span> <span class="id" title="var">funPinj</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">funPsurj</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fsurj</span> : <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">g</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span> := <span class="id" title="var">f</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">Fun.on</span> <span class="id" title="var">g</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> : <span class="id" title="var">OCanV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">g</span> := <span class="id" title="var">fsurj</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">funPsurj</span> : {<span class="id" title="var">s</span> : {<span class="id" title="var">surjfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">s</span>}.<br/>
 <span class="id" title="keyword">End</span> <span class="id" title="var">funPsurj</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">surjPfun</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}}<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ffun</span> : {<span class="id" title="var">homo</span> <span class="id" title="var">f</span> : <span class="id" title="var">x</span> / <span class="id" title="var">A</span> <span class="id" title="var">x</span> &gt;-&gt; <span class="id" title="var">B</span> <span class="id" title="var">x</span>}).<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">g</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span> := <span class="id" title="var">f</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">Surject.on</span> <span class="id" title="var">g</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">isFun.Build</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">g</span> <span class="id" title="var">ffun</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surjPfun</span> : {<span class="id" title="var">s</span> : {<span class="id" title="var">surjfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">s</span> :&gt; (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>)}.<br/>
 <span class="id" title="keyword">End</span> <span class="id" title="var">surjPfun</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Psplitinj</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>} {<span class="id" title="var">g</span>} (<span class="id" title="var">funK</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">cancel</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>}).<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">Can.Build</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">f</span> <span class="id" title="var">funK</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Psplitinj</span> : {<span class="id" title="var">i</span> : {<span class="id" title="var">splitinj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">i</span>}.<br/>
 <span class="id" title="keyword">End</span> <span class="id" title="var">Psplitinj</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">funPsplitinj</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}}.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">g</span>} (<span class="id" title="var">funK</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">cancel</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>}).<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">f'</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span> := <span class="id" title="var">f</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">Fun.on</span> <span class="id" title="var">f'</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">Can.Build</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">f'</span> <span class="id" title="var">funK</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">funPsplitinj</span> : {<span class="id" title="var">i</span> : {<span class="id" title="var">splitinjfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">i</span>}.<br/>
 <span class="id" title="keyword">End</span> <span class="id" title="var">funPsplitinj</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">PsplitinjT</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>} {<span class="id" title="var">g</span>} : <span class="id" title="var">cancel</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> →<br/>
&nbsp;&nbsp;{<span class="id" title="var">i</span> : {<span class="id" title="var">splitinj</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">aT</span>] &gt;-&gt; <span class="id" title="var">rT</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">i</span>}.<br/>
 
<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">funPsplitsurj</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}}.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">g</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">B</span> &gt;-&gt; <span class="id" title="var">A</span>}} (<span class="id" title="var">funK</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">B</span>, <span class="id" title="var">cancel</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>}).<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">f'</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span> := <span class="id" title="var">f</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">Fun.on</span> <span class="id" title="var">f'</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">CanV.Build</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f'</span> <span class="id" title="var">funS</span> <span class="id" title="var">funK</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">funPsplitsurj</span> : {<span class="id" title="var">s</span> : {<span class="id" title="var">splitsurjfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">s</span> :&gt; (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>)}.<br/>
 <span class="id" title="keyword">End</span> <span class="id" title="var">funPsplitsurj</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">PsplitsurjT</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>} {<span class="id" title="var">g</span>} : <span class="id" title="var">cancel</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span> →<br/>
&nbsp;&nbsp;{<span class="id" title="var">s</span> : {<span class="id" title="var">splitsurjfun</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">aT</span>] &gt;-&gt; [<span class="id" title="tactic">set</span>: <span class="id" title="var">rT</span>]} | <span class="id" title="var">f</span> = <span class="id" title="var">s</span>}.<br/>

<br/>
</div>

<div class="doc">
 Instances  
<div class="paragraph"> </div>

  The identity is a split bijection  
</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
 Iteration preserves Fun, Injectivity, and Surjectivity  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">iter_inv</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>}.<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">OInv</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">aT</span>}}.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_iter</span> <span class="id" title="var">n</span> : '<span class="id" title="var">oinv_</span>(<span class="id" title="var">iter</span> <span class="id" title="var">n</span> <span class="id" title="var">f</span>) = <span class="id" title="var">iter</span> <span class="id" title="var">n</span> (<span class="id" title="var">obind</span> '<span class="id" title="var">oinv_f</span>) \<span class="id" title="var">o</span> <span class="id" title="var">some</span>.<br/>
 <span class="id" title="keyword">End</span> <span class="id" title="var">OInv</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">OInv</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">f</span> : {<span class="id" title="var">inv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">aT</span>}}.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">some_iter_inv</span> <span class="id" title="var">n</span> : <span class="id" title="var">olift</span> (<span class="id" title="var">iter</span> <span class="id" title="var">n</span> <span class="id" title="var">f</span>^-1) = '<span class="id" title="var">oinv_</span>(<span class="id" title="var">iter</span> <span class="id" title="var">n</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_iter</span> <span class="id" title="var">n</span> : (<span class="id" title="var">iter</span> <span class="id" title="var">n</span> <span class="id" title="var">f</span>)^-1 = <span class="id" title="var">iter</span> <span class="id" title="var">n</span> <span class="id" title="var">f</span>^-1.  <br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">OInv</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iter_can_subproof</span> <span class="id" title="var">n</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">injfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">A</span>}) : <span class="id" title="var">OInv_Can</span> <span class="id" title="var">aT</span> <span class="id" title="var">aT</span> <span class="id" title="var">A</span> (<span class="id" title="var">iter</span> <span class="id" title="var">n</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">iter_inv</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">iter_surj</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iter_surj_subproof</span> <span class="id" title="var">n</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">A</span>}) : <span class="id" title="var">OInv_CanV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">A</span> (<span class="id" title="var">iter</span> <span class="id" title="var">n</span> <span class="id" title="var">f</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">iter_surj</span>.<br/>

<br/>
</div>

<div class="doc">
 Unbind  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Unbind</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">dflt</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unbind</span> (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">option</span> <span class="id" title="var">rT</span>) <span class="id" title="var">x</span> := <span class="id" title="var">odflt</span> (<span class="id" title="var">dflt</span> <span class="id" title="var">x</span>) (<span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">unbind_fun_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">some</span> @` <span class="id" title="var">B</span>}) : <span class="id" title="var">isFun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">unbind</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Oinv</span>.<br/>
<span class="id" title="keyword">Context</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">option</span> <span class="id" title="var">rT</span>}).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_unbind</span> : '<span class="id" title="var">oinv_</span>(<span class="id" title="var">unbind</span> <span class="id" title="var">f</span>) = '<span class="id" title="var">oinv_f</span> \<span class="id" title="var">o</span> <span class="id" title="var">some</span>.  <br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Oinv</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Inv</span>.<br/>
<span class="id" title="keyword">Context</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">inv</span> <span class="id" title="var">aT</span> &gt;-&gt; <span class="id" title="var">option</span> <span class="id" title="var">rT</span>}).<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_unbind_subproof</span> : <span class="id" title="var">olift</span> (<span class="id" title="var">f</span>^-1 \<span class="id" title="var">o</span> <span class="id" title="var">some</span>) = '<span class="id" title="var">oinv_</span>(<span class="id" title="var">unbind</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_unbind</span> : (<span class="id" title="var">unbind</span> <span class="id" title="var">f</span>)^-1 = <span class="id" title="var">f</span>^-1 \<span class="id" title="var">o</span> <span class="id" title="var">some</span>.  <br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Inv</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">unbind_inj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">injfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">some</span> @` <span class="id" title="var">B</span>}) :<br/>
&nbsp;&nbsp;&nbsp;@<span class="id" title="var">OInv_Can</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> (<span class="id" title="var">unbind</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">unbind_surj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">some</span> @` <span class="id" title="var">B</span>}) :<br/>
&nbsp;&nbsp;&nbsp;@<span class="id" title="var">OInv_CanV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">unbind</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Unbind</span>.<br/>

<br/>
</div>

<div class="doc">
 Odflt  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Odflt</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">T</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">T</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">odflt_unbind</span> : <span class="id" title="var">odflt</span> <span class="id" title="var">x</span> = <span class="id" title="var">unbind</span> (<span class="id" title="keyword">fun</span>⇒ <span class="id" title="var">x</span>) <span class="id" title="var">idfun</span>.  <br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Odflt</span>.<br/>

<br/>
</div>

<div class="doc">
 Subtypes  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">SubType</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">T</span>} (<span class="id" title="var">sT</span> : <span class="id" title="var">subType</span> <span class="id" title="var">P</span>) (<span class="id" title="var">x0</span> : <span class="id" title="var">sT</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_val</span> : '<span class="id" title="var">oinv_val</span> = <span class="id" title="var">insub</span>.  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">val_bij_subproof</span> : <span class="id" title="var">OInv_Can2</span> <span class="id" title="var">sT</span> <span class="id" title="var">T</span> <span class="id" title="var">setT</span> [<span class="id" title="tactic">set</span>` <span class="id" title="var">P</span>] <span class="id" title="var">val</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_insubd</span> : (<span class="id" title="var">insubd</span> <span class="id" title="var">x0</span>)^-1 = <span class="id" title="var">val</span>.  <br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">SubType</span>.<br/>

<br/>
</div>

<div class="doc">
 To setT  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">to_setT</span> {<span class="id" title="var">T</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">T</span>) : [<span class="id" title="tactic">set</span>: <span class="id" title="var">T</span>] :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">SigSub</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> (<span class="id" title="var">mem_set</span> <span class="id" title="var">I</span> : <span class="id" title="var">x</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">setT</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">setTbij</span> {<span class="id" title="var">T</span>} := [<span class="id" title="var">splitbij</span> <span class="id" title="keyword">of</span> @<span class="id" title="var">to_setT</span> <span class="id" title="var">T</span>].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_to_setT</span> <span class="id" title="var">T</span> : (@<span class="id" title="var">to_setT</span> <span class="id" title="var">T</span>)^-1 = <span class="id" title="var">val</span>.  <br/>

<br/>
</div>

<div class="doc">
 Subfun  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">subfun</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">T</span>} {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subfun</span> (<span class="id" title="var">AB</span> : <span class="id" title="var">A</span> `&lt;=` <span class="id" title="var">B</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">B</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">SigSub</span> (<span class="id" title="var">mem_set</span> (<span class="id" title="var">AB</span> <span class="id" title="var">_</span> (<span class="id" title="var">set_valP</span> <span class="id" title="var">a</span>))).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subfun_inj</span> {<span class="id" title="var">AB</span> : <span class="id" title="var">A</span> `&lt;=` <span class="id" title="var">B</span>} : <span class="id" title="var">injective</span> (<span class="id" title="var">subfun</span> <span class="id" title="var">AB</span>).<br/>
 
<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">subfun</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">subfun_eq</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">T</span>} {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subfun_imageT</span> (<span class="id" title="var">AB</span> : <span class="id" title="var">A</span> `&lt;=` <span class="id" title="var">B</span>) (<span class="id" title="var">BA</span> : <span class="id" title="var">B</span> `&lt;=` <span class="id" title="var">A</span>) : <span class="id" title="var">subfun</span> <span class="id" title="var">AB</span> @` <span class="id" title="var">setT</span> = <span class="id" title="var">setT</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subfun_inv_subproof</span> (<span class="id" title="var">AB</span> : <span class="id" title="var">A</span> = <span class="id" title="var">B</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">olift</span> (<span class="id" title="var">subfun</span> (<span class="id" title="var">subsetCW</span> <span class="id" title="var">AB</span>)) = '<span class="id" title="var">oinv_</span>(<span class="id" title="var">subfun</span> (<span class="id" title="var">subsetW</span> <span class="id" title="var">AB</span>)).<br/>
</div>

<div class="doc">
 Add a Inj_Can factory  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">subfun_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">seteqfun</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">seteqfun</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>} (<span class="id" title="var">AB</span> : <span class="id" title="var">A</span> = <span class="id" title="var">B</span>) := <span class="id" title="var">subfun</span> (<span class="id" title="var">subsetW</span> <span class="id" title="var">AB</span>).<br/>

<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>} (<span class="id" title="var">AB</span> : <span class="id" title="var">A</span> = <span class="id" title="var">B</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">seteqfun_can2_subproof</span> : <span class="id" title="var">Inv_Can2</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">setT</span> <span class="id" title="var">setT</span> (<span class="id" title="var">seteqfun</span> <span class="id" title="var">AB</span>).<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">seteqfun</span>.<br/>

<br/>
</div>

<div class="doc">
 Inclusion  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">incl</span>.<br/>
<span class="id" title="keyword">Context</span>  {<span class="id" title="var">T</span>} {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>}.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">incl</span> (<span class="id" title="var">AB</span> : <span class="id" title="var">A</span> `&lt;=` <span class="id" title="var">B</span>) := @<span class="id" title="var">id</span> <span class="id" title="var">T</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">eqincl</span> (<span class="id" title="var">AB</span> : <span class="id" title="var">A</span> = <span class="id" title="var">B</span>) := <span class="id" title="var">incl</span> (<span class="id" title="var">subsetW</span> <span class="id" title="var">AB</span>).<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eqincl_surj</span> <span class="id" title="var">AB</span> : <span class="id" title="var">Inv_Can2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">eqincl</span> <span class="id" title="var">AB</span>).<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">incl</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">inclT</span> <span class="id" title="var">A</span> := (<span class="id" title="var">incl</span> (@<span class="id" title="var">subsetT</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>

<br/>
</div>

<div class="doc">
 Ad hoc function  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">mkfun</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span>} {<span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>}.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">isfun</span> <span class="id" title="var">f</span> := {<span class="id" title="var">homo</span> <span class="id" title="var">f</span> : <span class="id" title="var">x</span> / <span class="id" title="var">A</span> <span class="id" title="var">x</span> &gt;-&gt; <span class="id" title="var">B</span> <span class="id" title="var">x</span>}.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mkfun</span> <span class="id" title="var">f</span> (<span class="id" title="var">fAB</span> : <span class="id" title="var">isfun</span> <span class="id" title="var">f</span>) := <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mkfun_fun</span> <span class="id" title="var">f</span> <span class="id" title="var">fAB</span> := [<span class="id" title="keyword">fun</span> <span class="id" title="keyword">of</span> @<span class="id" title="var">mkfun</span> <span class="id" title="var">f</span> <span class="id" title="var">fAB</span>].<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">mkfun</span>.<br/>

<br/>
</div>

<div class="doc">
 set_val  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">set_val</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">T</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>}.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">set_val</span> : <span class="id" title="var">A</span> → <span class="id" title="var">T</span> := <span class="id" title="var">eqincl</span> (<span class="id" title="var">set_mem_set</span> <span class="id" title="var">A</span>) \<span class="id" title="var">o</span> <span class="id" title="var">val</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_set_val</span> : '<span class="id" title="var">oinv_set_val</span> = <span class="id" title="var">insub</span>.  <br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_valE</span> : <span class="id" title="var">set_val</span> = <span class="id" title="var">val</span>.  <br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">set_val</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<span class="id" title="var">is_true</span> (<span class="id" title="var">set_val</span> <span class="id" title="var">_</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">_</span>)) ⇒ <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">apply</span>: <span class="id" title="var">valP</span>] : <span class="id" title="var">core</span>.<br/>

<br/>
</div>

<div class="doc">
 Squash  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ssquash</span> {<span class="id" title="var">T</span>} := [<span class="id" title="var">splitsurj</span> <span class="id" title="keyword">of</span> @<span class="id" title="var">squash</span> <span class="id" title="var">T</span>].<br/>

<br/>
</div>

<div class="doc">
 pickle and unpickle  
</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
 set0fun  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set0fun_inj</span> {<span class="id" title="var">P</span> <span class="id" title="var">T</span>} : <span class="id" title="var">injective</span> (@<span class="id" title="var">set0fun</span> <span class="id" title="var">P</span> <span class="id" title="var">T</span>).<br/>
 
<br/>

<br/>
</div>

<div class="doc">
 cast_ord  
</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
 enum_val &amp; enum_rank  
</div>
<div class="code">

<br/>

<br/>

<br/>
</div>

<div class="doc">
 Finset val  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finset_val</span> {<span class="id" title="var">T</span> : <span class="id" title="var">choiceType</span>} {<span class="id" title="var">X</span> : {<span class="id" title="var">fset</span> <span class="id" title="var">T</span>}} (<span class="id" title="var">x</span> : <span class="id" title="var">X</span>) : [<span class="id" title="tactic">set</span>` <span class="id" title="var">X</span>] :=<br/>
&nbsp;&nbsp;<span class="id" title="var">exist</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">x</span> \<span class="id" title="tactic">in</span> [<span class="id" title="tactic">set</span>` <span class="id" title="var">X</span>]) (<span class="id" title="var">val</span> <span class="id" title="var">x</span>) (<span class="id" title="var">mem_set</span> (<span class="id" title="var">valP</span> <span class="id" title="var">x</span>)).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">val_finset</span> {<span class="id" title="var">T</span> : <span class="id" title="var">choiceType</span>} {<span class="id" title="var">X</span> : {<span class="id" title="var">fset</span> <span class="id" title="var">T</span>}} (<span class="id" title="var">x</span> : [<span class="id" title="tactic">set</span>` <span class="id" title="var">X</span>]) : <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;[` <span class="id" title="var">set_mem</span> (<span class="id" title="var">valP</span> <span class="id" title="var">x</span>)]%<span class="id" title="var">fset</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">finset_valK</span> {<span class="id" title="var">T</span> : <span class="id" title="var">choiceType</span>} {<span class="id" title="var">X</span> : {<span class="id" title="var">fset</span> <span class="id" title="var">T</span>}} :<br/>
&nbsp;&nbsp;<span class="id" title="var">cancel</span> (@<span class="id" title="var">finset_val</span> <span class="id" title="var">T</span> <span class="id" title="var">X</span>) <span class="id" title="var">val_finset</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">val_finsetK</span> {<span class="id" title="var">T</span> : <span class="id" title="var">choiceType</span>} {<span class="id" title="var">X</span> : {<span class="id" title="var">fset</span> <span class="id" title="var">T</span>}} :<br/>
&nbsp;&nbsp;<span class="id" title="var">cancel</span> (@<span class="id" title="var">val_finset</span> <span class="id" title="var">T</span> <span class="id" title="var">X</span>) <span class="id" title="var">finset_val</span>.<br/>
 
<br/>

<br/>
</div>

<div class="doc">
 'I_n and `I_n  
</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
 Glueing  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">glue</span> {<span class="id" title="var">T</span> <span class="id" title="var">T'</span>} {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>} {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T'</span>}<br/>
&nbsp;&nbsp;<span class="id" title="keyword">of</span> [<span class="id" title="var">disjoint</span> <span class="id" title="var">X</span> &amp; <span class="id" title="var">Y</span>] &amp; [<span class="id" title="var">disjoint</span> <span class="id" title="var">A</span> &amp; <span class="id" title="var">B</span>] :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">T</span> → <span class="id" title="var">T'</span>) (<span class="id" title="var">u</span> : <span class="id" title="var">T</span>) ⇒ <span class="id" title="keyword">if</span> <span class="id" title="var">u</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">X</span> <span class="id" title="keyword">then</span> <span class="id" title="var">f</span> <span class="id" title="var">u</span> <span class="id" title="keyword">else</span> <span class="id" title="var">g</span> <span class="id" title="var">u</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Glue12</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">T</span> <span class="id" title="var">T'</span>} {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>} {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T'</span>}.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">XY</span> : [<span class="id" title="var">disjoint</span> <span class="id" title="var">X</span> &amp; <span class="id" title="var">Y</span>]} {<span class="id" title="var">AB</span> : [<span class="id" title="var">disjoint</span> <span class="id" title="var">A</span> &amp; <span class="id" title="var">B</span>]}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">glue1</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">T</span> → <span class="id" title="var">T'</span>) : {<span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">gl</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> =1 <span class="id" title="var">f</span>}.<br/>
 
<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">glue2</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">T</span> → <span class="id" title="var">T'</span>) : {<span class="id" title="tactic">in</span> <span class="id" title="var">Y</span>, <span class="id" title="var">gl</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> =1 <span class="id" title="var">g</span>}.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Glue12</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Glue</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">T</span> <span class="id" title="var">T'</span>} {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>} {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T'</span>}.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">XY</span> : [<span class="id" title="var">disjoint</span> <span class="id" title="var">X</span> &amp; <span class="id" title="var">Y</span>]} {<span class="id" title="var">AB</span> : [<span class="id" title="var">disjoint</span> <span class="id" title="var">A</span> &amp; <span class="id" title="var">B</span>]}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">glue_fun_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">X</span> &gt;-&gt; <span class="id" title="var">A</span>}) (<span class="id" title="var">g</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">Y</span> &gt;-&gt; <span class="id" title="var">B</span>}) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isFun</span> <span class="id" title="var">T</span> <span class="id" title="var">T'</span> (<span class="id" title="var">X</span> `|` <span class="id" title="var">Y</span>) (<span class="id" title="var">A</span> `|` <span class="id" title="var">B</span>) (<span class="id" title="var">gl</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_glue</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">T</span> &gt;-&gt; <span class="id" title="var">T'</span>}) (<span class="id" title="var">g</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">T</span> &gt;-&gt; <span class="id" title="var">T'</span>}) :<br/>
&nbsp;&nbsp;'<span class="id" title="var">oinv_</span>(<span class="id" title="var">gl</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>) = <span class="id" title="var">glue</span> <span class="id" title="var">AB</span> (<span class="id" title="var">eqbRL</span> <span class="id" title="var">disj_set_some</span> <span class="id" title="var">XY</span>) '<span class="id" title="var">oinv_f</span> '<span class="id" title="var">oinv_g</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">some_inv_glue_subproof</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : {<span class="id" title="var">inv</span> <span class="id" title="var">T</span> &gt;-&gt; <span class="id" title="var">T'</span>}) :<br/>
&nbsp;&nbsp;<span class="id" title="var">some</span> \<span class="id" title="var">o</span> (<span class="id" title="var">glue</span> <span class="id" title="var">AB</span> <span class="id" title="var">XY</span> <span class="id" title="var">f</span>^-1 <span class="id" title="var">g</span>^-1) = '<span class="id" title="var">oinv_</span>(<span class="id" title="var">gl</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_glue</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">invfun</span> <span class="id" title="var">X</span> &gt;-&gt; <span class="id" title="var">A</span>}) (<span class="id" title="var">g</span> : {<span class="id" title="var">invfun</span> <span class="id" title="var">Y</span> &gt;-&gt; <span class="id" title="var">B</span>}) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">gl</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>)^-1 = <span class="id" title="var">glue</span> <span class="id" title="var">AB</span> <span class="id" title="var">XY</span> <span class="id" title="var">f</span>^-1 <span class="id" title="var">g</span>^-1.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">glueo_can_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">injfun</span> <span class="id" title="var">X</span> &gt;-&gt; <span class="id" title="var">A</span>}) (<span class="id" title="var">g</span> : {<span class="id" title="var">injfun</span> <span class="id" title="var">Y</span> &gt;-&gt; <span class="id" title="var">B</span>}) :<br/>
&nbsp;&nbsp;<span class="id" title="var">OInv_Can</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">X</span> `|` <span class="id" title="var">Y</span>) (<span class="id" title="var">gl</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">glue_canv_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">X</span> &gt;-&gt; <span class="id" title="var">A</span>}) (<span class="id" title="var">g</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">Y</span> &gt;-&gt; <span class="id" title="var">B</span>}) :<br/>
&nbsp;&nbsp;<span class="id" title="var">OInv_CanV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">X</span> `|` <span class="id" title="var">Y</span>) (<span class="id" title="var">A</span> `|` <span class="id" title="var">B</span>) (<span class="id" title="var">gl</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Glue</span>.<br/>

<br/>
</div>

<div class="doc">
 Z-module addition is a bijection  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">addition</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">V</span> : <span class="id" title="var">zmodType</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">V</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_addr</span> : (+%<span class="id" title="var">R</span> <span class="id" title="var">x</span>)^-1 = (+%<span class="id" title="var">R</span> (- <span class="id" title="var">x</span>)).  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">addr_can2_subproof</span> : <span class="id" title="var">Inv_Can2</span> <span class="id" title="var">V</span> <span class="id" title="var">V</span> <span class="id" title="var">setT</span> <span class="id" title="var">setT</span> (+%<span class="id" title="var">R</span> <span class="id" title="var">x</span>).<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">addition</span>.<br/>

<br/>
</div>

<div class="doc">
 Z-module opposite is a bijection  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">addition</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">V</span> : <span class="id" title="var">zmodType</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">V</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_oppr</span> : (-%<span class="id" title="var">R</span>)^-1 = (-%<span class="id" title="var">R</span>). <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oppr_can2_subproof</span> : <span class="id" title="var">Inv_Can2</span> <span class="id" title="var">V</span> <span class="id" title="var">V</span> <span class="id" title="var">setT</span> <span class="id" title="var">setT</span> (-%<span class="id" title="var">R</span>).<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">addition</span>.<br/>

<br/>
</div>

<div class="doc">
 emtpyType  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">empty</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">T</span> : <span class="id" title="var">emptyType</span>} {<span class="id" title="var">T'</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">X</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>}.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">Y</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T'</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">empty_can_subproof</span> : <span class="id" title="var">OInv_Can</span> <span class="id" title="var">T</span> <span class="id" title="var">T'</span> <span class="id" title="var">X</span> <span class="id" title="var">any</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">empty_fun_subproof</span> <span class="id" title="var">Y</span> : <span class="id" title="var">isFun</span> <span class="id" title="var">T</span> <span class="id" title="var">T'</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">any</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">empty_canv_subproof</span> : <span class="id" title="var">OInv_CanV</span> <span class="id" title="var">T</span> <span class="id" title="var">T'</span> <span class="id" title="var">X</span> <span class="id" title="var">set0</span> <span class="id" title="var">any</span>.  <br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">empty</span>.<br/>

<br/>
</div>

<div class="doc">
 Theory of surjection  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">surj_lemmas</span>.<br/>
<span class="id" title="keyword">Variables</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surj_id</span> <span class="id" title="var">A</span> : <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">A</span> (@<span class="id" title="var">idfun</span> <span class="id" title="var">aT</span>).  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surj_set0</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> : <span class="id" title="var">set_surj</span> <span class="id" title="var">set0</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> → <span class="id" title="var">B</span> = <span class="id" title="var">set0</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surjE</span> <span class="id" title="var">f</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> = (<span class="id" title="var">B</span> `&lt;=` <span class="id" title="var">f</span> @` <span class="id" title="var">A</span>).  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surj_image_eq</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">f</span> : <span class="id" title="var">f</span> @` <span class="id" title="var">A</span> `&lt;=` <span class="id" title="var">B</span> → <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> → <span class="id" title="var">f</span> @` <span class="id" title="var">A</span> = <span class="id" title="var">B</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subl_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">A'</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> : <span class="id" title="var">A</span> `&lt;=` <span class="id" title="var">A'</span> → <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> → <span class="id" title="var">set_surj</span> <span class="id" title="var">A'</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subr_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">B'</span> <span class="id" title="var">f</span> : <span class="id" title="var">B'</span> `&lt;=` <span class="id" title="var">B</span> → <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> → <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B'</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">can_surj</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">B</span>, <span class="id" title="var">cancel</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>} → <span class="id" title="var">g</span> @` <span class="id" title="var">B</span> `&lt;=` <span class="id" title="var">A</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surj_epi</span> <span class="id" title="var">sT</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) (<span class="id" title="var">g</span> <span class="id" title="var">g'</span> : <span class="id" title="var">rT</span> → <span class="id" title="var">sT</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> → {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span> =1 <span class="id" title="var">g'</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>} → {<span class="id" title="tactic">in</span> <span class="id" title="var">B</span>, <span class="id" title="var">g</span> =1 <span class="id" title="var">g'</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">epiP</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) : <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> ↔<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">sT</span> (<span class="id" title="var">g</span> <span class="id" title="var">g'</span> : <span class="id" title="var">rT</span> → <span class="id" title="var">sT</span>), {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span> =1 <span class="id" title="var">g'</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>} → {<span class="id" title="tactic">in</span> <span class="id" title="var">B</span>, <span class="id" title="var">g</span> =1 <span class="id" title="var">g'</span>}.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">surj_lemmas</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">can_surj</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} <span class="id" title="var">g</span> [<span class="id" title="var">f</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>].<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">surj_epi</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">sT</span>} <span class="id" title="var">A</span> {<span class="id" title="var">B</span>} <span class="id" title="var">f</span> {<span class="id" title="var">g</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surj_comp</span> <span class="id" title="var">T1</span> <span class="id" title="var">T2</span> <span class="id" title="var">T3</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T1</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T2</span>) (<span class="id" title="var">C</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T3</span>) <span class="id" title="var">f</span> <span class="id" title="var">g</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> → <span class="id" title="var">set_surj</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">g</span> → <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> (<span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">image_eq</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">f</span> : {<span class="id" title="var">surjfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : <span class="id" title="var">f</span> @` <span class="id" title="var">A</span> = <span class="id" title="var">B</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_image_sub</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) {<span class="id" title="var">C</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} :<br/>
&nbsp;&nbsp;<span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">B</span> → '<span class="id" title="var">oinv_f</span> @` <span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">some</span> @` (<span class="id" title="var">f</span> @^-1` <span class="id" title="var">C</span>).<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">oinv_image_sub</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">f</span> {<span class="id" title="var">C</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_Iimage_sub</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} (<span class="id" title="var">f</span> : {<span class="id" title="var">inj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>}) {<span class="id" title="var">C</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} :<br/>
&nbsp;&nbsp;<span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">f</span> @` <span class="id" title="var">A</span> → <span class="id" title="var">some</span> @` (<span class="id" title="var">A</span> `&amp;` <span class="id" title="var">f</span> @^-1` <span class="id" title="var">C</span>) `&lt;=` '<span class="id" title="var">oinv_f</span> @` <span class="id" title="var">C</span>.<br/>
 <span class="id" title="keyword">Arguments</span> <span class="id" title="var">oinv_Iimage_sub</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">A</span>} <span class="id" title="var">f</span> {<span class="id" title="var">C</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_sub_image</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">bij</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}}<br/>
&nbsp;&nbsp;&nbsp;{<span class="id" title="var">C</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">CB</span> : <span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">B</span>) : '<span class="id" title="var">oinv_f</span> @` <span class="id" title="var">C</span> = <span class="id" title="var">some</span> @` (<span class="id" title="var">A</span> `&amp;` <span class="id" title="var">f</span> @^-1` <span class="id" title="var">C</span>).<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">oinv_sub_image</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">f</span> {<span class="id" title="var">C</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">preimageEoinv</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">bij</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">aT</span>] &gt;-&gt; <span class="id" title="var">B</span>}}<br/>
&nbsp;&nbsp;&nbsp;{<span class="id" title="var">C</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">CB</span> : <span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">B</span>) : <span class="id" title="var">some</span> @` (<span class="id" title="var">f</span> @^-1` <span class="id" title="var">C</span>) = '<span class="id" title="var">oinv_f</span> @` <span class="id" title="var">C</span>.<br/>
 <span class="id" title="keyword">Arguments</span> <span class="id" title="var">preimageEoinv</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">B</span>} <span class="id" title="var">f</span> {<span class="id" title="var">C</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_image_sub</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : {<span class="id" title="var">splitsurj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) {<span class="id" title="var">C</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} :<br/>
&nbsp;&nbsp;<span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">B</span> → <span class="id" title="var">f</span>^-1 @` <span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">f</span> @^-1` <span class="id" title="var">C</span>.<br/>
 <span class="id" title="keyword">Arguments</span> <span class="id" title="var">inv_image_sub</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">f</span> {<span class="id" title="var">C</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_Iimage_sub</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} (<span class="id" title="var">f</span> : {<span class="id" title="var">splitinj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>}) {<span class="id" title="var">C</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} :<br/>
&nbsp;&nbsp;<span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">f</span> @` <span class="id" title="var">A</span> →  <span class="id" title="var">A</span> `&amp;` <span class="id" title="var">f</span> @^-1` <span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">f</span>^-1 @` <span class="id" title="var">C</span>.<br/>
 <span class="id" title="keyword">Arguments</span> <span class="id" title="var">inv_Iimage_sub</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">A</span>} <span class="id" title="var">f</span> {<span class="id" title="var">C</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_sub_image</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">splitbij</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">C</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">CB</span> : <span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">B</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">f</span>^-1 @` <span class="id" title="var">C</span> = <span class="id" title="var">A</span> `&amp;` <span class="id" title="var">f</span> @^-1` <span class="id" title="var">C</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">inv_sub_image</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">f</span> {<span class="id" title="var">C</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">preimageEinv</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">splitbij</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">aT</span>] &gt;-&gt; <span class="id" title="var">B</span>}}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">C</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">CB</span> : <span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">B</span>) : <span class="id" title="var">f</span> @^-1` <span class="id" title="var">C</span> = <span class="id" title="var">f</span>^-1 @` <span class="id" title="var">C</span>.<br/>
 <span class="id" title="keyword">Arguments</span> <span class="id" title="var">preimageEinv</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">B</span>} <span class="id" title="var">f</span> {<span class="id" title="var">C</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">reindex_bigcup</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">I</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">I</span>) (<span class="id" title="var">P</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">Q</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">I</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) : <span class="id" title="var">set_fun</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">f</span> → <span class="id" title="var">set_surj</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">f</span> →<br/>
&nbsp;&nbsp;\<span class="id" title="var">bigcup_</span>(<span class="id" title="var">x</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Q</span>) <span class="id" title="var">F</span> <span class="id" title="var">x</span> = \<span class="id" title="var">bigcup_</span>(<span class="id" title="var">x</span> <span class="id" title="tactic">in</span> <span class="id" title="var">P</span>) <span class="id" title="var">F</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">reindex_bigcup</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">I</span>} <span class="id" title="var">f</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">reindex_bigcap</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">I</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">I</span>) (<span class="id" title="var">P</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">Q</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">I</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) : <span class="id" title="var">set_fun</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">f</span> → <span class="id" title="var">set_surj</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">f</span> →<br/>
&nbsp;&nbsp;\<span class="id" title="var">bigcap_</span>(<span class="id" title="var">x</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Q</span>) <span class="id" title="var">F</span> <span class="id" title="var">x</span> = \<span class="id" title="var">bigcap_</span>(<span class="id" title="var">x</span> <span class="id" title="tactic">in</span> <span class="id" title="var">P</span>) <span class="id" title="var">F</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">reindex_bigcap</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">I</span>} <span class="id" title="var">f</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigcap_bigcup</span> <span class="id" title="var">T</span> <span class="id" title="var">I</span> <span class="id" title="var">J</span> (<span class="id" title="var">D</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">I</span>) (<span class="id" title="var">E</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">J</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">J</span> → <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">J</span> →<br/>
&nbsp;&nbsp;\<span class="id" title="var">bigcap_</span>(<span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">D</span>) \<span class="id" title="var">bigcup_</span>(<span class="id" title="var">j</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> =<br/>
&nbsp;&nbsp;\<span class="id" title="var">bigcup_</span>(<span class="id" title="var">f</span> <span class="id" title="tactic">in</span> <span class="id" title="var">set_fun</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span>) \<span class="id" title="var">bigcap_</span>(<span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">D</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> (<span class="id" title="var">f</span> <span class="id" title="var">i</span>).<br/>

<br/>
</div>

<div class="doc">
 Injections  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">trivIset_inj</span> <span class="id" title="var">T</span> <span class="id" title="var">I</span> (<span class="id" title="var">D</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">I</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">D</span> <span class="id" title="var">i</span> → <span class="id" title="var">F</span> <span class="id" title="var">i</span> !=<span class="id" title="var">set0</span>) → <span class="id" title="var">trivIset</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span> → <span class="id" title="var">set_inj</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span>.<br/>

<br/>
</div>

<div class="doc">
 Bijections  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">set_bij_lemmas</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>}.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fun_set_bij</span> <span class="id" title="keyword">of</span> <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> := <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Context</span> (<span class="id" title="var">fbij</span> : <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_bij_inj</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>}.  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_bij_homo</span> : {<span class="id" title="var">homo</span> <span class="id" title="var">f</span> : <span class="id" title="var">x</span> / <span class="id" title="var">A</span> <span class="id" title="var">x</span> &gt;-&gt; <span class="id" title="var">B</span> <span class="id" title="var">x</span>}.  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_bij_sub</span> : <span class="id" title="var">f</span> @` <span class="id" title="var">A</span> `&lt;=` <span class="id" title="var">B</span>.  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_bij_surj</span> : <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.  <br/>

<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">set_bij_lemmas</span>.<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">fun_set_bij</span> : <span class="id" title="var">set_bij</span> &gt;-&gt; <span class="id" title="var">Funclass</span>.<br/>

<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">set_bij_bijfun</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fS</span> : <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>) := <span class="id" title="var">Bij.on</span> (<span class="id" title="var">fun_set_bij</span> <span class="id" title="var">fS</span>).<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Pbij</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>} (<span class="id" title="var">fbij</span> : <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>).<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> : @<span class="id" title="var">Bij</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> := <span class="id" title="var">fbij</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">bij_of_set_bijection</span> := [<span class="id" title="var">bij</span> <span class="id" title="keyword">of</span> <span class="id" title="var">f</span>].<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pbij</span> : {<span class="id" title="var">s</span> : {<span class="id" title="var">bij</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">s</span>}.  <br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Pbij</span>.<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">bij_of_set_bijection</span> : <span class="id" title="var">set_bij</span> &gt;-&gt; <span class="id" title="var">Bij.type</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bij</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">bij</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}} : <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>
 <span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_bij</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) (<span class="id" title="var">f</span> : {<span class="id" title="var">bij</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) <span class="id" title="keyword">of</span><br/>
&nbsp;&nbsp;<span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">bij</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;''bij_' f" := (<span class="id" title="var">phant_bij</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>)) : <span class="id" title="var">form_scope</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<span class="id" title="var">set_bij</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ⇒ <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">apply</span>: <span class="id" title="var">bij</span>] : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">PbijTT</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>} (<span class="id" title="var">fbijTT</span> : <span class="id" title="var">bijective</span> <span class="id" title="var">f</span>).<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := @<span class="id" title="var">BijTT.Build</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">fbijTT</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">bijection_of_bijective</span> := [<span class="id" title="var">splitbij</span> <span class="id" title="keyword">of</span> <span class="id" title="var">f</span>].<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">PbijTT</span> : {<span class="id" title="var">s</span> : {<span class="id" title="var">splitbij</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">aT</span>] &gt;-&gt; [<span class="id" title="tactic">set</span>: <span class="id" title="var">rT</span>]} | <span class="id" title="var">f</span> = <span class="id" title="var">s</span>}.<br/>
 <span class="id" title="keyword">End</span> <span class="id" title="var">PbijTT</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">setTT_bijective</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">aT</span>] [<span class="id" title="tactic">set</span>: <span class="id" title="var">rT</span>] <span class="id" title="var">f</span> = <span class="id" title="var">bijective</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bijTT</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>}  {<span class="id" title="var">f</span> : {<span class="id" title="var">bij</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">aT</span>] &gt;-&gt; [<span class="id" title="tactic">set</span>: <span class="id" title="var">rT</span>]}} : <span class="id" title="var">bijective</span> <span class="id" title="var">f</span>.<br/>
 <span class="id" title="keyword">Definition</span> <span class="id" title="var">phant_bijTT</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">bij</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">aT</span>] &gt;-&gt; [<span class="id" title="tactic">set</span>: <span class="id" title="var">rT</span>]})<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">of</span> <span class="id" title="var">phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span> := @<span class="id" title="var">bijTT</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;''bijTT_'  f" := (<span class="id" title="var">phant_bijTT</span> (<span class="id" title="var">Phantom</span> (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>) <span class="id" title="var">f</span>)) : <span class="id" title="var">form_scope</span>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Extern</span> 0 (<span class="id" title="var">bijective</span> <span class="id" title="var">_</span>) ⇒ <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">apply</span>: <span class="id" title="var">bijTT</span>] : <span class="id" title="var">core</span>.<br/>

<br/>
</div>

<div class="doc">
 Patching and restrictions  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">patch</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">d</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">patch</span> (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) <span class="id" title="var">u</span> := <span class="id" title="keyword">if</span> <span class="id" title="var">u</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> <span class="id" title="keyword">then</span> <span class="id" title="var">f</span> <span class="id" title="var">u</span> <span class="id" title="keyword">else</span> <span class="id" title="var">d</span> <span class="id" title="var">u</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patchT</span> <span class="id" title="var">f</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">patch</span> <span class="id" title="var">f</span> =1 <span class="id" title="var">f</span>}.  <br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patchN</span> <span class="id" title="var">f</span> : {<span class="id" title="tactic">in</span> [<span class="id" title="var">predC</span> <span class="id" title="var">A</span>], <span class="id" title="var">patch</span> <span class="id" title="var">f</span> =1 <span class="id" title="var">d</span>}.<br/>
 <span class="id" title="keyword">Lemma</span> <span class="id" title="var">patchC</span> <span class="id" title="var">f</span> : {<span class="id" title="tactic">in</span> ~` <span class="id" title="var">A</span>, <span class="id" title="var">patch</span> <span class="id" title="var">f</span> =1 <span class="id" title="var">d</span>}.<br/>
 
<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">inj</span>.<br/>
<span class="id" title="keyword">Context</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">inj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">rT</span>}).<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">g</span> := <span class="id" title="var">patch</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patch_inj_subproof</span> : <span class="id" title="var">Inj</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">A</span> <span class="id" title="var">g</span>.<br/>
 <span class="id" title="keyword">End</span> <span class="id" title="var">inj</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">patch</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">restrict</span> := (<span class="id" title="var">patch</span> (<span class="id" title="keyword">fun</span>⇒ <span class="id" title="var">point</span>)).<br/>
<span class="id" title="keyword">Notation</span> &quot;f \_ D" := (<span class="id" title="var">restrict</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span>) : <span class="id" title="var">fun_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patchE</span> <span class="id" title="var">aT</span> (<span class="id" title="var">rT</span> : <span class="id" title="var">pointedType</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> \<span class="id" title="var">_</span> <span class="id" title="var">B</span>) <span class="id" title="var">x</span> = <span class="id" title="keyword">if</span> <span class="id" title="var">x</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">B</span> <span class="id" title="keyword">then</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="keyword">else</span> <span class="id" title="var">point</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patch_pred</span> {<span class="id" title="var">I</span> <span class="id" title="var">T</span>} (<span class="id" title="var">D</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">I</span>}) (<span class="id" title="var">d</span> <span class="id" title="var">f</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">patch</span> <span class="id" title="var">d</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span> = <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> ⇒ <span class="id" title="keyword">if</span> <span class="id" title="var">D</span> <span class="id" title="var">i</span> <span class="id" title="keyword">then</span> <span class="id" title="var">f</span> <span class="id" title="var">i</span> <span class="id" title="keyword">else</span> <span class="id" title="var">d</span> <span class="id" title="var">i</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">preimage_restrict</span> (<span class="id" title="var">aT</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">rT</span> : <span class="id" title="var">pointedType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) (<span class="id" title="var">D</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> \<span class="id" title="var">_</span> <span class="id" title="var">D</span>) @^-1` <span class="id" title="var">B</span> = (<span class="id" title="keyword">if</span> <span class="id" title="var">point</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">B</span> <span class="id" title="keyword">then</span> ~` <span class="id" title="var">D</span> <span class="id" title="keyword">else</span> <span class="id" title="var">set0</span>) `|` <span class="id" title="var">D</span> `&amp;` <span class="id" title="var">f</span> @^-1` <span class="id" title="var">B</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">comp_patch</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">sT</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">g</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) <span class="id" title="var">D</span> (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) (<span class="id" title="var">h</span> : <span class="id" title="var">rT</span> → <span class="id" title="var">sT</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">h</span> \<span class="id" title="var">o</span> <span class="id" title="var">patch</span> <span class="id" title="var">g</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span> = <span class="id" title="var">patch</span> (<span class="id" title="var">h</span> \<span class="id" title="var">o</span> <span class="id" title="var">g</span>) <span class="id" title="var">D</span> (<span class="id" title="var">h</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patch_setI</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">g</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) <span class="id" title="var">D</span> <span class="id" title="var">D'</span> (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) :<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">patch</span> <span class="id" title="var">g</span> (<span class="id" title="var">D</span> `&amp;` <span class="id" title="var">D'</span>) <span class="id" title="var">f</span> = <span class="id" title="var">patch</span> <span class="id" title="var">g</span> <span class="id" title="var">D</span> (<span class="id" title="var">patch</span> <span class="id" title="var">g</span> <span class="id" title="var">D'</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patch_set0</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">g</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">patch</span> <span class="id" title="var">g</span> <span class="id" title="var">set0</span> <span class="id" title="var">f</span> = <span class="id" title="var">g</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">patch_setT</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">g</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">patch</span> <span class="id" title="var">g</span> <span class="id" title="var">setT</span> <span class="id" title="var">f</span> = <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">restrict_comp</span> {<span class="id" title="var">aT</span>} {<span class="id" title="var">rT</span> <span class="id" title="var">sT</span> : <span class="id" title="var">pointedType</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">rT</span> → <span class="id" title="var">sT</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) <span class="id" title="var">D</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">h</span> <span class="id" title="var">point</span> = <span class="id" title="var">point</span> → (<span class="id" title="var">h</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>) \<span class="id" title="var">_</span> <span class="id" title="var">D</span> = <span class="id" title="var">h</span> \<span class="id" title="var">o</span> (<span class="id" title="var">f</span> \<span class="id" title="var">_</span> <span class="id" title="var">D</span>).<br/>
 <span class="id" title="keyword">Arguments</span> <span class="id" title="var">restrict_comp</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">sT</span>} <span class="id" title="var">h</span> <span class="id" title="var">f</span> <span class="id" title="var">D</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">trivIset_restr</span> (<span class="id" title="var">T</span> <span class="id" title="var">I</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">D</span> <span class="id" title="var">D'</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">I</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">trivIset</span> <span class="id" title="var">D'</span> (<span class="id" title="var">F</span> \<span class="id" title="var">_</span> <span class="id" title="var">D</span>) = <span class="id" title="var">trivIset</span> (<span class="id" title="var">D</span> `&amp;` <span class="id" title="var">D'</span>) <span class="id" title="var">F</span>.<br/>

<br/>
</div>

<div class="doc">
 Restriction of domain and codomain  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">RestrictionLeft</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">U</span> <span class="id" title="var">V</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">V</span>) {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">U</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">V</span>}.<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sigL</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> → <span class="id" title="var">V</span>) : <span class="id" title="var">A</span> → <span class="id" title="var">V</span> := <span class="id" title="var">f</span> \<span class="id" title="var">o</span> <span class="id" title="var">set_val</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigL_isfun</span> (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : <span class="id" title="var">isFun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">A</span>] <span class="id" title="var">B</span> (<span class="id" title="var">sigL</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sigLfun</span> (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) := [<span class="id" title="keyword">fun</span> <span class="id" title="keyword">of</span> <span class="id" title="var">sigL</span> <span class="id" title="var">f</span>].<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">valL_</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">V</span>) : <span class="id" title="var">U</span> → <span class="id" title="var">V</span> := ((@<span class="id" title="var">oapp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^~ <span class="id" title="var">v</span>) <span class="id" title="var">f</span> \<span class="id" title="var">o</span> '<span class="id" title="var">oinv_set_val</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valL_isfun</span> (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">A</span>] &gt;-&gt; <span class="id" title="var">B</span>}) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isFun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">valL_</span> (<span class="id" title="var">f</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span>)).<br/>
 <span class="id" title="keyword">Definition</span> <span class="id" title="var">valLfun_</span> (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">A</span>] &gt;-&gt; <span class="id" title="var">B</span>}) := [<span class="id" title="keyword">fun</span> <span class="id" title="keyword">of</span> <span class="id" title="var">valL_</span> <span class="id" title="var">f</span>].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigLE</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> → <span class="id" title="var">V</span>) <span class="id" title="var">x</span> (<span class="id" title="var">xA</span> : <span class="id" title="var">x</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">sigL</span> <span class="id" title="var">f</span> (<span class="id" title="var">SigSub</span> <span class="id" title="var">xA</span>) = <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_sigLP</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">U</span> → <span class="id" title="var">V</span>):<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">f</span> =1 <span class="id" title="var">g</span>} ↔ <span class="id" title="var">sigL</span> <span class="id" title="var">f</span> = <span class="id" title="var">sigL</span> <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_sigLfunP</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) :<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">f</span> =1 <span class="id" title="var">g</span>} ↔ <span class="id" title="var">sigLfun</span> <span class="id" title="var">f</span> = <span class="id" title="var">sigLfun</span> <span class="id" title="var">g</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigLK</span> : <span class="id" title="var">valL_</span> \<span class="id" title="var">o</span> <span class="id" title="var">sigL</span> = <span class="id" title="var">restrict</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valLK</span> : <span class="id" title="var">cancel</span> <span class="id" title="var">valL_</span> <span class="id" title="var">sigL</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valLfunK</span> : <span class="id" title="var">cancel</span> <span class="id" title="var">valLfun_</span> <span class="id" title="var">sigLfun</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigL_valL</span> : <span class="id" title="var">sigL</span> \<span class="id" title="var">o</span> <span class="id" title="var">valL_</span> = <span class="id" title="var">id</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigL_valLfun</span> : <span class="id" title="var">sigLfun</span> \<span class="id" title="var">o</span> <span class="id" title="var">valLfun_</span> = <span class="id" title="var">id</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigL_restrict</span> : <span class="id" title="var">sigL</span> \<span class="id" title="var">o</span> <span class="id" title="var">restrict</span> = <span class="id" title="var">sigL</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">image_sigL</span>  : <span class="id" title="var">range</span> <span class="id" title="var">sigL</span> = <span class="id" title="var">setT</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_restrictP</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">U</span> → <span class="id" title="var">V</span>): {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">f</span> =1 <span class="id" title="var">g</span>} ↔ <span class="id" title="var">restrict</span> <span class="id" title="var">f</span> = <span class="id" title="var">restrict</span> <span class="id" title="var">g</span>.<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">RestrictionLeft</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">sigL</span> {<span class="id" title="var">U</span> <span class="id" title="var">V</span>} <span class="id" title="var">A</span> <span class="id" title="var">f</span> <span class="id" title="var">u</span> /.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">sigLE</span> {<span class="id" title="var">U</span> <span class="id" title="var">V</span>} <span class="id" title="var">A</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">valL_</span> {<span class="id" title="var">U</span> <span class="id" title="var">V</span>} <span class="id" title="var">v</span> {<span class="id" title="var">A</span>} <span class="id" title="var">f</span> <span class="id" title="var">u</span> /.<br/>
<span class="id" title="keyword">Notation</span> &quot;''valL_' v" := (<span class="id" title="var">valL_</span> <span class="id" title="var">v</span>) : <span class="id" title="var">form_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;''valLfun_' v" := (<span class="id" title="var">valLfun_</span> <span class="id" title="var">v</span>) : <span class="id" title="var">form_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">valL</span> := (<span class="id" title="var">valL_</span> <span class="id" title="var">point</span>).<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">RestrictionRight</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">U</span> <span class="id" title="var">V</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">V</span>}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sigR</span> (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">U</span>] &gt;-&gt; <span class="id" title="var">A</span>}) (<span class="id" title="var">u</span> : <span class="id" title="var">U</span>) : <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">SigSub</span> (<span class="id" title="var">mem_set</span> ('<span class="id" title="var">funS_f</span> <span class="id" title="var">I</span>) : <span class="id" title="var">f</span> <span class="id" title="var">u</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">valR</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> → <span class="id" title="var">A</span>) := <span class="id" title="var">set_val</span> \<span class="id" title="var">o</span> <span class="id" title="var">totalfun</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">valR_fun</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> → <span class="id" title="var">A</span>) : {<span class="id" title="keyword">fun</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">U</span>] &gt;-&gt; <span class="id" title="var">A</span>} := [<span class="id" title="keyword">fun</span> <span class="id" title="keyword">of</span> <span class="id" title="var">valR</span> <span class="id" title="var">f</span>].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigRK</span> (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">U</span>] &gt;-&gt; <span class="id" title="var">A</span>}) : <span class="id" title="var">valR</span> (<span class="id" title="var">sigR</span> <span class="id" title="var">f</span>) = <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigR_funK</span> (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">U</span>] &gt;-&gt; <span class="id" title="var">A</span>}) : <span class="id" title="var">valR_fun</span> (<span class="id" title="var">sigR</span> <span class="id" title="var">f</span>) = <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valRP</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> → <span class="id" title="var">A</span>) <span class="id" title="var">x</span> : <span class="id" title="var">A</span> (<span class="id" title="var">valR</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>).  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valRK</span> : <span class="id" title="var">cancel</span> <span class="id" title="var">valR_fun</span> <span class="id" title="var">sigR</span>.<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">RestrictionRight</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">sigR</span> {<span class="id" title="var">U</span> <span class="id" title="var">V</span> <span class="id" title="var">A</span>} <span class="id" title="var">f</span> <span class="id" title="var">u</span> /.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">RestrictionLeftInv</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">U</span> <span class="id" title="var">V</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">V</span>) {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">U</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">V</span>}.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_sigL</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">U</span> &gt;-&gt; <span class="id" title="var">V</span>}) : '<span class="id" title="var">oinv_</span>(<span class="id" title="var">rl</span> <span class="id" title="var">f</span>) = <span class="id" title="var">obind</span> <span class="id" title="var">insub</span> \<span class="id" title="var">o</span> '<span class="id" title="var">oinv_f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigL_inj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">inj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">V</span>}) : @<span class="id" title="var">OInv_Can</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">setT</span> (<span class="id" title="var">rl</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigL_surj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : @<span class="id" title="var">OInv_CanV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">setT</span> <span class="id" title="var">B</span> (<span class="id" title="var">rl</span> <span class="id" title="var">f</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_sigR</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">oinvfun</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">V</span>] &gt;-&gt; <span class="id" title="var">A</span>}) :<br/>
&nbsp;&nbsp;'<span class="id" title="var">oinv_</span>(<span class="id" title="var">rr</span> <span class="id" title="var">f</span>) = (<span class="id" title="var">rl</span> '<span class="id" title="var">oinv_f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigR_inj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">injfun</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">V</span>] &gt;-&gt; <span class="id" title="var">A</span>}) :<br/>
&nbsp;&nbsp;&nbsp;@<span class="id" title="var">OInv_Can</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">setT</span> (<span class="id" title="var">rr</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigR_surj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">surjfun</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">V</span>] &gt;-&gt; <span class="id" title="var">A</span>}) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">OInv_CanV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">setT</span> <span class="id" title="var">setT</span> (<span class="id" title="var">rr</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigR_some_inv</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">invfun</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">V</span>] &gt;-&gt; <span class="id" title="var">A</span>}) :<br/>
&nbsp;&nbsp;<span class="id" title="var">olift</span> (<span class="id" title="var">rl</span> <span class="id" title="var">f</span>^-1) = '<span class="id" title="var">oinv_</span>(<span class="id" title="var">rr</span> <span class="id" title="var">f</span>).<br/>
 
<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_sigR</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">invfun</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">V</span>] &gt;-&gt; <span class="id" title="var">A</span>}) : (<span class="id" title="var">rr</span> <span class="id" title="var">f</span>)^-1 = (<span class="id" title="var">rl</span> <span class="id" title="var">f</span>^-1).<br/>
 
<br/>
</div>

<div class="doc">
 HB Bug, if Fun.on instead of Surject.on  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigL_some_inv</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">splitbij</span> <span class="id" title="var">A</span> &gt;-&gt; [<span class="id" title="tactic">set</span>: <span class="id" title="var">V</span>]}) :<br/>
&nbsp;&nbsp;<span class="id" title="var">olift</span> (<span class="id" title="var">rr</span> [<span class="id" title="keyword">fun</span> <span class="id" title="keyword">of</span> <span class="id" title="var">f</span>^-1]) = '<span class="id" title="var">oinv_</span>(<span class="id" title="var">rl</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_sigL</span>  (<span class="id" title="var">f</span> : {<span class="id" title="var">splitbij</span> <span class="id" title="var">A</span> &gt;-&gt; [<span class="id" title="tactic">set</span>: <span class="id" title="var">V</span>]}) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">rl</span> <span class="id" title="var">f</span>)^-1 = (<span class="id" title="var">rr</span> [<span class="id" title="keyword">fun</span> <span class="id" title="keyword">of</span> <span class="id" title="var">f</span>^-1]).<br/>
 
<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_valL</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">V</span>}) :<br/>
&nbsp;&nbsp;'<span class="id" title="var">oinv_</span>(<span class="id" title="var">el</span> <span class="id" title="var">f</span>) = <span class="id" title="var">omap</span> <span class="id" title="var">set_val</span> \<span class="id" title="var">o</span> '<span class="id" title="var">oinv_f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oapp_comp_x</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">sT</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">rT</span> → <span class="id" title="var">sT</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">rT</span>) <span class="id" title="var">y</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">oapp</span> (<span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>) (<span class="id" title="var">g</span> <span class="id" title="var">x</span>) <span class="id" title="var">y</span> = <span class="id" title="var">g</span> (<span class="id" title="var">oapp</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valL_inj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">inj</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">A</span>] &gt;-&gt; <span class="id" title="var">V</span>}) : @<span class="id" title="var">OInv_Can</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> (<span class="id" title="var">el</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valL_surj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">A</span>] &gt;-&gt; <span class="id" title="var">B</span>}) : @<span class="id" title="var">OInv_CanV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">el</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valL_some_inv</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">inv</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">V</span>}) : <span class="id" title="var">olift</span> (<span class="id" title="var">er</span> <span class="id" title="var">f</span>^-1) = '<span class="id" title="var">oinv_</span>(<span class="id" title="var">el</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_valL</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">inv</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">V</span>}) : (<span class="id" title="var">el</span> <span class="id" title="var">f</span>)^-1 = <span class="id" title="var">er</span> <span class="id" title="var">f</span>^-1.<br/>
 
<br/>
</div>

<div class="doc">
 HB Bug, if Fun.on instead of Surject.on  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigL_injP</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> → <span class="id" title="var">V</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">injective</span> (<span class="id" title="var">rl</span> <span class="id" title="var">f</span>) ↔ {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigL_surjP</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> → <span class="id" title="var">V</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">set_surj</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">A</span>] <span class="id" title="var">B</span> (<span class="id" title="var">rl</span> <span class="id" title="var">f</span>) ↔ <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigL_funP</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> → <span class="id" title="var">V</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">set_fun</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">A</span>] <span class="id" title="var">B</span> (<span class="id" title="var">rl</span> <span class="id" title="var">f</span>) ↔ <span class="id" title="var">set_fun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigL_bijP</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> → <span class="id" title="var">V</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">A</span>] <span class="id" title="var">B</span> (<span class="id" title="var">rl</span> <span class="id" title="var">f</span>) ↔ <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valL_injP</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">V</span>) : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> (<span class="id" title="var">el</span> <span class="id" title="var">f</span>)} ↔ <span class="id" title="var">injective</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valL_surjP</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">V</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">el</span> <span class="id" title="var">f</span>) ↔ <span class="id" title="var">set_surj</span> <span class="id" title="var">setT</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valLfunP</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">V</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">set_fun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">el</span> <span class="id" title="var">f</span>) ↔ <span class="id" title="var">set_fun</span> <span class="id" title="var">setT</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valL_bijP</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">V</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">el</span> <span class="id" title="var">f</span>) ↔ <span class="id" title="var">set_bij</span> <span class="id" title="var">setT</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">RestrictionLeftInv</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">ExtentionLeftInv</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">U</span> <span class="id" title="var">V</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">U</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">V</span>}.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oinv_valR</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">oinv</span> <span class="id" title="var">V</span> &gt;-&gt; <span class="id" title="var">A</span>}) : '<span class="id" title="var">oinv_</span>(<span class="id" title="var">er</span> <span class="id" title="var">f</span>) = (<span class="id" title="var">el</span> '<span class="id" title="var">oinv_f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valR_inj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">inj</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">V</span>] &gt;-&gt; <span class="id" title="var">A</span>}) :<br/>
&nbsp;&nbsp;&nbsp;@<span class="id" title="var">OInv_Can</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">setT</span> (<span class="id" title="var">er</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valR_surj_subproof</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">surj</span> [<span class="id" title="tactic">set</span>: <span class="id" title="var">V</span>] &gt;-&gt; [<span class="id" title="tactic">set</span>: <span class="id" title="var">A</span>]}) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">OInv_CanV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">setT</span> <span class="id" title="var">A</span> (<span class="id" title="var">er</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">ExtentionLeftInv</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Restrictions2</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">U</span> <span class="id" title="var">V</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">V</span>) {<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">U</span>} {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">V</span>}.<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sigLR</span> := <span class="id" title="var">sigR</span> \<span class="id" title="var">o</span> (@<span class="id" title="var">sigLfun</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">valLR</span> : (<span class="id" title="var">A</span> → <span class="id" title="var">B</span>) → <span class="id" title="var">U</span> → <span class="id" title="var">V</span> := <span class="id" title="var">valL</span> \<span class="id" title="var">o</span> <span class="id" title="var">valR_fun</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">valLRfun</span> : (<span class="id" title="var">A</span> → <span class="id" title="var">B</span>) → {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} := <span class="id" title="var">valLfun</span> \<span class="id" title="var">o</span> <span class="id" title="var">valR_fun</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valLRE</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) : <span class="id" title="var">valLR</span> <span class="id" title="var">f</span> = <span class="id" title="var">valL</span> (<span class="id" title="var">valR</span> <span class="id" title="var">f</span>).  <br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valLRfunE</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) : <span class="id" title="var">valLRfun</span> <span class="id" title="var">f</span> = [<span class="id" title="keyword">fun</span> <span class="id" title="keyword">of</span> <span class="id" title="var">valLR</span> <span class="id" title="var">f</span>].  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigL2K</span> (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">valLR</span> (<span class="id" title="var">sigLR</span> <span class="id" title="var">f</span>) =1 <span class="id" title="var">f</span>}.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valLRK</span> : <span class="id" title="var">cancel</span> <span class="id" title="var">valLRfun</span> <span class="id" title="var">sigLR</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valLRfun_inj</span> : <span class="id" title="var">injective</span> <span class="id" title="var">valLRfun</span>.<br/>
 
<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigLR_injP</span> (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) :<br/>
&nbsp;&nbsp;<span class="id" title="var">injective</span> (<span class="id" title="var">sigLR</span> <span class="id" title="var">f</span>) ↔ {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valLR_injP</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) :<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> (<span class="id" title="var">valLR</span> <span class="id" title="var">f</span>)} ↔ <span class="id" title="var">injective</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigLR_surjP</span> (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) :<br/>
&nbsp;&nbsp;<span class="id" title="var">set_surj</span> <span class="id" title="var">setT</span> <span class="id" title="var">setT</span> (<span class="id" title="var">sigLR</span> <span class="id" title="var">f</span>) ↔ <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valLR_surjP</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">valLR</span> <span class="id" title="var">f</span>) ↔ <span class="id" title="var">set_surj</span> <span class="id" title="var">setT</span> <span class="id" title="var">setT</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigLR_bijP</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> → <span class="id" title="var">V</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> ↔<br/>
&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (<span class="id" title="var">fAB</span> : {<span class="id" title="var">homo</span> <span class="id" title="var">f</span> : <span class="id" title="var">x</span> / <span class="id" title="var">A</span> <span class="id" title="var">x</span> &gt;-&gt; <span class="id" title="var">B</span> <span class="id" title="var">x</span>}),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bijective</span> (<span class="id" title="var">sigLR</span> [<span class="id" title="keyword">fun</span> <span class="id" title="keyword">of</span> <span class="id" title="var">mkfun</span> <span class="id" title="var">fAB</span>]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sigLRfun_bijP</span> <span class="id" title="var">f</span> : <span class="id" title="var">bijective</span> (<span class="id" title="var">sigLR</span> <span class="id" title="var">f</span>) ↔ <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valLR_bijP</span> <span class="id" title="var">f</span> : <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">valLR</span> <span class="id" title="var">f</span>) ↔ <span class="id" title="var">bijective</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Restrictions2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subsetP</span> {<span class="id" title="var">T</span>} {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>} : {<span class="id" title="var">subset</span> <span class="id" title="var">A</span> ≤ <span class="id" title="var">B</span>} ↔ (<span class="id" title="var">A</span> `&lt;=` <span class="id" title="var">B</span>).<br/>
 
<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">set_bij_basic_lemmas</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>}.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_set_bijRL</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">f</span> =1 <span class="id" title="var">g</span>} → <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> → <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">g</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_set_bijLR</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">f</span> =1 <span class="id" title="var">g</span>} → <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">g</span> → <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">f</span> =1 <span class="id" title="var">g</span>} → <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> = <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bij_omap</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> (<span class="id" title="var">some</span> @` <span class="id" title="var">A</span>) (<span class="id" title="var">some</span> @` <span class="id" title="var">B</span>) (<span class="id" title="var">omap</span> <span class="id" title="var">f</span>) ↔ <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bij_olift</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> : <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> (<span class="id" title="var">some</span> @` <span class="id" title="var">B</span>) (<span class="id" title="var">olift</span> <span class="id" title="var">f</span>) ↔ <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">set_bij_basic_lemmas</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bij_sub_sym</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> <span class="id" title="var">C</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> <span class="id" title="var">D</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : {<span class="id" title="var">bij</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : <span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">A</span> → <span class="id" title="var">D</span> `&lt;=` <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> <span class="id" title="var">D</span> (<span class="id" title="var">some</span> @` <span class="id" title="var">C</span>) '<span class="id" title="var">oinv_f</span> ↔ <span class="id" title="var">set_bij</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splitbij_sub_sym</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} {<span class="id" title="var">A</span> <span class="id" title="var">C</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>} {<span class="id" title="var">B</span> <span class="id" title="var">D</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : {<span class="id" title="var">splitbij</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : <span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">A</span> → <span class="id" title="var">D</span> `&lt;=` <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> <span class="id" title="var">D</span> <span class="id" title="var">C</span> <span class="id" title="var">f</span>^-1 ↔ <span class="id" title="var">set_bij</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">set_bij_lemmas</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>}.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_bij00</span> <span class="id" title="var">T</span> <span class="id" title="var">U</span> (<span class="id" title="var">f</span> : <span class="id" title="var">T</span> → <span class="id" title="var">U</span>) : <span class="id" title="var">set_bij</span> <span class="id" title="var">set0</span> <span class="id" title="var">set0</span> <span class="id" title="var">f</span>.<br/>
 <span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">set_bij00</span> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inj_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">f</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>} → <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> (<span class="id" title="var">f</span> @` <span class="id" title="var">A</span>) <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bij_subl</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">bij</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : <span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">A</span> → <span class="id" title="var">f</span> @` <span class="id" title="var">C</span> = <span class="id" title="var">D</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">set_bij_lemmas</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">set_bij_lemmas</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>}.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">rT</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bij_subr</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">bij</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : <span class="id" title="var">C</span> = <span class="id" title="var">A</span> `&amp;` (<span class="id" title="var">f</span> @^-1` <span class="id" title="var">D</span>) → <span class="id" title="var">D</span> `&lt;=` <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bij_sub</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">bij</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : <span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">A</span> → <span class="id" title="var">D</span> `&lt;=` <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">homo</span> <span class="id" title="var">f</span> : <span class="id" title="var">x</span> / <span class="id" title="var">C</span> <span class="id" title="var">x</span> &gt;-&gt; <span class="id" title="var">D</span> <span class="id" title="var">x</span>} →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">homo</span> '<span class="id" title="var">oinv_f</span> : <span class="id" title="var">x</span> / <span class="id" title="var">D</span> <span class="id" title="var">x</span> &gt;-&gt; (<span class="id" title="var">some</span> @` <span class="id" title="var">C</span>) <span class="id" title="var">x</span>} →<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splitbij_sub</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> (<span class="id" title="var">f</span> : {<span class="id" title="var">splitbij</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) : <span class="id" title="var">C</span> `&lt;=` <span class="id" title="var">A</span> → <span class="id" title="var">D</span> `&lt;=` <span class="id" title="var">B</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">homo</span> <span class="id" title="var">f</span> : <span class="id" title="var">x</span> / <span class="id" title="var">C</span> <span class="id" title="var">x</span> &gt;-&gt; <span class="id" title="var">D</span> <span class="id" title="var">x</span>} →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">homo</span> <span class="id" title="var">f</span>^-1 : <span class="id" title="var">x</span> / <span class="id" title="var">D</span> <span class="id" title="var">x</span> &gt;-&gt; <span class="id" title="var">C</span> <span class="id" title="var">x</span>} →<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">can2_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}) (<span class="id" title="var">g</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">B</span> &gt;-&gt; <span class="id" title="var">A</span>}) :<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">cancel</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>} → {<span class="id" title="tactic">in</span> <span class="id" title="var">B</span>, <span class="id" title="var">cancel</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>} → <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bij_sub_setUrl</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">B'</span> <span class="id" title="var">f</span> : [<span class="id" title="var">disjoint</span> <span class="id" title="var">B</span> &amp; <span class="id" title="var">B'</span>] →<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> (<span class="id" title="var">B</span> `|` <span class="id" title="var">B'</span>) <span class="id" title="var">f</span> → <span class="id" title="var">set_bij</span> (<span class="id" title="var">A</span> `\` <span class="id" title="var">f</span> @^-1` <span class="id" title="var">B'</span>) <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bij_sub_setUrr</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">B'</span> <span class="id" title="var">f</span> : [<span class="id" title="var">disjoint</span> <span class="id" title="var">B</span> &amp; <span class="id" title="var">B'</span>] →<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> (<span class="id" title="var">B</span> `|` <span class="id" title="var">B'</span>) <span class="id" title="var">f</span> → <span class="id" title="var">set_bij</span> (<span class="id" title="var">A</span> `\` <span class="id" title="var">f</span> @^-1` <span class="id" title="var">B</span>) <span class="id" title="var">B'</span> <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bij_sub_setUll</span> <span class="id" title="var">A</span> <span class="id" title="var">A'</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> : [<span class="id" title="var">disjoint</span> <span class="id" title="var">A</span> &amp; <span class="id" title="var">A'</span>] →<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> (<span class="id" title="var">A</span> `|` <span class="id" title="var">A'</span>) <span class="id" title="var">B</span> <span class="id" title="var">f</span> → <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> (<span class="id" title="var">B</span> `\` <span class="id" title="var">f</span> @` <span class="id" title="var">A'</span>) <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bij_sub_setUlr</span> <span class="id" title="var">A</span> <span class="id" title="var">A'</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> : [<span class="id" title="var">disjoint</span> <span class="id" title="var">A</span> &amp; <span class="id" title="var">A'</span>] →<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> (<span class="id" title="var">A</span> `|` <span class="id" title="var">A'</span>) <span class="id" title="var">B</span> <span class="id" title="var">f</span> → <span class="id" title="var">set_bij</span> <span class="id" title="var">A'</span> (<span class="id" title="var">B</span> `\` <span class="id" title="var">f</span> @` <span class="id" title="var">A</span>) <span class="id" title="var">f</span>.<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">set_bij_lemmas</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bij_II_D1</span> <span class="id" title="var">T</span> <span class="id" title="var">n</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> `<span class="id" title="var">I_n</span>.+1 <span class="id" title="var">A</span> <span class="id" title="var">f</span> → <span class="id" title="var">set_bij</span> `<span class="id" title="var">I_n</span> (<span class="id" title="var">A</span> `\ <span class="id" title="var">f</span> <span class="id" title="var">n</span>) <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_bij_comp</span> <span class="id" title="var">T1</span> <span class="id" title="var">T2</span> <span class="id" title="var">T3</span> (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T1</span>) (<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T2</span>) (<span class="id" title="var">C</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T3</span>) <span class="id" title="var">f</span> <span class="id" title="var">g</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> → <span class="id" title="var">set_bij</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">g</span> → <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> (<span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">pointed_inverse</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">T</span> <span class="id" title="var">U</span>} (<span class="id" title="var">dflt</span> : <span class="id" title="var">U</span> → <span class="id" title="var">T</span>) (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">T</span>).<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> (<span class="id" title="var">f</span> : <span class="id" title="var">T</span> → <span class="id" title="var">U</span>) (<span class="id" title="var">i</span> : {<span class="id" title="var">inj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">U</span>}).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pinv_</span> <span class="id" title="var">f</span> := ('<span class="id" title="var">split_dflt</span> [<span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span>])^-1.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pinvK</span> <span class="id" title="var">f</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">f</span> @` <span class="id" title="var">A</span>, <span class="id" title="var">cancel</span> (<span class="id" title="var">pinv</span> <span class="id" title="var">f</span>) <span class="id" title="var">f</span>}.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pinvKV</span> <span class="id" title="var">f</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>} → {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">cancel</span> <span class="id" title="var">f</span> (<span class="id" title="var">pinv</span> <span class="id" title="var">f</span>)}.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">injpinv_surj</span> <span class="id" title="var">f</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>} →<br/>
&nbsp;&nbsp;<span class="id" title="var">set_surj</span> (<span class="id" title="var">f</span> @` <span class="id" title="var">A</span>) <span class="id" title="var">A</span> (<span class="id" title="var">pinv</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">injpinv_image</span> <span class="id" title="var">f</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>} →<br/>
&nbsp;&nbsp;<span class="id" title="var">pinv</span> <span class="id" title="var">f</span> @` (<span class="id" title="var">f</span> @` <span class="id" title="var">A</span>) = <span class="id" title="var">A</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">injpinv_bij</span> <span class="id" title="var">f</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>} →<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> (<span class="id" title="var">f</span> @` <span class="id" title="var">A</span>) <span class="id" title="var">A</span> (<span class="id" title="var">pinv</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surjpK</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> : <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> → {<span class="id" title="tactic">in</span> <span class="id" title="var">B</span>, <span class="id" title="var">cancel</span> (<span class="id" title="var">pinv</span> <span class="id" title="var">f</span>) <span class="id" title="var">f</span>}.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surjpinv_image_sub</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> : <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> → <span class="id" title="var">pinv</span> <span class="id" title="var">f</span> @` <span class="id" title="var">B</span> `&lt;=` <span class="id" title="var">A</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surjpinv_inj</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> : <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> → {<span class="id" title="tactic">in</span> <span class="id" title="var">B</span> &amp;, <span class="id" title="var">injective</span> (<span class="id" title="var">pinv</span> <span class="id" title="var">f</span>)}.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">surjpinv_bij</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> (<span class="id" title="var">g</span> := <span class="id" title="var">pinv</span> <span class="id" title="var">f</span>) : <span class="id" title="var">set_surj</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">set_bij</span> <span class="id" title="var">B</span> (<span class="id" title="var">g</span> @` <span class="id" title="var">B</span>) <span class="id" title="var">g</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bijpinv_bij</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> : <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> → <span class="id" title="var">set_bij</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> (<span class="id" title="var">pinv</span> <span class="id" title="var">f</span>).<br/>
 
<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">pPbij</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">B</span>: <span class="id" title="tactic">set</span> <span class="id" title="var">U</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">T</span> → <span class="id" title="var">U</span>} (<span class="id" title="var">fbij</span> : <span class="id" title="var">set_bij</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pPbij_</span> : {<span class="id" title="var">s</span> : {<span class="id" title="var">splitbij</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">s</span>}.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">pPbij</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">pPinj</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">f</span> : <span class="id" title="var">T</span> → <span class="id" title="var">U</span>} (<span class="id" title="var">finj</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>}).<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pPinj_</span> : {<span class="id" title="var">i</span> : {<span class="id" title="var">splitinj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">U</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">i</span>}.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">pPinj</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">injpPfun</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">U</span>} {<span class="id" title="var">f</span> : {<span class="id" title="var">inj</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">U</span>}} (<span class="id" title="var">ffun</span> : {<span class="id" title="var">homo</span> <span class="id" title="var">f</span> : <span class="id" title="var">x</span> / <span class="id" title="var">A</span> <span class="id" title="var">x</span> &gt;-&gt; <span class="id" title="var">B</span> <span class="id" title="var">x</span>}).<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">g</span> : <span class="id" title="var">_</span> → <span class="id" title="var">_</span> := <span class="id" title="var">f</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">SplitInj.copy</span> <span class="id" title="var">g</span> ('<span class="id" title="var">split_dflt</span> [<span class="id" title="keyword">fun</span> <span class="id" title="var">g</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span>]).<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">HB.instance</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">_</span> := <span class="id" title="var">isFun.Build</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">g</span> <span class="id" title="var">ffun</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">injpPfun_</span> : {<span class="id" title="var">i</span> : {<span class="id" title="var">splitinjfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">i</span> :&gt; (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>)}.<br/>
 <span class="id" title="keyword">End</span> <span class="id" title="var">injpPfun</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">funpPinj</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">B</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">U</span>} {<span class="id" title="var">f</span> : {<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>}} (<span class="id" title="var">finj</span> : {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>}).<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">funpPinj_</span> : {<span class="id" title="var">i</span> : {<span class="id" title="var">splitinjfun</span> <span class="id" title="var">A</span> &gt;-&gt; <span class="id" title="var">B</span>} | <span class="id" title="var">f</span> = <span class="id" title="var">i</span> :&gt; (<span class="id" title="var">_</span> → <span class="id" title="var">_</span>)}.<br/>
 <span class="id" title="keyword">End</span> <span class="id" title="var">funpPinj</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">pointed_inverse</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;''pinv_' dflt" := (<span class="id" title="var">pinv_</span> <span class="id" title="var">dflt</span>) : <span class="id" title="var">form_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">pinv</span> := '<span class="id" title="var">pinv_point</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;''pPbij_' dflt" := (<span class="id" title="var">pPbij_</span> <span class="id" title="var">dflt</span>) : <span class="id" title="var">form_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">pPbij</span> := '<span class="id" title="var">pPbij_point</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">selfPbij</span> := '<span class="id" title="var">pPbij_id</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;''pPinj_' dflt" := (<span class="id" title="var">pPinj_</span> <span class="id" title="var">dflt</span>) : <span class="id" title="var">form_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">pPinj</span> := '<span class="id" title="var">pPinj_point</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;''injpPfun_' dflt" := (<span class="id" title="var">injpPfun_</span> <span class="id" title="var">dflt</span>) : <span class="id" title="var">form_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">injpPfun</span> := '<span class="id" title="var">injpPfun_point</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;''funpPinj_' dflt" := (<span class="id" title="var">funpPinj_</span> <span class="id" title="var">dflt</span>) : <span class="id" title="var">form_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">funpPinj</span> := '<span class="id" title="var">funpPinj_point</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">function_space</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">ring_scope</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">GRing.Theory</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">cst</span> {<span class="id" title="var">T</span> <span class="id" title="var">T'</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">T'</span>) : <span class="id" title="var">T</span> → <span class="id" title="var">T'</span> := <span class="id" title="keyword">fun</span>⇒ <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">preimage_cst</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">a</span> : <span class="id" title="var">aT</span>) (<span class="id" title="var">A</span> : <span class="id" title="tactic">set</span> <span class="id" title="var">aT</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">cst</span> <span class="id" title="var">rT</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> @^-1` <span class="id" title="var">A</span> = <span class="id" title="keyword">if</span> <span class="id" title="var">a</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> <span class="id" title="keyword">then</span> <span class="id" title="var">setT</span> <span class="id" title="keyword">else</span> <span class="id" title="var">set0</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> <span class="id" title="keyword">Tactic</span> := <span class="id" title="tactic">idtac</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <span class="id" title="var">fct_zmodMixin</span> (<span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">M</span> : <span class="id" title="var">zmodType</span>) :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">ZmodMixin</span> (<span class="id" title="var">T</span> → <span class="id" title="var">M</span>) \0 (<span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> ⇒ - <span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> ⇒ <span class="id" title="var">f</span> \+ <span class="id" title="var">g</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Canonical</span> <span class="id" title="var">fct_zmodType</span> <span class="id" title="var">T</span> (<span class="id" title="var">M</span> : <span class="id" title="var">zmodType</span>) := <span class="id" title="var">ZmodType</span> (<span class="id" title="var">T</span> → <span class="id" title="var">M</span>) (<span class="id" title="var">fct_zmodMixin</span> <span class="id" title="var">T</span> <span class="id" title="var">M</span>).<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <span class="id" title="var">fct_ringMixin</span> (<span class="id" title="var">T</span> : <span class="id" title="var">pointedType</span>) (<span class="id" title="var">M</span> : <span class="id" title="var">ringType</span>) :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">RingMixin</span> [<span class="id" title="var">zmodType</span> <span class="id" title="keyword">of</span> <span class="id" title="var">T</span> → <span class="id" title="var">M</span>] (<span class="id" title="var">cst</span> 1) (<span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> ⇒ <span class="id" title="var">f</span> \* <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Canonical</span> <span class="id" title="var">fct_ringType</span> (<span class="id" title="var">T</span> : <span class="id" title="var">pointedType</span>) (<span class="id" title="var">M</span> : <span class="id" title="var">ringType</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">RingType</span> (<span class="id" title="var">T</span> → <span class="id" title="var">M</span>) (<span class="id" title="var">fct_ringMixin</span> <span class="id" title="var">T</span> <span class="id" title="var">M</span>).<br/>

<br/>
<span class="id" title="keyword">Program Canonical</span> <span class="id" title="var">fct_comRingType</span> (<span class="id" title="var">T</span> : <span class="id" title="var">pointedType</span>) (<span class="id" title="var">M</span> : <span class="id" title="var">comRingType</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">ComRingType</span> (<span class="id" title="var">T</span> → <span class="id" title="var">M</span>) <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <span class="id" title="var">fct_lmodMixin</span> (<span class="id" title="var">U</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">R</span> : <span class="id" title="var">ringType</span>) (<span class="id" title="var">V</span> : <span class="id" title="var">lmodType</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;:= @<span class="id" title="var">LmodMixin</span> <span class="id" title="var">R</span> [<span class="id" title="var">zmodType</span> <span class="id" title="keyword">of</span> <span class="id" title="var">U</span> → <span class="id" title="var">V</span>] (<span class="id" title="keyword">fun</span> <span class="id" title="var">k</span> <span class="id" title="var">f</span> ⇒ <span class="id" title="var">k</span> \*: <span class="id" title="var">f</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Canonical</span> <span class="id" title="var">fct_lmodType</span> <span class="id" title="var">U</span> (<span class="id" title="var">R</span> : <span class="id" title="var">ringType</span>) (<span class="id" title="var">V</span> : <span class="id" title="var">lmodType</span> <span class="id" title="var">R</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">LmodType</span> <span class="id" title="var">_</span> (<span class="id" title="var">U</span> → <span class="id" title="var">V</span>) (<span class="id" title="var">fct_lmodMixin</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fct_sumE</span> (<span class="id" title="var">I</span> <span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">M</span> : <span class="id" title="var">zmodType</span>) <span class="id" title="var">r</span> (<span class="id" title="var">P</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">I</span>}) (<span class="id" title="var">f</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span> → <span class="id" title="var">M</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span> : <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;(\<span class="id" title="var">sum_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">f</span> <span class="id" title="var">i</span>) <span class="id" title="var">x</span> = \<span class="id" title="var">sum_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">f</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span>.<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">function_space</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">function_space_lemmas</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">ring_scope</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">GRing.Theory</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">addrfctE</span> (<span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">K</span> : <span class="id" title="var">zmodType</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">T</span> → <span class="id" title="var">K</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">f</span> + <span class="id" title="var">g</span> = (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span> + <span class="id" title="var">g</span> <span class="id" title="var">x</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">opprfctE</span> (<span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">K</span> : <span class="id" title="var">zmodType</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">T</span> → <span class="id" title="var">K</span>) : - <span class="id" title="var">f</span> = (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ - <span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mulrfctE</span> (<span class="id" title="var">T</span> : <span class="id" title="var">pointedType</span>) (<span class="id" title="var">K</span> : <span class="id" title="var">ringType</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">T</span> → <span class="id" title="var">K</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">f</span> × <span class="id" title="var">g</span> = (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span> × <span class="id" title="var">g</span> <span class="id" title="var">x</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">scalrfctE</span> (<span class="id" title="var">T</span> : <span class="id" title="var">pointedType</span>) (<span class="id" title="var">K</span> : <span class="id" title="var">ringType</span>) (<span class="id" title="var">L</span> : <span class="id" title="var">lmodType</span> <span class="id" title="var">K</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">k</span> (<span class="id" title="var">f</span> : <span class="id" title="var">T</span> → <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">k</span> *: <span class="id" title="var">f</span> = (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">T</span> ⇒ <span class="id" title="var">k</span> *: <span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">cstE</span> (<span class="id" title="var">T</span> <span class="id" title="var">T'</span>: <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">T</span>) : <span class="id" title="var">cst</span> <span class="id" title="var">x</span> = <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span>: <span class="id" title="var">T'</span> ⇒ <span class="id" title="var">x</span>.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">exprfctE</span> (<span class="id" title="var">T</span> : <span class="id" title="var">pointedType</span>) (<span class="id" title="var">K</span> : <span class="id" title="var">ringType</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">T</span> → <span class="id" title="var">K</span>) <span class="id" title="var">n</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">f</span> ^+ <span class="id" title="var">n</span> = (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span> ^+ <span class="id" title="var">n</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">compE</span> (<span class="id" title="var">T1</span> <span class="id" title="var">T2</span> <span class="id" title="var">T3</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">T1</span> → <span class="id" title="var">T2</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">T2</span> → <span class="id" title="var">T3</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span> = <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>
 
<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fctE</span> :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">cstE</span>, <span class="id" title="var">compE</span>, <span class="id" title="var">opprfctE</span>, <span class="id" title="var">addrfctE</span>, <span class="id" title="var">mulrfctE</span>, <span class="id" title="var">scalrfctE</span>, <span class="id" title="var">exprfctE</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">function_space_lemmas</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_funK</span> <span class="id" title="var">T</span> (<span class="id" title="var">R</span> : <span class="id" title="var">unitRingType</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">T</span> → <span class="id" title="var">R</span>) : <span class="id" title="var">f</span>\^-1\^-1%<span class="id" title="var">R</span> = <span class="id" title="var">f</span>.<br/>
 </div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>