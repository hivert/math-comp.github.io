<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>mathcomp_extra</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library mathcomp_extra</h1>

<div class="code">
<span class="comment">(*&nbsp;mathcomp&nbsp;analysis&nbsp;(c)&nbsp;2022&nbsp;Inria&nbsp;and&nbsp;AIST.&nbsp;License:&nbsp;CeCILL-C.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">BinPos</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="var">choice</span>.<br/>
</div>

<div class="doc"> Missing coercion (done before Import to avoid redeclaration error,
   thanks to KS for the trick)
 MathComp 1.15 addition
</div>
<div class="code">
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">choice.Choice.mixin</span> : <span class="id" title="var">choice.Choice.class_of</span> &gt;-&gt; <span class="id" title="var">choice.Choice.mixin_of</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">all_ssreflect</span> <span class="id" title="var">finmap</span> <span class="id" title="var">ssralg</span> <span class="id" title="var">ssrnum</span> <span class="id" title="var">ssrint</span> <span class="id" title="var">rat</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">finset</span> <span class="id" title="var">interval</span>.<br/>

<br/>
</div>

<div class="doc"> MathComp 1.15 additions

  This files contains lemmas and definitions missing from MathComp.

               f \max g := fun x =&gt; Num.max (f x) (g x)
                oflit f := Some \o f
          pred_oapp T D := [pred x | oapp (mem D) false x]
                 f \* g := fun x =&gt; f x * g x
                   \- f := fun x =&gt; - f x
     lteBSide, bnd_simp == multirule to simplify inequalities between
                           interval bounds
               miditv i == middle point of interval i

               proj i f == f i, where f : forall i, T i
             dfwith f x == fun j =&gt; x if j = i, and f j otherwise
                           given x : T i
                 swap x := (x.2, x.1)

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;f \* g" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>).<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;f \- g" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>).<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;\- f"  (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 35, <span class="id" title="var">f</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 35).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">all_sig2_cond</span> {<span class="id" title="var">I</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">D</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span> → <span class="id" title="keyword">Prop</span>) : <span class="id" title="var">T</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> : <span class="id" title="var">I</span>, <span class="id" title="var">D</span> <span class="id" title="var">x</span> → {<span class="id" title="var">y</span> : <span class="id" title="var">T</span> | <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> &amp; <span class="id" title="var">Q</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>}) →<br/>
&nbsp;&nbsp;{<span class="id" title="var">f</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> : <span class="id" title="var">I</span>, <span class="id" title="var">T</span> | <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> : <span class="id" title="var">I</span>, <span class="id" title="var">D</span> <span class="id" title="var">x</span> → <span class="id" title="var">P</span> <span class="id" title="var">x</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) &amp; <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> : <span class="id" title="var">I</span>, <span class="id" title="var">D</span> <span class="id" title="var">x</span> → <span class="id" title="var">Q</span> <span class="id" title="var">x</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">olift</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) := <span class="id" title="var">Some</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oapp_comp</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">sT</span> (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">rT</span> → <span class="id" title="var">sT</span>) <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">oapp</span> (<span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>) <span class="id" title="var">x</span> =1 (@<span class="id" title="var">oapp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^~ <span class="id" title="var">x</span> <span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">omap</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">olift_comp</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">sT</span> (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">rT</span> → <span class="id" title="var">sT</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">olift</span> (<span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>) = <span class="id" title="var">olift</span> <span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">compA</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> → <span class="id" title="var">A</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> → <span class="id" title="var">B</span>) (<span class="id" title="var">h</span> : <span class="id" title="var">D</span> → <span class="id" title="var">C</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">f</span> \<span class="id" title="var">o</span> (<span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">h</span>) = (<span class="id" title="var">f</span> \<span class="id" title="var">o</span> <span class="id" title="var">g</span>) \<span class="id" title="var">o</span> <span class="id" title="var">h</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">can_in_pcan</span> [<span class="id" title="var">rT</span> <span class="id" title="var">aT</span> : <span class="id" title="keyword">Type</span>] (<span class="id" title="var">A</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">aT</span>}) [<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>] [<span class="id" title="var">g</span> : <span class="id" title="var">rT</span> → <span class="id" title="var">aT</span>] :<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">cancel</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>} → {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">pcancel</span> <span class="id" title="var">f</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> : <span class="id" title="var">rT</span> ⇒ <span class="id" title="var">Some</span> (<span class="id" title="var">g</span> <span class="id" title="var">y</span>))}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pcan_in_inj</span> [<span class="id" title="var">rT</span> <span class="id" title="var">aT</span> : <span class="id" title="keyword">Type</span>] [<span class="id" title="var">A</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">aT</span>}] [<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>] [<span class="id" title="var">g</span> : <span class="id" title="var">rT</span> → <span class="id" title="var">option</span> <span class="id" title="var">aT</span>] :<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">A</span>, <span class="id" title="var">pcancel</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>} → {<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pred_oapp</span> <span class="id" title="var">T</span> (<span class="id" title="var">D</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">T</span>}) : <span class="id" title="var">pred</span> (<span class="id" title="var">option</span> <span class="id" title="var">T</span>) :=<br/>
&nbsp;&nbsp;[<span class="id" title="var">pred</span> <span class="id" title="var">x</span> | <span class="id" title="var">oapp</span> (<span class="id" title="var">mem</span> <span class="id" title="var">D</span>) <span class="id" title="var">false</span> <span class="id" title="var">x</span>].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ocan_in_comp</span> [<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>] (<span class="id" title="var">D</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">B</span>}) (<span class="id" title="var">D'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">C</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">f</span> : <span class="id" title="var">B</span> → <span class="id" title="var">option</span> <span class="id" title="var">A</span>] [<span class="id" title="var">h</span> : <span class="id" title="var">C</span> → <span class="id" title="var">option</span> <span class="id" title="var">B</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">f'</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>] [<span class="id" title="var">h'</span> : <span class="id" title="var">B</span> → <span class="id" title="var">C</span>] :<br/>
&nbsp;&nbsp;{<span class="id" title="var">homo</span> <span class="id" title="var">h</span> : <span class="id" title="var">x</span> / <span class="id" title="var">x</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">D'</span> &gt;-&gt; <span class="id" title="var">x</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">pred_oapp</span> <span class="id" title="var">D</span>} →<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">D</span>, <span class="id" title="var">ocancel</span> <span class="id" title="var">f</span> <span class="id" title="var">f'</span>} → {<span class="id" title="tactic">in</span> <span class="id" title="var">D'</span>, <span class="id" title="var">ocancel</span> <span class="id" title="var">h</span> <span class="id" title="var">h'</span>} →<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">D'</span>, <span class="id" title="var">ocancel</span> (<span class="id" title="var">obind</span> <span class="id" title="var">f</span> \<span class="id" title="var">o</span> <span class="id" title="var">h</span>) (<span class="id" title="var">h'</span> \<span class="id" title="var">o</span> <span class="id" title="var">f'</span>)}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eqbRL</span> (<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> : <span class="id" title="var">bool</span>) : <span class="id" title="var">b1</span> = <span class="id" title="var">b2</span> → <span class="id" title="var">b2</span> → <span class="id" title="var">b1</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mul_fun</span> <span class="id" title="var">T</span> (<span class="id" title="var">R</span> : <span class="id" title="var">ringType</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">T</span> → <span class="id" title="var">R</span>) <span class="id" title="var">x</span> := (<span class="id" title="var">f</span> <span class="id" title="var">x</span> × <span class="id" title="var">g</span> <span class="id" title="var">x</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;f \* g" := (<span class="id" title="var">mul_fun</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>) : <span class="id" title="var">ring_scope</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">mul_fun</span> {<span class="id" title="var">T</span> <span class="id" title="var">R</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> /.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">opp_fun</span> <span class="id" title="var">T</span> (<span class="id" title="var">R</span> : <span class="id" title="var">zmodType</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">T</span> → <span class="id" title="var">R</span>) <span class="id" title="var">x</span> := (- <span class="id" title="var">f</span> <span class="id" title="var">x</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;\- f" := (<span class="id" title="var">opp_fun</span> <span class="id" title="var">f</span>) : <span class="id" title="var">ring_scope</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">opp_fun</span> {<span class="id" title="var">T</span> <span class="id" title="var">R</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> /.<br/>

<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">pair_of_interval</span> <span class="id" title="var">T</span> (<span class="id" title="var">I</span> : <span class="id" title="var">interval</span> <span class="id" title="var">T</span>) : <span class="id" title="var">itv_bound</span> <span class="id" title="var">T</span> × <span class="id" title="var">itv_bound</span> <span class="id" title="var">T</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span>: <span class="id" title="var">Interval</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> := <span class="id" title="var">I</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">b1</span>, <span class="id" title="var">b2</span>).<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Order.TTheory</span> <span class="id" title="var">GRing.Theory</span> <span class="id" title="var">Num.Theory</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">itv_simp</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">d</span> : <span class="id" title="var">unit</span>) (<span class="id" title="var">T</span> : <span class="id" title="var">porderType</span> <span class="id" title="var">d</span>).<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">bool</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ltBSide</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">b'</span> :<br/>
&nbsp;&nbsp;((<span class="id" title="var">BSide</span> <span class="id" title="var">b</span> <span class="id" title="var">x</span> &lt; <span class="id" title="var">BSide</span> <span class="id" title="var">b'</span> <span class="id" title="var">y</span>) = (<span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span> ?&lt;= <span class="id" title="keyword">if</span> <span class="id" title="var">b</span> &amp;&amp; ~~ <span class="id" title="var">b'</span>))%<span class="id" title="var">O</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">leBSide</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">b'</span> :<br/>
&nbsp;&nbsp;((<span class="id" title="var">BSide</span> <span class="id" title="var">b</span> <span class="id" title="var">x</span> ≤ <span class="id" title="var">BSide</span> <span class="id" title="var">b'</span> <span class="id" title="var">y</span>) = (<span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span> ?&lt;= <span class="id" title="keyword">if</span> <span class="id" title="var">b'</span> ==&gt; <span class="id" title="var">b</span>))%<span class="id" title="var">O</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lteBSide</span> := (<span class="id" title="var">ltBSide</span>, <span class="id" title="var">leBSide</span>).<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">BLeft_ltE</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> : (<span class="id" title="var">BSide</span> <span class="id" title="var">b</span> <span class="id" title="var">x</span> &lt; <span class="id" title="var">BLeft</span> <span class="id" title="var">y</span>)%<span class="id" title="var">O</span> = (<span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span>)%<span class="id" title="var">O</span>.<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">BRight_leE</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> : (<span class="id" title="var">BSide</span> <span class="id" title="var">b</span> <span class="id" title="var">x</span> ≤ <span class="id" title="var">BRight</span> <span class="id" title="var">y</span>)%<span class="id" title="var">O</span> = (<span class="id" title="var">x</span> ≤ <span class="id" title="var">y</span>)%<span class="id" title="var">O</span>.<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">BRight_BLeft_leE</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : (<span class="id" title="var">BRight</span> <span class="id" title="var">x</span> ≤ <span class="id" title="var">BLeft</span> <span class="id" title="var">y</span>)%<span class="id" title="var">O</span> = (<span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span>)%<span class="id" title="var">O</span>.<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">BLeft_BRight_ltE</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : (<span class="id" title="var">BLeft</span> <span class="id" title="var">x</span> &lt; <span class="id" title="var">BRight</span> <span class="id" title="var">y</span>)%<span class="id" title="var">O</span> = (<span class="id" title="var">x</span> ≤ <span class="id" title="var">y</span>)%<span class="id" title="var">O</span>.<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">BRight_BSide_ltE</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> : (<span class="id" title="var">BRight</span> <span class="id" title="var">x</span> &lt; <span class="id" title="var">BSide</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>)%<span class="id" title="var">O</span> = (<span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span>)%<span class="id" title="var">O</span>.<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">BLeft_BSide_leE</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> : (<span class="id" title="var">BLeft</span> <span class="id" title="var">x</span> ≤ <span class="id" title="var">BSide</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>)%<span class="id" title="var">O</span> = (<span class="id" title="var">x</span> ≤ <span class="id" title="var">y</span>)%<span class="id" title="var">O</span>.<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">BSide_ltE</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> : (<span class="id" title="var">BSide</span> <span class="id" title="var">b</span> <span class="id" title="var">x</span> &lt; <span class="id" title="var">BSide</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>)%<span class="id" title="var">O</span> = (<span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span>)%<span class="id" title="var">O</span>.<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">BSide_leE</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> : (<span class="id" title="var">BSide</span> <span class="id" title="var">b</span> <span class="id" title="var">x</span> ≤ <span class="id" title="var">BSide</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>)%<span class="id" title="var">O</span> = (<span class="id" title="var">x</span> ≤ <span class="id" title="var">y</span>)%<span class="id" title="var">O</span>.<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">BInfty_leE</span> <span class="id" title="var">a</span> : (<span class="id" title="var">a</span> ≤ <span class="id" title="var">BInfty</span> <span class="id" title="var">T</span> <span class="id" title="var">false</span>)%<span class="id" title="var">O</span>.  <br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">BInfty_geE</span> <span class="id" title="var">a</span> : (<span class="id" title="var">BInfty</span> <span class="id" title="var">T</span> <span class="id" title="var">true</span> ≤ <span class="id" title="var">a</span>)%<span class="id" title="var">O</span>.  <br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">BInfty_le_eqE</span> <span class="id" title="var">a</span> : (<span class="id" title="var">BInfty</span> <span class="id" title="var">T</span> <span class="id" title="var">false</span> ≤ <span class="id" title="var">a</span>)%<span class="id" title="var">O</span> = (<span class="id" title="var">a</span> == <span class="id" title="var">BInfty</span> <span class="id" title="var">T</span> <span class="id" title="var">false</span>).<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">BInfty_ge_eqE</span> <span class="id" title="var">a</span> : (<span class="id" title="var">a</span> ≤ <span class="id" title="var">BInfty</span> <span class="id" title="var">T</span> <span class="id" title="var">true</span>)%<span class="id" title="var">O</span> = (<span class="id" title="var">a</span> == <span class="id" title="var">BInfty</span> <span class="id" title="var">T</span> <span class="id" title="var">true</span>).<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">BInfty_ltE</span> <span class="id" title="var">a</span> : (<span class="id" title="var">a</span> &lt; <span class="id" title="var">BInfty</span> <span class="id" title="var">T</span> <span class="id" title="var">false</span>)%<span class="id" title="var">O</span> = (<span class="id" title="var">a</span> != <span class="id" title="var">BInfty</span> <span class="id" title="var">T</span> <span class="id" title="var">false</span>).<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">BInfty_gtE</span> <span class="id" title="var">a</span> : (<span class="id" title="var">BInfty</span> <span class="id" title="var">T</span> <span class="id" title="var">true</span> &lt; <span class="id" title="var">a</span>)%<span class="id" title="var">O</span> = (<span class="id" title="var">a</span> != <span class="id" title="var">BInfty</span> <span class="id" title="var">T</span> <span class="id" title="var">true</span>).<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">BInfty_ltF</span> <span class="id" title="var">a</span> : (<span class="id" title="var">BInfty</span> <span class="id" title="var">T</span> <span class="id" title="var">false</span> &lt; <span class="id" title="var">a</span>)%<span class="id" title="var">O</span> = <span class="id" title="var">false</span>.<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">BInfty_gtF</span> <span class="id" title="var">a</span> : (<span class="id" title="var">a</span> &lt; <span class="id" title="var">BInfty</span> <span class="id" title="var">T</span> <span class="id" title="var">true</span>)%<span class="id" title="var">O</span> = <span class="id" title="var">false</span>.<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">BInfty_BInfty_ltE</span> : (<span class="id" title="var">BInfty</span> <span class="id" title="var">T</span> <span class="id" title="var">true</span> &lt; <span class="id" title="var">BInfty</span> <span class="id" title="var">T</span> <span class="id" title="var">false</span>)%<span class="id" title="var">O</span>.  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ltBRight_leBLeft</span> (<span class="id" title="var">a</span> : <span class="id" title="var">itv_bound</span> <span class="id" title="var">T</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">a</span> &lt; <span class="id" title="var">BRight</span> <span class="id" title="var">r</span>)%<span class="id" title="var">O</span> = (<span class="id" title="var">a</span> ≤ <span class="id" title="var">BLeft</span> <span class="id" title="var">r</span>)%<span class="id" title="var">O</span>.<br/>
 <span class="id" title="keyword">Lemma</span> <span class="id" title="var">leBRight_ltBLeft</span> (<span class="id" title="var">a</span> : <span class="id" title="var">itv_bound</span> <span class="id" title="var">T</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">BRight</span> <span class="id" title="var">r</span> ≤ <span class="id" title="var">a</span>)%<span class="id" title="var">O</span> = (<span class="id" title="var">BLeft</span> <span class="id" title="var">r</span> &lt; <span class="id" title="var">a</span>)%<span class="id" title="var">O</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">bnd_simp</span> := (<span class="id" title="var">BLeft_ltE</span>, <span class="id" title="var">BRight_leE</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">BRight_BLeft_leE</span>, <span class="id" title="var">BLeft_BRight_ltE</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">BRight_BSide_ltE</span>, <span class="id" title="var">BLeft_BSide_leE</span>, <span class="id" title="var">BSide_ltE</span>, <span class="id" title="var">BSide_leE</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">BInfty_leE</span>, <span class="id" title="var">BInfty_geE</span>, <span class="id" title="var">BInfty_BInfty_ltE</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">BInfty_le_eqE</span>, <span class="id" title="var">BInfty_ge_eqE</span>, <span class="id" title="var">BInfty_ltE</span>, <span class="id" title="var">BInfty_gtE</span>, <span class="id" title="var">BInfty_ltF</span>, <span class="id" title="var">BInfty_gtF</span>,<br/>
&nbsp;&nbsp;@<span class="id" title="var">lexx</span> <span class="id" title="var">_</span> <span class="id" title="var">T</span>, @<span class="id" title="var">ltxx</span> <span class="id" title="var">_</span> <span class="id" title="var">T</span>, @<span class="id" title="var">eqxx</span> <span class="id" title="var">T</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">itv_splitU1</span> (<span class="id" title="var">a</span> : <span class="id" title="var">itv_bound</span> <span class="id" title="var">T</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">T</span>) : (<span class="id" title="var">a</span> ≤ <span class="id" title="var">BLeft</span> <span class="id" title="var">x</span>)%<span class="id" title="var">O</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Interval</span> <span class="id" title="var">a</span> (<span class="id" title="var">BRight</span> <span class="id" title="var">x</span>) =<span class="id" title="var">i</span> [<span class="id" title="var">predU1</span> <span class="id" title="var">x</span> &amp; <span class="id" title="var">Interval</span> <span class="id" title="var">a</span> (<span class="id" title="var">BLeft</span> <span class="id" title="var">x</span>)].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">itv_split1U</span> (<span class="id" title="var">a</span> : <span class="id" title="var">itv_bound</span> <span class="id" title="var">T</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">T</span>) : (<span class="id" title="var">BRight</span> <span class="id" title="var">x</span> ≤ <span class="id" title="var">a</span>)%<span class="id" title="var">O</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Interval</span> (<span class="id" title="var">BLeft</span> <span class="id" title="var">x</span>) <span class="id" title="var">a</span> =<span class="id" title="var">i</span> [<span class="id" title="var">predU1</span> <span class="id" title="var">x</span> &amp; <span class="id" title="var">Interval</span> (<span class="id" title="var">BRight</span> <span class="id" title="var">x</span>) <span class="id" title="var">a</span>].<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">itv_simp</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">miditv</span> (<span class="id" title="var">R</span> : <span class="id" title="var">numDomainType</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">interval</span> <span class="id" title="var">R</span>) : <span class="id" title="var">R</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">i</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Interval</span> (<span class="id" title="var">BSide</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span>) (<span class="id" title="var">BSide</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span>) ⇒ (<span class="id" title="var">a</span> + <span class="id" title="var">b</span>) / 2%:<span class="id" title="var">R</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Interval</span> -<span class="id" title="var">oo</span>%<span class="id" title="var">O</span> (<span class="id" title="var">BSide</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span>) ⇒ <span class="id" title="var">b</span> - 1<br/>
&nbsp;&nbsp;| <span class="id" title="var">Interval</span> (<span class="id" title="var">BSide</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span>) +<span class="id" title="var">oo</span>%<span class="id" title="var">O</span> ⇒ <span class="id" title="var">a</span> + 1<br/>
&nbsp;&nbsp;| <span class="id" title="var">Interval</span> -<span class="id" title="var">oo</span>%<span class="id" title="var">O</span> +<span class="id" title="var">oo</span>%<span class="id" title="var">O</span> ⇒ 0<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ 0<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">miditv_lemmas</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">R</span> : <span class="id" title="var">numFieldType</span>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">i</span> : <span class="id" title="var">interval</span> <span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mem_miditv</span> <span class="id" title="var">i</span> : (<span class="id" title="var">i</span>.1 &lt; <span class="id" title="var">i</span>.2)%<span class="id" title="var">O</span> → <span class="id" title="var">miditv</span> <span class="id" title="var">i</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">miditv_le_left</span> <span class="id" title="var">i</span> <span class="id" title="var">b</span> : (<span class="id" title="var">i</span>.1 &lt; <span class="id" title="var">i</span>.2)%<span class="id" title="var">O</span> → (<span class="id" title="var">BSide</span> <span class="id" title="var">b</span> (<span class="id" title="var">miditv</span> <span class="id" title="var">i</span>) ≤ <span class="id" title="var">i</span>.2)%<span class="id" title="var">O</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">miditv_ge_right</span> <span class="id" title="var">i</span> <span class="id" title="var">b</span> : (<span class="id" title="var">i</span>.1 &lt; <span class="id" title="var">i</span>.2)%<span class="id" title="var">O</span> → (<span class="id" title="var">i</span>.1 ≤ <span class="id" title="var">BSide</span> <span class="id" title="var">b</span> (<span class="id" title="var">miditv</span> <span class="id" title="var">i</span>))%<span class="id" title="var">O</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">miditv_lemmas</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">itv_porderType</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">d</span> : <span class="id" title="var">unit</span>) (<span class="id" title="var">T</span> : <span class="id" title="var">orderType</span> <span class="id" title="var">d</span>).<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> (<span class="id" title="var">a</span> : <span class="id" title="var">itv_bound</span> <span class="id" title="var">T</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>) (<span class="id" title="var">i</span> <span class="id" title="var">j</span> : <span class="id" title="var">interval</span> <span class="id" title="var">T</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">bool</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predC_itvl</span> <span class="id" title="var">a</span> : [<span class="id" title="var">predC</span> <span class="id" title="var">Interval</span> -<span class="id" title="var">oo</span>%<span class="id" title="var">O</span> <span class="id" title="var">a</span>] =<span class="id" title="var">i</span> <span class="id" title="var">Interval</span> <span class="id" title="var">a</span> +<span class="id" title="var">oo</span>%<span class="id" title="var">O</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predC_itvr</span> <span class="id" title="var">a</span> : [<span class="id" title="var">predC</span> <span class="id" title="var">Interval</span> <span class="id" title="var">a</span> +<span class="id" title="var">oo</span>%<span class="id" title="var">O</span>] =<span class="id" title="var">i</span> <span class="id" title="var">Interval</span> -<span class="id" title="var">oo</span>%<span class="id" title="var">O</span> <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">predC_itv</span> <span class="id" title="var">i</span> : [<span class="id" title="var">predC</span> <span class="id" title="var">i</span>] =<span class="id" title="var">i</span> [<span class="id" title="var">predU</span> <span class="id" title="var">Interval</span> -<span class="id" title="var">oo</span>%<span class="id" title="var">O</span> <span class="id" title="var">i</span>.1 &amp; <span class="id" title="var">Interval</span> <span class="id" title="var">i</span>.2 +<span class="id" title="var">oo</span>%<span class="id" title="var">O</span>].<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">itv_porderType</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sumr_le0</span> (<span class="id" title="var">R</span> : <span class="id" title="var">numDomainType</span>) <span class="id" title="var">I</span> (<span class="id" title="var">r</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ 0)%<span class="id" title="var">R</span> → (\<span class="id" title="var">sum_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ 0)%<span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">enum_ord0</span> : <span class="id" title="var">enum</span> '<span class="id" title="var">I_0</span> = [::].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">enum_ordSr</span> <span class="id" title="var">n</span> : <span class="id" title="var">enum</span> '<span class="id" title="var">I_n</span>.+1 =<br/>
&nbsp;&nbsp;<span class="id" title="var">rcons</span> (<span class="id" title="var">map</span> (<span class="id" title="var">widen_ord</span> (<span class="id" title="var">leqnSn</span> <span class="id" title="var">_</span>)) (<span class="id" title="var">enum</span> '<span class="id" title="var">I_n</span>)) <span class="id" title="var">ord_max</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">obindEapp</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">option</span> <span class="id" title="var">rT</span>) : <span class="id" title="var">obind</span> <span class="id" title="var">f</span> = <span class="id" title="var">oapp</span> <span class="id" title="var">f</span> <span class="id" title="var">None</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">omapEbind</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) : <span class="id" title="var">omap</span> <span class="id" title="var">f</span> = <span class="id" title="var">obind</span> (<span class="id" title="var">olift</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">omapEapp</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) : <span class="id" title="var">omap</span> <span class="id" title="var">f</span> = <span class="id" title="var">oapp</span> (<span class="id" title="var">olift</span> <span class="id" title="var">f</span>) <span class="id" title="var">None</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oappEmap</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) (<span class="id" title="var">y0</span> : <span class="id" title="var">rT</span>) <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">oapp</span> <span class="id" title="var">f</span> <span class="id" title="var">y0</span> <span class="id" title="var">x</span> = <span class="id" title="var">odflt</span> <span class="id" title="var">y0</span> (<span class="id" title="var">omap</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">omap_comp</span> <span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">sT</span> (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">rT</span> → <span class="id" title="var">sT</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">omap</span> (<span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>) =1 <span class="id" title="var">omap</span> <span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">omap</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oapp_comp_f</span> {<span class="id" title="var">aT</span> <span class="id" title="var">rT</span> <span class="id" title="var">sT</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">aT</span> → <span class="id" title="var">rT</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">rT</span> → <span class="id" title="var">sT</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">rT</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">oapp</span> (<span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">f</span>) (<span class="id" title="var">g</span> <span class="id" title="var">x</span>) =1 <span class="id" title="var">g</span> \<span class="id" title="var">o</span> <span class="id" title="var">oapp</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">can_in_comp</span> [<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>] (<span class="id" title="var">D</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">B</span>}) (<span class="id" title="var">D'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">C</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">f</span> : <span class="id" title="var">B</span> → <span class="id" title="var">A</span>] [<span class="id" title="var">h</span> : <span class="id" title="var">C</span> → <span class="id" title="var">B</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">f'</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>] [<span class="id" title="var">h'</span> : <span class="id" title="var">B</span> → <span class="id" title="var">C</span>] :<br/>
&nbsp;&nbsp;{<span class="id" title="var">homo</span> <span class="id" title="var">h</span> : <span class="id" title="var">x</span> / <span class="id" title="var">x</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">D'</span> &gt;-&gt; <span class="id" title="var">x</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">D</span>} →<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">D</span>, <span class="id" title="var">cancel</span> <span class="id" title="var">f</span> <span class="id" title="var">f'</span>} → {<span class="id" title="tactic">in</span> <span class="id" title="var">D'</span>, <span class="id" title="var">cancel</span> <span class="id" title="var">h</span> <span class="id" title="var">h'</span>} →<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">D'</span>, <span class="id" title="var">cancel</span> (<span class="id" title="var">f</span> \<span class="id" title="var">o</span> <span class="id" title="var">h</span>) (<span class="id" title="var">h'</span> \<span class="id" title="var">o</span> <span class="id" title="var">f'</span>)}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_inj_comp</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> → <span class="id" title="var">A</span>) (<span class="id" title="var">h</span> : <span class="id" title="var">C</span> → <span class="id" title="var">B</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">B</span>) (<span class="id" title="var">Q</span> : <span class="id" title="var">pred</span> <span class="id" title="var">C</span>) :<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">P</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">f</span>} → {<span class="id" title="tactic">in</span> <span class="id" title="var">Q</span> &amp;, <span class="id" title="var">injective</span> <span class="id" title="var">h</span>} → {<span class="id" title="var">homo</span> <span class="id" title="var">h</span> : <span class="id" title="var">x</span> / <span class="id" title="var">Q</span> <span class="id" title="var">x</span> &gt;-&gt; <span class="id" title="var">P</span> <span class="id" title="var">x</span>} →<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">Q</span> &amp;, <span class="id" title="var">injective</span> (<span class="id" title="var">f</span> \<span class="id" title="var">o</span> <span class="id" title="var">h</span>)}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pcan_in_comp</span> [<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>] (<span class="id" title="var">D</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">B</span>}) (<span class="id" title="var">D'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">C</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">f</span> : <span class="id" title="var">B</span> → <span class="id" title="var">A</span>] [<span class="id" title="var">h</span> : <span class="id" title="var">C</span> → <span class="id" title="var">B</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">f'</span> : <span class="id" title="var">A</span> → <span class="id" title="var">option</span> <span class="id" title="var">B</span>] [<span class="id" title="var">h'</span> : <span class="id" title="var">B</span> → <span class="id" title="var">option</span> <span class="id" title="var">C</span>] :<br/>
&nbsp;&nbsp;{<span class="id" title="var">homo</span> <span class="id" title="var">h</span> : <span class="id" title="var">x</span> / <span class="id" title="var">x</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">D'</span> &gt;-&gt; <span class="id" title="var">x</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">D</span>} →<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">D</span>, <span class="id" title="var">pcancel</span> <span class="id" title="var">f</span> <span class="id" title="var">f'</span>} → {<span class="id" title="tactic">in</span> <span class="id" title="var">D'</span>, <span class="id" title="var">pcancel</span> <span class="id" title="var">h</span> <span class="id" title="var">h'</span>} →<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">D'</span>, <span class="id" title="var">pcancel</span> (<span class="id" title="var">f</span> \<span class="id" title="var">o</span> <span class="id" title="var">h</span>) (<span class="id" title="var">obind</span> <span class="id" title="var">h'</span> \<span class="id" title="var">o</span> <span class="id" title="var">f'</span>)}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ocan_comp</span> [<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>] [<span class="id" title="var">f</span> : <span class="id" title="var">B</span> → <span class="id" title="var">option</span> <span class="id" title="var">A</span>] [<span class="id" title="var">h</span> : <span class="id" title="var">C</span> → <span class="id" title="var">option</span> <span class="id" title="var">B</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">f'</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>] [<span class="id" title="var">h'</span> : <span class="id" title="var">B</span> → <span class="id" title="var">C</span>] :<br/>
&nbsp;&nbsp;<span class="id" title="var">ocancel</span> <span class="id" title="var">f</span> <span class="id" title="var">f'</span> → <span class="id" title="var">ocancel</span> <span class="id" title="var">h</span> <span class="id" title="var">h'</span> → <span class="id" title="var">ocancel</span> (<span class="id" title="var">obind</span> <span class="id" title="var">f</span> \<span class="id" title="var">o</span> <span class="id" title="var">h</span>) (<span class="id" title="var">h'</span> \<span class="id" title="var">o</span> <span class="id" title="var">f'</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eqbLR</span> (<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> : <span class="id" title="var">bool</span>) : <span class="id" title="var">b1</span> = <span class="id" title="var">b2</span> → <span class="id" title="var">b1</span> → <span class="id" title="var">b2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gtr_opp</span> (<span class="id" title="var">R</span> : <span class="id" title="var">numDomainType</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">R</span>) : (0 &lt; <span class="id" title="var">r</span>)%<span class="id" title="var">R</span> → (- <span class="id" title="var">r</span> &lt; <span class="id" title="var">r</span>)%<span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_le_trans</span> {<span class="id" title="var">disp</span> : <span class="id" title="var">unit</span>} {<span class="id" title="var">T</span> : <span class="id" title="var">porderType</span> <span class="id" title="var">disp</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> <span class="id" title="var">t</span> : <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">z</span> ≤ <span class="id" title="var">x</span>)%<span class="id" title="var">O</span> → (<span class="id" title="var">y</span> ≤ <span class="id" title="var">t</span>)%<span class="id" title="var">O</span> → (<span class="id" title="var">x</span> ≤ <span class="id" title="var">y</span>)%<span class="id" title="var">O</span> → (<span class="id" title="var">z</span> ≤ <span class="id" title="var">t</span>)%<span class="id" title="var">O</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">eqLHS</span> := (<span class="id" title="var">X</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">X</span> == <span class="id" title="var">_</span>))%<span class="id" title="tactic">pattern</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">eqRHS</span> := (<span class="id" title="var">X</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">_</span> == <span class="id" title="var">X</span>))%<span class="id" title="tactic">pattern</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">leLHS</span> := (<span class="id" title="var">X</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">X</span> ≤ <span class="id" title="var">_</span>)%<span class="id" title="var">O</span>)%<span class="id" title="tactic">pattern</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">leRHS</span> := (<span class="id" title="var">X</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">_</span> ≤ <span class="id" title="var">X</span>)%<span class="id" title="var">O</span>)%<span class="id" title="tactic">pattern</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">ltLHS</span> := (<span class="id" title="var">X</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">X</span> &lt; <span class="id" title="var">_</span>)%<span class="id" title="var">O</span>)%<span class="id" title="tactic">pattern</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">ltRHS</span> := (<span class="id" title="var">X</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">_</span> &lt; <span class="id" title="var">X</span>)%<span class="id" title="var">O</span>)%<span class="id" title="tactic">pattern</span>.<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">boxed</span> <span class="id" title="var">T</span> := <span class="id" title="var">Box</span> <span class="id" title="keyword">of</span> <span class="id" title="var">T</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_bigl_supp</span> [<span class="id" title="var">R</span> : <span class="id" title="var">eqType</span>] [<span class="id" title="var">idx</span> : <span class="id" title="var">R</span>] [<span class="id" title="var">op</span> : <span class="id" title="var">Monoid.law</span> <span class="id" title="var">idx</span>] [<span class="id" title="var">I</span> : <span class="id" title="keyword">Type</span>]<br/>
&nbsp;&nbsp;[<span class="id" title="var">r</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>] [<span class="id" title="var">P1</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>] (<span class="id" title="var">P2</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;{<span class="id" title="tactic">in</span> [<span class="id" title="var">pred</span> <span class="id" title="var">x</span> | <span class="id" title="var">F</span> <span class="id" title="var">x</span> != <span class="id" title="var">idx</span>], <span class="id" title="var">P1</span> =1 <span class="id" title="var">P2</span>} →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">idx</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P1</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = \<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">idx</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P2</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">perm_big_supp_cond</span> [<span class="id" title="var">R</span> : <span class="id" title="var">eqType</span>] [<span class="id" title="var">idx</span> : <span class="id" title="var">R</span>] [<span class="id" title="var">op</span> : <span class="id" title="var">Monoid.com_law</span> <span class="id" title="var">idx</span>] [<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>]<br/>
&nbsp;&nbsp;[<span class="id" title="var">r</span> <span class="id" title="var">s</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>] [<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>] (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">perm_eq</span> [<span class="id" title="var">seq</span> <span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span> &amp;&amp; (<span class="id" title="var">F</span> <span class="id" title="var">i</span> != <span class="id" title="var">idx</span>)] [<span class="id" title="var">seq</span> <span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span> &amp;&amp; (<span class="id" title="var">F</span> <span class="id" title="var">i</span> != <span class="id" title="var">idx</span>)] →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">idx</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = \<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">idx</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span>| <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">perm_big_supp</span> [<span class="id" title="var">R</span> : <span class="id" title="var">eqType</span>] [<span class="id" title="var">idx</span> : <span class="id" title="var">R</span>] [<span class="id" title="var">op</span> : <span class="id" title="var">Monoid.com_law</span> <span class="id" title="var">idx</span>] [<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>]<br/>
&nbsp;&nbsp;[<span class="id" title="var">r</span> <span class="id" title="var">s</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>] [<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>] (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">perm_eq</span> [<span class="id" title="var">seq</span> <span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | (<span class="id" title="var">F</span> <span class="id" title="var">i</span> != <span class="id" title="var">idx</span>)] [<span class="id" title="var">seq</span> <span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | (<span class="id" title="var">F</span> <span class="id" title="var">i</span> != <span class="id" title="var">idx</span>)] →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">idx</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = \<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">idx</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span>| <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">order_scope</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">ring_scope</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">GRing.Theory</span> <span class="id" title="var">Order.TTheory</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mulr_ge0_gt0</span> (<span class="id" title="var">R</span> : <span class="id" title="var">numDomainType</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">R</span>) : 0 ≤ <span class="id" title="var">x</span> → 0 ≤ <span class="id" title="var">y</span> →<br/>
&nbsp;&nbsp;(0 &lt; <span class="id" title="var">x</span> × <span class="id" title="var">y</span>) = (0 &lt; <span class="id" title="var">x</span>) &amp;&amp; (0 &lt; <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">lt_le_gt_ge</span>.<br/>
<span class="id" title="keyword">Variable</span> (<span class="id" title="var">R</span> : <span class="id" title="var">numFieldType</span>).<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splitr</span> <span class="id" title="var">x</span> : <span class="id" title="var">x</span> = <span class="id" title="var">x</span> / 2%:<span class="id" title="var">R</span> + <span class="id" title="var">x</span> / 2%:<span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ler_addgt0Pr</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">reflect</span> (<span class="id" title="keyword">∀</span> <span class="id" title="var">e</span>, <span class="id" title="var">e</span> &gt; 0 → <span class="id" title="var">x</span> ≤ <span class="id" title="var">y</span> + <span class="id" title="var">e</span>) (<span class="id" title="var">x</span> ≤ <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ler_addgt0Pl</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">reflect</span> (<span class="id" title="keyword">∀</span> <span class="id" title="var">e</span>, <span class="id" title="var">e</span> &gt; 0 → <span class="id" title="var">x</span> ≤ <span class="id" title="var">e</span> + <span class="id" title="var">y</span>) (<span class="id" title="var">x</span> ≤ <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_segment_addgt0Pr</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">reflect</span> (<span class="id" title="keyword">∀</span> <span class="id" title="var">e</span>, <span class="id" title="var">e</span> &gt; 0 → <span class="id" title="var">y</span> \<span class="id" title="tactic">in</span> `[<span class="id" title="var">x</span> - <span class="id" title="var">e</span>, <span class="id" title="var">z</span> + <span class="id" title="var">e</span>]) (<span class="id" title="var">y</span> \<span class="id" title="tactic">in</span> `[<span class="id" title="var">x</span>, <span class="id" title="var">z</span>]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_segment_addgt0Pl</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">reflect</span> (<span class="id" title="keyword">∀</span> <span class="id" title="var">e</span>, <span class="id" title="var">e</span> &gt; 0 → <span class="id" title="var">y</span> \<span class="id" title="tactic">in</span> `[(- <span class="id" title="var">e</span> + <span class="id" title="var">x</span>), (<span class="id" title="var">e</span> + <span class="id" title="var">z</span>)]) (<span class="id" title="var">y</span> \<span class="id" title="tactic">in</span> `[<span class="id" title="var">x</span>, <span class="id" title="var">z</span>]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_le</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">x</span> &lt; <span class="id" title="var">a</span> → <span class="id" title="var">x</span> &lt; <span class="id" title="var">b</span>) → <span class="id" title="var">a</span> ≤ <span class="id" title="var">b</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gt_ge</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">b</span> &lt; <span class="id" title="var">x</span> → <span class="id" title="var">a</span> &lt; <span class="id" title="var">x</span>) → <span class="id" title="var">a</span> ≤ <span class="id" title="var">b</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">lt_le_gt_ge</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">itvxx</span> <span class="id" title="var">d</span> (<span class="id" title="var">T</span> : <span class="id" title="var">porderType</span> <span class="id" title="var">d</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">T</span>) : `[<span class="id" title="var">x</span>, <span class="id" title="var">x</span>] =<span class="id" title="var">i</span> <span class="id" title="var">pred1</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">itvxxP</span> <span class="id" title="var">d</span> (<span class="id" title="var">T</span> : <span class="id" title="var">porderType</span> <span class="id" title="var">d</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>) : <span class="id" title="var">reflect</span> (<span class="id" title="var">y</span> = <span class="id" title="var">x</span>) (<span class="id" title="var">y</span> \<span class="id" title="tactic">in</span> `[<span class="id" title="var">x</span>, <span class="id" title="var">x</span>]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subset_itv_oo_cc</span> <span class="id" title="var">d</span> (<span class="id" title="var">T</span> : <span class="id" title="var">porderType</span> <span class="id" title="var">d</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">T</span>) : {<span class="id" title="var">subset</span> `]<span class="id" title="var">a</span>, <span class="id" title="var">b</span>[ ≤ `[<span class="id" title="var">a</span>, <span class="id" title="var">b</span>]}.<br/>

<br/>
</div>

<div class="doc"> End of MathComp 1.15 additions
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;`1- r" (<span class="id" title="var">format</span> "`1- r", <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2).<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;f \^-1" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 3, <span class="id" title="var">format</span> "f \^-1").<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">natr1</span> (<span class="id" title="var">R</span> : <span class="id" title="var">ringType</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : (<span class="id" title="var">n</span>%:<span class="id" title="var">R</span> + 1 = <span class="id" title="var">n</span>.+1%:<span class="id" title="var">R</span> :&gt; <span class="id" title="var">R</span>)%<span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nat1r</span> (<span class="id" title="var">R</span> : <span class="id" title="var">ringType</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : (1 + <span class="id" title="var">n</span>%:<span class="id" title="var">R</span> = <span class="id" title="var">n</span>.+1%:<span class="id" title="var">R</span> :&gt; <span class="id" title="var">R</span>)%<span class="id" title="var">R</span>.<br/>

<br/>
</div>

<div class="doc"> To be backported to finmap
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fset_nat_maximum</span> (<span class="id" title="var">X</span> : <span class="id" title="var">choiceType</span>) (<span class="id" title="var">A</span> : {<span class="id" title="var">fset</span> <span class="id" title="var">X</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">X</span> → <span class="id" title="var">nat</span>) : <span class="id" title="var">A</span> != <span class="id" title="var">fset0</span> →<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">∃</span> <span class="id" title="var">i</span>, <span class="id" title="var">i</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> ∧ <span class="id" title="keyword">∀</span> <span class="id" title="var">j</span>, <span class="id" title="var">j</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">A</span> → <span class="id" title="var">f</span> <span class="id" title="var">j</span> ≤ <span class="id" title="var">f</span> <span class="id" title="var">i</span>)%<span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">image_nat_maximum</span> <span class="id" title="var">n</span> (<span class="id" title="var">f</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">∃</span> <span class="id" title="var">i</span>, <span class="id" title="var">i</span> ≤ <span class="id" title="var">n</span> ∧ <span class="id" title="keyword">∀</span> <span class="id" title="var">j</span>, <span class="id" title="var">j</span> ≤ <span class="id" title="var">n</span> → <span class="id" title="var">f</span> <span class="id" title="var">j</span> ≤ <span class="id" title="var">f</span> <span class="id" title="var">i</span>)%<span class="id" title="var">N</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">card_fset_sum1</span> (<span class="id" title="var">T</span> : <span class="id" title="var">choiceType</span>) (<span class="id" title="var">A</span> : {<span class="id" title="var">fset</span> <span class="id" title="var">T</span>}) :<br/>
&nbsp;&nbsp;#|` <span class="id" title="var">A</span>| = (\<span class="id" title="var">sum_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">A</span>) 1)%<span class="id" title="var">N</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">big_rmcond</span> {<span class="id" title="var">R</span> <span class="id" title="var">idx</span> <span class="id" title="var">op</span> <span class="id" title="var">I</span> <span class="id" title="var">r</span>} <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">big_rmcond_in</span> {<span class="id" title="var">R</span> <span class="id" title="var">idx</span> <span class="id" title="var">op</span> <span class="id" title="var">I</span> <span class="id" title="var">r</span>} <span class="id" title="var">P</span>.<br/>

<br/>
</div>

<div class="doc"> MathComp 1.16.0 additions
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">bigminr_maxr</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Num.Def</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigminr_maxr</span> (<span class="id" title="var">R</span> : <span class="id" title="var">realDomainType</span>) <span class="id" title="var">I</span> <span class="id" title="var">r</span> (<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">minr</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = - \<span class="id" title="var">big</span>[<span class="id" title="var">maxr</span>/- <span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) - <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">bigminr_maxr</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">SemiGroupProperties</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">R</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">op</span> : <span class="id" title="var">R</span> → <span class="id" title="var">R</span> → <span class="id" title="var">R</span>).<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">opA</span> : <span class="id" title="var">associative</span> <span class="id" title="var">op</span>.<br/>

<br/>
</div>

<div class="doc"> Convert an AC op : R -&gt; R -&gt; R to a com_law on option R
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">AC_subdef</span> <span class="id" title="keyword">of</span> <span class="id" title="var">associative</span> <span class="id" title="var">op</span> &amp; <span class="id" title="var">commutative</span> <span class="id" title="var">op</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">oapp</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> ⇒ <span class="id" title="var">Some</span> (<span class="id" title="var">oapp</span> (<span class="id" title="var">op</span>^~ <span class="id" title="var">y</span>) <span class="id" title="var">y</span> <span class="id" title="var">x</span>)) <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">oAC</span> := <span class="id" title="var">nosimpl</span> <span class="id" title="var">AC_subdef</span>.<br/>

<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">opC</span> : <span class="id" title="var">commutative</span> <span class="id" title="var">op</span>.<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">opCA</span> : <span class="id" title="var">left_commutative</span> <span class="id" title="var">op</span>.  <br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">opAC</span> : <span class="id" title="var">right_commutative</span> <span class="id" title="var">op</span>.<br/>

<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">opyy</span> : <span class="id" title="var">idempotent</span> <span class="id" title="var">op</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">opACE</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">oop</span> (<span class="id" title="var">Some</span> <span class="id" title="var">x</span>) (<span class="id" title="var">Some</span> <span class="id" title="var">y</span>) = <span class="id" title="var">some</span> (<span class="id" title="var">op</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oopA_subdef</span> : <span class="id" title="var">associative</span> <span class="id" title="var">oop</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oopx1_subdef</span> : <span class="id" title="var">left_id</span> <span class="id" title="var">None</span> <span class="id" title="var">oop</span>.  <br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oop1x_subdef</span> : <span class="id" title="var">right_id</span> <span class="id" title="var">None</span> <span class="id" title="var">oop</span>.  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">oopC_subdef</span> : <span class="id" title="var">commutative</span> <span class="id" title="var">oop</span>.<br/>

<br/>
<span class="id" title="keyword">Canonical</span> <span class="id" title="var">opAC_law</span> := <span class="id" title="var">Monoid.Law</span> <span class="id" title="var">oopA_subdef</span> <span class="id" title="var">oopx1_subdef</span> <span class="id" title="var">oop1x_subdef</span>.<br/>
<span class="id" title="keyword">Canonical</span> <span class="id" title="var">opAC_com_law</span> := <span class="id" title="var">Monoid.ComLaw</span> <span class="id" title="var">oopC_subdef</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span> [<span class="id" title="var">x</span> : <span class="id" title="var">R</span>].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">some_big_AC</span> [<span class="id" title="var">I</span> : <span class="id" title="keyword">Type</span>] <span class="id" title="var">r</span> <span class="id" title="var">P</span> (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">Some</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) =<br/>
&nbsp;&nbsp;<span class="id" title="var">oop</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">oop</span>/<span class="id" title="var">None</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">Some</span> (<span class="id" title="var">F</span> <span class="id" title="var">i</span>)) (<span class="id" title="var">Some</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">big_ACE</span> [<span class="id" title="var">I</span> : <span class="id" title="keyword">Type</span>] <span class="id" title="var">r</span> <span class="id" title="var">P</span> (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> =<br/>
&nbsp;&nbsp;<span class="id" title="var">odflt</span> <span class="id" title="var">x</span> (<span class="id" title="var">oop</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">oop</span>/<span class="id" title="var">None</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">Some</span> (<span class="id" title="var">F</span> <span class="id" title="var">i</span>)) (<span class="id" title="var">Some</span> <span class="id" title="var">x</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">big_undup_AC</span> [<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>] <span class="id" title="var">r</span> <span class="id" title="var">P</span> (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) (<span class="id" title="var">opK</span> : <span class="id" title="var">idempotent</span> <span class="id" title="var">op</span>) :<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">undup</span> <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = \<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">perm_big_AC</span> [<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>] [<span class="id" title="var">r</span>] <span class="id" title="var">s</span> [<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>] [<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>] :<br/>
&nbsp;<span class="id" title="var">perm_eq</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span> → \<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = \<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Id</span>.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">opxx</span> : <span class="id" title="var">op</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span> = <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">big_const_idem</span> <span class="id" title="var">I</span> (<span class="id" title="var">r</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>) <span class="id" title="var">P</span> : \<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">x</span> = <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">big_id_idem</span> <span class="id" title="var">I</span> (<span class="id" title="var">r</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>) <span class="id" title="var">P</span> <span class="id" title="var">F</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">op</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) <span class="id" title="var">x</span> = \<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">big_mkcond_idem</span> <span class="id" title="var">I</span> <span class="id" title="var">r</span> (<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>) <span class="id" title="var">F</span> :<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = \<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span>) (<span class="id" title="keyword">if</span> <span class="id" title="var">P</span> <span class="id" title="var">i</span> <span class="id" title="keyword">then</span> <span class="id" title="var">F</span> <span class="id" title="var">i</span> <span class="id" title="keyword">else</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">big_split_idem</span> <span class="id" title="var">I</span> <span class="id" title="var">r</span> (<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>) <span class="id" title="var">F1</span> <span class="id" title="var">F2</span> :<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">op</span> (<span class="id" title="var">F1</span> <span class="id" title="var">i</span>) (<span class="id" title="var">F2</span> <span class="id" title="var">i</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">op</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F1</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F2</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">big_id_idem_AC</span> <span class="id" title="var">I</span> (<span class="id" title="var">r</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>) <span class="id" title="var">P</span> <span class="id" title="var">F</span> :<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">op</span> (<span class="id" title="var">F</span> <span class="id" title="var">i</span>) <span class="id" title="var">x</span> = \<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigID_idem</span> <span class="id" title="var">I</span> <span class="id" title="var">r</span> (<span class="id" title="var">a</span> <span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>) <span class="id" title="var">F</span> :<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">op</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span> &amp;&amp; <span class="id" title="var">a</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span> &amp;&amp; ~~ <span class="id" title="var">a</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Id</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">big_rem_AC</span> (<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>) <span class="id" title="var">z</span> (<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>) <span class="id" title="var">F</span> : <span class="id" title="var">z</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">r</span> →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">y</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">y</span>) <span class="id" title="var">F</span> <span class="id" title="var">y</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">P</span> <span class="id" title="var">z</span> <span class="id" title="keyword">then</span> <span class="id" title="var">op</span> (<span class="id" title="var">F</span> <span class="id" title="var">z</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">y</span> &lt;- <span class="id" title="var">rem</span> <span class="id" title="var">z</span> <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">y</span>) <span class="id" title="var">F</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> \<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">y</span> &lt;- <span class="id" title="var">rem</span> <span class="id" title="var">z</span> <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">y</span>) <span class="id" title="var">F</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigD1_AC</span> (<span class="id" title="var">I</span> : <span class="id" title="var">finType</span>) <span class="id" title="var">j</span> (<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>) <span class="id" title="var">F</span> : <span class="id" title="var">P</span> <span class="id" title="var">j</span> →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = <span class="id" title="var">op</span> (<span class="id" title="var">F</span> <span class="id" title="var">j</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span> &amp;&amp; (<span class="id" title="var">i</span> != <span class="id" title="var">j</span>)) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">le</span> : <span class="id" title="var">rel</span> <span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">le_refl</span> : <span class="id" title="var">reflexive</span> <span class="id" title="var">le</span>.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">op_incr</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">le</span> <span class="id" title="var">x</span> (<span class="id" title="var">op</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sub_big</span> <span class="id" title="var">I</span> [<span class="id" title="var">s</span>] (<span class="id" title="var">P</span> <span class="id" title="var">P'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">I</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) : (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) →<br/>
&nbsp;&nbsp;<span class="id" title="var">le</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sub_big_seq</span> (<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>) <span class="id" title="var">s</span> <span class="id" title="var">s'</span> <span class="id" title="var">P</span> (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">count_mem</span> <span class="id" title="var">i</span> <span class="id" title="var">s</span> ≤ <span class="id" title="var">count_mem</span> <span class="id" title="var">i</span> <span class="id" title="var">s'</span>)%<span class="id" title="var">N</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">le</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s'</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sub_big_seq_cond</span> (<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>) <span class="id" title="var">s</span> <span class="id" title="var">s'</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span> (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">count_mem</span> <span class="id" title="var">i</span> (<span class="id" title="var">filter</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>) ≤ <span class="id" title="var">count_mem</span> <span class="id" title="var">i</span> (<span class="id" title="var">filter</span> <span class="id" title="var">P'</span> <span class="id" title="var">s'</span>))%<span class="id" title="var">N</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">le</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">uniq_sub_big</span> (<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>) <span class="id" title="var">s</span> <span class="id" title="var">s'</span> <span class="id" title="var">P</span> (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) : <span class="id" title="var">uniq</span> <span class="id" title="var">s</span> → <span class="id" title="var">uniq</span> <span class="id" title="var">s'</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">subset</span> <span class="id" title="var">s</span> ≤ <span class="id" title="var">s'</span>} →<br/>
&nbsp;&nbsp;<span class="id" title="var">le</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s'</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">uniq_sub_big_cond</span> (<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>) <span class="id" title="var">s</span> <span class="id" title="var">s'</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span> (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uniq</span> (<span class="id" title="var">filter</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>) → <span class="id" title="var">uniq</span> (<span class="id" title="var">filter</span> <span class="id" title="var">P'</span> <span class="id" title="var">s'</span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">subset</span> [<span class="id" title="var">seq</span> <span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>] ≤ [<span class="id" title="var">seq</span> <span class="id" title="var">i</span> &lt;- <span class="id" title="var">s'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">le</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sub_big_idem</span> (<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>) <span class="id" title="var">s</span> <span class="id" title="var">s'</span> <span class="id" title="var">P</span> (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">subset</span> <span class="id" title="var">s</span> ≤ <span class="id" title="var">s'</span>} →<br/>
&nbsp;&nbsp;<span class="id" title="var">le</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s'</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sub_big_idem_cond</span> (<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>) <span class="id" title="var">s</span> <span class="id" title="var">s'</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span> (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">subset</span> [<span class="id" title="var">seq</span> <span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>] ≤ [<span class="id" title="var">seq</span> <span class="id" title="var">i</span> &lt;- <span class="id" title="var">s'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>]} →<br/>
&nbsp;&nbsp;<span class="id" title="var">le</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sub_in_big</span> [<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>] (<span class="id" title="var">s</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>) (<span class="id" title="var">P</span> <span class="id" title="var">P'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">I</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">s</span>, <span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">P'</span> <span class="id" title="var">i</span>} →<br/>
&nbsp;&nbsp;<span class="id" title="var">le</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_big_ord</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> [<span class="id" title="var">P</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">nat</span>}] [<span class="id" title="var">F</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">R</span>] : (<span class="id" title="var">n</span> ≤ <span class="id" title="var">m</span>)%<span class="id" title="var">N</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">le</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subset_big</span> [<span class="id" title="var">I</span> : <span class="id" title="var">finType</span>] [<span class="id" title="var">A</span> <span class="id" title="var">A'</span> <span class="id" title="var">P</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">I</span>}] (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> \<span class="id" title="var">subset</span> <span class="id" title="var">A'</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">le</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A'</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subset_big_cond</span> (<span class="id" title="var">I</span> : <span class="id" title="var">finType</span>) (<span class="id" title="var">A</span> <span class="id" title="var">A'</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">I</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">set</span> <span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>]  \<span class="id" title="var">subset</span> [<span class="id" title="tactic">set</span> <span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>] →<br/>
&nbsp;&nbsp;<span class="id" title="var">le</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_big_nat_cond</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span> (<span class="id" title="var">P</span> <span class="id" title="var">P'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">nat</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">n'</span> ≤ <span class="id" title="var">n</span>)%<span class="id" title="var">N</span> → (<span class="id" title="var">m</span> ≤ <span class="id" title="var">m'</span>)%<span class="id" title="var">N</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, (<span class="id" title="var">n</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span>)%<span class="id" title="var">N</span> → <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) →<br/>
&nbsp;&nbsp;<span class="id" title="var">le</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">n</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">n'</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_big_nat</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span> [<span class="id" title="var">P</span>] [<span class="id" title="var">F</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">R</span>] : (<span class="id" title="var">n'</span> ≤ <span class="id" title="var">n</span>)%<span class="id" title="var">N</span> → (<span class="id" title="var">m</span> ≤ <span class="id" title="var">m'</span>)%<span class="id" title="var">N</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">le</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">n</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">n'</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m'</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_big_ord_cond</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="var">P</span> <span class="id" title="var">P'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">nat</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">n</span> ≤ <span class="id" title="var">m</span>)%<span class="id" title="var">N</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span> : '<span class="id" title="var">I_n</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) →<br/>
&nbsp;&nbsp;<span class="id" title="var">le</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">op</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">SemiGroupProperties</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">bigmaxmin</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">order_scope</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">d</span> : <span class="id" title="var">_</span>) (<span class="id" title="var">T</span> : <span class="id" title="var">porderType</span> <span class="id" title="var">d</span>).<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">I</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>) (<span class="id" title="var">x0</span> <span class="id" title="var">x</span> : <span class="id" title="var">T</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmax_le</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">x0</span> ≤ <span class="id" title="var">x</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">f</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">x</span>) → \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">f</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmax_lt</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">x0</span> &lt; <span class="id" title="var">x</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">f</span> <span class="id" title="var">i</span> &lt; <span class="id" title="var">x</span>) → \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">f</span> <span class="id" title="var">i</span> &lt; <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_bigmin</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> &lt; <span class="id" title="var">x0</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">x</span> &lt; <span class="id" title="var">f</span> <span class="id" title="var">i</span>) → <span class="id" title="var">x</span> &lt; \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">f</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_bigmin</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> ≤ <span class="id" title="var">x0</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">x</span> ≤ <span class="id" title="var">f</span> <span class="id" title="var">i</span>) → <span class="id" title="var">x</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">f</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">bigmaxmin</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">bigmax</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">order_scope</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">d</span> : <span class="id" title="var">unit</span>) (<span class="id" title="var">T</span> : <span class="id" title="var">orderType</span> <span class="id" title="var">d</span>).<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">bigmax_Type</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">I</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">T</span>).<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> (<span class="id" title="var">P</span> <span class="id" title="var">a</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmax_mkcond</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> : \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> =<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span>) (<span class="id" title="keyword">if</span> <span class="id" title="var">P</span> <span class="id" title="var">i</span> <span class="id" title="keyword">then</span> <span class="id" title="var">F</span> <span class="id" title="var">i</span> <span class="id" title="keyword">else</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmax_split</span> <span class="id" title="var">P</span> <span class="id" title="var">F1</span> <span class="id" title="var">F2</span> :<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) (<span class="id" title="var">max</span> (<span class="id" title="var">F1</span> <span class="id" title="var">i</span>) (<span class="id" title="var">F2</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;<span class="id" title="var">max</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F1</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F2</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmax_idl</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> :<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = <span class="id" title="var">max</span> <span class="id" title="var">x</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmax_idr</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> :<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = <span class="id" title="var">max</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmaxID</span> <span class="id" title="var">a</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> : \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> =<br/>
&nbsp;&nbsp;<span class="id" title="var">max</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span> &amp;&amp; <span class="id" title="var">a</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span> &amp;&amp; ~~ <span class="id" title="var">a</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">bigmax_Type</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">le_maxr_id</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>) : <span class="id" title="var">x</span> ≤ <span class="id" title="var">max</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sub_bigmax</span> [<span class="id" title="var">x0</span>] <span class="id" title="var">I</span> <span class="id" title="var">s</span> (<span class="id" title="var">P</span> <span class="id" title="var">P'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">I</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sub_bigmax_seq</span> [<span class="id" title="var">x0</span>] (<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>) <span class="id" title="var">s</span> <span class="id" title="var">s'</span> <span class="id" title="var">P</span> (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>) : {<span class="id" title="var">subset</span> <span class="id" title="var">s</span> ≤ <span class="id" title="var">s'</span>} →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s'</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sub_bigmax_cond</span> [<span class="id" title="var">x0</span>] (<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>) <span class="id" title="var">s</span> <span class="id" title="var">s'</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span> (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">subset</span> [<span class="id" title="var">seq</span> <span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>] ≤ [<span class="id" title="var">seq</span> <span class="id" title="var">i</span> &lt;- <span class="id" title="var">s'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>]} →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sub_in_bigmax</span> [<span class="id" title="var">x0</span>] [<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>] (<span class="id" title="var">s</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>) (<span class="id" title="var">P</span> <span class="id" title="var">P'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">I</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">s</span>, <span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">P'</span> <span class="id" title="var">i</span>} →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_bigmax_nat</span> [<span class="id" title="var">x0</span>] <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span> <span class="id" title="var">P</span> (<span class="id" title="var">F</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">T</span>) : <span class="id" title="var">n'</span> ≤ <span class="id" title="var">n</span> → <span class="id" title="var">m</span> ≤ <span class="id" title="var">m'</span> →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">n</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">n'</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m'</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_bigmax_nat_cond</span> [<span class="id" title="var">x0</span>] <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span> (<span class="id" title="var">P</span> <span class="id" title="var">P'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">nat</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">n'</span> ≤ <span class="id" title="var">n</span>)%<span class="id" title="var">N</span> → (<span class="id" title="var">m</span> ≤ <span class="id" title="var">m'</span>)%<span class="id" title="var">N</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">n</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span> → <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">n</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">n'</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_bigmax_ord</span> [<span class="id" title="var">x0</span>] <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="var">P</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">nat</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">T</span>) : (<span class="id" title="var">n</span> ≤ <span class="id" title="var">m</span>)%<span class="id" title="var">N</span> →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_bigmax_ord_cond</span> [<span class="id" title="var">x0</span>] <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="var">P</span> <span class="id" title="var">P'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">nat</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">n</span> ≤ <span class="id" title="var">m</span>)%<span class="id" title="var">N</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span> : '<span class="id" title="var">I_n</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subset_bigmax</span> [<span class="id" title="var">x0</span>] [<span class="id" title="var">I</span> : <span class="id" title="var">finType</span>] (<span class="id" title="var">A</span> <span class="id" title="var">A'</span> <span class="id" title="var">P</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">I</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> \<span class="id" title="var">subset</span> <span class="id" title="var">A'</span> →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A'</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subset_bigmax_cond</span> [<span class="id" title="var">x0</span>] (<span class="id" title="var">I</span> : <span class="id" title="var">finType</span>) (<span class="id" title="var">A</span> <span class="id" title="var">A'</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">I</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">set</span> <span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>]  \<span class="id" title="var">subset</span> [<span class="id" title="tactic">set</span> <span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>] →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">bigmax_finType</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">I</span> : <span class="id" title="var">finType</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">T</span>).<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> (<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmaxD1</span> <span class="id" title="var">j</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> : <span class="id" title="var">P</span> <span class="id" title="var">j</span> →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = <span class="id" title="var">max</span> (<span class="id" title="var">F</span> <span class="id" title="var">j</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span> &amp;&amp; (<span class="id" title="var">i</span> != <span class="id" title="var">j</span>)) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_bigmax_cond</span> <span class="id" title="var">j</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> : <span class="id" title="var">P</span> <span class="id" title="var">j</span> → <span class="id" title="var">F</span> <span class="id" title="var">j</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_bigmax</span> <span class="id" title="var">F</span> <span class="id" title="var">j</span> : <span class="id" title="var">F</span> <span class="id" title="var">j</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_i</span> <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
</div>

<div class="doc"> NB: as of [2022-08-02], bigop.bigmax_sup already exists for nat
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmax_sup</span> <span class="id" title="var">j</span> <span class="id" title="var">P</span> <span class="id" title="var">m</span> <span class="id" title="var">F</span> : <span class="id" title="var">P</span> <span class="id" title="var">j</span> → <span class="id" title="var">m</span> ≤ <span class="id" title="var">F</span> <span class="id" title="var">j</span> → <span class="id" title="var">m</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmax_leP</span> <span class="id" title="var">m</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> : <span class="id" title="var">reflect</span> (<span class="id" title="var">x</span> ≤ <span class="id" title="var">m</span> ∧ <span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmax_ltP</span> <span class="id" title="var">m</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">reflect</span> (<span class="id" title="var">x</span> &lt; <span class="id" title="var">m</span> ∧ <span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">F</span> <span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmax_eq_arg</span> <span class="id" title="var">j</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> : <span class="id" title="var">P</span> <span class="id" title="var">j</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">x</span> ≤ <span class="id" title="var">F</span> <span class="id" title="var">i</span>) →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = <span class="id" title="var">F</span> [<span class="id" title="var">arg</span> <span class="id" title="var">max_</span>(<span class="id" title="var">i</span> &gt; <span class="id" title="var">j</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_bigmax</span> <span class="id" title="var">j</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> : <span class="id" title="var">P</span> <span class="id" title="var">j</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">x</span> ≤ <span class="id" title="var">F</span> <span class="id" title="var">i</span>) →<br/>
&nbsp;&nbsp;{<span class="id" title="var">i0</span> | <span class="id" title="var">i0</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">P</span> &amp; \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = <span class="id" title="var">F</span> <span class="id" title="var">i0</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_bigmax2</span> <span class="id" title="var">P</span> <span class="id" title="var">F1</span> <span class="id" title="var">F2</span> : (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">F1</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">F2</span> <span class="id" title="var">i</span>) →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F1</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">max</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F2</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">bigmax_finType</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">bigmax</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">bigmax_mkcond</span> {<span class="id" title="var">d</span> <span class="id" title="var">T</span> <span class="id" title="var">I</span> <span class="id" title="var">r</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">bigmaxID</span> {<span class="id" title="var">d</span> <span class="id" title="var">T</span> <span class="id" title="var">I</span> <span class="id" title="var">r</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">bigmaxD1</span> {<span class="id" title="var">d</span> <span class="id" title="var">T</span> <span class="id" title="var">I</span> <span class="id" title="var">x</span>} <span class="id" title="var">j</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">bigmax_sup</span> {<span class="id" title="var">d</span> <span class="id" title="var">T</span> <span class="id" title="var">I</span> <span class="id" title="var">x</span>} <span class="id" title="var">j</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">bigmax_eq_arg</span> {<span class="id" title="var">d</span> <span class="id" title="var">T</span> <span class="id" title="var">I</span>} <span class="id" title="var">x</span> <span class="id" title="var">j</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">eq_bigmax</span> {<span class="id" title="var">d</span> <span class="id" title="var">T</span> <span class="id" title="var">I</span> <span class="id" title="var">x</span>} <span class="id" title="var">j</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">bigmin</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">order_scope</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">d</span> : <span class="id" title="var">_</span>) (<span class="id" title="var">T</span> : <span class="id" title="var">orderType</span> <span class="id" title="var">d</span>).<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">bigmin_Type</span>.<br/>
<span class="id" title="keyword">Variable</span> (<span class="id" title="var">I</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">T</span>).<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> (<span class="id" title="var">P</span> <span class="id" title="var">a</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmin_mkcond</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> : \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> =<br/>
&nbsp;&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span>) (<span class="id" title="keyword">if</span> <span class="id" title="var">P</span> <span class="id" title="var">i</span> <span class="id" title="keyword">then</span> <span class="id" title="var">F</span> <span class="id" title="var">i</span> <span class="id" title="keyword">else</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmin_split</span> <span class="id" title="var">P</span> <span class="id" title="var">F1</span> <span class="id" title="var">F2</span> :<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) (<span class="id" title="var">min</span> (<span class="id" title="var">F1</span> <span class="id" title="var">i</span>) (<span class="id" title="var">F2</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;<span class="id" title="var">min</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F1</span> <span class="id" title="var">i</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F2</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmin_idl</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> :<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = <span class="id" title="var">min</span> <span class="id" title="var">x</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmin_idr</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> :<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = <span class="id" title="var">min</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>) <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigminID</span> <span class="id" title="var">a</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> : \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> =<br/>
&nbsp;&nbsp;<span class="id" title="var">min</span> (\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span> &amp;&amp; <span class="id" title="var">a</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">r</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span> &amp;&amp; ~~ <span class="id" title="var">a</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">bigmin_Type</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">le_minr_id</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>) : <span class="id" title="var">x</span> ≥ <span class="id" title="var">min</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sub_bigmin</span> [<span class="id" title="var">x0</span>] <span class="id" title="var">I</span> <span class="id" title="var">s</span> (<span class="id" title="var">P</span> <span class="id" title="var">P'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">I</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P'</span> <span class="id" title="var">i</span> → <span class="id" title="var">P</span> <span class="id" title="var">i</span>) →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sub_bigmin_cond</span> [<span class="id" title="var">x0</span>] (<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>) <span class="id" title="var">s</span> <span class="id" title="var">s'</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span> (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">subset</span> [<span class="id" title="var">seq</span> <span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>] ≤ [<span class="id" title="var">seq</span> <span class="id" title="var">i</span> &lt;- <span class="id" title="var">s'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>]} →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sub_bigmin_seq</span> [<span class="id" title="var">x0</span>] (<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>) <span class="id" title="var">s</span> <span class="id" title="var">s'</span> <span class="id" title="var">P</span> (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>) : {<span class="id" title="var">subset</span> <span class="id" title="var">s'</span> ≤ <span class="id" title="var">s</span>} →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s'</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sub_in_bigmin</span> [<span class="id" title="var">x0</span>] [<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>] (<span class="id" title="var">s</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>) (<span class="id" title="var">P</span> <span class="id" title="var">P'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">I</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="tactic">in</span> <span class="id" title="var">s</span>, <span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P'</span> <span class="id" title="var">i</span> → <span class="id" title="var">P</span> <span class="id" title="var">i</span>} →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_bigmin_nat</span> [<span class="id" title="var">x0</span>] <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span> <span class="id" title="var">P</span> (<span class="id" title="var">F</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">n</span> ≤ <span class="id" title="var">n'</span>)%<span class="id" title="var">N</span> → (<span class="id" title="var">m'</span> ≤ <span class="id" title="var">m</span>)%<span class="id" title="var">N</span> →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">n</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">n'</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m'</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_bigmin_nat_cond</span> [<span class="id" title="var">x0</span>] <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span> (<span class="id" title="var">P</span> <span class="id" title="var">P'</span> : <span class="id" title="var">pred</span> <span class="id" title="var">nat</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">n</span> ≤ <span class="id" title="var">n'</span>)%<span class="id" title="var">N</span> → (<span class="id" title="var">m'</span> ≤ <span class="id" title="var">m</span>)%<span class="id" title="var">N</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">n'</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m'</span> → <span class="id" title="var">P'</span> <span class="id" title="var">i</span> → <span class="id" title="var">P</span> <span class="id" title="var">i</span>) →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">n</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">n'</span> ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">m'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_bigmin_ord</span> [<span class="id" title="var">x0</span>] <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">nat</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">T</span>) : (<span class="id" title="var">m</span> ≤ <span class="id" title="var">n</span>)%<span class="id" title="var">N</span> →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_bigmin_ord_cond</span> [<span class="id" title="var">x0</span>] <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="var">P</span> <span class="id" title="var">P'</span> : <span class="id" title="var">pred</span> <span class="id" title="var">nat</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">m</span> ≤ <span class="id" title="var">n</span>)%<span class="id" title="var">N</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span> : '<span class="id" title="var">I_m</span>, <span class="id" title="var">P'</span> <span class="id" title="var">i</span> → <span class="id" title="var">P</span> <span class="id" title="var">i</span>) →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subset_bigmin</span> [<span class="id" title="var">x0</span>] [<span class="id" title="var">I</span> : <span class="id" title="var">finType</span>] [<span class="id" title="var">A</span> <span class="id" title="var">A'</span> <span class="id" title="var">P</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">I</span>}] (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A'</span> \<span class="id" title="var">subset</span> <span class="id" title="var">A</span> →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A'</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subset_bigmin_cond</span> [<span class="id" title="var">x0</span>] (<span class="id" title="var">I</span> : <span class="id" title="var">finType</span>) (<span class="id" title="var">A</span> <span class="id" title="var">A'</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span> : {<span class="id" title="var">pred</span> <span class="id" title="var">I</span>}) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">set</span> <span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>]  \<span class="id" title="var">subset</span> [<span class="id" title="tactic">set</span> <span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>] →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x0</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A'</span> | <span class="id" title="var">P'</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">bigmin_finType</span>.<br/>
<span class="id" title="keyword">Variable</span> (<span class="id" title="var">I</span> : <span class="id" title="var">finType</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">T</span>).<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> (<span class="id" title="var">P</span> : <span class="id" title="var">pred</span> <span class="id" title="var">I</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">T</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigminD1</span> <span class="id" title="var">j</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> : <span class="id" title="var">P</span> <span class="id" title="var">j</span> →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = <span class="id" title="var">min</span> (<span class="id" title="var">F</span> <span class="id" title="var">j</span>) (\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span> &amp;&amp; (<span class="id" title="var">i</span> != <span class="id" title="var">j</span>)) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmin_le_cond</span> <span class="id" title="var">j</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> : <span class="id" title="var">P</span> <span class="id" title="var">j</span> → \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">F</span> <span class="id" title="var">j</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmin_le</span> <span class="id" title="var">j</span> <span class="id" title="var">F</span> : \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_i</span> <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">F</span> <span class="id" title="var">j</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmin_inf</span> <span class="id" title="var">j</span> <span class="id" title="var">P</span> <span class="id" title="var">m</span> <span class="id" title="var">F</span> : <span class="id" title="var">P</span> <span class="id" title="var">j</span> → <span class="id" title="var">F</span> <span class="id" title="var">j</span> ≤ <span class="id" title="var">m</span> → \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmin_geP</span> <span class="id" title="var">m</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> : <span class="id" title="var">reflect</span> (<span class="id" title="var">m</span> ≤ <span class="id" title="var">x</span> ∧ <span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">m</span> ≤ <span class="id" title="var">F</span> <span class="id" title="var">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">m</span> ≤ \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmin_gtP</span> <span class="id" title="var">m</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">reflect</span> (<span class="id" title="var">m</span> &lt; <span class="id" title="var">x</span> ∧ <span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">m</span> &lt; <span class="id" title="var">F</span> <span class="id" title="var">i</span>) (<span class="id" title="var">m</span> &lt; \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bigmin_eq_arg</span> <span class="id" title="var">j</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> : <span class="id" title="var">P</span> <span class="id" title="var">j</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">x</span>) →<br/>
&nbsp;&nbsp;\<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = <span class="id" title="var">F</span> [<span class="id" title="var">arg</span> <span class="id" title="var">min_</span>(<span class="id" title="var">i</span> &lt; <span class="id" title="var">j</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span>].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_bigmin</span> <span class="id" title="var">j</span> <span class="id" title="var">P</span> <span class="id" title="var">F</span> : <span class="id" title="var">P</span> <span class="id" title="var">j</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span> → <span class="id" title="var">F</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">x</span>) →<br/>
&nbsp;&nbsp;{<span class="id" title="var">i0</span> | <span class="id" title="var">i0</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">P</span> &amp; \<span class="id" title="var">big</span>[<span class="id" title="var">min</span>/<span class="id" title="var">x</span>]<span class="id" title="var">_</span>(<span class="id" title="var">i</span> | <span class="id" title="var">P</span> <span class="id" title="var">i</span>) <span class="id" title="var">F</span> <span class="id" title="var">i</span> = <span class="id" title="var">F</span> <span class="id" title="var">i0</span>}.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">bigmin_finType</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">bigmin</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">bigmin_mkcond</span> {<span class="id" title="var">d</span> <span class="id" title="var">T</span> <span class="id" title="var">I</span> <span class="id" title="var">r</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">bigminID</span> {<span class="id" title="var">d</span> <span class="id" title="var">T</span> <span class="id" title="var">I</span> <span class="id" title="var">r</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">bigminD1</span> {<span class="id" title="var">d</span> <span class="id" title="var">T</span> <span class="id" title="var">I</span> <span class="id" title="var">x</span>} <span class="id" title="var">j</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">bigmin_inf</span> {<span class="id" title="var">d</span> <span class="id" title="var">T</span> <span class="id" title="var">I</span> <span class="id" title="var">x</span>} <span class="id" title="var">j</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">bigmin_eq_arg</span> {<span class="id" title="var">d</span> <span class="id" title="var">T</span> <span class="id" title="var">I</span>} <span class="id" title="var">x</span> <span class="id" title="var">j</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">eq_bigmin</span> {<span class="id" title="var">d</span> <span class="id" title="var">T</span> <span class="id" title="var">I</span> <span class="id" title="var">x</span>} <span class="id" title="var">j</span>.<br/>

<br/>
</div>

<div class="doc"> End of MathComp 1.16.0 additions

  MathComp &gt; 1.16 additions
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;f \max g" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">max_fun</span> <span class="id" title="var">T</span> (<span class="id" title="var">R</span> : <span class="id" title="var">numDomainType</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">T</span> → <span class="id" title="var">R</span>) <span class="id" title="var">x</span> := <span class="id" title="var">Num.max</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="var">g</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Notation</span> &quot;f \max g" := (<span class="id" title="var">max_fun</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>) : <span class="id" title="var">ring_scope</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">max_fun</span> {<span class="id" title="var">T</span> <span class="id" title="var">R</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> /.<br/>

<br/>
</div>

<div class="doc"> End of mathComp &gt; 1.16 additions
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">onem</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">R</span> : <span class="id" title="var">numDomainType</span>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">r</span> : <span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">onem</span> <span class="id" title="var">r</span> := 1 - <span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">onem0</span> : `1-0 = 1.  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">onem1</span> : `1-1 = 0.  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">onemK</span> <span class="id" title="var">r</span> : `1-(`1-<span class="id" title="var">r</span>) = <span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_onemK</span> <span class="id" title="var">r</span> : <span class="id" title="var">r</span> + `1- <span class="id" title="var">r</span> = 1.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">onem_gt0</span> <span class="id" title="var">r</span> : <span class="id" title="var">r</span> &lt; 1 → 0 &lt; `1-<span class="id" title="var">r</span>.  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">onem_ge0</span> <span class="id" title="var">r</span> : <span class="id" title="var">r</span> ≤ 1 → 0 ≤ `1-<span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">onem_le1</span> <span class="id" title="var">r</span> : 0 ≤ <span class="id" title="var">r</span> → `1-<span class="id" title="var">r</span> ≤ 1.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">onem_lt1</span> <span class="id" title="var">r</span> : 0 &lt; <span class="id" title="var">r</span> → `1-<span class="id" title="var">r</span> &lt; 1.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">onemX_ge0</span> <span class="id" title="var">r</span> <span class="id" title="var">n</span> : 0 ≤ <span class="id" title="var">r</span> → <span class="id" title="var">r</span> ≤ 1 → 0 ≤ `1-(<span class="id" title="var">r</span> ^+ <span class="id" title="var">n</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">onemX_lt1</span> <span class="id" title="var">r</span> <span class="id" title="var">n</span> : 0 &lt; <span class="id" title="var">r</span> → `1-(<span class="id" title="var">r</span> ^+ <span class="id" title="var">n</span>) &lt; 1.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">onemD</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span> : `1-(<span class="id" title="var">r</span> + <span class="id" title="var">s</span>) = `1-<span class="id" title="var">r</span> - <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">onemMr</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span> : <span class="id" title="var">s</span> × `1-<span class="id" title="var">r</span> = <span class="id" title="var">s</span> - <span class="id" title="var">s</span> × <span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">onemM</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span> : `1-(<span class="id" title="var">r</span> × <span class="id" title="var">s</span>) = `1-<span class="id" title="var">r</span> + `1-<span class="id" title="var">s</span> - `1-<span class="id" title="var">r</span> × `1-<span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">onem</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;`1- r" := (<span class="id" title="var">onem</span> <span class="id" title="var">r</span>) : <span class="id" title="var">ring_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lez_abs2</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">int</span>) : 0 ≤ <span class="id" title="var">a</span> → <span class="id" title="var">a</span> ≤ <span class="id" title="var">b</span> → (`|<span class="id" title="var">a</span>| ≤ `|<span class="id" title="var">b</span>|)%<span class="id" title="var">N</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ler_gtP</span> (<span class="id" title="var">R</span> : <span class="id" title="var">numFieldType</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">reflect</span> (<span class="id" title="keyword">∀</span> <span class="id" title="var">z</span>, <span class="id" title="var">z</span> &gt; <span class="id" title="var">y</span> → <span class="id" title="var">x</span> ≤ <span class="id" title="var">z</span>) (<span class="id" title="var">x</span> ≤ <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ler_ltP</span> (<span class="id" title="var">R</span> : <span class="id" title="var">numFieldType</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">reflect</span> (<span class="id" title="keyword">∀</span> <span class="id" title="var">z</span>, <span class="id" title="var">z</span> &lt; <span class="id" title="var">x</span> → <span class="id" title="var">z</span> ≤ <span class="id" title="var">y</span>) (<span class="id" title="var">x</span> ≤ <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">inv_fun</span> <span class="id" title="var">T</span> (<span class="id" title="var">R</span> : <span class="id" title="var">unitRingType</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">T</span> → <span class="id" title="var">R</span>) <span class="id" title="var">x</span> := (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)^-1%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;f \^-1" := (<span class="id" title="var">inv_fun</span> <span class="id" title="var">f</span>) : <span class="id" title="var">ring_scope</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">inv_fun</span> {<span class="id" title="var">T</span> <span class="id" title="var">R</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> /.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">bound_side</span> <span class="id" title="var">d</span> (<span class="id" title="var">T</span> : <span class="id" title="var">porderType</span> <span class="id" title="var">d</span>) (<span class="id" title="var">c</span> : <span class="id" title="var">bool</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">itv_bound</span> <span class="id" title="var">T</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">x</span> <span class="id" title="keyword">is</span> <span class="id" title="var">BSide</span> <span class="id" title="var">c'</span> <span class="id" title="var">_</span> <span class="id" title="keyword">then</span> <span class="id" title="var">c</span> == <span class="id" title="var">c'</span> <span class="id" title="keyword">else</span> <span class="id" title="var">false</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">real_ltr_distlC</span> [<span class="id" title="var">R</span> : <span class="id" title="var">numDomainType</span>] [<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">R</span>] (<span class="id" title="var">e</span> : <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> - <span class="id" title="var">y</span> \<span class="id" title="keyword">is</span> <span class="id" title="var">Num.real</span> → (`|<span class="id" title="var">x</span> - <span class="id" title="var">y</span>| &lt; <span class="id" title="var">e</span>) = (<span class="id" title="var">x</span> - <span class="id" title="var">e</span> &lt; <span class="id" title="var">y</span> &lt; <span class="id" title="var">x</span> + <span class="id" title="var">e</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">proj</span> {<span class="id" title="var">I</span>} {<span class="id" title="var">T</span> : <span class="id" title="var">I</span> → <span class="id" title="keyword">Type</span>} <span class="id" title="var">i</span> (<span class="id" title="var">f</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">T</span> <span class="id" title="var">i</span>) := <span class="id" title="var">f</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">DFunWith</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">I</span> : <span class="id" title="var">eqType</span>) (<span class="id" title="var">T</span> : <span class="id" title="var">I</span> → <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>, <span class="id" title="var">T</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dfwith</span> <span class="id" title="var">i</span> (<span class="id" title="var">x</span> : <span class="id" title="var">T</span> <span class="id" title="var">i</span>) (<span class="id" title="var">j</span> : <span class="id" title="var">I</span>) : <span class="id" title="var">T</span> <span class="id" title="var">j</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">i</span> =<span class="id" title="var">P</span> <span class="id" title="var">j</span>) <span class="id" title="keyword">is</span> <span class="id" title="var">ReflectT</span> <span class="id" title="var">ij</span> <span class="id" title="keyword">then</span> <span class="id" title="var">ecast</span> <span class="id" title="var">j</span> (<span class="id" title="var">T</span> <span class="id" title="var">j</span>) <span class="id" title="var">ij</span> <span class="id" title="var">x</span> <span class="id" title="keyword">else</span> <span class="id" title="var">f</span> <span class="id" title="var">j</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dfwithin</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span> : <span class="id" title="var">dfwith</span> <span class="id" title="var">x</span> <span class="id" title="var">i</span> = <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dfwithout</span> <span class="id" title="var">i</span> (<span class="id" title="var">x</span> : <span class="id" title="var">T</span> <span class="id" title="var">i</span>) <span class="id" title="var">j</span> : <span class="id" title="var">i</span> != <span class="id" title="var">j</span> → <span class="id" title="var">dfwith</span> <span class="id" title="var">x</span> <span class="id" title="var">j</span> = <span class="id" title="var">f</span> <span class="id" title="var">j</span>.<br/>

<br/>
<span class="id" title="keyword">Variant</span> <span class="id" title="var">dfwith_spec</span> <span class="id" title="var">i</span> (<span class="id" title="var">x</span> : <span class="id" title="var">T</span> <span class="id" title="var">i</span>) : <span class="id" title="keyword">∀</span> <span class="id" title="var">j</span>, <span class="id" title="var">T</span> <span class="id" title="var">j</span> → <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">DFunWithin</span> : <span class="id" title="var">dfwith_spec</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">DFunWithout</span> <span class="id" title="var">j</span> : <span class="id" title="var">i</span> != <span class="id" title="var">j</span> → <span class="id" title="var">dfwith_spec</span> <span class="id" title="var">x</span> (<span class="id" title="var">f</span> <span class="id" title="var">j</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dfwithP</span> <span class="id" title="var">i</span> (<span class="id" title="var">x</span> : <span class="id" title="var">T</span> <span class="id" title="var">i</span>) (<span class="id" title="var">j</span> : <span class="id" title="var">I</span>) : <span class="id" title="var">dfwith_spec</span> <span class="id" title="var">x</span> (<span class="id" title="var">dfwith</span> <span class="id" title="var">x</span> <span class="id" title="var">j</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">projK</span> <span class="id" title="var">i</span> (<span class="id" title="var">x</span> : <span class="id" title="var">T</span> <span class="id" title="var">i</span>) : <span class="id" title="var">cancel</span> (@<span class="id" title="var">dfwith</span> <span class="id" title="var">i</span>) (<span class="id" title="var">proj</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">DFunWith</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">dfwith</span> {<span class="id" title="var">I</span> <span class="id" title="var">T</span>} <span class="id" title="var">f</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">swap</span> (<span class="id" title="var">T1</span> <span class="id" title="var">T2</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">T1</span> × <span class="id" title="var">T2</span>) := (<span class="id" title="var">x</span>.2, <span class="id" title="var">x</span>.1).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ler_sqrt</span> {<span class="id" title="var">R</span> : <span class="id" title="var">rcfType</span>} (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;(0 ≤ <span class="id" title="var">b</span> → (<span class="id" title="var">Num.sqrt</span> <span class="id" title="var">a</span> ≤ <span class="id" title="var">Num.sqrt</span> <span class="id" title="var">b</span>) = (<span class="id" title="var">a</span> ≤ <span class="id" title="var">b</span>))%<span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">order_min</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">d</span> : <span class="id" title="var">unit</span>) (<span class="id" title="var">T</span> : <span class="id" title="var">orderType</span> <span class="id" title="var">d</span>).<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Order</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">order_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_min_lt</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">T</span>) : (<span class="id" title="var">min</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> &lt; <span class="id" title="var">min</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>)%<span class="id" title="var">O</span> → (<span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span>)%<span class="id" title="var">O</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">order_min</span>.<br/>

<br/>
</div>

<div class="doc"> MathComp 2.1 additions
</div>
<div class="code">

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">poly</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">coefE</span> :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">coef0</span>, <span class="id" title="var">coef1</span>, <span class="id" title="var">coefC</span>, <span class="id" title="var">coefX</span>, <span class="id" title="var">coefXn</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">coefZ</span>, <span class="id" title="var">coefMC</span>, <span class="id" title="var">coefCM</span>, <span class="id" title="var">coefXnM</span>, <span class="id" title="var">coefMXn</span>, <span class="id" title="var">coefXM</span>, <span class="id" title="var">coefMX</span>, <span class="id" title="var">coefMNn</span>, <span class="id" title="var">coefMn</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">coefN</span>, <span class="id" title="var">coefB</span>, <span class="id" title="var">coefD</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">coef_cons</span>, <span class="id" title="var">coef_Poly</span>, <span class="id" title="var">coef_poly</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">coef_deriv</span>, <span class="id" title="var">coef_nderivn</span>, <span class="id" title="var">coef_derivn</span>, <span class="id" title="var">coef_map</span>, <span class="id" title="var">coef_sum</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">coef_comp_poly</span>).<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Pdeg2</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Field</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Pdeg2Field</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">F</span> : <span class="id" title="var">fieldType</span>.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">nz2</span> : 2%:<span class="id" title="var">R</span> != 0 :&gt; <span class="id" title="var">F</span>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">p</span> : {<span class="id" title="var">poly</span> <span class="id" title="var">F</span>}.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">degp</span> : <span class="id" title="var">size</span> <span class="id" title="var">p</span> = 3%<span class="id" title="var">N</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">a</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_2</span>.<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">b</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_1</span>.<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">c</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_0</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">pneq0</span> : <span class="id" title="var">p</span> != 0.  <br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">aneq0</span> : <span class="id" title="var">a</span> != 0.<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">a2neq0</span> : 2%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span> != 0.  <br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">sqa2neq0</span> : (2%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span>) ^+ 2 != 0.  <br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">aa4</span> : 4%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span> × <span class="id" title="var">a</span> = (2%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span>)^+2.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">splitr</span> (<span class="id" title="var">x</span> : <span class="id" title="var">F</span>) : <span class="id" title="var">x</span> = <span class="id" title="var">x</span> / 2%:<span class="id" title="var">R</span> + <span class="id" title="var">x</span> / 2%:<span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">pE</span> : <span class="id" title="var">p</span> = <span class="id" title="var">a</span> *: '<span class="id" title="var">X</span>^2 + <span class="id" title="var">b</span> *: '<span class="id" title="var">X</span> + <span class="id" title="var">c</span>%:<span class="id" title="var">P</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="keyword">delta</span> := <span class="id" title="var">b</span> ^+ 2 - 4%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span> × <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">deg2_poly_canonical</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">p</span> = <span class="id" title="var">a</span> *: (('<span class="id" title="var">X</span> + (<span class="id" title="var">b</span> / (2%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span>))%:<span class="id" title="var">P</span>)^+2 - (<span class="id" title="keyword">delta</span> / (4%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span> ^+ 2))%:<span class="id" title="var">P</span>).<br/>

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">r</span> : <span class="id" title="var">F</span>.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">r_sqrt_delta</span> : <span class="id" title="var">r</span> ^+ 2 = <span class="id" title="keyword">delta</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">r1</span> := (- <span class="id" title="var">b</span> - <span class="id" title="var">r</span>) / (2%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span>).<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">r2</span> := (- <span class="id" title="var">b</span> + <span class="id" title="var">r</span>) / (2%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">deg2_poly_factor</span> : <span class="id" title="var">p</span> = <span class="id" title="var">a</span> *: ('<span class="id" title="var">X</span> - <span class="id" title="var">r1</span>%:<span class="id" title="var">P</span>) × ('<span class="id" title="var">X</span> - <span class="id" title="var">r2</span>%:<span class="id" title="var">P</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Pdeg2Field</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Field</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Real</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Pdeg2Real</span>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">F</span> : <span class="id" title="var">realFieldType</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Pdeg2RealConvex</span>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">p</span> : {<span class="id" title="var">poly</span> <span class="id" title="var">F</span>}.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">degp</span> : <span class="id" title="var">size</span> <span class="id" title="var">p</span> = 3%<span class="id" title="var">N</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">a</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_2</span>.<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">b</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_1</span>.<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">c</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_0</span>.<br/>

<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">age0</span> : 0 ≤ <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="keyword">delta</span> := <span class="id" title="var">b</span> ^+ 2 - 4%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span> × <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">pneq0</span> : <span class="id" title="var">p</span> != 0.  <br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">aneq0</span> : <span class="id" title="var">a</span> != 0.<br/>
 <span class="id" title="keyword">Let</span> <span class="id" title="var">agt0</span> : 0 &lt; <span class="id" title="var">a</span>.  <br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">a4gt0</span> : 0 &lt; 4%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span>.  <br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">deg2_poly_min</span> <span class="id" title="var">x</span> : <span class="id" title="var">p</span>.[- <span class="id" title="var">b</span> / (2%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span>)] ≤ <span class="id" title="var">p</span>.[<span class="id" title="var">x</span>].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">deg2_poly_minE</span> : <span class="id" title="var">p</span>.[- <span class="id" title="var">b</span> / (2%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span>)] = - <span class="id" title="keyword">delta</span> / (4%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">deg2_poly_ge0</span> : <span class="id" title="var">reflect</span> (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, 0 ≤ <span class="id" title="var">p</span>.[<span class="id" title="var">x</span>]) (<span class="id" title="keyword">delta</span> ≤ 0).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Pdeg2RealConvex</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Pdeg2Real</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Pdeg2RealClosed</span>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">F</span> : <span class="id" title="var">rcfType</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Pdeg2RealClosedConvex</span>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">p</span> : {<span class="id" title="var">poly</span> <span class="id" title="var">F</span>}.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">degp</span> : <span class="id" title="var">size</span> <span class="id" title="var">p</span> = 3%<span class="id" title="var">N</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">a</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_2</span>.<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">b</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_1</span>.<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">c</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_0</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">nz2</span> : 2%:<span class="id" title="var">R</span> != 0 :&gt; <span class="id" title="var">F</span>.  <br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="keyword">delta</span> := <span class="id" title="var">b</span> ^+ 2 - 4%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span> × <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">r1</span> := (- <span class="id" title="var">b</span> - <span class="id" title="var">Num.sqrt</span> <span class="id" title="keyword">delta</span>) / (2%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span>).<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">r2</span> := (- <span class="id" title="var">b</span> + <span class="id" title="var">Num.sqrt</span> <span class="id" title="keyword">delta</span>) / (2%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">deg2_poly_factor</span> : 0 ≤ <span class="id" title="keyword">delta</span> → <span class="id" title="var">p</span> = <span class="id" title="var">a</span> *: ('<span class="id" title="var">X</span> - <span class="id" title="var">r1</span>%:<span class="id" title="var">P</span>) × ('<span class="id" title="var">X</span> - <span class="id" title="var">r2</span>%:<span class="id" title="var">P</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Pdeg2RealClosedConvex</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Pdeg2RealClosed</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Real</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Pdeg2</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Degle2PolyRealConvex</span>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> (<span class="id" title="var">F</span> : <span class="id" title="var">realFieldType</span>) (<span class="id" title="var">p</span> : {<span class="id" title="var">poly</span> <span class="id" title="var">F</span>}).<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">degp</span> : (<span class="id" title="var">size</span> <span class="id" title="var">p</span> ≤ 3)%<span class="id" title="var">N</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">a</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_2</span>.<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">b</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_1</span>.<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">c</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_0</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="keyword">delta</span> := <span class="id" title="var">b</span> ^+ 2 - 4%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span> × <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">deg_le2_poly_delta_ge0</span> : 0 ≤ <span class="id" title="var">a</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, 0 ≤ <span class="id" title="var">p</span>.[<span class="id" title="var">x</span>]) → <span class="id" title="keyword">delta</span> ≤ 0.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Degle2PolyRealConvex</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Degle2PolyRealClosedConvex</span>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> (<span class="id" title="var">F</span> : <span class="id" title="var">rcfType</span>) (<span class="id" title="var">p</span> : {<span class="id" title="var">poly</span> <span class="id" title="var">F</span>}).<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">degp</span> : (<span class="id" title="var">size</span> <span class="id" title="var">p</span> ≤ 3)%<span class="id" title="var">N</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">a</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_2</span>.<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">b</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_1</span>.<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">c</span> := <span class="id" title="var">p</span>`<span class="id" title="var">_0</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="keyword">delta</span> := <span class="id" title="var">b</span> ^+ 2 - 4%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span> × <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">deg_le2_poly_ge0</span> : (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, 0 ≤ <span class="id" title="var">p</span>.[<span class="id" title="var">x</span>]) → <span class="id" title="keyword">delta</span> ≤ 0.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Degle2PolyRealClosedConvex</span>.<br/>

<br/>
</div>

<div class="doc"> not yet backported
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">deg_le2_ge0</span> (<span class="id" title="var">F</span> : <span class="id" title="var">rcfType</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <span class="id" title="var">F</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, 0 ≤ <span class="id" title="var">a</span> × <span class="id" title="var">x</span> ^+ 2 + <span class="id" title="var">b</span> × <span class="id" title="var">x</span> + <span class="id" title="var">c</span>)%<span class="id" title="var">R</span> → (<span class="id" title="var">b</span> ^+ 2 - 4%:<span class="id" title="var">R</span> × <span class="id" title="var">a</span> × <span class="id" title="var">c</span> ≤ 0)%<span class="id" title="var">R</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>